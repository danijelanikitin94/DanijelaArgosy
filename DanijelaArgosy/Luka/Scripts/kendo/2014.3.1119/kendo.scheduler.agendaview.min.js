(function(n,t){t(["./kendo.scheduler.view"],n)})(function(){return function(n){function e(n){for(var i=0,t=0,r=n.length;t<r;t++)i+=n[t].items.length;return i}function o(n,i){return n.valuePrimitive&&(i=t.getter(n.dataValueField)(i)),i}function s(n){for(var r=0,f=n.length,t,i=[];r<f;r++)t=n[r],t.groups?(t=u(t.groups),i=i.concat(t)):i=i.concat(u(t.items));return i}function u(n){for(var i=[].concat(n),t=i.shift(),u=[],r=[].push;t;)t.groups?r.apply(i,t.groups):t.items?r.apply(i,t.items):r.call(u,t),t=i.shift();return u}var t=window.kendo,i=t.ui,r=".kendoAgendaView",f='<div class="k-task" title="#:title.replace(/"/g,"\'")#" data-#=kendo.ns#uid="#=uid#"># if (resources[0]) {#<span class="k-scheduler-mark" style="background-color:#=resources[0].color#"><\/span># } ## if (data.isException()) { #<span class="k-icon k-i-exception"><\/span># } else if (data.isRecurring()) {#<span class="k-icon k-i-refresh"><\/span># } #{0}#if (showDelete) {#<a href="\\#" class="k-link k-event-delete"><span class="k-icon k-si-close"><\/span><\/a>#}#<\/div>';i.AgendaView=i.SchedulerView.extend({init:function(u,e){i.SchedulerView.fn.init.call(this,u,e);e=this.options;e.editable&&(e.editable=n.extend({"delete":!0},e.editable,{create:!1,update:!1}));this.title=e.title;this.name="agenda";this._eventTemplate=this._eventTmpl(e.eventTemplate,f);this._dateTemplate=t.template(e.eventDateTemplate);this._groupTemplate=t.template(e.eventGroupTemplate);this._timeTemplate=t.template(e.eventTimeTemplate);this.element.on("mouseenter"+r,".k-scheduler-agenda .k-scheduler-content tr","_mouseenter").on("mouseleave"+r,".k-scheduler-agenda .k-scheduler-content tr","_mouseleave").on("click"+r,".k-scheduler-agenda .k-scheduler-content .k-link:has(.k-si-close)","_remove");this._renderLayout(e.date)},_mouseenter:function(t){n(t.currentTarget).addClass("k-state-hover")},_mouseleave:function(t){n(t.currentTarget).removeClass("k-state-hover")},_remove:function(i){i.preventDefault();this.trigger("remove",{uid:n(i.currentTarget).closest(".k-task").attr(t.attr("uid"))})},nextDate:function(){return t.date.nextDay(this.startDate())},startDate:function(){return this._startDate},endDate:function(){return this._endDate},previousDate:function(){return t.date.previousDay(this.startDate())},_renderLayout:function(n){this._startDate=n;this._endDate=t.date.addDays(n,7);this.createLayout(this._layout());this.table.addClass("k-scheduler-agenda")},_layout:function(){var n=[{text:this.options.messages.time,className:"k-scheduler-timecolumn"},{text:this.options.messages.event}],t,i,r;if(this._isMobilePhoneView()||n.splice(0,0,{text:this.options.messages.date,className:"k-scheduler-datecolumn"}),t=this.groupedResources,t.length){for(i=[],r=0;r<t.length;r++)i.push({text:"",className:"k-scheduler-groupcolumn"});n=i.concat(n)}return{columns:n}},_tasks:function(n){for(var e,o=[],s=0;s<n.length;s++){var f=n[s],r=f.start,u=f.end,h=(t.date.getDate(u)-t.date.getDate(r))/t.date.MS_PER_DAY+1,i=f.clone();if(i.startDate=t.date.getDate(r),i.startDate>=this.startDate()&&o.push(i),h>1)for(i.end=t.date.nextDay(r),i.head=!0,e=1;e<h;e++)r=i.end,i=f.clone(),i.start=r,i.startDate=t.date.getDate(r),i.end=t.date.nextDay(r),e==h-1?(i.end=new Date(i.start.getFullYear(),i.start.getMonth(),i.start.getDate(),u.getHours(),u.getMinutes(),u.getSeconds(),u.getMilliseconds()),i.tail=!0):(i.isAllDay=!0,i.middle=!0),i.end<=this.endDate()&&i.start>=this.startDate()&&o.push(i)}return new t.data.Query(o).sort([{field:"start",dir:"asc"},{field:"end",dir:"asc"}]).groupBy({field:"startDate"}).toArray()},_renderTaskGroups:function(n,i){for(var f,e,s=[],a=this.options.editable,p=a&&a.destroy!==!1&&!this._isMobile(),v=this._isMobilePhoneView(),u=0;u<n.length;u++){var h=n[u].value,c=n[u].items,y=t.date.isToday(h);for(f=0;f<c.length;f++){var r=c[f],o=[],l=v?[]:o;if(u===0&&f===0&&i.length)for(e=0;e<i.length;e++)l.push(t.format('<td class="k-scheduler-groupcolumn{2}" rowspan="{0}">{1}<\/td>',i[e].rowSpan,this._groupTemplate({value:i[e].text}),i[e].className));f===0&&(v?(l.push(t.format('<td class="k-scheduler-datecolumn" colspan="2">{0}<\/td>',this._dateTemplate({date:h}))),s.push('<tr role="row" aria-selected="false"'+(y?' class="k-today">':">")+l.join("")+"<\/tr>")):o.push(t.format('<td class="k-scheduler-datecolumn{3}{2}" rowspan="{0}">{1}<\/td>',c.length,this._dateTemplate({date:h}),u==n.length-1&&!i.length?" k-last":"",i.length?"":" k-first")));r.format=r.head?"{0:t}":r.tail?"{1:t}":"{0:t}-{1:t}";r.resources=this.eventResources(r);o.push(t.format('<td class="k-scheduler-timecolumn"><div>{0}{1}{2}<\/div><\/td><td>{3}<\/td>',r.tail||r.middle?'<span class="k-icon k-i-arrow-w"><\/span>':"",this._timeTemplate(r.clone({start:r.startTime||r.start,end:r.endTime||r.end})),r.head||r.middle?'<span class="k-icon k-i-arrow-e"><\/span>':"",this._eventTemplate(r.clone({showDelete:p}))));s.push('<tr role="row" aria-selected="false"'+(y?' class="k-today">':">")+o.join("")+"<\/tr>")}}return s.join("")},render:function(n){var i=this.content.find("table").empty(),t=[],r,u;n.length>0&&(r=this.groupedResources,r.length?(t=this._createGroupConfiguration(n,r,null),this._renderGroups(t,i,[])):(t=this._tasks(n),i.append(this._renderTaskGroups(t,[]))));u=this._eventsList=s(t);this._angularItems(i,u);this.refreshLayout();this.trigger("activate")},_angularItems:function(n,i){this.angular("compile",function(){var r=[],u=i.map(function(i){return r.push({dataItem:i}),n.find(".k-task["+t.attr("uid")+"="+i.uid+"]")});return{elements:u,data:r}})},_renderGroups:function(n,t,i){for(var u,r=0,f=n.length;r<f;r++)u=i.splice(0),u.push(n[r]),n[r].groups?this._renderGroups(n[r].groups,t,u):t.append(this._renderTaskGroups(n[r].items,u))},_createGroupConfiguration:function(n,r,u){for(var v,l,w,y,f,a,h=r[0],p=[],c=h.dataSource.view(),b=this._isMobilePhoneView(),s=0;s<c.length;s++)v=o(h,c[s]),l=new t.data.Query(n).filter({field:h.field,operator:i.SchedulerView.groupEqFilter(v)}).toArray(),l.length&&(w=this._tasks(l),y=u?"":" k-first",s===c.length-1&&(!u||u.className.indexOf("k-last")>-1)&&(y+=" k-last"),f={text:t.getter(h.dataTextField)(c[s]),value:v,rowSpan:0,className:y},r.length>1?(f.groups=this._createGroupConfiguration(l,r.slice(1),f),u&&(u.rowSpan+=f.rowSpan)):(f.items=w,a=e(f.items),b&&(a+=f.items.length),f.rowSpan=a,u&&(u.rowSpan+=a)),p.push(f));return p},selectionByElement:function(t){var r,i,u;if(t=n(t),!t.hasClass("k-scheduler-datecolumn"))return this._isMobile()?(u=t.parent(),r=u.parent().children().filter(function(){return n(this).children(":not(.k-scheduler-datecolumn)").length}).index(u)):r=t.parent().index(),i=this._eventsList[r],{index:r,start:i.start,end:i.end,isAllDay:i.isAllDay,uid:i.uid}},select:function(n){this.clearSelection();var t=this.table.find(".k-task").eq(n.index).closest("tr").addClass("k-state-selected").attr("aria-selected",!0)[0];this.current(t)},move:function(n,i){var u=!1,f=n.index,r;return i==t.keys.UP?(f--,u=!0):i==t.keys.DOWN&&(f++,u=!0),u&&(r=this._eventsList[f],r&&(n.start=r.start,n.end=r.end,n.isAllDay=r.isAllDay,n.events=[r.uid],n.index=f)),u},moveToEvent:function(){return!1},constrainSelection:function(n){var t=this._eventsList[0];t&&(n.start=t.start,n.end=t.end,n.isAllDay=t.isAllDay,n.events=[t.uid],n.index=0)},isInRange:function(){return!0},destroy:function(){this.element&&this.element.off(r);i.SchedulerView.fn.destroy.call(this)},options:{title:"Agenda",name:"agenda",editable:!0,selectedDateFormat:"{0:D}-{1:D}",eventTemplate:"#:title#",eventTimeTemplate:"#if(data.isAllDay) {##=this.options.messages.allDay##} else { ##=kendo.format(format, start, end)## } #",eventDateTemplate:'<strong class="k-scheduler-agendaday">#=kendo.toString(date, "dd")#<\/strong><em class="k-scheduler-agendaweek">#=kendo.toString(date,"dddd")#<\/em><span class="k-scheduler-agendadate">#=kendo.toString(date, "y")#<\/span>',eventGroupTemplate:'<strong class="k-scheduler-adgendagroup">#=value#<\/strong>',messages:{event:"Event",date:"Date",time:"Time",allDay:"all day"}}})}(window.kendo.jQuery),window.kendo},typeof define=="function"&&define.amd?define:function(n,t){t()});
//# sourceMappingURL=kendo.scheduler.agendaview.min.js.map
