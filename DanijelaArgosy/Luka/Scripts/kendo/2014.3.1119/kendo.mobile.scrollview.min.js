(function(n,t){t(["./kendo.fx","./kendo.data","./kendo.draganddrop"],n)})(function(){return function(n,t){var i=window.kendo,lt=i.mobile,d=lt.ui,r=n.proxy,s=i.effects.Transition,at=i.ui.Pane,vt=i.ui.PaneDimensions,y=d.DataBoundWidget,g=i.data.DataSource,yt=i.data.Buffer,pt=i.data.BatchBuffer,e=Math,h=e.abs,c=e.ceil,nt=e.round,wt=e.max,bt=e.min,tt=e.floor,u="change",l="changing",f="refresh",p="km-current-page",it="km-virtual-page",rt="function",w="itemChange",ut="cleanup",kt=3,dt=-1,gt=0,ni=1,a=-1,ti=0,v=1,ft=i.Class.extend({init:function(t){var i=this,e=n("<ol class='km-pages'/>");t.element.append(e);this._changeProxy=r(i,"_change");this._refreshProxy=r(i,"_refresh");t.bind(u,this._changeProxy);t.bind(f,this._refreshProxy);n.extend(i,{element:e,scrollView:t})},items:function(){return this.element.children()},_refresh:function(n){for(var t="",i=0;i<n.pageCount;i++)t+="<li/>";this.element.html(t);this.items().eq(n.page).addClass(p)},_change:function(n){this.items().removeClass(p).eq(n.page).addClass(p)},destroy:function(){this.scrollView.unbind(u,this._changeProxy);this.scrollView.unbind(f,this._refreshProxy);this.element.remove()}}),b,o,k,ct;i.mobile.ui.ScrollViewPager=ft;var et="transitionEnd",ot="dragStart",st="dragEnd",ht=i.Observable.extend({init:function(t,r){var f=this,o,l,e,c,a,v;i.Observable.fn.init.call(this);this.element=t;this.container=t.parent();o=new i.ui.Movable(f.element);l=new s({axis:"x",movable:o,onEnd:function(){f.trigger(et)}});e=new i.UserEvents(t,{start:function(n){h(n.x.velocity)*2>=h(n.y.velocity)?e.capture():e.cancel();f.trigger(ot,n);l.cancel()},allowSelection:!0,end:function(n){f.trigger(st,n)}});c=new vt({element:f.element,container:f.container});a=c.x;a.bind(u,function(){f.trigger(u)});v=new at({dimensions:c,userEvents:e,movable:o,elastic:!0});n.extend(f,{duration:r&&r.duration||1,movable:o,transition:l,userEvents:e,dimensions:c,dimension:a,pane:v});this.bind([et,ot,st,u],r)},size:function(){return{width:this.dimensions.x.getSize(),height:this.dimensions.y.getSize()}},total:function(){return this.dimension.getTotal()},offset:function(){return-this.movable.x},updateDimension:function(){this.dimension.update(!0)},refresh:function(){this.dimensions.refresh()},moveTo:function(n){this.movable.moveAxis("x",-n)},transitionTo:function(n,t,i){i?this.moveTo(-n):this.transition.moveTo({location:n,duration:this.duration,ease:t})}});i.mobile.ui.ScrollViewElasticPane=ht;b=i.Observable.extend({init:function(n,t,r){var u=this;i.Observable.fn.init.call(this);u.element=n;u.pane=t;u._getPages();this.page=0;this.pageSize=r.pageSize||1;this.contentHeight=r.contentHeight;this.enablePager=r.enablePager},scrollTo:function(n,t){this.page=n;this.pane.transitionTo(-n*this.pane.size().width,s.easeOutExpo,t)},paneMoved:function(n,t,i,r){var u=this,f=u.pane,l=f.size().width*u.pageSize,o=nt,y=t?s.easeOutBack:s.easeOutExpo,h,e;n===a?o=c:n===v&&(o=tt);e=o(f.offset()/l);h=wt(u.minSnap,bt(-e*l,u.maxSnap));e!=u.page&&i&&i({currentPage:u.page,nextPage:e})&&(h=-u.page*f.size().width);f.transitionTo(h,y,r)},updatePage:function(){var n=this.pane,t=nt(n.offset()/n.size().width);return t!=this.page?(this.page=t,!0):!1},forcePageUpdate:function(){return this.updatePage()},resizeTo:function(n){var r=this.pane,t=n.width,i,u;this.pageElements.width(t);this.contentHeight==="100%"&&(i=this.element.parent().height(),this.enablePager===!0&&(u=this.element.parent().find("ol.km-pages"),u.length&&(i-=u.outerHeight(!0))),this.element.css("height",i),this.pageElements.css("height",i));r.updateDimension();this._paged||(this.page=tt(r.offset()/t));this.scrollTo(this.page,!0);this.pageCount=c(r.total()/t);this.minSnap=-(this.pageCount-1)*t;this.maxSnap=0},_getPages:function(){this.pageElements=this.element.find(i.roleSelector("page"));this._paged=this.pageElements.length>0}});i.mobile.ui.ScrollViewContent=b;o=i.Observable.extend({init:function(n,t,r){var u=this;i.Observable.fn.init.call(this);u.element=n;u.pane=t;u.options=r;u._templates();u.page=r.page||0;u.pages=[];u._initPages();u.resizeTo(u.pane.size());u.pane.dimension.forceEnabled()},setDataSource:function(n){this.dataSource=g.create(n);this._buffer();this._pendingPageRefresh=!1;this._pendingWidgetRefresh=!1},_viewShow:function(){var n=this;n._pendingWidgetRefresh&&(setTimeout(function(){n._resetPages()},0),n._pendingWidgetRefresh=!1)},_buffer:function(){var n=this.options.itemsPerPage;this.buffer&&this.buffer.destroy();this.buffer=n>1?new pt(this.dataSource,n):new yt(this.dataSource,n*3);this._resizeProxy=r(this,"_onResize");this._resetProxy=r(this,"_onReset");this._endReachedProxy=r(this,"_onEndReached");this.buffer.bind({resize:this._resizeProxy,reset:this._resetProxy,endreached:this._endReachedProxy})},_templates:function(){var n=this.options.template,t=this.options.emptyTemplate,u={},f={};typeof n===rt&&(u.template=n,n="#=this.template(data)#");this.template=r(i.template(n),u);typeof t===rt&&(f.emptyTemplate=t,t="#=this.emptyTemplate(data)#");this.emptyTemplate=r(i.template(t),f)},_initPages:function(){for(var i=this.pages,r=this.element,n,t=0;t<kt;t++)n=new k(r),i.push(n);this.pane.updateDimension()},resizeTo:function(n){for(var t,u,i=this.pages,f=this.pane,r=0;r<i.length;r++)i[r].setWidth(n.width);this.options.contentHeight==="auto"?this.element.css("height",this.pages[1].element.height()):this.options.contentHeight==="100%"&&(t=this.element.parent().height(),this.options.enablePager===!0&&(u=this.element.parent().find("ol.km-pages"),u.length&&(t-=u.outerHeight(!0))),this.element.css("height",t),i[0].element.css("height",t),i[1].element.css("height",t),i[2].element.css("height",t));f.updateDimension();this._repositionPages();this.width=n.width},scrollTo:function(n){var t=this.buffer,i;(t.syncDataSource(),i=t.at(n),i)&&(this._updatePagesContent(n),this.page=n)},paneMoved:function(n,t,r,u){var f=this,h=f.pane,y=h.size().width,s=h.offset(),c=Math.abs(s)>=y/3,p=t?i.effects.Transition.easeOutBack:i.effects.Transition.easeOutExpo,l=f.page+2>f.buffer.total(),o,e=0;n===v?f.page!==0&&(e=-1):n!==a||l?s>0&&c&&!l?e=1:s<0&&c&&f.page!==0&&(e=-1):e=1;o=f.page;e&&(o=e>0?o+1:o-1);r&&r({currentPage:f.page,nextPage:o})&&(e=0);e===0?f._cancelMove(p,u):e===-1?f._moveBackward(u):e===1&&f._moveForward(u)},updatePage:function(){var n=this.pages;return this.pane.offset()===0?!1:(this.pane.offset()>0?(n.push(this.pages.shift()),this.page++,this.setPageContent(n[2],this.page+1)):(n.unshift(this.pages.pop()),this.page--,this.setPageContent(n[0],this.page-1)),this._repositionPages(),this._resetMovable(),!0)},forcePageUpdate:function(){var n=this.pane.offset(),t=this.pane.size().width*3/4;return h(n)>t?this.updatePage():!1},_resetMovable:function(){this.pane.moveTo(0)},_moveForward:function(n){this.pane.transitionTo(-this.width,i.effects.Transition.easeOutExpo,n)},_moveBackward:function(n){this.pane.transitionTo(this.width,i.effects.Transition.easeOutExpo,n)},_cancelMove:function(n,t){this.pane.transitionTo(0,n,t)},_resetPages:function(){this.page=this.options.page||0;this._updatePagesContent(this.page);this._repositionPages();this.trigger("reset")},_onResize:function(){this.pageCount=c(this.dataSource.total()/this.options.itemsPerPage);this._pendingPageRefresh&&(this._updatePagesContent(this.page),this._pendingPageRefresh=!1);this.trigger("resize")},_onReset:function(){this.pageCount=c(this.dataSource.total()/this.options.itemsPerPage);this._resetPages()},_onEndReached:function(){this._pendingPageRefresh=!0},_repositionPages:function(){var n=this.pages;n[0].position(dt);n[1].position(gt);n[2].position(ni)},_updatePagesContent:function(n){var t=this.pages,i=n||0;this.setPageContent(t[0],i-1);this.setPageContent(t[1],i);this.setPageContent(t[2],i+1)},setPageContent:function(t,r){var f=this.buffer,e=this.template,o=this.emptyTemplate,u=null;r>=0&&(u=f.at(r),n.isArray(u)&&!u.length&&(u=null));this.trigger(ut,{item:t.element});u!==null?t.content(e(u)):t.content(o({}));i.mobile.init(t.element);this.trigger(w,{item:t.element,data:u,ns:i.mobile.ui})}});i.mobile.ui.VirtualScrollViewContent=o;k=i.Class.extend({init:function(t){this.element=n("<div class='"+it+"'><\/div>");this.width=t.width();this.element.width(this.width);t.append(this.element)},content:function(n){this.element.html(n)},position:function(n){this.element.css("transform","translate3d("+this.width*n+"px, 0, 0)")},setWidth:function(n){this.width=n;this.element.width(n)}});i.mobile.ui.VirtualPage=k;ct=y.extend({init:function(n,t){var u=this,h,e,s;y.fn.init.call(u,n,t);t=u.options;n=u.element;i.stripWhitespace(n[0]);n.wrapInner("<div/>").addClass("km-scrollview");this.options.enablePager&&(this.pager=new ft(this));u.inner=n.children().first();u.page=0;u.inner.css("height",t.contentHeight);u.pane=new ht(u.inner,{duration:this.options.duration,transitionEnd:r(this,"_transitionEnd"),dragStart:r(this,"_dragStart"),dragEnd:r(this,"_dragEnd"),change:r(this,f)});u.bind("resize",function(){u.pane.refresh()});u.page=t.page;h=this.inner.children().length===0;e=h?new o(u.inner,u.pane,t):new b(u.inner,u.pane,t);e.page=u.page;e.bind("reset",function(){u._syncWithContent();u.trigger(f,{pageCount:e.pageCount,page:e.page})});e.bind("resize",function(){u.trigger(f,{pageCount:e.pageCount,page:e.page})});e.bind(w,function(n){u.trigger(w,n);u.angular("compile",function(){return{elements:n.item,data:[{dataItem:n.data}]}})});e.bind(ut,function(n){u.angular("cleanup",function(){return{elements:n.item}})});u._content=e;u.setDataSource(t.dataSource);s=u.container();s.nullObject?(u.viewInit(),u.viewShow()):s.bind("show",r(this,"viewShow")).bind("init",r(this,"viewInit"))},options:{name:"ScrollView",page:0,duration:400,velocityThreshold:.8,contentHeight:"auto",pageSize:1,itemsPerPage:1,bounceVelocityThreshold:1.6,enablePager:!0,autoBind:!0,template:"",emptyTemplate:""},events:[l,u,f],destroy:function(){y.fn.destroy.call(this);i.destroy(this.element)},viewInit:function(){this.options.autoBind&&this._content.scrollTo(this._content.page,!0)},viewShow:function(){this.pane.refresh()},refresh:function(){var n=this._content;n.resizeTo(this.pane.size());this.page=n.page;this.trigger(f,{pageCount:n.pageCount,page:n.page})},content:function(n){this.element.children().first().html(n);this._content._getPages();this.pane.refresh()},value:function(n){var t=this.dataSource;if(n)this.scrollTo(t.indexOf(n),!0);else return t.at(this.page)},scrollTo:function(n,t){this._content.scrollTo(n,t);this._syncWithContent()},prev:function(){var n=this,i=n.page-1;n._content instanceof o?n._content.paneMoved(v,t,function(t){return n.trigger(l,t)}):i>-1&&n.scrollTo(i)},next:function(){var n=this,i=n.page+1;n._content instanceof o?n._content.paneMoved(a,t,function(t){return n.trigger(l,t)}):i<n._content.pageCount&&n.scrollTo(i)},setDataSource:function(n){if(this._content instanceof o){var t=!n;this.dataSource=g.create(n);this._content.setDataSource(this.dataSource);this.options.autoBind&&!t&&this.dataSource.fetch()}},items:function(){return this.element.find("."+it)},_syncWithContent:function(){var i=this._content.pages,r=this._content.buffer,n,f;this.page=this._content.page;n=r?r.at(this.page):t;n instanceof Array||(n=[n]);f=i?i[1].element:t;this.trigger(u,{page:this.page,element:f,data:n})},_dragStart:function(){this._content.forcePageUpdate()&&this._syncWithContent()},_dragEnd:function(n){var u=this,t=n.x.velocity,r=this.options.velocityThreshold,i=ti,f=h(t)>this.options.bounceVelocityThreshold;t>r?i=v:t<-r&&(i=a);this._content.paneMoved(i,f,function(n){return u.trigger(l,n)})},_transitionEnd:function(){this._content.updatePage()&&this._syncWithContent()}});d.plugin(ct)}(window.kendo.jQuery),window.kendo},typeof define=="function"&&define.amd?define:function(n,t){t()});
//# sourceMappingURL=kendo.mobile.scrollview.min.js.map
