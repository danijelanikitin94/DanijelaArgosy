(function(n,t){t(["./kendo.dom","./kendo.touch","./kendo.draganddrop","./kendo.columnsorter","./kendo.datetimepicker","./kendo.editable"],n)})(function(){return function(n){function d(n){for(var t=[],u=n.className,r=0,f=n.level;r<f;r++)t.push(i("span",{className:u}));return t}function y(){var i=t._activeElement();i.nodeName.toLowerCase()!=="body"&&n(i).blur()}var t=window.kendo,e=t.dom,i=e.element,c=e.text,g=t.support.browser,l=t.support.mobileOS,o=t.ui,s=o.Widget,h=n.extend,p=n.map,w=n.isFunction,a=t.keys,b={title:"Title",start:"Start Time",end:"End Time",percentComplete:"% Done",parentId:"Predecessor ID",id:"ID",orderId:"Order ID"},k="string",u=".kendoGanttList",v="click",f=".",r=o.GanttList=s.extend({init:function(n,t){s.fn.init.call(this,n,t);this.options.columns.length===0&&this.options.columns.push("title");this.dataSource=this.options.dataSource;this._columns();this._layout();this._domTrees();this._header();this._sortable();this._editable();this._selectable();this._draggable();this._attachEvents();this._adjustHeight()},_adjustHeight:function(){this.content.height(this.element.height()-this.header.parent().outerHeight())},destroy:function(){s.fn.destroy.call(this);this._reorderDraggable&&this._reorderDraggable.destroy();this._tableDropArea&&this._tableDropArea.destroy();this._contentDropArea&&this._contentDropArea.destroy();this.touch&&this.touch.destroy();this.content.off(u);this.header=null;this.content=null;this.levels=null;t.destroy(this.element)},options:{name:"GanttList",selectable:!0,editable:!0},_attachEvents:function(){var t=this,i=r.styles;t.content.on(v+u,"td > span."+i.icon+":not(."+i.iconHidden+")",function(i){var u=n(this),r=t._modelFromElement(u);r.set("expanded",!r.get("expanded"));i.stopPropagation()})},_domTrees:function(){this.headerTree=new e.Tree(this.header[0]);this.contentTree=new e.Tree(this.content[0])},_columns:function(){var n=this.options.columns,t=function(){this.field="";this.title="";this.editable=!1;this.sortable=!1};this.columns=p(n,function(n){return n=typeof n=="string"?{field:n,title:b[n]}:n,h(new t,n)})},_layout:function(){var t=this.element,n=r.styles;t.addClass(n.wrapper).append("<div class='"+n.gridHeader+"'><div class='"+n.gridHeaderWrap+"'><\/div><\/div>").append("<div class='"+n.gridContentWrap+"'><\/div>");this.header=t.find(f+n.gridHeaderWrap);this.content=t.find(f+n.gridContent)},_header:function(){var u=this.headerTree,n,t,r;n=i("colgroup",null,this._cols());t=i("thead",{role:"rowgroup"},[i("tr",{role:"row"},this._ths())]);r=i("table",{style:{"min-width":this.options.listWidth+"px"},role:"grid"},[n,t]);u.render([r])},_render:function(n){var t,r,u;this.levels=[{field:null,value:0}];t=i("colgroup",null,this._cols());r=i("tbody",{role:"rowgroup"},this._trs(n));u=i("table",{style:{"min-width":this.options.listWidth+"px"},tabIndex:0,role:"treegrid"},[t,r]);this.contentTree.render([u]);this.trigger("render")},_ths:function(){for(var u=this.columns,n,f,e=[],t=0,o=u.length;t<o;t++)n=u[t],f={"data-field":n.field,"data-title":n.title,className:r.styles.header,role:"columnheader"},e.push(i("th",f,[c(n.title)]));return e},_cols:function(){for(var r=this.columns,u,f,n,e=[],t=0,o=r.length;t<o;t++)u=r[t],n=u.width,f=n&&parseInt(n,10)!==0?{style:{width:typeof n===k?n:n+"px"}}:null,e.push(i("col",f,[]));return e},_trs:function(n){for(var t,o=[],u,i=[],e,s=r.styles,f=0,h=n.length;f<h;f++)t=n[f],e=this._levels({idx:t.parentId,id:t.id,summary:t.summary}),u={"data-uid":t.uid,"data-level":e,role:"row"},t.summary&&(u["aria-expanded"]=t.expanded),f%2!=0&&i.push(s.alt),t.summary&&i.push(s.group),i.length&&(u.className=i.join(" ")),o.push(this._tds({task:t,attr:u,level:e})),i=[];return o},_tds:function(n){for(var r=[],u=this.columns,f,t=0,e=u.length;t<e;t++)f=u[t],r.push(this._td({task:n.task,column:f,level:n.level}));return i("tr",n.attr,r)},_td:function(n){var h=[],a=this.options.resourcesField,f=r.styles,l=n.task,e=n.column,o=l.get(e.field)||[],u,s;if(e.field==a){for(u=[],s=0;s<o.length;s++)u.push(t.format("{0} [{1}]",o[s].get("name"),o[s].get("formatedValue")));u=u.join(", ")}else u=e.format?t.format(e.format,o):o;return e.field==="title"&&(h=d({level:n.level,className:f.iconPlaceHolder}),h.push(i("span",{className:f.icon+" "+(l.summary?l.expanded?f.iconCollapse:f.iconExpand:f.iconHidden)}))),h.push(i("span",null,[c(u)])),i("td",{role:"gridcell"},h)},_levels:function(n){for(var i=this.levels,t,u=n.summary,f=n.idx,e=n.id,r=0,o=i.length;r<o;r++)if(t=i[r],t.field==f)return u&&i.push({field:e,value:t.value+1}),t.value},_sortable:function(){for(var e=this.options.resourcesField,o=this.columns,n,r,u=this.header.find("th"),f,i=0,s=u.length;i<s;i++)n=o[i],n.sortable&&n.field!==e&&(f=u.eq(i),r=f.data("kendoColumnSorter"),r&&r.destroy(),f.attr("data-"+t.ns+"field",n.field).kendoColumnSorter({dataSource:this.dataSource}));u=null},_selectable:function(){var t=this,i=this.options.selectable;if(i)this.content.on(v+u,"tr",function(i){var r=n(this);i.ctrlKey?t.clearSelection():t.select(r)})},select:function(n){var i=this.content.find(n),t=r.styles.selected;if(i.length){i.siblings(f+t).removeClass(t).attr("aria-selected",!1).end().addClass(t).attr("aria-selected",!0);this.trigger("change");return}return this.content.find(f+t)},clearSelection:function(){var n=this.select();n.length&&(n.removeClass(r.styles.selected),this.trigger("change"))},_setDataSource:function(n){this.dataSource=n},_editable:function(){var t=this,i=r.styles,f="span."+i.icon+":not("+i.iconHidden+")",e=function(){t.editable&&t.editable.end()&&t._closeCell()},o=function(t){var r=n(t.currentTarget);r.hasClass(i.editCell)||y()};if(this.options.editable){this._startEditHandler=function(i){var r=i.currentTarget?n(i.currentTarget):i,u=t._columnFromElement(r);t.editable||u.editable&&t._editCell({cell:r,column:u})};t.content.on("focusin"+u,function(){clearTimeout(t.timer);t.timer=null}).on("focusout"+u,function(){t.timer=setTimeout(e,1)}).on("keydown"+u,function(n){var u=n.keyCode,i,r;switch(u){case a.ENTER:y();e();break;case a.ESC:t.editable&&(i=t._editableContainer,r=t._modelFromElement(i),t.trigger("cancel",{model:r,cell:i})||t._closeCell(!0))}});if(l)t.touch=t.content.kendoTouch({filter:"td",touchstart:function(n){o(n.touch)},doubletap:function(i){n(i.touch.initialTouch).is(f)||t._startEditHandler(i.touch)}}).data("kendoTouch");else t.content.on("mousedown"+u,"td",function(n){o(n)}).on("dblclick"+u,"td",function(i){n(i.target).is(f)||t._startEditHandler(i)})}},_editCell:function(i){var a=this.options.resourcesField,v=r.styles,f=i.cell,u=i.column,c=this._modelFromElement(f),o=this.dataSource._createNewModel(c.toJSON()),e=o.fields[u.field]||o[u.field],s=e.validation,y=t.attr("type"),p=t.attr("bind"),h={name:u.field,required:e.validation?e.validation.required===!0:!1},l;if(u.field===a){u.editor(f,o);return}this._editableContent=f.children().detach();this._editableContainer=f;f.data("modelCopy",o);(e.type==="date"||n.type(e)==="date")&&/H|m|s|F|g|u/.test(u.format)&&(u.field==="start"&&delete e.validation.dateCompare,h[p]="value:"+u.field,h[y]="date",l=function(t,i){n('<input type="text"/>').attr(h).appendTo(t).kendoDateTimePicker({format:i.format})});this.editable=f.addClass(v.editCell).kendoEditable({fields:{field:u.field,format:u.format,editor:u.editor||l},model:o,clearContainer:!1}).data("kendoEditable");s&&s.dateCompare&&w(s.dateCompare)&&s.message&&(n("<span "+t.attr("for")+'="'+u.field+'" class="k-invalid-msg"/>').hide().appendTo(f),f.find("[name="+u.field+"]").attr(t.attr("dateCompare-msg"),s.message));this.trigger("edit",{model:c,cell:f})&&this._closeCell(!0)},_closeCell:function(n){var e=r.styles,t=this._editableContainer,f=this._modelFromElement(t),o=this._columnFromElement(t),u=o.field,s=t.data("modelCopy"),i={};i[u]=s.get(u);t.empty().removeData("modelCopy").removeClass(e.editCell).append(this._editableContent);this.editable.destroy();this.editable=null;this._editableContainer=null;this._editableContent=null;n||(u==="start"&&(i.end=new Date(i.start.getTime()+f.duration())),this.trigger("update",{task:f,updateInfo:i}))},_draggable:function(){var o=this,e=null,s=!0,u,i=r.styles,y="tr["+t.attr("level")+" = 0]:last",c={},v=function(){e=null;u=null;s=!0;c={}},p=function(n){for(var t=n;t;){if(e.get("id")===t.get("id")){s=!1;break}t=o.dataSource.taskParent(t)}},w=function(){var i=n(u).height(),r=t.getOffset(u).top;h(u,{beforeLimit:r+i*.25,afterLimit:r+i*.75})},b=function(n){var o=n.location,r=i.dropAdd,e="add",s=parseInt(u.attr(t.attr("level")),10),f;o<=u.beforeLimit?(f=u.prev(),r=i.dropTop,e="insert-before"):o>=u.afterLimit&&(f=u.next(),r=i.dropBottom,e="insert-after");f&&parseInt(f.attr(t.attr("level")),10)===s&&(r=i.dropMiddle);c.className=r;c.command=e},a=function(){return o._reorderDraggable.hint.children(f+i.dragStatus).removeClass(i.dropPositions)};this.options.editable&&(this._reorderDraggable=this.content.kendoDraggable({distance:10,holdToDrag:l,group:"listGroup",filter:"tr[data-uid]",ignore:f+i.input,hint:function(t){return n('<div class="'+i.header+" "+i.dragClue+'"/>').css({width:300,paddingLeft:t.css("paddingLeft"),paddingRight:t.css("paddingRight"),lineHeight:t.height()+"px",paddingTop:t.css("paddingTop"),paddingBottom:t.css("paddingBottom")}).append('<span class="'+i.icon+" "+i.dragStatus+'" /><span class="'+i.dragClueText+'"/>')},cursorOffset:{top:-20,left:0},container:this.content,dragstart:function(n){o.editable&&n.preventDefault();e=o._modelFromElement(n.currentTarget);this.hint.children(f+i.dragClueText).text(e.get("title"))},drag:function(n){s&&(b(n.y),a().addClass(c.className))},dragend:function(){v()},dragcancel:function(){v()}}).data("kendoDraggable"),this._tableDropArea=this.content.kendoDropTargetArea({distance:0,group:"listGroup",filter:"tr[data-uid]",dragenter:function(n){u=n.dropTarget;p(o._modelFromElement(u));w();a().toggleClass(i.dropDenied,!s)},dragleave:function(){s=!0;a()},drop:function(){var n=o._modelFromElement(u),t=n.orderId,i={parentId:n.parentId};if(s){switch(c.command){case"add":i.parentId=n.id;break;case"insert-before":i.orderId=n.parentId===e.parentId&&n.orderId>e.orderId?t-1:t;break;case"insert-after":i.orderId=n.parentId===e.parentId&&n.orderId>e.orderId?t:t+1}o.trigger("update",{task:e,updateInfo:i})}}}).data("kendoDropTargetArea"),this._contentDropArea=this.element.kendoDropTargetArea({distance:0,group:"listGroup",filter:f+i.gridContent,drop:function(){var t=o._modelFromElement(o.content.find(y)),n=t.orderId,i={parentId:null,orderId:e.parentId!==null?n+1:n};o.trigger("update",{task:e,updateInfo:i})}}).data("kendoDropTargetArea"))},_modelFromElement:function(n){var i=n.closest("tr");return this.dataSource.getByUid(i.attr(t.attr("uid")))},_columnFromElement:function(n){var t=n.closest("td"),i=t.parent(),r=i.children().index(t);return this.columns[r]}});h(!0,o.GanttList,{styles:{wrapper:"k-treelist k-grid k-widget",header:"k-header",alt:"k-alt",editCell:"k-edit-cell",group:"k-treelist-group",gridHeader:"k-grid-header",gridHeaderWrap:"k-grid-header-wrap",gridContent:"k-grid-content",gridContentWrap:"k-grid-content",selected:"k-state-selected",icon:"k-icon",iconCollapse:"k-i-collapse",iconExpand:"k-i-expand",iconHidden:"k-i-none",iconPlaceHolder:"k-icon k-i-none",input:"k-input",dropPositions:"k-insert-top k-insert-bottom k-add k-insert-middle",dropTop:"k-insert-top",dropBottom:"k-insert-bottom",dropAdd:"k-add",dropMiddle:"k-insert-middle",dropDenied:"k-denied",dragStatus:"k-drag-status",dragClue:"k-drag-clue",dragClueText:"k-clue-text"}})}(window.kendo.jQuery),window.kendo},typeof define=="function"&&define.amd?define:function(n,t){t()});
//# sourceMappingURL=kendo.gantt.list.min.js.map
