(function(n,t){t(["./kendo.dom","./kendo.draganddrop"],n)})(function(){return function(n){function et(n){return delete n.name,delete n.prefix,delete n.views,n}function ot(n){var i=[],t=n.workWeekStart;for(i.push(t);n.workWeekEnd!=t;)t>6?t-=7:t++,i.push(t);return i}function c(){var t=kendo._activeElement();t.nodeName.toLowerCase()!=="body"&&n(t).blur()}var e=kendo.ui.Widget,t=kendo.dom.element,o=kendo.dom.text,k=n.isPlainObject,s=n.extend,l=kendo.support.browser,d=kendo.keys,a=kendo.data.Query,f=".kendoGanttTimeline",h="click",g="dblclick",nt="keydown",i=".",tt=kendo.template("#=kendo.toString(start, 't')#"),v=kendo.template("#=kendo.toString(start, 'ddd M/dd')#"),y=kendo.template("#=kendo.toString(start, 'ddd M/dd')# - #=kendo.toString(kendo.date.addDays(end, -1), 'ddd M/dd')#"),p=kendo.template("#=kendo.toString(start, 'MMM')#"),it=kendo.template("#=kendo.toString(start, 'yyyy')#"),rt=kendo.template('<div class="#=styles.marquee#"><div class="#=styles.marqueeColor#"><\/div><\/div>'),w=kendo.template('<div style="z-index: 100002;" class="#=styles.tooltipWrapper#"><div class="#=styles.tooltipContent#"><div>Start: #=kendo.toString(start, "ddd M/dd HH:mm")#<\/div><div>End: #=kendo.toString(end, "ddd M/dd HH:mm")#<\/div><\/div><\/div>'),ut=kendo.template('<div style="z-index: 100002;" class="#=styles.tooltipWrapper#" ><div class="#=styles.tooltipContent#">#=text#%<\/div><div class="#=styles.tooltipCallout#" style="left:13px;"><\/div><\/div>'),ft={day:{type:"kendo.ui.GanttDayView"},week:{type:"kendo.ui.GanttWeekView"},month:{type:"kendo.ui.GanttMonthView"},year:{type:"kendo.ui.GanttYearView"}},r=kendo.ui.GanttView=e.extend({init:function(n,t){e.fn.init.call(this,n,t);this.title=this.options.title||this.options.name;this.header=this.element.find(i+r.styles.gridHeader);this.content=this.element.find(i+r.styles.gridContent);this.contentWidth=this.content.width();this._workDays=ot(this.options);this._headerTree=t.headerTree;this._taskTree=t.taskTree;this._dependencyTree=t.dependencyTree;this._taskCoordinates={}},destroy:function(){e.fn.destroy.call(this);this.headerRow=null;this.header=null;this.content=null;this._dragHint=null;this._resizeHint=null;this._resizeTooltip=null;this._percentCompleteResizeTooltip=null;this._headerTree=null;this._taskTree=null;this._dependencyTree=null},options:{showWorkHours:!1,showWorkDays:!1,workDayStart:new Date(1980,1,1,8,0,0),workDayEnd:new Date(1980,1,1,17,0,0),workWeekStart:1,workWeekEnd:5,hourSpan:1,slotSize:100},renderLayout:function(){this._slots=this._createSlots();this._tableWidth=this._calculateTableWidth();this.createLayout(this._layout());this._slotDimensions();this._adjustHeight()},_adjustHeight:function(){this.content.height(this.element.height()-this.header.outerHeight())},createLayout:function(n){var i=this._headers(n),r=this._colgroup(),u=this._headerTree,f=t("thead",null,i),e=t("table",{style:{width:this._tableWidth+"px"}},[r,f]);u.render([e]);this.headerRow=this.header.find("table:first tr").last()},_slotDimensions:function(){for(var r=this.headerRow[0].children,u=this._timeSlots(),t,i,n=0,f=r.length;n<f;n++)i=r[n],t=u[n],t.offsetLeft=i.offsetLeft,t.offsetWidth=i.offsetWidth},render:function(n){var u=n.length,f=r.styles,t,e=this._rowsTable(u),o=this._columnsTable(u),s=this._tasksTable(n);this._taskTree.render([e,o,s]);t=this.content.find(i+f.rowsTable);this._contentHeight=t.height();this._rowHeight=t.find("tr").height();this.content.find(i+f.columnsTable).height(this._contentHeight)},_rowsTable:function(n){for(var u=[],f,e=r.styles,s=[null,{className:e.alt}],i=0;i<n;i++)f=t("tr",s[i%2],[t("td",null,[o(" ")])]),u.push(f);return this._createTable(1,u,{className:e.rowsTable})},_columnsTable:function(){for(var e=[],s,h=r.styles,c=this._timeSlots(),a=c.length,u,n,l=0,i,f=0;f<a;f++)u=c[f],i={},n=u.span,l+=n,n!==1&&(i.colspan=n),u.isNonWorking&&(i.className=h.nonWorking),e.push(t("td",i,[o(" ")]));return s=t("tr",null,e),this._createTable(l,[s],{className:h.columnsTable})},_tasksTable:function(n){for(var l=[],e,o,u,i,s=r.styles,y=this._taskCoordinates={},a=this._calculateMilestoneWidth(),v=Math.round(a.width),h=this.options.resourcesField,p=[s.resource,s.resourceAlt],c,w=this._calculateResourcesMargin(),b=function(n){var t,r;t=u.left;r=t+u.width;i.isMilestone()&&(t-=v/2,r=t+v);y[i.id]={start:t,end:r,rowIndex:n}},f=0,k=n.length;f<k;f++)i=n[f],u=this._taskPosition(i),e=t("tr",null),o=t("td",null,[this._renderTask(n[f],u)]),i[h]&&i[h].length&&(c=Math.max(u.width||a.clientWidth,0)+u.left,o.children.push(t("div",{className:s.resourcesWrap,style:{left:c+"px",width:this._tableWidth-(c+w)+"px"}},this._renderResources(i[h],p[f%2])))),e.children.push(o),l.push(e),b(f);return this._createTable(1,l,{className:r.styles.tasksTable})},_createTable:function(n,i,r){for(var u=[],f,e,o=0;o<n;o++)u.push(t("col"));return f=t("colgroup",null,u),e=t("tbody",null,i),r.style||(r.style={}),r.style.width=this._tableWidth+"px",t("table",r,[f,e])},_calculateTableWidth:function(){for(var r=this._timeSlots(),t=0,u=0,n,i=0,f=r.length;i<f;i++)n=r[i].span,u+=n,n>t&&(t=n);return Math.round(u*this.options.slotSize/t)},_calculateMilestoneWidth:function(){var i,u=r.styles.task+" "+r.styles.taskMilestone,t=n("<div class='"+u+"' style='visibility: hidden; position: absolute'>");return this.content.append(t),i={width:t[0].getBoundingClientRect().width,clientWidth:t[0].clientWidth},t.remove(),i},_calculateResourcesMargin:function(){var i,t=n("<div class='"+r.styles.resourcesWrap+"' style='visibility: hidden; position: absolute'>");return this.content.append(t),i=parseInt(t.css("margin-left"),10),t.remove(),i},_renderTask:function(n,i){var f,e,o=this.options.editable,s,c=i.left,u=r.styles,h=u.taskWrap;return n.summary?e=this._renderSummary(n,i):n.isMilestone()?(e=this._renderMilestone(n,i),h+=" "+u.taskMilestoneWrap):e=this._renderSingleTask(n,i),f=t("div",{className:h,style:{left:c+"px"}},[e]),o&&(f.children.push(t("div",{className:u.taskDot+" "+u.taskDotStart})),f.children.push(t("div",{className:u.taskDot+" "+u.taskDotEnd}))),n.summary||n.isMilestone()||!o||(s=Math.round(i.width*n.percentComplete),f.children.push(t("div",{className:u.taskDragHandle,style:{left:s+"px"}}))),f},_renderSingleTask:function(n,i){var u=r.styles,e=Math.round(i.width*n.percentComplete),f=t("div",{className:u.taskContent},[t("div",{className:u.taskTemplate},[o(n.title)])]);return this.options.editable&&(f.children.push(t("span",{className:u.taskActions},[t("a",{className:u.link+" "+u.taskDelete,href:"#"},[t("span",{className:u.icon+" "+u.iconDelete})])])),f.children.push(t("span",{className:u.taskResizeHandle+" "+u.taskResizeHandleWest})),f.children.push(t("span",{className:u.taskResizeHandle+" "+u.taskResizeHandleEast}))),t("div",{className:u.task+" "+u.taskSingle,"data-uid":n.uid,style:{width:Math.max(i.width-2,0)+"px"}},[t("div",{className:u.taskComplete,style:{width:e+"px"}}),f])},_renderMilestone:function(n){var i=r.styles;return t("div",{className:i.task+" "+i.taskMilestone,"data-uid":n.uid})},_renderSummary:function(n,i){var u=r.styles,f=Math.round(i.width*n.percentComplete);return t("div",{className:u.task+" "+u.taskSummary,"data-uid":n.uid,style:{width:i.width+"px"}},[t("div",{className:u.taskSummaryProgress,style:{width:f+"px"}},[t("div",{className:u.taskSummaryComplete,style:{width:i.width+"px"}})])])},_renderResources:function(n,i){for(var f=[],r,u=0,e=n.length;u<e;u++)r=n[u],f.push(t("span",{className:i,style:{color:r.get("color")}},[o(r.get("name"))]));return f},_taskPosition:function(n){var t=Math.round,i=t(this._offset(n.start)),r=t(this._offset(n.end));return{left:i,width:r-i}},_offset:function(n){var f=this._timeSlots(),t,i,r,u,e=this._slotIndex("start",n);return(t=f[e],t.end<n)?t.offsetLeft+t.offsetWidth:t.start>n?t.offsetLeft:(i=n-t.start,r=t.end-t.start,u=i/r*t.offsetWidth,t.offsetLeft+u)},_slotIndex:function(n,t){var f=this._timeSlots(),r=0,u=f.length-1,i;do i=Math.ceil((u+r)/2),f[i][n]<t?r=i:(i===u&&i--,u=i);while(r!==u);return r},_timeByPosition:function(n,t,i){var r=this._slotByPosition(n);if(t)return i?r.end:r.start;var u=n-(this.content.offset().left-this.content.scrollLeft()),f=r.end-r.start,e=f*((u-r.offsetLeft)/r.offsetWidth);return new Date(r.start.getTime()+e)},_slotByPosition:function(n){var t=n-(this.content.offset().left-this.content.scrollLeft()),i=this._slotIndex("offsetLeft",t);return this._timeSlots()[i]},_renderDependencies:function(n){for(var t=[],r=this._dependencyTree,i=0,u=n.length;i<u;i++)t.push.apply(t,this._renderDependency(n[i]));r.render(t)},_renderDependency:function(n){var r=this._taskCoordinates[n.predecessorId],u=this._taskCoordinates[n.successorId],t,f,i,e;if(!r||!u)return[];for(f="_render"+["FF","FS","SF","SS"][n.type],t=this[f](r,u),i=0,e=t.length;i<e;i++)t[i].attr["data-uid"]=n.uid;return t},_renderFF:function(n,t){var i=this._dependencyFF(n,t,!1);return i[i.length-1].children[0]=this._arrow(!0),i},_renderSS:function(n,t){var i=this._dependencyFF(t,n,!0);return i[0].children[0]=this._arrow(!1),i.reverse()},_renderFS:function(n,t){var i=this._dependencyFS(n,t,!1);return i[i.length-1].children[0]=this._arrow(!1),i},_renderSF:function(n,t){var i=this._dependencyFS(t,n,!0);return i[0].children[0]=this._arrow(!0),i.reverse()},_dependencyFF:function(n,t,i){var w=this,v=[],e=0,f=0,u=0,o=0,s=i?"start":"end",y,h=2,b=1,c=this._rowHeight,k=10,g=n.rowIndex*c+Math.floor(c/2)-1,l=t.rowIndex*c+Math.floor(c/2)-1,a=r.styles,p=function(){v.push(w._line(a.line+" "+a.lineHorizontal,{left:e+"px",top:f+"px",width:u+"px"}))},d=function(){v.push(w._line(a.line+" "+a.lineVertical,{left:e+"px",top:f+"px",height:o+"px"}))};return e=n[s],f=g,u=k,y=t[s]-n[s],y>0!==i&&(u=Math.abs(y)+k),i?(e-=u,u-=b,p()):(p(),e+=u-h),l<f?(o=f-l,o+=h,f=l,d()):(o=l-f,o+=h,d(),f+=o-h),u=Math.abs(e-t[s]),i||(u-=b,e-=u),p(),v},_dependencyFS:function(n,t,i){var g=this,p=[],o=0,f=0,u=0,e=0,h=this._rowHeight,nt=Math.floor(h/2),c=10,w=2*c,b=t.start-n.end,l=2,k=1,a=n.rowIndex*h+Math.floor(h/2)-1,s=t.rowIndex*h+Math.floor(h/2)-1,v=r.styles,d=function(){p.push(g._line(v.line+" "+v.lineHorizontal,{left:o+"px",top:f+"px",width:u+"px"}))},y=function(){p.push(g._line(v.line+" "+v.lineVertical,{left:o+"px",top:f+"px",height:e+"px"}))};return o=n.end,f=a,u=c,i&&(o+=k,b>w&&(u=b-(c-l)),u-=k),d(),o+=u-l,b<=w&&(e=i?Math.abs(s-a)-nt:nt,s<a?(f-=e,e+=l,y()):(y(),f+=e),u=n.end-t.start+w,u<c&&(u=c),o-=u-l,d()),s<a?(e=f-s,f=s,e+=l,y()):(e=s-f,y(),f+=e),u=t.start-o,i||(u-=k),d(),p},_line:function(n,i){return t("div",{className:n,style:i})},_arrow:function(n){return t("span",{className:n?r.styles.arrowWest:r.styles.arrowEast})},_colgroup:function(){for(var i,f,r=this._timeSlots(),e=r.length,u=[],n=0;n<e;n++)for(i=0,f=r[n].span;i<f;i++)u.push(t("col"));return t("colgroup",null,u)},_createDragHint:function(n){this._dragHint=n.clone().addClass(r.styles.dragHint).css("cursor","move");n.parent().append(this._dragHint)},_updateDragHint:function(n){var t=this._offset(n);this._dragHint.css({left:t})},_removeDragHint:function(){this._dragHint.remove();this._dragHint=null},_createResizeHint:function(t){var u=r.styles,f=this._taskCoordinates[t.id].rowIndex*this._rowHeight,e,i;this._resizeHint=n(rt({styles:u})).css({top:0,height:this._contentHeight});this.content.append(this._resizeHint);this._resizeTooltip=n(w({styles:u,start:t.start,end:t.end})).css({top:0,left:0});this.content.append(this._resizeTooltip);this._resizeTooltipWidth=this._resizeTooltip.outerWidth();e=this._resizeTooltip.outerHeight();i=f-e;i<0&&(i=f+this._rowHeight);this._resizeTooltipTop=i},_updateResizeHint:function(t,i,u){var o=this._offset(t),s=this._offset(i),c=s-o,f=u?o:s,h=this._tableWidth-17,e=this._resizeTooltipWidth;this._resizeHint.css({left:o,width:c});this._resizeTooltip&&this._resizeTooltip.remove();f-=Math.round(e/2);f<0?f=0:f+e>h&&(f=h-e);this._resizeTooltip=n(w({styles:r.styles,start:t,end:i})).css({top:this._resizeTooltipTop,left:f,"min-width":e});this.content.append(this._resizeTooltip)},_removeResizeHint:function(){this._resizeHint.remove();this._resizeHint=null;this._resizeTooltip.remove();this._resizeTooltip=null},_updatePercentCompleteTooltip:function(t,u,f){this._removePercentCompleteTooltip();var e=this._percentCompleteResizeTooltip=n(ut({styles:r.styles,text:f})).appendTo(this.element),o=Math.round(e.outerWidth()/2),s=e.find(i+r.styles.callout),h=Math.round(s.outerWidth()/2);e.css({top:t-(e.outerHeight()+h),left:u-o});s.css("left",o-h)},_removePercentCompleteTooltip:function(){this._percentCompleteResizeTooltip&&this._percentCompleteResizeTooltip.remove();this._percentCompleteResizeTooltip=null},_updateDependencyDragHint:function(n,t,i){this._removeDependencyDragHint();i?this._creteVmlDependencyDragHint(n,t):this._creteDependencyDragHint(n,t)},_creteDependencyDragHint:function(t,i){var e=r.styles,u=i.x-t.x,o=i.y-t.y,s=Math.sqrt(u*u+o*o),f=Math.atan(o/u);u<0&&(f+=Math.PI);n("<div class='"+e.line+" "+e.lineHorizontal+" "+e.dependencyHint+"'><\/div>").css({top:t.y,left:t.x,width:s,"transform-origin":"0% 0","-ms-transform-origin":"0% 0","-webkit-transform-origin":"0% 0",transform:"rotate("+f+"rad)","-ms-transform":"rotate("+f+"rad)","-webkit-transform":"rotate("+f+"rad)"}).appendTo(this.content)},_creteVmlDependencyDragHint:function(t,i){var u=n("<kvml:line class='"+r.styles.dependencyHint+"' style='position:absolute; top: 0px;' strokecolor='black' strokeweight='2px' from='"+t.x+"px,"+t.y+"px' to='"+i.x+"px,"+i.y+"px'><\/kvml:line>").appendTo(this.content);u[0].outerHTML=u[0].outerHTML},_removeDependencyDragHint:function(){this.content.find(i+r.styles.dependencyHint).remove()},_scrollTo:function(n){var i=n.offset().left,r=n.width(),e=i+r,c=n.closest("tr"),s=c.offset().top,p=c.height(),l=s+p,t=this.content,a=t.offset(),h=a.top,w=t.height(),v=h+w,u=a.left,f=t.width(),o=u+f,y=kendo.support.scrollbar();s<h?t.scrollTop(t.scrollTop()+(s-h)):l>v&&t.scrollTop(t.scrollTop()+(l+y-v));i<u&&r>f&&e<o||e>o&&r<f?t.scrollLeft(t.scrollLeft()+(e+y-o)):(e>o&&r>f&&i>u||i<u&&r<f)&&t.scrollLeft(t.scrollLeft()+(i-u))},_timeSlots:function(){return this._slots[this._slots.length-1]},_headers:function(n){for(var u,a,h=[],f,e,i,c,l=r.styles,s=0,v=n.length;s<v;s++){for(f=n[s],e=[],u=0,a=f.length;u<a;u++)i=f[u],c=o(i.text),e.push(t("th",{colspan:i.span,className:l.header+(i.isNonWorking?" "+l.nonWorking:"")},[c]));h.push(t("tr",null,e))}return h},_hours:function(n,t){var i,e=[],r=this.options,s=r.workDayStart.getHours(),h=r.workDayEnd.getHours(),f,u,o=r.hourSpan;for(n=new Date(n),t=new Date(t);n<t;)i=new Date(n),u=i.getHours(),f=u>=s&&u<h,i.setHours(i.getHours()+o),u==i.getHours()&&i.setHours(i.getHours()+2*o),(!r.showWorkHours||f)&&e.push({start:n,end:i,isNonWorking:!f,span:1}),n=i;return e},_days:function(n,t){var i,u=[],r;for(n=new Date(n),t=new Date(t);n<t;)i=kendo.date.nextDay(n),r=this._isWorkDay(n),(!this.options.showWorkDays||r)&&u.push({start:n,end:i,isNonWorking:!r,span:1}),n=i;return u},_weeks:function(n,t){var i,f=[],e=this.calendarInfo().firstDay,r,u;for(n=new Date(n),t=new Date(t);n<t;)i=kendo.date.dayOfWeek(kendo.date.addDays(n,1),e,1),i>t&&(i=t),r=this._days(n,i),u=r.length,u>0&&f.push({start:r[0].start,end:r[u-1].end,span:u}),n=i;return f},_months:function(n,t){var i,f=[],r,u;for(n=new Date(n),t=new Date(t);n<t;)i=new Date(n),i.setMonth(i.getMonth()+1),r=this._days(n,i),u=r.length,u>0&&f.push({start:r[0].start,end:r[u-1].end,span:u}),n=i;return f},_years:function(n,t){var i,r=[];for(n=new Date(n),t=new Date(t);n<t;)i=new Date(n),i.setFullYear(i.getFullYear()+1),r.push({start:n,end:i,span:12}),n=i;return r},_slotHeaders:function(n,t){for(var u=[],i,r=0,f=n.length;r<f;r++)i=n[r],u.push({text:t(i),isNonWorking:!!i.isNonWorking,span:i.span});return u},_isWorkDay:function(n){for(var r=n.getDay(),i=this._workDays,t=0,u=i.length;t<u;t++)if(i[t]===r)return!0;return!1},calendarInfo:function(){return kendo.getCulture().calendars.standard}}),b,u;s(!0,r,{styles:{alt:"k-alt",nonWorking:"k-nonwork-hour",header:"k-header",gridHeader:"k-grid-header",gridHeaderWrap:"k-grid-header-wrap",gridContent:"k-grid-content",rowsTable:"k-gantt-rows",columnsTable:"k-gantt-columns",tasksTable:"k-gantt-tasks",resource:"k-resource",resourceAlt:"k-resource k-alt",task:"k-task",taskSingle:"k-task-single",taskMilestone:"k-task-milestone",taskSummary:"k-task-summary",taskWrap:"k-task-wrap",taskMilestoneWrap:"k-milestone-wrap",resourcesWrap:"k-resources-wrap",taskDot:"k-task-dot",taskDotStart:"k-task-start",taskDotEnd:"k-task-end",taskDragHandle:"k-task-draghandle",taskContent:"k-task-content",taskTemplate:"k-task-template",taskActions:"k-task-actions",taskDelete:"k-task-delete",taskComplete:"k-task-complete",link:"k-link",icon:"k-icon",iconDelete:"k-si-close",taskResizeHandle:"k-resize-handle",taskResizeHandleWest:"k-resize-w",taskResizeHandleEast:"k-resize-e",taskSummaryProgress:"k-task-summary-progress",taskSummaryComplete:"k-task-summary-complete",line:"k-line",lineHorizontal:"k-line-h",lineVertical:"k-line-v",arrowWest:"k-arrow-w",arrowEast:"k-arrow-e",dragHint:"k-drag-hint",dependencyHint:"k-dependency-hint",tooltipWrapper:"k-widget k-tooltip k-popup k-group k-reset",tooltipContent:"k-tooltip-content",tooltipCallout:"k-callout k-callout-s",callout:"k-callout",marquee:"k-marquee k-gantt-marquee",marqueeColor:"k-marquee-color"}});kendo.ui.GanttDayView=r.extend({name:"day",options:{timeHeaderTemplate:tt,dayHeaderTemplate:v},range:function(n){this.start=kendo.date.getDate(n.start);this.end=kendo.date.getDate(n.end);(kendo.date.getMilliseconds(n.end)>0||this.end.getTime()===this.start.getTime())&&(this.end=kendo.date.addDays(this.end,1))},_createSlots:function(){var n,t,i,u,f=[],r,e;for(n=this._days(this.start,this.end),i=[],r=0,e=n.length;r<e;r++)t=n[r],u=this._hours(t.start,t.end),t.span=u.length,i.push.apply(i,u);return f.push(n),f.push(i),f},_layout:function(){var n=[],t=this.options;return n.push(this._slotHeaders(this._slots[0],kendo.template(t.dayHeaderTemplate))),n.push(this._slotHeaders(this._slots[1],kendo.template(t.timeHeaderTemplate))),n}});kendo.ui.GanttWeekView=r.extend({name:"week",options:{dayHeaderTemplate:v,weekHeaderTemplate:y},range:function(n){var i=this.calendarInfo(),t=i.firstDay;this.start=kendo.date.getDate(kendo.date.dayOfWeek(n.start,t,-1));this.end=kendo.date.getDate(kendo.date.dayOfWeek(n.end,t,1))},_createSlots:function(){var n=[];return n.push(this._weeks(this.start,this.end)),n.push(this._days(this.start,this.end)),n},_layout:function(){var n=[],t=this.options;return n.push(this._slotHeaders(this._slots[0],kendo.template(t.weekHeaderTemplate))),n.push(this._slotHeaders(this._slots[1],kendo.template(t.dayHeaderTemplate))),n}});kendo.ui.GanttMonthView=r.extend({name:"month",options:{weekHeaderTemplate:y,monthHeaderTemplate:p},range:function(n){this.start=kendo.date.firstDayOfMonth(n.start);this.end=kendo.date.addDays(kendo.date.getDate(kendo.date.lastDayOfMonth(n.end)),1)},_createSlots:function(){var n=[];return n.push(this._months(this.start,this.end)),n.push(this._weeks(this.start,this.end)),n},_layout:function(){var n=[],t=this.options;return n.push(this._slotHeaders(this._slots[0],kendo.template(t.monthHeaderTemplate))),n.push(this._slotHeaders(this._slots[1],kendo.template(t.weekHeaderTemplate))),n}});kendo.ui.GanttYearView=r.extend({name:"year",options:{yearHeaderTemplate:it,monthHeaderTemplate:p},range:function(n){this.start=kendo.date.firstDayOfMonth(new Date(n.start.setMonth(0)));this.end=kendo.date.firstDayOfMonth(new Date(n.end.setMonth(12)))},_createSlots:function(){var t=[],i=this._months(this.start,this.end);return n(i).each(function(n,t){t.span=1}),t.push(this._years(this.start,this.end)),t.push(i),t},_layout:function(){var n=[],t=this.options;return n.push(this._slotHeaders(this._slots[0],kendo.template(t.yearHeaderTemplate))),n.push(this._slotHeaders(this._slots[1],kendo.template(t.monthHeaderTemplate))),n}});b={wrapper:"k-timeline k-grid k-widget",gridHeader:"k-grid-header",gridHeaderWrap:"k-grid-header-wrap",gridContent:"k-grid-content",gridContentWrap:"k-grid-content",tasksWrapper:"k-gantt-tables",dependenciesWrapper:"k-gantt-dependencies",task:"k-task",line:"k-line",taskResizeHandle:"k-resize-handle",taskResizeHandleWest:"k-resize-w",taskDragHandle:"k-task-draghandle",taskComplete:"k-task-complete",taskDelete:"k-task-delete",taskWrapActive:"k-task-wrap-active",taskWrap:"k-task-wrap",taskDot:"k-task-dot",taskDotStart:"k-task-start",taskDotEnd:"k-task-end",hovered:"k-state-hover",selected:"k-state-selected",origin:"k-origin"};u=kendo.ui.GanttTimeline=e.extend({init:function(n,t){e.fn.init.call(this,n,t);this.options.views&&this.options.views.length||(this.options.views=["day","week","month"]);this._wrapper();this._domTrees();this._views();this._selectable();this._draggable();this._resizable();this._percentResizeDraggable();this._createDependencyDraggable();this._attachEvents()},options:{name:"GanttTimeline",messages:{views:{day:"Day",week:"Week",month:"Month",year:"Year"}},snap:!0,selectable:!0,editable:!0},destroy:function(){e.fn.destroy.call(this);this._unbindView(this._selectedView);this._moveDraggable&&this._moveDraggable.destroy();this._resizeDraggable&&this._resizeDraggable.destroy();this._percentDraggable&&this._percentDraggable.destroy();this._dependencyDraggable&&this._dependencyDraggable.destroy();this._headerTree=null;this._taskTree=null;this._dependencyTree=null;this.wrapper.off(f);kendo.destroy(this.wrapper)},_wrapper:function(){var n=u.styles;this.wrapper=this.element.addClass(n.wrapper).append("<div class='"+n.gridHeader+"'><div class='"+n.gridHeaderWrap+"'><\/div><\/div>").append("<div class='"+n.gridContentWrap+"'><div class='"+n.tasksWrapper+"'><\/div><div class='"+n.dependenciesWrapper+"'><\/div><\/div>")},_domTrees:function(){var n=u.styles,t=kendo.dom.Tree,r=this.wrapper;this._headerTree=new t(r.find(i+n.gridHeaderWrap)[0]);this._taskTree=new t(r.find(i+n.tasksWrapper)[0]);this._dependencyTree=new t(r.find(i+n.dependenciesWrapper)[0])},_views:function(){var e=this.options.views,n,i,t,r,u,f,o;for(this.views={},f=0,o=e.length;f<o;f++)(n=e[f],i=k(n),i&&n.selectable===!1)||(t=i?typeof n.type!="string"?n.title:n.type:n,r=ft[t],r&&(i&&(n.type=r.type),r.title=this.options.messages.views[t]),n=s({title:t},r,i?n:{}),t&&(this.views[t]=n,(!u||n.selected)&&(u=t)));u&&(this._selectedViewName=u)},view:function(n){return n&&(this._selectView(n),this.trigger("navigate",{view:n,action:"changeView"})),this._selectedView},_selectView:function(n){n&&this.views[n]&&(this._selectedView&&this._unbindView(this._selectedView),this._selectedView=this._initializeView(n),this._selectedViewName=n)},_viewByIndex:function(n){var t,i=this.views;for(t in i){if(!n)return t;n--}},_initializeView:function(n){var t=this.views[n],i;if(t)if(i=t.type,typeof i=="string"&&(i=kendo.getter(t.type)(window)),i)t=new i(this.wrapper,et(s(!0,{headerTree:this._headerTree,taskTree:this._taskTree,dependencyTree:this._dependencyTree},t,this.options)));else throw new Error("There is no such view");return t},_unbindView:function(n){n&&n.destroy()},_range:function(n){var t,i;return!n||!n.length?{start:new Date,end:new Date}:(t=new a(n).sort({field:"start",dir:"asc"}).toArray()[0].start||new Date,i=new a(n).sort({field:"end",dir:"desc"}).toArray()[0].end||new Date,{start:new Date(t),end:new Date(i)})},_render:function(n){var t=this.view(),i=this._range(n);this._tasks=n;t.range(i);t.renderLayout();t.render(n)},_renderDependencies:function(n){this.view()._renderDependencies(n)},_taskByUid:function(n){for(var r=this._tasks,u=r.length,t,i=0;i<u;i++)if(t=r[i],t.uid===n)return t},_draggable:function(){var n=this,t,r,f,o,s=this.options.snap,e,h=u.styles,l=function(){n.view()._removeDragHint();t&&t.css("opacity",1);t=null;r=null;e=!1};this.options.editable&&(this._moveDraggable=new kendo.ui.Draggable(this.wrapper,{distance:0,filter:i+h.task,holdToDrag:kendo.support.mobileOS,ignore:i+h.taskResizeHandle}),this._moveDraggable.bind("dragstart",function(i){var u=n.view();if(t=i.currentTarget.parent(),r=n._taskByUid(i.currentTarget.attr("data-uid")),n.trigger("moveStart",{task:r})){i.preventDefault();return}f=r.start;o=u._timeByPosition(i.x.location,s)-f;u._createDragHint(t);t.css("opacity",.5);e=!0}).bind("drag",kendo.throttle(function(t){if(e){var i=n.view(),u=new Date(i._timeByPosition(t.x.location,s)-o);n.trigger("move",{task:r,start:u})||(f=u,i._updateDragHint(f))}},15)).bind("dragend",function(){n.trigger("moveEnd",{task:r,start:f});l()}).bind("dragcancel",function(){l()}).userEvents.bind("select",function(){c()}))},_resizable:function(){var f=this,o,r,n,t,e,a=this.options.snap,s,h=u.styles,l=function(){f.view()._removeResizeHint();o=null;r=null;s=!1};this.options.editable&&(this._resizeDraggable=new kendo.ui.Draggable(this.wrapper,{distance:0,filter:i+h.taskResizeHandle,holdToDrag:!1}),this._resizeDraggable.bind("dragstart",function(u){if(e=u.currentTarget.hasClass(h.taskResizeHandleWest),o=u.currentTarget.closest(i+h.task),r=f._taskByUid(o.attr("data-uid")),f.trigger("resizeStart",{task:r})){u.preventDefault();return}n=r.start;t=r.end;f.view()._createResizeHint(r);s=!0}).bind("drag",kendo.throttle(function(i){if(s){var o=f.view(),u=o._timeByPosition(i.x.location,a,!e);e?n=u<t?u:t:t=u>n?u:n;f.trigger("resize",{task:r,start:n,end:t})||o._updateResizeHint(n,t,e)}},15)).bind("dragend",function(){var i=e?n:t;f.trigger("resizeEnd",{task:r,resizeStart:e,start:n,end:t});l()}).bind("dragcancel",function(){l()}).userEvents.bind("select",function(){c()}))},_percentResizeDraggable:function(){var r=this,f,n,o,s,h,l,e,v,y,a,t=u.styles,p=function(){r.view()._removePercentCompleteTooltip();n=null;f=null;a=!1},w=function(r){n.find(i+t.taskComplete).width(r).end().siblings(i+t.taskDragHandle).css("left",r)};this.options.editable&&(this._percentDraggable=new kendo.ui.Draggable(this.wrapper,{distance:0,filter:i+t.taskDragHandle,holdToDrag:!1}),this._percentDraggable.bind("dragstart",function(u){n=u.currentTarget.siblings(i+t.task);f=r._taskByUid(n.attr("data-uid"));e=f.percentComplete;o=n.offset();s=this.element.offset();h=n.find(i+t.taskComplete).width();l=n.outerWidth();a=!0}).bind("drag",kendo.throttle(function(n){if(a){var t=Math.max(0,Math.min(l,h+n.x.initialDelta));e=Math.round(t/l*100);w(t);v=o.top-s.top;y=o.left+t-s.left;r.view()._updatePercentCompleteTooltip(v,y,e)}},15)).bind("dragend",function(){r.trigger("percentResizeEnd",{task:f,percentComplete:e/100});p()}).bind("dragcancel",function(){w(h);p()}).userEvents.bind("select",function(){c()}))},_createDependencyDraggable:function(){var f=this,r,e=n(),h=n(),a,y,p,o,s,w=l.msie&&l.version<9,t=u.styles,b=function(){r.css("display","").removeClass(t.hovered);r.parent().removeClass(t.origin);r=null;v(!1);h=n();e=n();f.view()._removeDependencyDragHint();a=!1},v=function(n){h.hasClass(t.origin)||(h.find(i+t.taskDot).css("display",n?"block":""),e.toggleClass(t.hovered,n))};this.options.editable&&(w&&document.namespaces&&document.namespaces.add("kvml","urn:schemas-microsoft-com:vml","#default#VML"),this._dependencyDraggable=new kendo.ui.Draggable(this.wrapper,{distance:0,filter:i+t.taskDot,holdToDrag:!1}),this._dependencyDraggable.bind("dragstart",function(n){r=n.currentTarget.css("display","block").addClass(t.hovered);r.parent().addClass(t.origin);var i=r.offset();o=f.view().content;s=o.offset();y=Math.round(i.left+o.scrollLeft()-s.left+r.outerHeight()/2);p=Math.round(i.top+o.scrollTop()-s.top+r.outerWidth()/2);a=!0}).bind("drag",kendo.throttle(function(r){if(a){f.view()._removeDependencyDragHint();var u=n(kendo.elementUnderCursor(r)),c=r.x.location+o.scrollLeft()-s.left,l=r.y.location+o.scrollTop()-s.top;f.view()._updateDependencyDragHint({x:y,y:p},{x:c,y:l},w);v(!1);e=u.hasClass(t.taskDot)?u:n();h=u.closest(i+t.taskWrap);v(!0)}},15)).bind("dragend",function(){if(e.length){var s=r.hasClass(t.taskDotStart),n=e.hasClass(t.taskDotStart),h=s?n?3:2:n?1:0,u=f._taskByUid(r.siblings(i+t.task).attr("data-uid")),o=f._taskByUid(e.siblings(i+t.task).attr("data-uid"));u!==o&&f.trigger("dependencyDragEnd",{type:h,predecessor:u,successor:o})}b()}).bind("dragcancel",function(){b()}).userEvents.bind("select",function(){c()}))},_selectable:function(){var t=this,r=u.styles;if(this.options.selectable)this.wrapper.on(h+f,i+r.task,function(i){i.stopPropagation();i.ctrlKey?t.trigger("clear"):t.trigger("select",{uid:n(this).attr("data-uid")})}).on(h+f,i+r.tasksWrapper,function(){t.selectDependency().length>0?t.clearSelection():t.trigger("clear")}).on(h+f,i+r.line,function(n){n.stopPropagation();t.selectDependency(this)})},select:function(n){var r=this.wrapper.find(n),t=u.styles;if(r.length){this.clearSelection();r.addClass(t.selected);kendo.support.mobileOS&&r.parent().addClass(t.taskWrapActive);return}return this.wrapper.find(i+t.task+i+t.selected)},selectDependency:function(t){var f=this.wrapper.find(t),e,r=u.styles;if(f.length){this.clearSelection();this.trigger("clear");e=n(f).attr("data-uid");this.wrapper.find(i+r.line+"[data-uid='"+e+"']").addClass(r.selected);return}return this.wrapper.find(i+r.line+i+r.selected)},clearSelection:function(){var n=u.styles;this.wrapper.find(i+n.selected).removeClass(n.selected);kendo.support.mobileOS&&this.wrapper.find(i+n.taskWrapActive).removeClass(n.taskWrapActive)},_attachEvents:function(){var t=this,r=u.styles;if(this.options.editable){this._tabindex();this.wrapper.on(h+f,i+r.taskDelete,function(u){t.trigger("removeTask",{uid:n(this).closest(i+r.task).attr("data-uid")});u.stopPropagation();u.preventDefault()}).on(g+f,i+r.task,function(i){t.trigger("editTask",{uid:n(this).attr("data-uid")});i.stopPropagation();i.preventDefault()}).on(nt+f,function(n){var i;n.keyCode===d.DELETE&&(i=t.selectDependency(),i.length&&(t.trigger("removeDependency",{uid:i.attr("data-uid")}),t.clearSelection()))})}}});s(!0,u,{styles:b})}(window.kendo.jQuery),window.kendo},typeof define=="function"&&define.amd?define:function(n,t){t()});
//# sourceMappingURL=kendo.gantt.timeline.min.js.map
