(function(n,t){t(["./kendo.draganddrop"],n)})(function(){return function(n,t){function rt(n){return typeof n!="undefined"}function s(n,t,i){return Math.max(Math.min(parseInt(n,10),i===Infinity?i:parseInt(i,10)),parseInt(t,10))}function ri(n,t){return function(){var i=this,r=i.wrapper,u=r[0].style,o=i.options;if(!o.isMaximized&&!o.isMinimized)return i.restoreOptions={width:u.width,height:u.height},r.children(c).hide().end().children(f).find(gt).parent().hide().eq(0).before(e.action({name:"Restore"})),t.call(i),n=="maximize"?i.wrapper.children(f).find(ot).parent().hide():i.wrapper.children(f).find(ot).parent().show(),i}}function hi(){return!this.type||this.type.toLowerCase().indexOf("script")>=0}function ui(n){var t=this;t.owner=n;t._draggable=new st(n.wrapper,{filter:">"+c,group:n.wrapper.id+"-resizing",dragstart:i(t.dragstart,t),drag:i(t.drag,t),dragend:i(t.dragend,t)});t._draggable.userEvents.bind("press",i(t.addOverlay,t));t._draggable.userEvents.bind("release",i(t.removeOverlay,t))}function fi(n,t){var r=this;r.owner=n;r._draggable=new st(n.wrapper,{filter:t,group:n.wrapper.id+"-moving",dragstart:i(r.dragstart,r),drag:i(r.drag,r),dragend:i(r.dragend,r),dragcancel:i(r.dragcancel,r)});r._draggable.userEvents.stopPropagation=!1}var r=window.kendo,k=r.ui.Widget,st=r.ui.Draggable,ht=n.isPlainObject,ei=r._activeElement,i=n.proxy,d=n.extend,oi=n.each,h=r.template,g="body",e,u=".kendoWindow",l=".k-window",ut=".k-window-title",f=ut+"bar",o=".k-window-content",c=".k-resize-handle",nt=".k-overlay",p="k-content-frame",ct="k-loading",lt="k-state-hover",at="k-state-focused",vt="k-window-maximized",a=":visible",tt="hidden",v="cursor",ft="open",et="activate",yt="deactivate",pt="close",it="refresh",wt="resizeEnd",bt="dragstart",kt="dragend",dt="error",y="overflow",w="zIndex",gt=".k-window-actions .k-i-minimize,.k-window-actions .k-i-maximize",ni=".k-i-pin",ti=".k-i-unpin",ot=ni+","+ti,b=".k-window-titlebar .k-window-action",ii=".k-window-titlebar .k-i-refresh",si=r.isLocalUrl,ci=k.extend({init:function(e,s){var h=this,c,w={},g,nt,v,it=!1,y,d,ot=s&&s.actions&&!s.actions.length,p;k.fn.init.call(h,e,s);s=h.options;v=s.position;e=h.element;y=s.content;ot&&(s.actions=[]);h.appendTo=n(s.appendTo);h._animations();y&&!ht(y)&&(y=s.content={url:y});e.find("script").filter(hi).remove();e.parent().is(h.appendTo)||v.top!==t&&v.left!==t||(e.is(a)?(w=e.offset(),it=!0):(g=e.css("visibility"),nt=e.css("display"),e.css({visibility:tt,display:""}),w=e.offset(),e.css({visibility:g,display:nt})),v.top===t&&(v.top=w.top),v.left===t&&(v.left=w.left));rt(s.visible)&&s.visible!==null||(s.visible=e.is(a));c=h.wrapper=e.closest(l);e.is(".k-content")&&c[0]||(e.addClass("k-window-content k-content"),h._createWindow(e,s),c=h.wrapper=e.closest(l),h._dimensions());h._position();s.pinned&&h.pin(!0);y&&h.refresh(y);s.visible&&h.toFront();d=c.children(o);h._tabindex(d);s.visible&&s.modal&&h._overlay(c.is(a)).css({opacity:.5});c.on("mouseenter"+u,b,i(h._buttonEnter,h)).on("mouseleave"+u,b,i(h._buttonLeave,h)).on("click"+u,"> "+b,i(h._windowActionHandler,h));d.on("keydown"+u,i(h._keydown,h)).on("focus"+u,i(h._focus,h)).on("blur"+u,i(h._blur,h));this._resizable();this._draggable();p=e.attr("id");p&&(p=p+"_wnd_title",c.children(f).children(ut).attr("id",p),d.attr({role:"dialog","aria-labelledby":p}));c.add(c.children(".k-resize-handle,"+f)).on("mousedown"+u,i(h.toFront,h));h.touchScroller=r.touchScroller(e);h._resizeHandler=i(h._onDocumentResize,h);h._marker=r.guid().substring(0,8);n(window).on("resize"+u+h._marker,h._resizeHandler);s.visible&&(h.trigger(ft),h.trigger(et));r.notify(h)},_buttonEnter:function(t){n(t.currentTarget).addClass(lt)},_buttonLeave:function(t){n(t.currentTarget).removeClass(lt)},_focus:function(){this.wrapper.addClass(at)},_blur:function(){this.wrapper.removeClass(at)},_dimensions:function(){var t=this.wrapper,n=this.options,r=n.width,u=n.height,e=n.maxHeight,o=["minWidth","minHeight","maxWidth","maxHeight"],i,f;for(this.title(n.title),i=0;i<o.length;i++)f=n[o[i]],f&&f!=Infinity&&t.css(o[i],f);e&&e!=Infinity&&this.element.css("maxHeight",e);r&&(r.toString().indexOf("%")>0?t.width(r):t.width(s(r,n.minWidth,n.maxWidth)));u&&(u.toString().indexOf("%")>0?t.height(u):t.height(s(u,n.minHeight,n.maxHeight)));n.visible||t.hide()},_position:function(){var t=this.wrapper,n=this.options.position;n.top===0&&(n.top=n.top.toString());n.left===0&&(n.left=n.left.toString());t.css({top:n.top||"",left:n.left||""})},_animations:function(){var n=this.options;n.animation===!1&&(n.animation={open:{effects:{}},close:{hide:!0,effects:{}}})},_resize:function(){r.resize(this.element.children())},_resizable:function(){var r=this.options.resizable,t=this.wrapper;if(this.resizing&&(t.off("dblclick"+u).children(c).remove(),this.resizing.destroy(),this.resizing=null),r){t.on("dblclick"+u,f,i(function(t){n(t.target).closest(".k-window-action").length||this.toggleMaximization()},this));oi("n e s w se sw ne nw".split(" "),function(n,i){t.append(e.resizeHandle(i))});this.resizing=new ui(this)}t=null},_draggable:function(){var n=this.options.draggable;this.dragging&&(this.dragging.destroy(),this.dragging=null);n&&(this.dragging=new fi(this,n.dragHandle||f))},_actions:function(){var t=this.options.actions,i=this.wrapper.children(f),u=i.find(".k-window-actions");t=n.map(t,function(n){return{name:n}});u.html(r.render(e.action,t))},setOptions:function(n){k.fn.setOptions.call(this,n);this._animations();this._dimensions();this._position();this._resizable();this._draggable();this._actions()},events:[ft,et,yt,pt,it,"resize",wt,bt,kt,dt],options:{name:"Window",animation:{open:{effects:{zoom:{direction:"in"},fade:{direction:"in"}},duration:350},close:{effects:{zoom:{direction:"out",properties:{scale:.7}},fade:{direction:"out"}},duration:350,hide:!0}},title:"",actions:["Close"],autoFocus:!0,modal:!1,resizable:!0,draggable:!0,minWidth:90,minHeight:50,maxWidth:Infinity,maxHeight:Infinity,pinned:!1,position:{},content:null,visible:null,height:null,width:null,appendTo:"body"},_closable:function(){return n.inArray("close",n.map(this.options.actions,function(n){return n.toLowerCase()}))>-1},_keydown:function(n){var u=this,h=u.options,f=r.keys,e=n.keyCode,t=u.wrapper,c,i,o=10,p=u.options.isMaximized,v,y,l,a;n.target!=n.currentTarget||u._closing||(e==f.ESC&&u._closable()&&u._close(!1),!h.draggable||n.ctrlKey||p||(c=r.getOffset(t),e==f.UP?i=t.css("top",c.top-o):e==f.DOWN?i=t.css("top",c.top+o):e==f.LEFT?i=t.css("left",c.left-o):e==f.RIGHT&&(i=t.css("left",c.left+o))),h.resizable&&n.ctrlKey&&!p&&(e==f.UP?(i=!0,y=t.height()-o):e==f.DOWN&&(i=!0,y=t.height()+o),e==f.LEFT?(i=!0,v=t.width()-o):e==f.RIGHT&&(i=!0,v=t.width()+o),i&&(l=s(v,h.minWidth,h.maxWidth),a=s(y,h.minHeight,h.maxHeight),isNaN(l)||(t.width(l),u.options.width=l+"px"),isNaN(a)||(t.height(a),u.options.height=a+"px"),u.resize())),i&&n.preventDefault())},_overlay:function(t){var i=this.appendTo.children(nt),r=this.wrapper;return i.length||(i=n("<div class='k-overlay' />")),i.insertBefore(r[0]).toggle(t).css(w,parseInt(r.css(w),10)-1),i},_actionForIcon:function(n){var t=/\bk-i-\w+\b/.exec(n[0].className)[0];return{"k-i-close":"_close","k-i-maximize":"maximize","k-i-minimize":"minimize","k-i-restore":"restore","k-i-refresh":"refresh","k-i-pin":"pin","k-i-unpin":"unpin"}[t]},_windowActionHandler:function(t){if(!this._closing){var r=n(t.target).closest(".k-window-action").find(".k-icon"),i=this._actionForIcon(r);if(i)return t.preventDefault(),this[i](),!1}},_modals:function(){var t=this,i=n(l).filter(function(){var r=n(this),u=t._object(r),i=u&&u.options;return i&&i.modal&&i.visible&&r.is(a)}).sort(function(t,i){return+n(t).css("zIndex")-+n(i).css("zIndex")});return t=null,i},_object:function(n){var t=n.children(o);return t.data("kendoWindow")||t.data("kendo"+this.options.name)},center:function(){var t=this,e=t.options.position,i=t.wrapper,r=n(window),o=0,s=0,u,f;return t.options.isMaximized?t:(t.options.pinned||(o=r.scrollTop(),s=r.scrollLeft()),f=s+Math.max(0,(r.width()-i.width())/2),u=o+Math.max(0,(r.height()-i.height()-parseInt(i.css("paddingTop"),10))/2),i.css({left:f,top:u}),e.top=u,e.left=f,t)},title:function(n){var i=this,r=i.wrapper,s=i.options,t=r.children(f),o=t.children(ut),u;return arguments.length?(n===!1?(r.addClass("k-window-titleless"),t.remove()):(t.length?o.html(n):(r.prepend(e.titlebar(s)),i._actions(),t=r.children(f)),u=t.outerHeight(),r.css("padding-top",u),t.css("margin-top",-u)),i.options.title=n,i):o.text()},content:function(n,t){var i=this.wrapper.children(o),u=i.children(".km-scroll-container");return(i=u[0]?u:i,!rt(n))?i.html():(this.angular("cleanup",function(){return{elements:i.children()}}),r.destroy(this.element.children()),i.empty().html(n),this.angular("compile",function(){for(var n=[],r=i.length;--r>=0;)n.push({dataItem:t});return{elements:i.children(),data:n}}),this)},open:function(){var t=this,e=t.wrapper,u=t.options,s=u.animation.open,c=e.children(o),f,h;return t.trigger(ft)||(t._closing&&e.kendoStop(!0,!0),t._closing=!1,t.toFront(),u.autoFocus&&t.element.focus(),u.visible=!0,u.modal&&(f=t._overlay(!1),f.kendoStop(!0,!0),s.duration&&r.effects.Fade?(h=r.fx(f).fadeIn(),h.duration(s.duration||0),h.endValue(.5),h.play()):f.css("opacity",.5),f.show()),e.is(a)||(c.css(y,tt),e.show().kendoStop().kendoAnimate({effects:s.effects,duration:s.duration,complete:i(this._activate,this)}))),u.isMaximized&&(t._documentScrollTop=n(document).scrollTop(),n("html, body").css(y,tt)),t},_activate:function(){this.options.autoFocus&&this.element.focus();this.trigger(et);this.wrapper.children(o).css(y,"")},_removeOverlay:function(i){var f=this._modals(),e=this.options,s=e.modal&&!f.length,h=e.modal?this._overlay(!0):n(t),o=e.animation.close,u;s?!i&&o.duration&&r.effects.Fade?(u=r.fx(h).fadeOut(),u.duration(o.duration||0),u.startValue(.5),u.play()):this._overlay(!1).remove():f.length&&this._object(f.last())._overlay(!0)},_close:function(t){var r=this,u=r.wrapper,f=r.options,s=f.animation.open,e=f.animation.close;if(u.is(a)&&!r.trigger(pt,{userTriggered:!t})){if(r._closing)return;r._closing=!0;f.visible=!1;n(l).each(function(t,i){var r=n(i).children(o);i!=u&&r.find("> ."+p).length>0&&r.children(nt).remove()});this._removeOverlay();u.kendoStop().kendoAnimate({effects:e.effects||s.effects,reverse:e.reverse===!0,duration:e.duration,complete:i(this._deactivate,this)})}r.options.isMaximized&&(n("html, body").css(y,""),r._documentScrollTop&&r._documentScrollTop>0&&n(document).scrollTop(r._documentScrollTop))},_deactivate:function(){this.wrapper.hide().css("opacity","");this.trigger(yt);var n=this._object(this._modals().last());n&&n.toFront()},close:function(){return this._close(!0),this},_actionable:function(t){return n(t).is(b+","+b+" .k-icon,:input,a")},_shouldFocus:function(t){var r=ei(),i=this.element;return this.options.autoFocus&&!n(r).is(i)&&!this._actionable(t)&&(!i.find(r).length||!i.find(t).length)},toFront:function(t){var r=this,i=r.wrapper,h=i[0],u=+i.css(w),c=u,a=t&&t.target||null,f,s;return n(l).each(function(t,i){var r=n(i),f=r.css(w),s=r.children(o);isNaN(f)||(u=Math.max(+f,u));i!=h&&s.find("> ."+p).length>0&&s.append(e.overlay)}),(!i[0].style.zIndex||c<u)&&i.css(w,u+2),r.element.find("> .k-overlay").remove(),r._shouldFocus(a)&&(r.element.focus(),f=n(window).scrollTop(),s=parseInt(i.position().top,10),s>0&&s<f&&(f>0?n(window).scrollTop(s):i.css("top",f))),i=null,r},toggleMaximization:function(){return this._closing?this:this[this.options.isMaximized?"restore":"maximize"]()},restore:function(){var t=this,i=t.options,u=i.minHeight,r=t.restoreOptions;return!i.isMaximized&&!i.isMinimized?t:(u&&u!=Infinity&&t.wrapper.css("min-height",u),t.wrapper.css({position:i.pinned?"fixed":"absolute",left:r.left,top:r.top,width:r.width,height:r.height}).removeClass(vt).find(".k-window-content,.k-resize-handle").show().end().find(".k-window-titlebar .k-i-restore").parent().remove().end().end().find(gt).parent().show().end().end().find(ot).parent().show(),t.options.width=r.width,t.options.height=r.height,n("html, body").css(y,""),this._documentScrollTop&&this._documentScrollTop>0&&n(document).scrollTop(this._documentScrollTop),i.isMaximized=i.isMinimized=!1,t.resize(),t)},maximize:ri("maximize",function(){var t=this,i=t.wrapper,r=i.position();d(t.restoreOptions,{left:r.left,top:r.top});i.css({left:0,top:0,position:"fixed"}).addClass(vt);this._documentScrollTop=n(document).scrollTop();n("html, body").css(y,tt);t.options.isMaximized=!0;t._onDocumentResize()}),minimize:ri("minimize",function(){var n=this;n.wrapper.css({height:"",minHeight:""});n.element.hide();n.options.isMinimized=!0}),pin:function(t){var i=this,u=n(window),r=i.wrapper,e=parseInt(r.css("top"),10),o=parseInt(r.css("left"),10);!t&&(i.options.pinned||i.options.isMaximized)||(r.css({position:"fixed",top:e-u.scrollTop(),left:o-u.scrollLeft()}),r.children(f).find(ni).addClass("k-i-unpin").removeClass("k-i-pin"),i.options.pinned=!0)},unpin:function(){var t=this,r=n(window),i=t.wrapper,u=parseInt(i.css("top"),10),e=parseInt(i.css("left"),10);t.options.pinned&&!t.options.isMaximized&&(i.css({position:"",top:u+r.scrollTop(),left:e+r.scrollLeft()}),i.children(f).find(ti).addClass("k-i-pin").removeClass("k-i-unpin"),t.options.pinned=!1)},_onDocumentResize:function(){var t=this,u=t.wrapper,f=n(window),i,r;t.options.isMaximized&&(i=f.width(),r=f.height()-parseInt(u.css("padding-top"),10),u.css({width:i,height:r}),t.options.width=i,t.options.height=r,t.resize())},refresh:function(t){var r=this,o=r.options,s=n(r.element),c,f,l;if(ht(t)||(t={url:t}),t=d({},o.content,t),f=rt(o.iframe)?o.iframe:t.iframe,l=t.url,l)if(rt(f)||(f=!si(l)),f){c=s.find("."+p)[0];c?c.src=l||c.src:s.html(e.contentFrame(d({},o,{content:t})));s.find("."+p).unbind("load"+u).on("load"+u,i(this._triggerRefresh,this))}else r._ajaxRequest(t);else t.template&&r.content(h(t.template)({})),r.trigger(it);return s.toggleClass("k-window-iframecontent",!!f),r},_triggerRefresh:function(){this.trigger(it)},_ajaxComplete:function(){clearTimeout(this._loadingIconTimeout);this.wrapper.find(ii).removeClass(ct)},_ajaxError:function(n,t){this.trigger(dt,{status:t,xhr:n})},_ajaxSuccess:function(n){return function(t){var i=t;n&&(i=h(n)(t||{}));this.content(i,t);this.element.prop("scrollTop",0);this.trigger(it)}},_showLoading:function(){this.wrapper.find(ii).addClass(ct)},_ajaxRequest:function(t){this._loadingIconTimeout=setTimeout(i(this._showLoading,this),100);n.ajax(d({type:"GET",dataType:"html",cache:!1,error:i(this._ajaxError,this),complete:i(this._ajaxComplete,this),success:i(this._ajaxSuccess(t.template),this)},t))},destroy:function(){var i=this;i.resizing&&i.resizing.destroy();i.dragging&&i.dragging.destroy();i.wrapper.off(u).children(o).off(u).end().find(".k-resize-handle,.k-window-titlebar").off(u);n(window).off("resize"+u+i._marker);clearTimeout(i._loadingIconTimeout);k.fn.destroy.call(i);i.unbind(t);r.destroy(i.wrapper);i._removeOverlay(!0);i.wrapper.empty().remove();i.wrapper=i.appendTo=i.element=n()},_createWindow:function(){var t=this.element,u=this.options,f,i,o=r.support.isRtl(t);u.scrollable===!1&&t.attr("style","overflow:hidden;");i=n(e.wrapper(u));f=t.find("iframe:not(.k-content)").map(function(){var n=this.getAttribute("src");return this.src="",n});i.toggleClass("k-rtl",o).appendTo(this.appendTo).append(t).find("iframe:not(.k-content)").each(function(n){this.src=f[n]});i.find(".k-window-title").css(o?"left":"right",i.find(".k-window-actions").outerWidth()+10);t.css("visibility","").show();t.find("[data-role=editor]").each(function(){var t=n(this).data("kendoEditor");t&&t.refresh()});i=t=null}});e={wrapper:h("<div class='k-widget k-window' />"),action:h("<a role='button' href='\\#' class='k-window-action k-link'><span role='presentation' class='k-icon k-i-#= name.toLowerCase() #'>#= name #<\/span><\/a>"),titlebar:h("<div class='k-window-titlebar k-header'>&nbsp;<span class='k-window-title'>#= title #<\/span><div class='k-window-actions' /><\/div>"),overlay:"<div class='k-overlay' />",contentFrame:h("<iframe frameborder='0' title='#= title #' class='"+p+"' src='#= content.url #'>This page requires frames in order to show content<\/iframe>"),resizeHandle:h("<div class='k-resize-handle k-resize-#= data #'><\/div>")};ui.prototype={addOverlay:function(){this.owner.wrapper.append(e.overlay)},removeOverlay:function(){this.owner.wrapper.find(nt).remove()},dragstart:function(t){var i=this,f=i.owner,u=f.wrapper;i.elementPadding=parseInt(u.css("padding-top"),10);i.initialPosition=r.getOffset(u,"position");i.resizeDirection=t.currentTarget.prop("className").replace("k-resize-handle k-resize-","");i.initialSize={width:u.width(),height:u.height()};i.containerOffset=r.getOffset(f.appendTo,"position");u.children(c).not(t.currentTarget).hide();n(g).css(v,t.currentTarget.css(v))},drag:function(n){var u=this,f=u.owner,e=f.wrapper,t=f.options,o=u.resizeDirection,h=u.containerOffset,c=u.initialPosition,v=u.initialSize,i,r,l,a,y=Math.max(n.x.location,h.left),p=Math.max(n.y.location,h.top);o.indexOf("e")>=0?(i=y-c.left,e.width(s(i,t.minWidth,t.maxWidth))):o.indexOf("w")>=0&&(a=c.left+v.width,i=s(a-y,t.minWidth,t.maxWidth),e.css({left:a-i-h.left,width:i}));o.indexOf("s")>=0?(r=p-c.top-u.elementPadding,e.height(s(r,t.minHeight,t.maxHeight))):o.indexOf("n")>=0&&(l=c.top+v.height,r=s(l-p,t.minHeight,t.maxHeight),e.css({top:l-r-h.top,height:r}));i&&(f.options.width=i+"px");r&&(f.options.height=r+"px");f.resize()},dragend:function(t){var r=this,i=r.owner,u=i.wrapper;return u.children(c).not(t.currentTarget).show(),n(g).css(v,""),i.touchScroller&&i.touchScroller.reset(),t.keyCode==27&&u.css(r.initialPosition).css(r.initialSize),i.trigger(wt),!1},destroy:function(){this._draggable&&this._draggable.destroy();this._draggable=this.owner=null}};fi.prototype={dragstart:function(t){var i=this.owner,u=i.element,f=u.find(".k-window-actions"),o=r.getOffset(i.appendTo);i.trigger(bt);i.initialWindowPosition=r.getOffset(i.wrapper,"position");i.startPosition={left:t.x.client-i.initialWindowPosition.left,top:t.y.client-i.initialWindowPosition.top};i.minLeftPosition=f.length>0?f.outerWidth()+parseInt(f.css("right"),10)-u.outerWidth():20-u.outerWidth();i.minLeftPosition-=o.left;i.minTopPosition=-o.top;i.wrapper.append(e.overlay).children(c).hide();n(g).css(v,t.currentTarget.css(v))},drag:function(t){var i=this.owner,r=i.options.position,u=Math.max(t.y.client-i.startPosition.top,i.minTopPosition),f=Math.max(t.x.client-i.startPosition.left,i.minLeftPosition),e={left:f,top:u};n(i.wrapper).css(e);r.top=u;r.left=f},_finishDrag:function(){var t=this.owner;t.wrapper.children(c).toggle(!t.options.isMinimized).end().find(nt).remove();n(g).css(v,"")},dragcancel:function(n){this._finishDrag();n.currentTarget.closest(l).css(this.owner.initialWindowPosition)},dragend:function(){return this._finishDrag(),this.owner.trigger(kt),!1},destroy:function(){this._draggable&&this._draggable.destroy();this._draggable=this.owner=null}};r.ui.plugin(ci)}(window.kendo.jQuery),window.kendo},typeof define=="function"&&define.amd?define:function(n,t){t()});
//# sourceMappingURL=kendo.window.min.js.map
