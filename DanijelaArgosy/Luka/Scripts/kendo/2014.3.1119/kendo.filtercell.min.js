(function(n,t){t(["./kendo.autocomplete","./kendo.datepicker","./kendo.numerictextbox","./kendo.combobox","./kendo.dropdownlist"],n)})(function(){return function(n,t){function v(t,i){var r=[],u,f;if(n.isPlainObject(t))if(t.hasOwnProperty("filters"))r=t.filters;else if(t.field==i)return t;for(n.isArray(t)&&(r=t),u=0;u<r.length;u++)if(f=v(r[u],i),f)return f}function y(t,i){t.filters&&(t.filters=n.grep(t.filters,function(n){return y(n,i),n.filters?n.filters.length:n.field!=i}))}function p(n,t){var r=i.getter(t,!0);return function(t){for(var f=n(t),e=[],o=0,s={},i,u;o<f.length;)i=f[o++],u=r(i),s.hasOwnProperty(u)||(e.push(i),s[u]=!0);return e}}var i=window.kendo,a=i.ui,o=i.data.DataSource,s=a.Widget,h="change",c="boolean",l="enums",r="string",u="Is equal to",f="Is not equal to",e=n.proxy,w=s.extend({init:function(u,f){var d,y,v;u=n(u).addClass("k-filtercell");var k=this.wrapper=n("<span/>").appendTo(u),o=this,p,w,a,b=o.operators=f.operators||{},g=o.input=n("<input/>").attr(i.attr("bind"),"value: value").appendTo(k);s.fn.init.call(o,u[0],f);f=o.options;p=o.dataSource=f.dataSource;o.model=p.reader.model;a=f.type=r;d=i.getter("reader.model.fields",!0)(p)||{};y=d[f.field];y&&y.type&&(a=f.type=y.type);f.values&&(f.type=a=l);b=b[a]||f.operators[a];o._parse=function(n){return n+""};o.model&&o.model.fields&&(v=o.model.fields[f.field],v&&v.parse&&(o._parse=e(v.parse,v)));o.viewModel=w=i.observable({operator:f.operator,value:null,operatorVisible:function(){var n=this.get("value");return n!==null&&n!==t&&n!="undefined"}});w.bind(h,e(o.updateDsFilter,o));a==r&&o.initSuggestDataSource(f);f.inputWidth!==null&&g.width(f.inputWidth);o._setInputType(f,a);a!=c&&f.showOperators!==!1?o._createOperatorDropDown(b):k.addClass("k-operator-hidden");o._createClearIcon();i.bind(this.wrapper,w);a==r&&(f.template||o.setAutoCompleteSource());a==l&&o.setComboBoxSource(o.options.values);o._refreshUI();o._refreshHandler=e(o._refreshUI,o);o.dataSource.bind(h,o._refreshHandler)},_setInputType:function(t,u){var f=this,e=f.input,s;if(typeof t.template=="function")t.template.call(f.viewModel,{element:f.input,dataSource:f.suggestDataSource});else if(u==r)e.attr(i.attr("role"),"autocomplete").attr(i.attr("text-field"),t.dataTextField||t.field).attr(i.attr("filter"),t.suggestionOperator).attr(i.attr("delay"),t.delay).attr(i.attr("min-length"),t.minLength).attr(i.attr("value-primitive"),!0);else if(u=="date")e.attr(i.attr("role"),"datepicker");else if(u==c){e.remove();var o=n("<input type='radio'/>"),a=f.wrapper,v=i.guid(),h=n("<label/>").text(t.messages.isTrue).append(o);o.attr(i.attr("bind"),"checked:value").attr("name",v).val("true");s=h.clone().text(t.messages.isFalse);o.clone().val("false").appendTo(s);a.append([h,s])}else u=="number"?e.attr(i.attr("role"),"numerictextbox"):u==l&&e.attr(i.attr("role"),"combobox").attr(i.attr("text-field"),"text").attr(i.attr("suggest"),!0).attr(i.attr("filter"),"contains").attr(i.attr("value-field"),"value").attr(i.attr("value-primitive"),!0)},_createOperatorDropDown:function(t){var u=[],r,f;for(r in t)u.push({text:t[r],value:r});f=n('<input class="k-dropdown-operator" '+i.attr("bind")+'="value: operator"/>').appendTo(this.wrapper);this.operatorDropDown=f.kendoDropDownList({dataSource:u,dataTextField:"text",dataValueField:"value",open:function(){this.popup.element.width(150)},valuePrimitive:!0}).data("kendoDropDownList");this.operatorDropDown.wrapper.find(".k-i-arrow-s").removeClass("k-i-arrow-s").addClass("k-filter")},initSuggestDataSource:function(n){var i=n.suggestDataSource;i instanceof o||(!n.customDataSource&&i&&(i.group=t),i=this.suggestDataSource=o.create(i));n.customDataSource||(i._pageSize=t,i.reader.data=p(i.reader.data,this.options.field));this.suggestDataSource=i},setAutoCompleteSource:function(){var n=this.input.data("kendoAutoComplete");n&&n.setDataSource(this.suggestDataSource)},setComboBoxSource:function(n){var i=o.create({data:n}),t=this.input.data("kendoComboBox");t&&t.setDataSource(i)},_refreshUI:function(){var t=this,i=v(t.dataSource.filter(),this.options.field)||{},r=t.viewModel;t.manuallyUpdatingVM=!0;i=n.extend(!0,{},i);t.options.type==c&&r.value!==i.value&&t.wrapper.find(":radio").prop("checked",!1);i.operator&&r.set("operator",i.operator);r.set("value",i.value);t.manuallyUpdatingVM=!1},updateDsFilter:function(i){var r=this,o=r.viewModel,u,f,e;r.manuallyUpdatingVM||i.field=="operator"&&o.value===t||(u=n.extend({},r.viewModel.toJSON(),{field:r.options.field}),f={logic:"and",filters:[]},u.value!==t&&u.value!==null&&f.filters.push(u),e=r._merge(f),e.filters.length?r.dataSource.filter(e):r.dataSource.filter({}))},_merge:function(t){var f=this,s=t.logic||"and",r=t.filters,e,i=f.dataSource.filter()||{filters:[],logic:"and"},u,o;for(y(i,f.options.field),u=0,o=r.length;u<o;u++)e=r[u],e.value=f._parse(e.value);return r=n.grep(r,function(n){return n.value!==""&&n.value!==null}),r.length&&(i.filters.length?(t.filters=r,i.logic!=="and"&&(i.filters=[{logic:i.logic,filters:i.filters}],i.logic="and"),r.length>1?i.filters.push(t):i.filters.push(r[0])):(i.filters=r,i.logic=s)),i},_createClearIcon:function(){var t=this;n("<button type='button' class='k-button k-button-icon'/>").attr(i.attr("bind"),"visible:operatorVisible").html("<span class='k-icon k-i-close'/>").click(e(t.clearFilter,t)).appendTo(t.wrapper)},clearFilter:function(){this.viewModel.set("value",null)},destroy:function(){var n=this;n.filterModel=null;s.fn.destroy.call(n);i.destroy(n.element)},events:[h],options:{name:"FilterCell",delay:200,minLength:1,inputWidth:null,values:t,customDataSource:!1,field:"",dataTextField:"",type:"string",suggestDataSource:null,suggestionOperator:"startswith",operator:"eq",showOperators:!0,template:null,messages:{isTrue:"is true",isFalse:"is false",filter:"Filter",clear:"Clear",operator:"Operator"},operators:{string:{eq:u,neq:f,startswith:"Starts with",contains:"Contains",doesnotcontain:"Does not contain",endswith:"Ends with"},number:{eq:u,neq:f,gte:"Is greater than or equal to",gt:"Is greater than",lte:"Is less than or equal to",lt:"Is less than"},date:{eq:u,neq:f,gte:"Is after or equal to",gt:"Is after",lte:"Is before or equal to",lt:"Is before"},enums:{eq:u,neq:f}}}});a.plugin(w)}(window.kendo.jQuery),window.kendo},typeof define=="function"&&define.amd?define:function(n,t){t()});
//# sourceMappingURL=kendo.filtercell.min.js.map
