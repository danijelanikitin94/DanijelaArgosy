function ControlLoader(a){var b=this;if(a==null){a=false}if(a){b.loadControls($(document))}}ControlLoader.prototype.BASE_SCRIPT_PATH="/scripts/controls/";ControlLoader.prototype.BASE_TEMPLATE_PATH="/scripts/controls/templates/";ControlLoader.prototype.EVENT_SCRIPT_CONTROL_LOADED="SCRIPT_CONTROL_LOADED";ControlLoader.prototype.EVENT_SCRIPT_TEMPLATE_LOADED="SCRIPT_TEMPLATE_LOADED";ControlLoader.prototype.controls={};ControlLoader.prototype.loadedControls={};ControlLoader.prototype.loadingControls={};ControlLoader.prototype.loadedTemplates={};ControlLoader.prototype.loadControls=function(b){var c=this,b=b.parent().length?b.parent():b,a=b.find("*[data-argosy-control]");a.each(function(d){c.processControlElement(this)})};ControlLoader.prototype.processControlElement=function(c,a){var e=this;if($(c).attr("data-argosy-uuid")==null){var b=$(c).attr("data-argosy-control");var d=e.parseControlOptions(c);d.uuid=e.addUniqueIdentifier($(c));e.loadControl(b,d,function(f){if(e.controls[b]==null){e.controls[b]=[]}e.controls[b].push(f);if(a!=null&&a!=undefined){a(f)}})}};ControlLoader.prototype.findControl=function(d){var c=this;var a=null;for(var b in c.controls){if(c.controls.hasOwnProperty(b)){$(c.controls[b]).each(function(e){if(this.options.uuid==d){a=this}})}}return a};ControlLoader.prototype.addUniqueIdentifier=function(a){var c=this;var b=$.getGuid();a.attr("data-argosy-uuid",b);return b};ControlLoader.prototype.isControlLoaded=function(a){var b=this;return b.loadedControls[a]!=null&&b.loadedControls[a]};ControlLoader.prototype.isControlLoading=function(a){var b=this;return b.loadingControls[a]!=null&&b.loadingControls[a]};ControlLoader.prototype.parseControlOptions=function(a){var c=this;var b={};$(a.attributes).each(function(d){if(this.name.indexOf("data-argosy-options-")>-1){var f=$.camelCase(this.name.replace("data-argosy-options-",""));var g=this.value;if(g.toLowerCase()=="true"){g=true}else{if(g.toLowerCase()=="false"){g=false}else{if(g.toLowerCase()=="null"){g=null}else{if(!isNaN(g)){if(g.indexOf(".")>-1){g=parseFloat(g)}else{g=parseInt(g)}}}}}b[f]=g}});return b};ControlLoader.prototype.addScriptWithPath=function(b,a){var c=this;if(app_Version_Num){b=b+"?v="+app_Version_Num}c.loadingControls[b]=true;$.noCacheScript(a+b,function(d){$(c).trigger(c.EVENT_SCRIPT_CONTROL_LOADED+b)})};ControlLoader.prototype.loadControl=function(b,d,a){var e=this;var c=function(f){jsConsole.log(f.type);e.loadedControls[b]=true;e.loadingControls[b]=false;if(a!=undefined&&a!=null){a(e.initScript(b,d))}else{if(b.defaultCallback!=undefined&&b.defaultCallback!=null){b.defaultCallback(e.initScript(b,d))}}};if(b!==null){c({})}};ControlLoader.prototype.loadTemplate=function(b,a){var f=this;var c=window.location.host.indexOf("dev-")===-1?".html":".html";var e=b.replace(/\./,"/")+c;var d={method:"GET",cache:true,url:f.BASE_TEMPLATE_PATH+e+"?r="+sessionToken,success:function(g){jsConsole.log(f.EVENT_SCRIPT_TEMPLATE_LOADED+b.replace(/\./,"/"));$(f).trigger(f.EVENT_SCRIPT_TEMPLATE_LOADED+b.replace(/\./,"/"));a(g)}};jQuery.ajax(d)};ControlLoader.prototype.initScript=function(controlType,opts){var scriptConstructor="new "+controlType+"("+JSON.stringify(opts)+");";return eval(scriptConstructor)};if(!String.prototype.startsWith){String.prototype.startsWith=function(b,a){a=a||0;return this.indexOf(b,a)===a}}(function(){var a=jQuery.fn.addClass;var c=jQuery.fn.removeClass;var d=jQuery.fn.show;var b=jQuery.fn.hide;jQuery.fn.addClass=function(){jQuery(this).trigger("beforeAddCssClass",arguments);var g=a.apply(this,arguments);jQuery(this).trigger("afterAddCssClass",arguments);return g};jQuery.fn.removeClass=function(){jQuery(this).trigger("beforeRemoveCssClass",arguments);var g=c.apply(this,arguments);jQuery(this).trigger("afterRemoveCssClass",arguments);return g};var f=jQuery.fn.val;jQuery.fn.val=function(){var g;if(arguments.length>0){g=f.apply(this,[])}var h=f.apply(this,arguments);if(arguments.length>0&&g!=f.apply(this,[])){jQuery(this).change()}return h};jQuery.fn.show=function(i,g,h){var j=this;return jQuery(j).each(function(){var l=jQuery(this);var k=function(){if(jQuery.isFunction(h)){h.apply(l)}l.trigger("afterShow")};l.trigger("beforeShow");if(l.hasClass("hide")){l.removeClass("hide").addClass("show")}else{d.apply(l,[i,g,k])}})};jQuery.fn.hide=function(i,g,h){var j=this;return jQuery(j).each(function(){var l=jQuery(this);var k=function(){if(jQuery.isFunction(h)){h.apply(l)}l.trigger("afterHide")};l.trigger("beforeHide");if(l.hasClass("show")){l.removeClass("show").addClass("hide")}else{b.apply(l,[i,g,k])}})};jQuery.fn.center=function(){this.css("position","absolute");this.css("top",($(window).height()-this.height())/2+$(window).scrollTop()+"px");this.css("left",($(window).width()-this.width())/2+$(window).scrollLeft()+"px");return this};jQuery.fn.outerHtml=function(){return jQuery("<div />").append(this.eq(0).clone()).html()};jQuery.parseProperty=function(g,h){var i=[];$(g).each(function(j){i.push(this[h])});return i};jQuery.getGuid=function(){var g=new Date().getTime();var h="xxxxxxxx-xxxx-xxxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(i){var j=(g+Math.random()*16)%16|0;g=Math.floor(g/16);return(i=="x"?j:(j&7|8)).toString(16)});return h};jQuery.cachedScript=function(i,h){var g={dataType:"script",cache:true,url:i,success:h};return jQuery.ajax(g)};jQuery.noCacheScript=function(i,h){var g={dataType:"script",cache:false,url:i,success:h};return jQuery.ajax(g)};jQuery.addChangeEvent=function(h){var g=function(n){var l=$((n.currentTarget==null?n.sender.element:n.currentTarget));var m=l.attr("data-link");var o=l.val();$("*[data-link="+m+"]").each(function(q){var p=$(this);if(p.is("input")||p.is("select")||p.is("textarea")){$.updateValue(p,o)}else{p.html(o)}})};var k=null;if($.isKendo(h)){var i=$.kendoType(h);var j=$(h).data(i);if(j!=null){j.bind("change",g);j.bind("select",g)}}else{if(e.currentTarget.oninput!=null){k=e.currentTarget.oninput}this.oninput=function(l){g(l);if(k!=null){k(l)}}}};jQuery.updateValue=function(g,j){if($.isKendo(g)){var h=$.kendoType(g);var i=$(g).data(h);if(i!=null&&i.value!=null&&i.value()!=j){i.value(j)}}else{$(g).val(j)}};jQuery.isKendo=function(h){var g=$(h).data();var i=false;if(g!=null){$.each(g,function(j,k){if(j.indexOf("kendo")>-1){i=true}})}return i};jQuery.kendoType=function(h){var g=$(h).data();var i=null;if(g!=null){$.each(g,function(j,k){if(j.indexOf("kendo")>-1){i=j}})}return i};jQuery.getKendoControl=function(g){var h=null;if($.isKendo(g)){var i="get"+$.capitalizeFirstLetter($.kendoType(g));h=g[i]()}return h};jQuery.capitalizeFirstLetter=function(g){return g.charAt(0).toUpperCase()+g.slice(1)};jQuery.submitAsForm=function(l,g,j){if($.type(g)!="string"){g=JSON.stringify(g)}if(j==null){j="FormData"}var h=$("<form />",{action:l,"class":"hide",method:"post",enctype:"multipart/form-data"});var i=$("<input />",{value:g,id:j,name:j,type:"hidden"});var k=$("<input />",{type:"submit",value:"Submit Form"});h.append(i);h.append(k);h.appendTo("body").submit()};jQuery.waitFor=function(i,h,j){console.log("Waiting on "+i+" to exist...");var g=setInterval(function(){var k=$(i);if(k.length){console.log(i+"Exists!");clearInterval(g);h(k)}},j)}})();function ArgosyEvents(){}ArgosyEvents.prototype.COMPANY_LINKS_SHOW="EVENT_SHOW_COMPANY_LINKS";ArgosyEvents.prototype.COMPANY_LINKS_HIDE="EVENT_HIDE_COMPANY_LINKS";ArgosyEvents.prototype.COMPANY_FILTER_SHOW="COMPANY_FILTER_SHOW";ArgosyEvents.prototype.COMPANY_FILTER_HIDE="COMPANY_FILTER_HIDE";ArgosyEvents.prototype.PART_CATEGORY_CHANGE="EVENT_PART_CATEGORY_CHANGE";ArgosyEvents.prototype.PART_CATEGORIES_LOADED="EVENT_PART_CATEGORIES_LOADED_CHANGE";ArgosyEvents.prototype.PART_CATEGORY_VIEW_CHANGE="EVENT_PART_CATEGORY_VIEW_CHANGE";ArgosyEvents.prototype.SEARCH_PART_GRID_VIEW="EVENT_SEARCH_PART_GRID_VIEW";ArgosyEvents.prototype.SEARCH_PAGE_GRID="EVENT_SEARCH_PAGE_GRID";ArgosyEvents.prototype.COUNTRY_CHANGE="EVENT_COUNTRY_CHANGE";ArgosyEvents.prototype.PAGE_DOM_CHANGE="EVENT_PAGE_DOM_CHANGE";ArgosyEvents.prototype.START_LOADING="EVENT_SHOW_BLOCK_UI";ArgosyEvents.prototype.END_LOADING="EVENT_HIDE_BLOCK_UI";ArgosyEvents.prototype.USER_GROUP_CHANGE="EVENT_USER_GROUP_CHANGE";ArgosyEvents.prototype.VERIFY_ADDRESS="EVENT_VERIFY_ADDRESS";ArgosyEvents.prototype.SHOW_PART_DETAILS_MODAL="EVENT_SHOW_PART_DETAILS_MODAL";ArgosyEvents.prototype.SHOW_ASSET_DETAILS_MODAL="EVENT_SHOW_ASSET_DETAILS_MODAL";ArgosyEvents.prototype.SHOW_PART_USAGE_MODAL="EVENT_SHOW_PART_USAGE_MODAL";ArgosyEvents.prototype.SHOW_VIEWING_RIGHTS_MODAL="EVENT_SHOW_VIEWING_RIGHTS_MODAL";ArgosyEvents.prototype.SHOW_ASSET_USAGE_MODAL="EVENT_SHOW_ASSET_USAGE_MODAL";ArgosyEvents.prototype.SHOW_KIT_INVENTORY_DETAILS_MODAL="EVENT_SHOW_KIT_INVENTORY_DETAILS_MODAL";ArgosyEvents.prototype.SEARCH_PERSONALIZED_PROOF_COLLECTIONS="EVENT_SEARCH_PERSONALIZED_PROOF_COLLECTIONS";ArgosyEvents.prototype.SHOW_PERSONALIZED_PROOF_COLLECTION_DETAILS="EVENT_SHOW_PERSONALIZED_PROOF_COLLECTION_DETAILS";ArgosyEvents.prototype.SELECT_ALL_PERSONALIZED_PROOF_COLLECTION_ITEMS="EVENT_SELECT_ALL_PERSONALIZED_PROOF_COLLECTION_ITEMS";ArgosyEvents.prototype.REORDER_SELECTED_PERSONALIZED_PROOF_COLLECTION_ITEMS="EVENT_REORDER_SELECTED_PERSONALIZED_PROOF_COLLECTION_ITEMS";ArgosyEvents.prototype.SHOW_THEME="EVENT_SHOW_THEME";ArgosyEvents.prototype.SHOW_STANDARD_THEMES="EVENT_SHOW_STANDARD_THEMES";ArgosyEvents.prototype.FULL_TEXT_SEARCH="EVENT_FULL_TEXT_SEARCH";ArgosyEvents.prototype.UPDATE_PART_QUANTITIES="EVENT_UPDATE_PART_QUANTITIES";ArgosyEvents.prototype.SHOW_SHARE_ASSET_MODAL="EVENT_SHOW_SHARE_ASSET_MODAL";ArgosyEvents.prototype.SHOW_PART_CONFIGURATION_MODAL="EVENT_SHOW_PART_CONFIGURATION_MODAL";ArgosyEvents.prototype.SHOW_PART_QUANTITY_MODAL="EVENT_SHOW_PART_QUANTITY_MODAL";ArgosyEvents.prototype.TOGGLE_SWITCH_CHANGE="EVENT_TOGGLE_SWITCH_CHANGE";ArgosyEvents.prototype.SELECT_GLOBAL_PROFILE="EVENT_SELECT_GLOBAL_PROFILE";ArgosyEvents.prototype.SELECT_STANDARD_PROFILE="EVENT_SELECT_STANDARD_PROFILE";ArgosyEvents.prototype.PROJECT_REVISION_CHANGE="EVENT_PROJECT_REVISION_CHANGE";ArgosyEvents.prototype.PART_ADDED_TO_CART="EVENT_PART_ADDED_TO_CART";ArgosyEvents.prototype.PROMPT_NOTIFY="EVENT_PROMPT_NOTIFY";ArgosyEvents.prototype.ITEM_DELETED_FROM_CART="EVENT_ITEM_DELETED_FROM_CART";ArgosyEvents.prototype.ASSET_DIRECTORY_CHANGED="EVENT_ASSET_DIRECTORY_CHANGED";ArgosyEvents.prototype.ASSET_DIRECTORY_CREATED="EVENT_ASSET_DIRECTORY_CREATED";ArgosyEvents.prototype.REFRESH_ASSET_DIRECTORY="EVENT_REFRESH_ASSET_DIRECTORY";ArgosyEvents.prototype.SELECT_ALL_ASSETS="EVENT_SELECT_ALL_ASSETS";ArgosyEvents.prototype.DO_ASSET_ACTION="EVENT_DO_ASSET_ACTION";ArgosyEvents.prototype.RELOAD_ASSET_FOLDERS="EVENT_RELOAD_ASSET_FOLDERS";ArgosyEvents.prototype.MOVE_ASSETS_TO_FOLDER="EVENT_MOVE_ASSETS_TO_FOLDER";ArgosyEvents.prototype.ADD_ASSET_TO_CART="EVENT_ADD_ASSET_TO_CART";ArgosyEvents.prototype.ADD_ASSET_TO_CART2="EVENT_ADD_ASSET_TO_CART2";ArgosyEvents.prototype.ADD_ASSET_TO_CART_FINAL="EVENT_ADD_ASSET_TO_CART_FINAL";ArgosyEvents.prototype.SHOW_ASSET_UPLOAD_MODAL="EVENT_SHOW_ASSET_UPLOAD_MODAL";ArgosyEvents.prototype.MVC_VIEW_PRODUCTS_CONTROL_LOADED="EVENT_TEMPLATE_PRODUCT_VIEW_LOADED";ArgosyEvents.prototype.UPDATE_ASSET_TAGS="EVENT_UPDATE_ASSET_TAGS";ArgosyEvents.prototype.GLOBAL_TEMPLATES_LOADED="SCRIPT_TEMPLATE_LOADEDGlobalTemplates";ArgosyEvents.prototype.ADD_UPLOAD_TO_CART="EVENT_ADD_UPLOAD_TO_CART";ArgosyEvents.prototype.REGISTRATION_FIRED="EVENT_REGISTRATION_FIRED";ArgosyEvents.prototype.SELECTED_USER="EVENT_SELECTED_USER";ArgosyEvents.prototype.SELECTED_CONSUMER="EVENT_SELECTED_CONSUMER";ArgosyEvents.prototype.CLEAR_SELECTED_USER="EVENT_CLEAR_SELECTED_USER";ArgosyEvents.prototype.CLEAR_SELECTED_CONSUMER="EVENT_CLEAR_SELECTED_CONSUMER";ArgosyEvents.prototype.SHOW_USER_HIERARCHY_MODAL="EVENT_SHOW_USER_HIERARCHY_MODAL";ArgosyEvents.prototype.KENDO_EDITOR_IMAGE_UPLOADED="EVENT_KENDO_EDITOR_IMAGE_UPLOADED";ArgosyEvents.prototype.KENDO_EDITOR_IMAGE_REMOVED="EVENT_KENDO_EDITOR_IMAGE_REMOVED";ArgosyEvents.prototype.EVENT_FAVORITES_ADDED_REMOVED="EVENT_FAVORITES_ADDED_REMOVED";ArgosyEvents.prototype.EVENT_NEED_CONFIGURATION_PART="EVENT_NEED_CONFIGURATION_PART";ArgosyEvents.prototype.EVENT_SEND_CONFIGURATION_PART="EVENT_SEND_CONFIGURATION_PART";ArgosyEvents.prototype.EVENT_BUILD_PROOF="EVENT_BUILD_PROOF";ArgosyEvents.prototype.EVENT_SHOW_PROOFING_FORM="EVENT_SHOW_PROOFING_FORM";ArgosyEvents.prototype.EVENT_REGENERATE_VARIABLES="EVENT_REGENERATE_VARIABLES";ArgosyEvents.prototype.EVENT_CONSUMER_UPDATED="EVENT_CONSUMER_UPDATED";ArgosyEvents.prototype.EVENT_CONSUMER_COMPANY_ADDED="EVENT_CONSUMER_COMPANY_ADDED";ArgosyEvents.prototype.EVENT_ASSET_PERMISSION_SAVE="EVENT_ASSET_PERMISSION_SAVE";ArgosyEvents.prototype.EVENT_RELOAD_ASSET_USERGROUPS="EVENT_RELOAD_ASSET_USERGROUPS";ArgosyEvents.prototype.EVENT_RELOAD_ASSET_USERS="EVENT_RELOAD_ASSET_USERS";ArgosyEvents.prototype.EVENT_USER_SELECTED_ADDRESS="EVENT_USER_SELECTED_ADDRESS";ArgosyEvents.prototype.EVENT_USER_SELECTED_BILLING_ADDRESS="EVENT_USER_SELECTED_BILLING_ADDRESS";ArgosyEvents.prototype.EVENT_ADD_DAM_ROLE="EVENT_ADD_DAM_ROLE";ArgosyEvents.prototype.EVENT_SHOW_IMAGE_EDITOR="EVENT_SHOW_IMAGE_EDITOR";ArgosyEvents.prototype.EVENT_GLOBAL_MULTI_UPLOAD_COMPLETE="EVENT_GLOBAL_MULTI_UPLOAD_COMPLETE";ArgosyEvents.prototype.EVENT_SHOW_GLOBAL_MULTI_UPLOAD="EVENT_SHOW_GLOBAL_MULTI_UPLOAD";ArgosyEvents.prototype.EVENT_SEND_EXCEL_DATASOURCE="EVENT_SEND_EXCEL_DATASOURCE";ArgosyEvents.prototype.EVENT_REQUEST_EXCEL_DATASOURCE="EVENT_REQUEST_EXCEL_DATASOURCE";ArgosyEvents.prototype.EVENT_PART_INPUT_QTY_CHANGED="EVENT_PART_INPUT_QTY_CHANGED";ArgosyEvents.prototype.EVENT_COUNTRY_STATE_MAP_LOADED="EVENT_COUNTRY_STATE_MAP_LOADED";ArgosyEvents.prototype.EVENT_STATE_CHANGED="EVENT_STATE_CHANGED";ArgosyEvents.prototype.EVENT_GENERATE_HIGH_RES_PROOF="EVENT_GENERATE_HIGH_RES_PROOF";ArgosyEvents.prototype.EVENT_TEMPORARY_GLOBAL_PROFILE_CREATED="EVENT_TEMPORARY_GLOBAL_PROFILE_CREATED";ArgosyEvents.prototype.EVENT_CARTLINE_SAVED_FOR_LATER="EVENT_CARTLINE_SAVED_FOR_LATER";ArgosyEvents.prototype.EVENT_SAVED_CARTLINE_ADDED_TO_SHOPPING_CART="EVENT_SAVED_CARTLINE_ADDED_TO_SHOPPING_CART";ArgosyEvents.prototype.ADDRESS_USERS_LOADED="EVENT_ADDRESS_USERS_LOADED";ArgosyEvents.prototype.ADDRESS_USER_GROUPS_LOADED="EVENT_ADDRESS_USER_GROUPS_LOADED";ArgosyEvents.prototype.EVENT_FILTER_AGGREGATE_SEARCH="EVENT_FILTER_AGGREGATE_SEARCH";ArgosyEvents.prototype.EVENT_TOGGLE_COMPANY_FILTERS="EVENT_TOGGLE_COMPANY_FILTERS";ArgosyEvents.prototype.EVENT_EDIT_ORDER_LINE="EVENT_EDIT_ORDER_LINE";ArgosyEvents.prototype.EVENT_UPDATE_ORDER_CALCULATION="EVENT_UPDATE_ORDER_CALCULATION";ArgosyEvents.prototype.MANAGE_COOP_DOLLARS_CONTROL_LOADED="EVENT_TEMPLATE_MANAGE_COOP_DOLLARS_LOADED";ArgosyEvents.prototype.EVENT_AUTOCOMPLETE_USER_SELECTED="EVENT_AUTOCOMPLETE_USER_SELECTED";ArgosyEvents.prototype.EVENT_AUTOCOMPLETE_PART_SELECTED="EVENT_AUTOCOMPLETE_PART_SELECTED";ArgosyEvents.prototype.EVENT_DELETE_ADJUSTMENT_USERS="EVENT_DELETE_ADJUSTMENT_USERS";ArgosyEvents.prototype.EVENT_UPDATE_VARIABLES_BY_LINE_ID="EVENT_UPDATE_VARIABLES_BY_LINE_ID";ArgosyEvents.prototype.EVENT_UPDATE_MAILING_LIST_COST="EVENT_UPDATE_MAILING_LIST_COST";var OrderStatuses=[{value:"Open",text:"All Open",selected:true},{value:"",text:"All"},{value:"D",text:"Approval Denied"},{value:"W",text:"Approval Pending"},{value:"A",text:"Awaiting Shipment"},{value:"S",text:"Back Ordered"},{value:"N",text:"Batch Processing"},{value:"X",text:"Canceled"},{value:"C",text:"Closed"},{value:"J",text:"Consolidated"},{value:"Y",text:"Fast Pick Pack"},{value:"U",text:"Fast Pick Pack Not Printed"},{value:"F",text:"Firmed"},{value:"I",text:"Invoiced"},{value:"B",text:"On Hold"},{value:"P",text:"Picking"},{value:"E",text:"Pre Close"},{value:"O",text:"Quick Ship"},{value:"R",text:"Released"},{value:"V",text:"Saved"},{value:"Z",text:"Shipping"},{value:"T",text:"Waved"}];var MaskedOrderStatuses=[{value:"Open",text:"All Open",selected:true},{value:"working",text:"Working"},{value:"C",text:"Closed"},{value:"D",text:"Denied"},{value:"X",text:"Canceled"},{value:"W",text:"Pending Approval"},{value:"all",text:"All"}];var RMAStatuses=[{value:"1",text:"Processing",selected:true},{value:"2",text:"Complete"},{value:"0",text:"All"}];var ActiveStates=[{value:"Y",text:"Active",selected:true},{value:"N",text:"Inactive"},{value:"",text:"All"}];var HDTicketStatuses=[{value:"1",text:"Open",selected:true},{value:"2",text:"On-Hold"},{value:"3",text:"Being Researched"},{value:"4",text:"Close"},{value:"0",text:"All"}];var HDIssueTypes=[{value:"1",text:"Order Questions"},{value:"2",text:"Report Request"},{value:"3",text:"Functionality Request"},{value:"4",text:"Other"},{value:"5",text:"Shipping Questions"},{value:"0",text:"All",selected:true}];var HDTicketPriority=[{value:"1",text:"High"},{value:"2",text:"Medium"},{value:"3",text:"Low"}];var ProjectStatuses=[{value:"0",text:"All Projects"},{value:"8",text:"All Open"},{value:"7",text:"All Approved"},{value:"1",text:"Released"},{value:"2",text:"Change Requested"},{value:"3",text:"Awaiting Clients Approval"},{value:"5",text:"Need Pricing Approval"},{value:"6",text:"Need Artwork Approval"},{value:"4",text:"Closed"}];var InputExtensions=[{value:"",text:"All"},{value:"32",text:".ai"},{value:"2",text:".bmp"},{value:"25",text:".docx"},{value:"33",text:".eps"},{value:"3",text:".gif"},{value:"1",text:".jpg"},{value:"20",text:".mp3"},{value:"17",text:".mp4"},{value:"7",text:".pdf"},{value:"5",text:".png"},{value:"29",text:".pptx"},{value:"34",text:".psd"},{value:"31",text:".tif"},{value:"38",text:".zip"}];var OutputExtensions=[{value:"",text:"All"},{value:"25",text:".docx"},{value:"33",text:".eps"},{value:"1",text:".jpg"},{value:"20",text:".mp3"},{value:"17",text:".mp4"},{value:"7",text:".pdf"},{value:"5",text:".png"},{value:"29",text:".pptx"},{value:"38",text:".zip"}];var controlLoader=null;var app_Version_Num="";var argosyEvents=new ArgosyEvents();var pricingManager=null;var showDebugInfo;var countryStateMap=null;var validSessionRequestRunning=false;var productDetailControl=null;var personalizedProofCollectionDetailsControl=null;var jsConsole={log:function(a){if(showDebugInfo===true){window.console&&console.log(a)}},warn:function(a){if(showDebugInfo===true){window.console&&console.warn(a)}},error:function(a){window.console&&console.error(a)}};kendo.data.binders.keyPress=kendo.data.Binder.extend({init:function(b,a,d){kendo.data.Binder.fn.init.call(this,b,a,d);var c=this.bindings.keyPress;$(b).bind("keypress",function(){c.get()})},refresh:function(){}});kendo.data.binders.keyDown=kendo.data.Binder.extend({init:function(b,a,d){kendo.data.Binder.fn.init.call(this,b,a,d);var c=this.bindings.keyDown;$(b).bind("keydown",function(){c.get()})},refresh:function(){}});kendo.data.binders.objectData=kendo.data.Binder.extend({init:function(b,a,c){var d=this;kendo.data.Binder.fn.init.call(this,b,a,c)},refresh:function(){var b=this;var a=b.bindings.objectData.get()}});function framebuster(){if(window.parent!=window){window.parent.location=window.location}}$(document).ready(function(){framebuster();kendo.culture("~{LangCulture}~");controlLoader=new ControlLoader(true);globalPageInit();addArgosyActions();controlLoader.loadControl("PricingManager",{},function(a){pricingManager=a});controlLoader.loadControl("ModalProductDetail",{},function(a){productDetailControl=a;var b=getQuerystring("showSku");if(b!=null&&b.trim().length>0){$(document).trigger(argosyEvents.SHOW_PART_DETAILS_MODAL,b.trim())}});controlLoader.loadControl("PersonalizedProofCollectionDetails",{},function(a){personalizedProofCollectionDetailsControl=a});addPageScript();$.ajaxSettings.traditional=true;setupDomEvents();setupPageEvents();setupPageDefaultFocus();setupFormDefaultSubmits($("body"));setupGlobalImageEditor();startExpirationTimeout();setupPartTypeAheadSearch($("#searchInput"));setupPartTypeAheadSearch($("input[name=searchFor]"));$(".fancybox").fancybox();$(".parthistory").fancybox({href:"#coming_content"});$(".fancybox-ajax").fancybox({type:"ajax",transitionIn:"none",transitionOut:"none",})});function setupPartTypeAheadSearch(a){var b={filter:"startswith",minLength:2,dataSource:{type:"odata",serverFiltering:true,transport:{read:function(d){var c=d.data.filter.filters[0].value;$.ajax({url:"/api/lucenesearch/PartTypeAhead?prefix="+c,dataType:"json",method:"GET",success:function(e){d.success(e)}})}},schema:{data:function(c){return c},total:function(c){return c.length}}}};a.kendoAutoComplete(b)}var loadingMap=false;function getCountryStateMap(){if(!loadingMap){loadingMap=true;$.ajax({url:"/DataView/GetCountryStateMap",dataType:"json",cache:true,success:function(a){countryStateMap=a;$(document).trigger(argosyEvents.EVENT_COUNTRY_STATE_MAP_LOADED)}})}}function startExpirationTimeout(){setTimeout(function(){checkForSecurityRedirect()},(31*60*1000))}function checkForSecurityRedirect(){var a=window.location.href.toLowerCase().indexOf("/login")===-1;var b=window.location.href.toLowerCase().indexOf("/register")===-1;var c=window.location.href.toLowerCase().indexOf("/security")===-1;if(!validSessionRequestRunning&&a&&b&&c){validSessionRequestRunning=true;jQuery.ajax({type:"GET",contentType:"application/json",url:"/Security/IsSessionExpired",dataType:"json",success:function(d){if(!d.IsAuthenticated){window.location=d.RedirectTo}else{startExpirationTimeout()}},error:function(d){location.reload()},complete:function(){validSessionRequestRunning=false}})}}var ReturnCode={Failed:500,Success:200};function hideTopNav(){$(".navbar-static-top, nav").hide()}function setupDomEvents(){var d=$("section");var a=window.MutationObserver||window.WebKitMutationObserver;var b=new a(mutationHandler);var c={childList:true,characterData:false,attributes:false,subtree:true};d.each(function(){b.observe(this,c)})}function mutationHandler(a){a.forEach(function(b){if(b.addedNodes!=null&&b.addedNodes.length>0){$(b.addedNodes).each(function(c){var d=$(this);setupFormDefaultSubmits(d);d.find(".fancybox").fancybox()})}})}function reloadImage(b,a){if(a==null){a=500}$(b).hide();setTimeout(function(c){b.src="/Store/Proofing/GetProofingImage?imagePath="+b.src;$(b).show()},a)}function isValidEmailAddress(a){var b=new RegExp(/^(.+)@([^\(\);:,<>]+\.[a-zA-Z]{2,4})/);return b.test(a)}function getCartCount(){var a="/Store/Cart/GetCartCount";$.ajax({url:a,dataType:"json",type:"GET",contentType:"application/json; charset=utf-8",success:function(b){$("._emCartCount").html("("+b+")")}})}function formatBytes(a,b){if(a==0){return"0 Byte"}var e=1000;var c=b+1||3;var f=["Bytes","KB","MB","GB","TB","PB","EB","ZB","YB"];var d=Math.floor(Math.log(a)/Math.log(e));return parseFloat((a/Math.pow(e,d)).toFixed(c))+" "+f[d]}function setupPageEvents(){$(document).bind(argosyEvents.PAGE_DOM_CHANGE,function(b,a){convertInputsInElements(b,a);setupFormDefaultSubmits($(a));if($(a).hasClass("fancybox-wrap")){setTimeout(function(c){setFancyboxFocus()},250)}});$(document).bind(argosyEvents.SHOW_PART_DETAILS_MODAL,function(c,b){var g=null,h=true,d=false,f=false;if($.type(b)==="object"){g=b.partId;h=b.showAddToCart==null?true:(b.showAddToCart=="true"||b.showAddToCart==true);d=b.hideCartInputs==null?d:b.hideCartInputs;f=b.isInventoryView==null?f:b.isInventoryView}else{g=b}if(productDetailControl!=null){var a=function(e){productDetailControl.show(e,d,f,h);$(document).trigger(argosyEvents.END_LOADING)};if(isNaN(g)){getPartBySku(g,a)}else{getPart(parseInt(g),a)}}});$(document).bind(argosyEvents.PART_ADDED_TO_CART,function(b,a){getCartCount()});$(document).bind(argosyEvents.ITEM_DELETED_FROM_CART,function(b,a){getCartCount()});$(document).bind(argosyEvents.PROMPT_NOTIFY,function(b,a){prompt.notify({question:a.message,type:a.type})});$(document).bind(argosyEvents.START_LOADING,function(b,a){if(a!=null){if(a.name!=null&&a.name.trim().length>0){$(document).find("*[data-argosy-loading="+a.name+"]").each(function(d){var c=$(this);block(c,c.attr("data-argosy-loading-message"),c.attr("data-argosy-loading-blank")=="true")})}else{if(a.element!=null){block(a.element,a.message)}}}else{block()}});$(document).bind(argosyEvents.END_LOADING,function(b,a){if(a!=null&&a.name!=null&&a.name.trim().length>0){$(document).find("*[data-argosy-loading]").each(function(c){if($(this).attr("data-argosy-loading").toLowerCase().indexOf(a.name.trim().toLowerCase())>-1){unblock(this)}})}else{if(a!=null&&a.element!=null){unblock(a.element)}else{unblock()}}})}function loadEmptyGridTemplate(b){var a={Message:b};return kendo.Template.compile($("#_GlobalNoResultsTemplate").html())(a)}function htmlEncode(a){return $("<div/>").text(a).html()}function htmlDecode(a){return $("<div/>").html(a).text()}function unblock(a){if(a!=null){$(a).unblock()}else{$.unblockUI()}}function disable(a){var b={backgroundColor:"gray",opacity:0.75,cursor:"wait"};$(a).block({message:"",baseZ:9500,overlayCSS:b})}function enable(a){$(a).unblock()}function block(c,d,a){if(a==null){a=false}if(d==null){d=a?"":"~{MsgLoading}~"}var b={"background-color":"transparent","background-size":"32px auto","background-repeat":"no-repeat","background-position":"center top","-moz-opacity":"1",opacity:"1",border:"none",height:"100px","z-index":"9999",};var e={backgroundColor:"transparent",opacity:1,cursor:"wait"};if(c!=null){if(a){b={}}$(c).block({centerX:true,centerY:true,css:b,message:"<div class='loading-message-wrapper' style='padding: 10px 5px; margin-top: 0px; border-radius: 5px; background-color: #fafafa; border: #ccc 1px solid; box-shadow: 0px 0px 13px 0px rgba(52, 50, 50, 0.09);'><div style='color: #666; margin-top: 0; padding-top: 0'> <img style='margin: 0 10px; width: 20px' src='/content/images/generic.gif'>"+d+"</div></div>",overlayCSS:e,baseZ:500})}else{$.blockUI({message:"<div class='loading-message-wrapper' style='padding: 10px 5px;  margin-top: 0px; border-radius: 5px; background-color: #fafafa; border: #ccc 1px solid; box-shadow: 0px 0px 13px 0px rgba(52, 50, 50, 0.09);'><div style='color: #666; margin-top: 0; padding-top: 0'><img style='margin: 0 10px; width: 20px;' src='/content/images/generic.gif'>"+d+"</div></div>",css:b,overlayCSS:e,baseZ:9500});$(".blockUI.blockMsg").center()}}function handleDataSourceException(a){window.location="/Error"}_defaultDataSourceConfig={pageSize:50,page:1,serverPaging:true,serverSorting:true,serverFiltering:true,pageable:{refresh:true,pageSizes:[50,100,500],buttonCount:5},filter:[],schema:{data:"Records",total:"TotalRecords",errors:"Guid"},error:function(a){window.location="/Error"}};function addPageScript(){if(location.pathname.indexOf("mockups")>-1){$.getScript("/scripts/page"+convertToJavascriptFile(location.pathname))}}function convertToJavascriptFile(a){if(a=="/"){a="/browse-products.html"}return a.substring(0,a.indexOf("."))+".js"}function pluralize(b,a){return b+(a>1?"s":"")}function appendLoadingAttribute(b,d,c){var a="";if(c==null){c=false}if(b.attr("data-argosy-loading")!=null){a+=b.attr("data-argosy-loading")+","}b.attr("data-argosy-loading-blank",c);a+=d;b.attr("data-argosy-loading",a)}function convertPartToPricing(e,d){var b={value:e.DefaultQuantity,cartId:0,overrideQuantitySettings:false,renderPriceBreak:e.IsLimitPartOrderQuantity&&e.Discounts&&e.Discounts.length>0&&!e.IsEdeliveryOnly,renderPriceInput:e.Discounts==null||e.Discounts.length===0||!e.IsEdeliveryOnly,change:function(f){},dataBound:function(f){},spin:function(f){},isCartQty:true,isEdeliverySelected:false,disabled:false,spinEventTriggered:false,appendZeroDiscount:false,rank:0,min:1,isEditable:!e.Options.IsMailingListRequired,minQty:e.MinOrderQty,maxQty:e.MaxOrderQty};d=$.extend({},b,d);if(d.appendZeroDiscount&&d.renderPriceBreak){var a=e.Discounts[0];e.Discounts.splice(0,0,$.extend({},a,{Id:0,Quantity:0,Range:"0",Discount:0,CostPerEach:0}))}var c=e.Discounts;return{part:{partId:e.PartId,sku:e.Sku,partName:e.Name,partDesc:e.Description,isEdeliveryOnly:e.IsEdeliveryOnly,discounts:c,isExpired:e.IsExpired,flagOffered:e.FlagOffered,cpq:e.CPQ,isOrderByCpq:e.IsOrderByCPQ,rank:d.rank,isEditable:!e.Options.IsMailingListRequired},discounts:e.Discounts,options:d,change:d.change,dataBound:d.dataBound,value:d.value,spin:d.spin,min:d.min,isInputDisabled:function(f){if(this.part.isEdeliveryOnly){this.options.value=1;this.set("options",this.options)}if(!this.part.hasOwnProperty("isEditable")){this.part.isEditable=true}return this.part.isEdeliveryOnly||this.options.isEdeliverySelected||this.options.disabled||!this.part.isEditable}}}function addArgosyActions(a){if(a==undefined){a=null}var b=(a==null)?$("*[data-argosy-action]"):$(a).find("*[data-argosy-action]");b.each(function(d){var f=$(this);var c=f.attr("data-argosy-action").toLowerCase();if(c.indexOf(",")>-1){c=c.split(",")}else{var g=c;c=[];c.push(g)}f.unbind("click").unbind("change").unbind("hover");$(c).each(function(h){var e=this.toString();switch(e){case"addproducthover":f.click(function(i){var k=f.attr("data-argosy-target");var l=f.closest(".product-image-wrapper").find(k);if(!l.hasClass("hover")){l.addClass("hover")}else{l.removeClass("hover")}});break;case"masonhover":f.mouseenter(function(i){var k=f.attr("data-argosy-target");var l=f.closest(".product-image-wrapper").find(k);if(!l.hasClass("display-info")){l.addClass("display-info")}}).mouseleave(function(i){var k=f.attr("data-argosy-target");var l=f.closest(".product-image-wrapper").find(k);if(l.hasClass("display-info")){l.removeClass("display-info")}});break;case"addproducthover-list":f.click(function(i){var k=f.attr("data-argosy-target");var l=f.closest("#grid_product").find(k);if(!l.hasClass("hover")){l.addClass("hover")}else{l.removeClass("hover")}});break;case"addrapidorder":f.click(function(l){var k=f.attr("data-argosy-dataid"),m=$(this),n="/Store/Browse/AddRemoveFavorites",i={};i.isFavorite=!m.hasClass("selected");i.partId=k;m.toggleClass("selected");$.ajax({url:n,dataType:"json",data:JSON.stringify(i),type:"POST",contentType:"application/json; charset=utf-8"});$(document).trigger(argosyEvents.EVENT_FAVORITES_ADDED_REMOVED,k)});break;case"addtocart":f.unbind("click");f.click(function(m){var n=f.attr("data-argosy-dataid"),p=f.attr("data-argosy-qty"),o=f.attr("data-argosy-partname"),q=$("#addToCartQuantity_"+n),i=$("#_ProductDetailModalAlert"),l={};if(p){l.qty=parseInt(p)}else{if(q.length>0){l.qty=parseInt(q.val())}else{l.qty=1}}if(l.qty==null||isNaN(l.qty)){l.qty=parseInt(q.attr("value"))}var k=function(s){var r=checkBeforeAddingToCart(s,l.qty,i);if(r){i.hide();l.partId=n;sendPartToCart(l,o)}};getPart(n,k)});break;case"showproductdetails":f.click(function(){var i=f.attr("data-argosy-dataid");var k=f.attr("data-argosy-show-add-to-cart");$(document).trigger(argosyEvents.SHOW_PART_DETAILS_MODAL,{partId:i,showAddToCart:k==null?true:k})});break;case"showpersonalizedproofcollectiondetails":f.click(function(){var i=f.attr("data-argosy-dataid");$(document).trigger(argosyEvents.SHOW_PERSONALIZED_PROOF_COLLECTION_DETAILS,i)});break;case"selectallpersonalizedproofcollectionitems":f.click(function(i){$(document).trigger(argosyEvents.SELECT_ALL_PERSONALIZED_PROOF_COLLECTION_ITEMS,{isChecked:i.target.checked})});break;case"reorderselectedpersonalizedproofcollectionitems":f.click(function(){$(document).trigger(argosyEvents.REORDER_SELECTED_PERSONALIZED_PROOF_COLLECTION_ITEMS)});break;case"edittheme":f.click(function(){var i=f.attr("data-argosy-dataid");changeCSS("/Style/ChangeCss?id="+i);$(document).trigger(argosyEvents.SHOW_THEME,i)});break;case"showstandardthemes":f.click(function(){$(document).trigger(argosyEvents.SHOW_STANDARD_THEMES)});break;case"showassetdetails":f.click(function(k){var i=f.attr("data-argosy-dataid");$(document).trigger(argosyEvents.SHOW_ASSET_DETAILS_MODAL,i)});break;case"showcategory":f.click(function(k){var i=f.attr("data-argosy-categoryName");window.location.hash="#Category:"+i});break;case"showproductusagehistory":f.click(function(k){var i=f.data("argosy-dataid");var l=f.data("argosy-partname");$(document).trigger(argosyEvents.SHOW_PART_USAGE_MODAL,{partId:i,partName:l})});break;case"showviewingrights":f.click(function(){var k=f.data("inclusionTags"),i=f.data("exclusionTags");var l={partId:f.data("partId"),partName:f.data("partName"),companyId:f.data("companyId"),inclusionTags:k,exclusionTags:i};$(document).trigger(argosyEvents.SHOW_VIEWING_RIGHTS_MODAL,l)});break;case"showpartconfigureoptions":f.click(function(k){var i=f.data("argosy-dataid");$(document).trigger(argosyEvents.SHOW_PART_CONFIGURATION_MODAL,i)});break;case"showpartquantitymodal":f.click(function(k){var i=f.data("argosy-dataid");$(document).trigger(argosyEvents.SHOW_PART_QUANTITY_MODAL,i)});break;case"showkitinventorymodal":f.click(function(k){var i=f.data("argosy-dataid");$(document).trigger(argosyEvents.SHOW_KIT_INVENTORY_DETAILS_MODAL,i)});break;case"showassetusagehistory":f.click(function(l){var k=f.data("argosy-dataid");var i=f.data("argosy-assetname");$(document).trigger(argosyEvents.SHOW_ASSET_USAGE_MODAL,{assetId:k,assetName:i})});break;case"shareasset":f.click(function(k){var i=f.data("argosy-dataid");$(document).trigger(argosyEvents.SHOW_SHARE_ASSET_MODAL,i)});break;case"updatepartquantities":var j=$(f);if(!$.isKendo(j)){j.kendoNumericTextBox({min:j.val(),format:"n0",step:1,decimals:0,spinners:false,change:function(k){var i=k.sender.element.attr("data-argosy-dataid");var l=k.sender.value();$(document).trigger(argosyEvents.UPDATE_PART_QUANTITIES,{partId:i,value:l})}})}else{j.on("change paste",function(k){var i=parseInt(k.target.attributes["data-argosy-dataid"].value);var l=null;if($.isKendo(k.target)){l=$.getKendoControl($(k.target)).value()}else{l=$(k.target).val()}$(document).trigger(argosyEvents.UPDATE_PART_QUANTITIES,{partId:i,value:l})})}break;case"select-global-profile":f.change(function(i){var k=$(this).val();$(document).trigger(argosyEvents.SELECT_GLOBAL_PROFILE,{globalProfileId:k,element:this})});break;case"select-standard-profile":f.change(function(i){var k=$(this).val();$(document).trigger(argosyEvents.SELECT_STANDARD_PROFILE,{standardProfileId:k,element:this})});break;case"select-proofing-profile":f.change(function(i){var k=$(this).val();triggerProfileChangeEvent(k)});break;case"change-folder-view":f.click(function(m){var k=f.attr("data-argosy-dataid");var l=f.attr("data-argosy-dataname");var i=f.attr("data-argosy-datadescription");var n=f.attr("data-argosy-datauid");$(document).trigger(argosyEvents.ASSET_DIRECTORY_CHANGED,{Id:k,Name:l,Description:i,uid:n})});break;case"show-large-image":f.dblclick(function(k){var i=f.attr("data-argosy-datahref");if(i!=null&&i.length>0){$.fancybox({href:i})}});break;case"show-large-image-single":f.click(function(k){var i=f.attr("data-argosy-datahref");if(i!=null&&i.length>0){$.fancybox({href:i})}});break;case"select-all-assets":f.change(function(i){$(document).trigger(argosyEvents.SELECT_ALL_ASSETS,{isChecked:i.target.checked})});break;case"asset-action-change":f.change(function(i){$(document).trigger(argosyEvents.DO_ASSET_ACTION,{action:f.val()});setTimeout(function(){f.getKendoDropDownList().select(0)},500)});break;case"add-asset-to-cart":f.click(function(k){var i=f.attr("data-argosy-dataid");$(document).trigger(argosyEvents.ADD_ASSET_TO_CART,i)});break;default:}})});$(document).trigger(argosyEvents.PAGE_DOM_CHANGE,a)}function triggerProfileChangeEvent(d,a,c){if(d.indexOf("-")){var b=d.split("-");switch(b[0]){case"global":$(document).trigger(argosyEvents.SELECT_GLOBAL_PROFILE,{globalProfileId:parseInt(b[1]),element:this,callback:a,showLoading:c});break;case"profile":$(document).trigger(argosyEvents.SELECT_STANDARD_PROFILE,{standardProfileId:parseInt(b[1]),element:this,callback:a,showLoading:c});break}}}function reorderOrder(a){var d="/Admin/Orders/ReOrder",b={},c=false;b.orderNumber=a;block(null,"Reordering "+a);$.ajax({url:d,dataType:"json",data:JSON.stringify(b),type:"POST",contentType:"application/json; charset=utf-8",success:function(f){var i=f.IsError===false,g="Success, "+a+" has been reordered.",j="success";if(!i){g=f.Message;j="error"}else{window.location=f.Data}var h={message:g,type:j};c=i;$(document).trigger(argosyEvents.PROMPT_NOTIFY,h)},error:function(f){var g={message:"Unable to re-order at this time.",type:"error"};$(document).trigger(argosyEvents.PROMPT_NOTIFY,g)},complete:function(f){if(c){block(null,"~{MsgTransferToCart}~ ")}else{unblock()}}})}function placeSavedOrder(c){var f="/Admin/Orders/PlaceSavedOrder",d={},e=false;d.orderId=c;var a=false;var b={question:"~{MsgSureAboutPlacing}~",description:"",button:"Confirm",type:"warning",yes:function(g){if(!a&&(typeof(g.preventDefault)==="function")){block(null,"~{MsgVerifyingOrder}~");$.ajax({url:f,dataType:"json",data:JSON.stringify(d),type:"POST",contentType:"application/json; charset=utf-8",success:function(h){var k=h.IsError===false,i="~{MsgOrderUpdated}~",l="success";if(!k){i=h.Message;l="error";unblock()}else{window.location.reload(true)}var j={message:i,type:l};e=k;$(document).trigger(argosyEvents.PROMPT_NOTIFY,j)},error:function(h){var i={message:"Unable to place order at this time.",type:"error"};$(document).trigger(argosyEvents.PROMPT_NOTIFY,i)}});a=true}}};prompt.alert(b)}function checkBeforeAddingToCart(c,d,a){$("._alertModalMsgs").addClass("hide");var b=true;if(!c.CanDirectMail&&!c.CanUpload&&!c.CanCustomize&&!c.IsPersonalizeable&&!c.IsConfigurable){if(d<=0){$("._ProductQuantityModalAlertForZero").removeClass("hide");b=false}else{if(userSettings.EnforceMinMaxOrderQty&&(d>c.MaxOrderQty||d<c.MinOrderQty)){if(d>c.MaxOrderQty){$("._ProductQuantityModalAlertForMax").removeClass("hide")}if(d<c.MinOrderQty){$("._ProductQuantityModalAlertForMin").removeClass("hide")}b=false}}}if(!b){a.removeClass("hide")}else{a.addClass("hide")}$.fancybox.update();return b}function sendPartsToCartOrCustomization(c,b,a){var d="/Store/Cart/BulkAddToCart";callCarts(c,b,d,a)}function sendPartToCartOrCustomization(c,b,a){sendPartToCartOrCustomization([c],b,url,a)}function sendPartsToCart(c,b,a){var d="/Store/Cart/BulkAddToCart";callCarts(c,b,d,a)}function sendPartToCart(c,b,a){sendPartsToCart([c],b,a)}function callCart(b,a,c){callCarts([b],a,c)}function callCarts(c,b,d,a){d="/Store/Cart/BulkAddToCart";block(null,"~{MsgAddingToCart}~");$.ajax({url:d,dataType:"json",data:JSON.stringify(c),type:"POST",contentType:"application/json; charset=utf-8",success:function(f){callCartSuccess(f,b,a!=null)},error:function(){var e={message:"Unable to add to cart",type:"error"};$(document).trigger(argosyEvents.PROMPT_NOTIFY,e)},complete:function(f){unblock()}})}function callCartSuccess(a,d,b){var g=a.ReturnCode===ReturnCode.Success,c=d+" ~{AddedToCart}~",h="success";if(!g){c=a.Message;h="error"}var f={message:c,type:h};if(a.ReturnResponse!==null&&a.ReturnResponse!==undefined){if(a.ReturnResponse.PostJsonData!==null&&a.ReturnResponse.PostJsonData!==undefined&&a.ReturnResponse.PostJsonData.length>0){$.submitAsForm(a.ReturnResponse.ReturnUrl,a.ReturnResponse.PostJsonData)}else{if(a.ReturnResponse.ReturnUrl!=null){window.location=a.ReturnResponse.ReturnUrl}else{if(!b){$(document).trigger(argosyEvents.PROMPT_NOTIFY,f)}$(document).trigger(argosyEvents.PART_ADDED_TO_CART,d)}}}else{if(!b){$(document).trigger(argosyEvents.PROMPT_NOTIFY,f)}$(document).trigger(argosyEvents.PART_ADDED_TO_CART,d)}}function setActiveMenuItem(){var b=window.location.href.toLowerCase(),a=$("#menu");a.find(" a.active").removeClass("active");if(b.indexOf("digitalassets")>=0){a.find(".select-digital-assets-menu").addClass("active")}else{if(b.indexOf("retail")>=0){a.find(".select-retail-menu").addClass("active")}else{if(b.indexOf("admin")>=0){a.find(".select-admin-menu").addClass("active")}else{if(b.indexOf("tools")>=0){a.find(".select-tools-menu").addClass("active")}else{if(b.indexOf("account")>=0){a.find(".select-account-menu").addClass("active")}else{a.find(".select-store-menu").addClass("active")}}}}}}function showPartQuantityModal(e){var b="div[data-argosy-view=ModalPartQuantityView]",d="#_ProductModelViewTemplate",c="#_ProductQuantityModalViewTemplate",a="div[data-argosy-modal=ModalPartQuantity]",f=e.PartName,g=kendo.observable({quantity:e.DefaultQuantity,partId:e.PartId,part:new kendo.data.ObservableObject(e),priceBreakDataBound:function(l){var i=$(l.sender.element),k=i.data("kendoDropDownList").list.width(),j=70;i.data("kendoDropDownList").list.width("auto");i.closest(".k-widget").width(j)},addToCart:function(k){var m=this,n="/Store/Cart/AddToCart",i=$("#_ProductQuantityModalAlert"),j={qty:m.get("quantity")},l=checkBeforeAddingToCart(e,j.qty,i);if(l){i.hide();j.part=e;j.partId=e.PartId;callCart(j,f,n);$.fancybox.close()}},updateQuantity:function(i){var j=this;j.quantity=parseInt(i.sender.value())}}),h=function(){var i=$.fancybox.wrap.find("select.price-break-dropdown,input.qty_input:not([data-role])");$(i).each(function(j){if($.isKendo(this)){$.getKendoControl($(this)).value(e.DefaultQuantity)}else{$(this).val(e.DefaultQuantity)}})};if($(b).length<=0){$(document.body).append($(d).html())}if(e.IsOrderByCPQ&&(e.DefaultQuantity%e.CPQ)!=0){g.quantity=1*e.CPQ;e.DefaultQuantity=1*e.CPQ}$(b).html(kendo.Template.compile($(c).html())(e));kendo.bind($("#_ProductQtyBindHref"),g);$.fancybox({href:a,type:"inline",scrolling:"no",afterShow:function(i){h();addArgosyActions($.fancybox.wrap)}})}function kendoOptionsToObject(b){if(b.data!=null){b=b.data}var a={};if(b!=null){if(b.page!=null){a.Page=b.page}if(b.pageSize!=null){a.PageSize=b.pageSize}if(b.skip!=null){a.Skip=b.skip}if(b.take!=null){a.Take=b.take}if(b.sort!=null&&b.sort.length>0){var c=[];$(b.sort).each(function(d){c.push(this.field+"-"+this.dir)});a.Sort=c}if(b.filter!=null){a=parseFilterExpression(a,b.filter)}}return a}function parseFilterExpression(a,b){if(b.field!=null){a[b.field]=b.value}if(b.filters!=null&&b.filters.length>0){for(var c=0;c<b.filters.length;c++){a=parseFilterExpression(a,b.filters[c])}}return a}function getInputValue(c){var d=null;var f=null;c=$(c);if(c.getKendoDatePicker()!=null){val=c.getKendoDatePicker().value();if(val!=null){d=val.toJSON()}}else{if($.isKendo(c)){var a=$.getKendoControl(c);val=a.value();if(val!=null){d=val}}else{var e="";if(c.is("div")&&$(c).find("input[type='checkbox']").length>0){c=$(c).find("input[type='checkbox']");e="checkbox"}else{if(c.is("input")){e=String(c.attr("type")).toLowerCase()}}switch(e){case"checkbox":case"radio":d=c.is(":checked");break;default:var b=c.val();if(c.data("getValue")!=undefined){b=c.data("getValue")()}if(b!=""&&b!=null){d=b}break}}}if(d!=null&&(typeof d)=="string"&&d.toLowerCase()=="null"){d=null}return d}function setInputValue(d,h){if(!(d instanceof jQuery)){d=$(d)}var e="";if(d.is("div")&&$(d).find("input[type='checkbox']").length>0){d=$(d).find("input[type='checkbox']");e="checkbox"}else{if(d.is("select")){e="select"}else{e=d.attr("type")}}if($.isKendo(d)){var f=$.getKendoControl(d);if(f!=null&&!d.is("select")){f.value(h);return}else{if(f!=null&&f.dataSource!=null){var a=f.dataSource.data();var c=$.grep(a,function(i){return i.value===h});if(c.length===0){f.dataSource.add({Text:h,Value:h})}f.select(function(i){return i.value===h});return}}}switch(e){case"checkbox":if(h!=null&&h){d.attr("checked","checked")}else{d.removeAttr("checked")}break;default:try{if(d.attr("maxlength")!=null){var g=parseInt(d.attr("maxlength"));if(g>0&&h.length>g){h.substring(0,g)}}}catch(b){}d.val(h);break}}function kendoOptionsToQuerystring(a){var b=[];if(a!=null&&a.data!=null){if(a.data.page!=null){b.push("page="+a.data.page)}if(a.data.pageSize!=null){b.push("pageSize="+a.data.pageSize)}if(a.data.skip!=null){b.push("skip="+a.data.skip)}if(a.data.take!=null){b.push("take="+a.data.take)}if(a.data.sort!=null&&a.data.sort.length>0){var c=[];$(a.data.sort).each(function(d){c.push(this.field+"-"+this.dir)});b.push("sort="+c.join(","))}}if(b.length>0){return"?"+b.join("&")}else{return""}}function convertInputsInElements(b,a){var c=$(a);c.find("input:not([data-argosy-control]):not([data-role])").each(function(d){var e=$(this);switch(e.attr("type")){case"text":e.addClass("k-textbox");break;case"number":e.kendoNumericTextBox({spinners:false,});break;case"date":e.kendoDatePicker({});break}});c.find("select:not([data-argosy-control]):not([data-role])").each(function(d){var e=$(this);e.kendoDropDownList();e.getKendoDropDownList().list.width("auto")});c.find("*[data-argosy-control]:not([data-argosy-uuid]:not([data-role]))").each(function(d){var e=$(this);controlLoader.processControlElement(this,function(f){var g=e.attr("data-argosy-search");e.removeAttr("data-argosy-search");if(e.find("select").length>0){e.find("select").attr("data-argosy-search",g)}else{if(e.find("input").length>0){e.find("input").attr("data-argosy-search",g)}}})});c.find("*[data-link]").each(function(d){$.addChangeEvent(this)})}function getInputControl(f,a){var d=null;if(a==null){a={}}if(a.placeholder==null){a.placeholder=""}if(a["class"]==null){a["class"]=""}switch(f){case"text":case"number":case"date":var e=$("<input />",{type:f,placeholder:a.placeholder,"class":a["class"]});d=e;break;case"checkbox":var b=kendo.guid();var h=$("<div />");h.append($("<input />",{type:f,id:b,"class":a["class"]}));h.append($("<label />",{text:a.placeholder,"for":b}));if(a.checked!=null&&a.checked){h.find("input").attr("checked","checked")}d=h;break;case"select":var g=$("<select />",{type:f,placeholder:a.placeholder,"class":a["class"]});if(a.data!=null&&a.data.length>0){if(a.placeholder!==null&&a.placeholder.length>0){g.append($("<option />",{text:a.placeholder,value:""}))}$(a.data).each(function(){g.append($("<option />",{text:this.text,value:this.value,selected:(this.selected!=null&&this.selected)}))})}d=g;break;case"argosy":var c=$("<div />",a);c.removeAttr("dataargosysearch");d=c;break}if(d!=null){if(a.dataArgosySearch!=null){d.attr("data-argosy-search",a.dataArgosySearch)}if(a["class"]!=null){d.attr("class",a["class"])}return d.outerHtml()}return""}function getQuerystring(b,a){if(a==null){a=""}b=b.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var d=new RegExp("[\\?&]"+b+"=([^&#]*)","i");var c=d.exec(window.location.href);if(c==null){return a}else{return c[1]}}function globalPageInit(){if(window.addEventListener){window.addEventListener("orientationchange",function(){window.location.reload()},false)}$(document).on("click","span.quick-view",function(f){f.preventDefault();f.stopPropagation();$.magnificPopup.open({items:{src:$(this).data("prdid"),type:"inline"}})});if($(window).width()>900){$(".prod-th").mouseenter(function(f){$(".quick-view").hide();$(".quick-view",this).stop().fadeIn(300)}).mouseleave(function(f){$(".quick-view").hide()})}var e=$("#imgCompanyLogo").attr("src");if(e===undefined){e=""}var b=$("<div class='mobile-nav'><table class='w100'><tr><td class='textl w100'><a href='/'><img class='padl10 img-responsive company-logo' src='"+e+"' /></a></td><td><a href='/Store/contactus' class='co-neutral'><i class='f24 fa fa-phone'></i></a></td><td class='padr5 padl10'><a href='#divUserLogin' class='fancybox co-neutral'><i class='f24 fa fa-user'></i></a></td><td><a class='mobile-button neutral-link' id='show-nav'><i class='f24 fa fa-navicon'></i></a></td></tr></table></div>");var a=$("#menu");var c=a.clone();c.removeAttr("id");c.addClass("mobile-menu");b.append(c);$("body").prepend(b);c.find("li.has-sub > a").each(function(){var h=$(this);var f=false;var g=h.next("ul").slideUp();h.on("click",function(i){i.preventDefault();f=!f;g.slideToggle(f);h.closest("li").toggleClass("active",f)})});$("ul.mobile-menu").hide();$("#show-nav").on("click",function(){$("ul.mobile-menu").slideToggle()});function d(){a.find(".open").removeClass("open")}$(document).on("click","#menu.click-me .has-sub > a",function(f){f.preventDefault();f.stopPropagation();var g=$(this);var h=g.parent();if(h.hasClass("level-1")){if(h.hasClass("open")){d()}else{d();h.addClass("open");g.next("ul").toggleClass("open")}}else{if(g.next("ul").hasClass("open")){h.find("ul").removeClass("open")}else{g.closest("ul.open").find("ul").removeClass("open");g.next("ul").addClass("open")}}});$(".topNavSearch").each(function(g,f){f=$(f);if(f.is("input")){f.keypress(function(h){if(h.keyCode==13){if(h.preventDefault()){h.preventDefault()}else{h.returnValue=false}window.location="/Search?searchFor="+encodeURIComponent(f.val())}h.returnValue=true})}else{f.click(function(h){var i=f.parent().parent().find("input");window.location="/Search?searchFor="+encodeURIComponent(i.val())})}})}function parseUri(d){var c=parseUri.options,b=c.parser[c.strictMode?"strict":"loose"].exec(d),e={},a=14;while(a--){e[c.key[a]]=b[a]||""}e[c.q.name]={};e[c.key[12]].replace(c.q.parser,function(f,g,h){if(g){e[c.q.name][g]=h}});return e}parseUri.options={strictMode:false,key:["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"],q:{name:"queryKey",parser:/(?:^|&)([^&=]*)=?([^&]*)/g},parser:{strict:/^(?:([^:\/?#]+):)?(?:\/\/((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?))?((((?:[^?#\/]*\/)*)([^?#]*))(?:\?([^#]*))?(?:#(.*))?)/,loose:/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/}};function downloadFile(d,a,b,c){if(a==null){a=false}if(b==null){b=""}currentPage=window.location.pathname;$("#file-download").attr("src","/download?path="+d+"&forceDownload="+a+"&overrideFileName="+b+"&currentPage="+currentPage+"&partId="+c)}function setupFormDefaultSubmits(d){var c=jQuery(".defaultButton");var b=null;if(c.length>1){jsConsole.warn("Multiple default buttons for page.  first button will be used by default.")}if(c.length>0){var a=jQuery(c[0]);b=a;jsConsole.log("default button ["+a.attr("id")+"]")}else{jsConsole.warn("No default buttons for page.")}$(d).find(".submitAction").each(function(h){var f=jQuery(this);var k=null;var l="";if(f.data()["defaultSubmit"]==null){if(f.attr("submit")!=undefined&&f.attr("submit")!=null){switch(f.attr("submit").substr(0,1)){case".":case"#":l=f.attr("submit");break;default:l="#"+f.attr("submit");break}var j=jQuery(l);if(j.length>0){k=jQuery(j[0])}else{jsConsole.warn("could not find submit button "+f.attr("submit")+".")}}var g=f.closest(".fancybox-inner");if(g){var e=g.find(".fancyboxDefaultSubmit");if(e){k=e}}if(k==null&&b!=null){k=b}if(!f.is("textarea")){if(k!=null){jsConsole.log(f.attr("id")+" submits with "+l);f.unbind("keypress");f.keypress(function(i){setFormSubmit(i,k)})}else{jsConsole.warn(f.attr("id")+" has no button assignment")}f.data("defaultSubmit",{isConfigured:true,submitButton:k})}}})}function setFormSubmit(b,a){if(b.keyCode==13){jQuery(a)[0].click();if(b.preventDefault()){b.preventDefault()}else{b.returnValue=false}}b.returnValue=true}function setFancyboxFocus(){if($.fancybox.wrap){var a=$.fancybox.wrap.find("input.defaultFancyboxFocus:not(.k-textbox)");if(a.length>1){jsConsole.warn("Multiple default elements to focus on.  first element will be used by default.")}if(a.length>0){if($.isKendo(a)){$.getKendoControl(a).focus()}else{jQuery(a[0]).focus()}}}}function setupPageDefaultFocus(){var a=jQuery(".defaultFocus");if(a.length>1){jsConsole.warn("Multiple default elements to focus on.  first element will be used by default.")}if(a.length>0){jQuery(a[0]).focus()}}function setupGlobalImageEditor(){$("body").append($("<div />",{"class":"hide",id:"GlobalImageEditor"}));var a=$("#GlobalImageEditor");a.kendoImageEditor({});a=a.getKendoImageEditor();$(document).bind(argosyEvents.EVENT_SHOW_IMAGE_EDITOR,function(c,b){if(a!=null){a.value(b.imageUrl);a.edit(b.imageUrl,function(d){$(b.input).val(d.UploadFileUrl);$(b.preview).attr("src",d.PreviewFileUrl+"?w=150&h=150");if(b.returnHref!=null){$.fancybox({href:b.returnHref})}},function(){if(b.returnHref!=null){$.fancybox({href:b.returnHref})}},b.isFixedAspectRatio,b.minHeight,b.minWidth)}})}var __partCache=new Array();function getPart(b,a){$(document).trigger(argosyEvents.START_LOADING);$.ajax({url:"/Store/Part/GetPartById/"+b,type:"GET",dataType:"json",contentType:"application/json; charset=utf-8",success:function(c){a($.extend(true,{},c));$(document).trigger(argosyEvents.END_LOADING)}})}function getPartBySku(b,a){$(document).trigger(argosyEvents.START_LOADING);$.ajax({url:"/Store/Part/GetPartBySku/"+b,type:"GET",dataType:"json",contentType:"application/json; charset=utf-8",success:function(c){a($.extend(true,{},c));$(document).trigger(argosyEvents.END_LOADING)}})}function addPart(a){__partCache[a.PartId]=a}function addParts(a){$(a).each(function(b,c){__partCache[c.PartId]=c})}function getUser(b,a){$(document).trigger(argosyEvents.START_LOADING);$.ajax({url:"/Admin/Users/GetUser/"+b,type:"GET",dataType:"json",contentType:"application/json; charset=utf-8",success:function(c){a($.extend(true,{},c));$(document).trigger(argosyEvents.END_LOADING)}})}function qualifyURL(c){var b=document.createElement("a");b.href=c;return b.href}function jsonPath(obj,expr,arg){var P={resultType:arg&&arg.resultType||"VALUE",result:[],normalize:function(expr){var subx=[];return expr.replace(/[\['](\??\(.*?\))[\]']/g,function($0,$1){return"[#"+(subx.push($1)-1)+"]"}).replace(/'?\.'?|\['?/g,";").replace(/;;;|;;/g,";..;").replace(/;$|'?\]|'$/g,"").replace(/#([0-9]+)/g,function($0,$1){return subx[$1]})},asPath:function(path){var x=path.split(";"),p="$";for(var i=1,n=x.length;i<n;i++){p+=/^[0-9*]+$/.test(x[i])?("["+x[i]+"]"):("['"+x[i]+"']")}return p},store:function(p,v){if(p){P.result[P.result.length]=P.resultType=="PATH"?P.asPath(p):v}return !!p},trace:function(expr,val,path){if(expr){var x=expr.split(";"),loc=x.shift();x=x.join(";");if(val&&val.hasOwnProperty(loc)){P.trace(x,val[loc],path+";"+loc)}else{if(loc==="*"){P.walk(loc,x,val,path,function(m,l,x,v,p){P.trace(m+";"+x,v,p)})}else{if(loc===".."){P.trace(x,val,path);P.walk(loc,x,val,path,function(m,l,x,v,p){typeof v[m]==="object"&&P.trace("..;"+x,v[m],p+";"+m)})}else{if(/,/.test(loc)){for(var s=loc.split(/'?,'?/),i=0,n=s.length;i<n;i++){P.trace(s[i]+";"+x,val,path)}}else{if(/^\(.*?\)$/.test(loc)){P.trace(P.eval(loc,val,path.substr(path.lastIndexOf(";")+1))+";"+x,val,path)}else{if(/^\?\(.*?\)$/.test(loc)){P.walk(loc,x,val,path,function(m,l,x,v,p){if(P.eval(l.replace(/^\?\((.*?)\)$/,"$1"),v[m],m)){P.trace(m+";"+x,v,p)}})}else{if(/^(-?[0-9]*):(-?[0-9]*):?([0-9]*)$/.test(loc)){P.slice(loc,x,val,path)}}}}}}}}else{P.store(path,val)}},walk:function(loc,expr,val,path,f){if(val instanceof Array){for(var i=0,n=val.length;i<n;i++){if(i in val){f(i,loc,expr,val,path)}}}else{if(typeof val==="object"){for(var m in val){if(val.hasOwnProperty(m)){f(m,loc,expr,val,path)}}}}},slice:function(loc,expr,val,path){if(val instanceof Array){var len=val.length,start=0,end=len,step=1;loc.replace(/^(-?[0-9]*):(-?[0-9]*):?(-?[0-9]*)$/g,function($0,$1,$2,$3){start=parseInt($1||start);end=parseInt($2||end);step=parseInt($3||step)});start=(start<0)?Math.max(0,start+len):Math.min(len,start);end=(end<0)?Math.max(0,end+len):Math.min(len,end);for(var i=start;i<end;i+=step){P.trace(i+";"+expr,val,path)}}},eval:function(x,_v,_vname){try{return $&&_v&&eval(x.replace(/@/g,"_v"))}catch(e){throw new SyntaxError("jsonPath: "+e.message+": "+x.replace(/@/g,"_v").replace(/\^/g,"_a"))}}};var $=obj;if(expr&&obj&&(P.resultType=="VALUE"||P.resultType=="PATH")){P.trace(P.normalize(expr).replace(/^\$;/,""),obj,"$");return P.result.length?P.result:false}}function serializeObject(b){var a={};if(b){$(b).find("input, textarea").each(function(){var c=$(this).attr("name");var d=$(this).val();a[c]=d})}return a}function getPreviewImage(c,b){var d;$("#"+b).removeAttr("onload");var a=getFileExtension(c);if(a==".pdf"||a==".eps"){$.ajax({url:"/Upload/Preview?filePath="+c,dataType:"json",method:"POST",success:function(e){if(a==".pdf"){d=e[0].href}else{d=e}setPreviewPath(d,b)},error:function(f){},complete:function(f){}})}else{setTimeout(function(f){setPreviewPath(c,b)},100)}}function setPreviewPath(b,a){$("#"+a).attr("src",b+"?h=150&w=150&t="+Math.random());$("#"+a).attr("path",b)}function getFileExtension(b){var a="";if(b!=null){a="."+b.split(".").pop()}return a}function getUrlVars(d){var e=[],a;if(d!=undefined){var b=d.slice(d.indexOf("?")+1).split("&");for(var c=0;c<b.length;c++){a=b[c].split("=");e.push(a[0]);e[a[0]]=a[1]}}return e}function showKitBuilderContainer(a){$(".kit-container:visible:not(#"+a+")").hide();$("#"+a).toggle();$(".fa-minus-circle").each(function(b){$(this).addClass("fa-plus-circle");$(this).removeClass("fa-minus-circle")});if(!$("#"+a).is(":hidden")){KitBuilder.prototype.ActiveTab=a;$("#"+a+"Expander").removeClass("fa-plus-circle").addClass("fa-minus-circle")}else{$("#"+a+"Expander").addClass("fa-plus-circle").removeClass("fa-minus-circle")}};function AccountingUnitUserGroupsGrid(a){var b=this;$.extend(true,b.options,b.baseOptions,a);b.setupGrid({})}AccountingUnitUserGroupsGrid.prototype.options={};AccountingUnitUserGroupsGrid.prototype.baseOptions={gridViewSelector:"div[data-argosy-control=AccountingUnitUserGroupsGrid]"};AccountingUnitUserGroupsGrid.prototype.searchCriteria={};AccountingUnitUserGroupsGrid.prototype.setupGrid=function(){var b=this,c=$("div[data-argosy-control='AccountingUnitUserGroupsGrid']").data("kendoCollapseGrid"),d;if(c!=null){d=c.getKendoGrid()}if(d==null){var a={dataSource:b.getDataSource({}),groupable:false,sortable:true,scrollable:false,exportToExcel:false,selectable:"multiple, row",pageable:{refresh:false,pageSizes:false,buttonCount:1},columns:[{template:"<i class='fa la fa-times'></i>",width:"10%"},{title:"~{UserGroupName}~",field:"UserGroupName",width:"80%"},{title:"<div class='text-center'>~{Default}~</div>",template:"<div class=' text-center '>#if (IsDefault) {#<span>YES</span>#} else {#<span>NO</span>#}#</div>",width:"10%"}],title:"~{UserGroups}~",toolbar:[{name:"addUserGroups",text:" ~{Add}~","class":"fa fa-plus"}],addUserGroups:function(){showAddUserGroupsModal()},dataBound:function(f){f.sender.items().each(function(e,g){$(g).find(".fa.la.fa-times").parent().click(function(){b.showDeleteUserFromAccountUnit(f.sender.dataItem(g))})})}};$(b.options.gridViewSelector).kendoCollapseGrid(a)}else{d.dataSource.read()}};AccountingUnitUserGroupsGrid.prototype.showDeleteUserFromAccountUnit=function(b){var a=this;prompt.alert({question:"Are you sure you want to remove this User Group?",description:"",button:"Remove",type:"warning",yes:function(c){if(typeof(c.preventDefault)==="function"){a.deleteUserGroupsFromAU(b)}}})};AccountingUnitUserGroupsGrid.prototype.deleteUserGroupsFromAU=function(a){$.ajax({url:"/Admin/AccountUnit/DeleteUserGroupFromAccountingUnit",type:"POST",data:JSON.stringify({userGroup:a}),dataType:"json",traditional:true,contentType:"application/json; charset=utf-8",success:function(c){if(c.ReturnCode===ReturnCode.Success){prompt.notify({question:"Items(s) were successfully deleted.",type:"success"})}else{prompt.clientResponseError(c)}var d=$("div[data-argosy-control='AccountingUnitUserGroupsGrid']").data("kendoCollapseGrid"),e=d.getKendoGrid(),b=$("div[data-argosy-control='AddUserGroupToAccountUnitGrid']").data("kendoGrid");e.dataSource.read();b.dataSource.read()}});$.fancybox.close()};AccountingUnitUserGroupsGrid.prototype.getDataSource=function(){var a=this;a.dataSourceOpts.pageSize=5;a.dataSourceOpts.serverPaging=true;a.dataSourceOpts.serverFiltering=true;a.dataSourceOpts.serverSorting=true;a.dataSourceOpts.transport={read:{url:"/DataView/GetAccountingUnitUserGroups",contentType:"application/json",dataType:"json",data:{AccountingUnitId:a.options.accountingUnitId,UserGroups:true}}};a.dataSourceOpts.schema={data:function(b){return b.Records},total:function(b){return b.TotalRecords}};return new kendo.data.DataSource(a.dataSourceOpts)};AccountingUnitUserGroupsGrid.prototype.dataSourceOpts={};function AccountingUnitUsersGrid(a){var b=this;$.extend(true,b.options,b.baseOptions,a);b.setupGrid({})}AccountingUnitUsersGrid.prototype.options={};AccountingUnitUsersGrid.prototype.baseOptions={gridViewSelector:"div[data-argosy-view=AccountingUnitUsersGrid]",};AccountingUnitUsersGrid.prototype.searchCriteria={};AccountingUnitUsersGrid.prototype.setupGrid=function(){var c=this;if($(c.options.gridViewSelector).getKendoGrid()==null){var b={dataSource:c.getDataSource({}),groupable:false,sortable:true,scrollable:false,exportToExcel:false,selectable:"multiple, row",pageable:{refresh:false,pageSizes:false,buttonCount:1},columns:[{template:"<i class='fa la fa-times'></i>",width:"10%"},{title:"~{UserName}~",field:"Username",width:"40%"},{title:"~{FullName}~",template:"${FirstName} ${LastName}",width:"40%"},{title:"<div class='text-center'>~{Default}~</div>",template:"<div class=' text-center '>#if (IsDefault) {#<span>YES</span>#} else {#<span>NO</span>#}#</div>",width:"10%"}],title:"~{Users}~",toolbar:[{name:"addusers",text:" ~{Add}~","class":"fa fa-plus"}],addusers:function(d){showAddUsersModal()},dataBinding:function(d){},dataBound:function(d){var g=$(d.sender.element);var f=g.getKendoGrid();g.find("tbody tr[role=row]").each(function(){var e=f.dataItem(this);var h=$(this).find(".fa.la.fa-times").parent();h.unbind("click");h.click(function(){c.showDeleteUserFromAccountUnit(e)})})}};$(c.options.gridViewSelector).kendoCollapseGrid(b)}else{var a=$(c.options.gridViewSelector).getKendoGrid();a.dataSource.read();a.refresh()}};AccountingUnitUsersGrid.prototype.showDeleteUserFromAccountUnit=function(a){var c=this;var b={question:"",description:"",button:"",type:"warning",yes:function(d){if(typeof(d.preventDefault)==="function"){c.deleteUsersFromAU(a)}}};b.question="Are you sure you want to remove this User?";b.button="Remove";prompt.alert(b)};AccountingUnitUsersGrid.prototype.deleteUsersFromAU=function(c){var b=this;var a={user:c};$.ajax({url:"/Admin/AccountUnit/DeleteUsersFromAccountingUnit",type:"POST",data:JSON.stringify(a),dataType:"json",traditional:true,contentType:"application/json; charset=utf-8",success:function(e){if(e.ReturnCode==ReturnCode.Success){$(e.Records).each(function(){prompt.notify({question:"User "+this.Key+" was "+(!this.Value?"":"not")+" successfully deleted.",type:(!this.Value?"success":"error")})})}else{prompt.clientResponseError(e)}var d=$(b.options.gridViewSelector).find(".k-collapse-grid").getKendoGrid();d.dataSource.read();d.refresh(true)}});$.fancybox.close()};AccountingUnitUsersGrid.prototype.getDataSource=function(a){var b=this;$.extend(true,b.dataSourceOpts,_defaultDataSourceConfig,a);b.dataSourceOpts.pageSize=5;b.dataSourceOpts.transport={read:function(c){var d=b.options;d.Users=true;$.extend(true,d,kendoOptionsToObject(c),b.searchCriteria);$.ajax({url:"/DataView/GetAccountingUnitUsers",dataType:"json",data:d,success:function(e){if(e.ReturnCode==ReturnCode.Failed){handleDataSourceException(e)}else{c.success(e)}}})}};return new kendo.data.DataSource(b.dataSourceOpts)};AccountingUnitUsersGrid.prototype.dataSourceOpts={};function AccountManagedEmployeesGrid(a){var b=this;$.extend(true,b.options,b.baseOptions,a);b.setupGrid({})}AccountManagedEmployeesGrid.prototype.options={};AccountManagedEmployeesGrid.prototype.baseOptions={gridViewSelector:"div[data-argosy-view=AccountManagedEmployeesGrid]",userManagerGrid:null};AccountManagedEmployeesGrid.prototype.searchCriteria={};AccountManagedEmployeesGrid.prototype.setupGrid=function(){var c=this;if($(c.options.gridViewSelector).getKendoGrid()==null){var b={dataSource:c.getDataSource({}),groupable:false,sortable:true,scrollable:false,exportToExcel:false,pageable:{refresh:false,pageSizes:false,buttonCount:1},columns:[{title:"~{UserName}~",field:"EmployeeUserName",width:"50%"},{title:"~{Name}~",field:"EmployeeName",width:"50%"}],title:"~{ManagedUsers}~",dataBinding:function(d){},dataBound:function(d){var g=$(d.sender.element);var f=g.getKendoGrid();g.find("tbody tr[role=row]").each(function(){var e=f.dataItem(this);var h=$(this).find(".fa.la.fa-times").parent();h.unbind("click");h.click(function(){c.DeleteEmployeesFromUser([e])})})},};$(c.options.gridViewSelector).kendoCollapseGrid(b)}else{var a=$(c.options.gridViewSelector).getKendoGrid();a.dataSource.read();a.refresh()}};AccountManagedEmployeesGrid.prototype.getDataSource=function(a){var b=this;$.extend(true,b.dataSourceOpts,_defaultDataSourceConfig,a);b.dataSourceOpts.pageSize=5;b.dataSourceOpts.transport={read:function(c){var d={managerUserId:b.options.managerUserId,IsTopLevelOnly:true};$.extend(true,d,kendoOptionsToObject(c),b.searchCriteria);$.ajax({url:"/DataView/GetManagerUsers",dataType:"json",data:d,success:function(e){if(e.ReturnCode==ReturnCode.Failed){handleDataSourceException(e)}else{c.success(e)}}})}};return new kendo.data.DataSource(b.dataSourceOpts)};AccountManagedEmployeesGrid.prototype.dataSourceOpts={};function AccountUnitGridView(a){var b=this;$.extend(true,b.options,b.baseOptions,a);$(document).bind(argosyEvents.SEARCH_PAGE_GRID,function(d,c){b.refineSearch(c)});b.refineSearch({})}AccountUnitGridView.prototype.options={userId:0,companyId:0};AccountUnitGridView.prototype.baseOptions={gridViewSelector:"div[data-argosy-view=AccountUnitGridView]",forModal:false,};AccountUnitGridView.prototype.searchCriteria={};AccountUnitGridView.prototype.refineSearch=function(a){var b=this;b.searchCriteria=a;b.setupGrid()};AccountUnitGridView.prototype.setupGrid=function(){var c=this;if($(c.options.gridViewSelector).getKendoGrid()==null){var b={scrollable:false,editable:false,autoBind:true,dataSource:c.getDataSource({}),groupable:false,sortable:true,selectable:"multiple, row",pageable:{refresh:true,pageSizes:[50,100,500],buttonCount:5},columns:[{title:"~{AccountingUnit}~",field:"AccountUnitDesc",template:"<a href='/Admin/AccountUnit/Edit/${AccountingUnitId}'>${AccountUnitDesc}<a>",},{title:"~{ProcessLevel}~",field:"ProcessLevel"},{title:"~{Department}~",field:"DepartmentDescription"},{title:"~{State}~",field:"State"},{title:"<div class='text-center'>~{Active}~</div>",field:"IsActive",template:"<div class='bold text-center'>#if (IsActive == true) {#<span>YES</span>#} else {#<span>NO</span>#}#</div>"}],checkboxes:true,dataBinding:function(d){},dataBound:function(g){var h=$(g.sender.element);var d=h.find(".k-button.k-button-icontext.k-grid-activate");var f=h.find(".k-button.k-button-icontext.k-grid-deactivate");if(!c.options.forModal){d.unbind("click");f.unbind("click");d.click(function(e){c.showUpdateAUModal(c.getSelectedRecords(),true)});f.click(function(e){c.showUpdateAUModal(c.getSelectedRecords(),false)})}else{d.hide();f.hide();h.find(".k-grid-export-excel").hide()}$("div[data-argosy-view=AccountUnitGridView] th:eq(2) ,div[data-argosy-view=AccountUnitGridView]  tr td:nth-child(3)").addClass("hidden-sm hidden-xs");$("div[data-argosy-view=AccountUnitGridView] th:eq(3),div[data-argosy-view=AccountUnitGridView]  tr td:nth-child(4)").addClass("hidden-sm hidden-xs");$("div[data-argosy-view=AccountUnitGridView] th:eq(4),div[data-argosy-view=AccountUnitGridView]  tr td:nth-child(5)").addClass("hidden-sm hidden-xs")},toolbar:[{name:"deactivate",text:"<i class='fa fa-close'></i><span class='resp-hidden'> ~{Deactivate}~</span>"},{name:"activate",text:"<i class='fa fa-check'></i><span class='resp-hidden'> ~{Activate}~</span>"}],search:[{name:"Keyword",type:"text",placeholder:"~{SearchByNameState}~",toolbar:true},{name:"IsActive",type:"select",toolbar:true,data:[{value:"true",text:"~{Active}~",selected:true},{value:"false",text:"~{Inactive}~"},{value:"null",text:"~{All}~"}]}],};$(c.options.gridViewSelector).kendoArgosyGrid(b)}else{var a=$(c.options.gridViewSelector).getKendoGrid();a.dataSource.read();a.refresh()}};AccountUnitGridView.prototype.showUpdateAUModal=function(d,a){var c=this;var b={question:"",description:"",button:"",type:"warning",yes:function(f){c.updateAUState(d,a)},no:function(f){}};if(a){b.question="~{WantToActivateSelection}~";b.description="~{ActiveAccountsIgnored}~";b.button="~{Activate}~"}else{b.question="~{WantToDeactivateSelection}~";b.description="~{InactiveAccountsIgnored}~";b.button="~{Deactivate}~"}prompt.alert(b)};AccountUnitGridView.prototype.updateAUState=function(d,a){var c=this;$(d).each(function(f,e){e.IsActive=a});var b={accountUnits:d};$.ajax({url:"/Admin/AccountUnit/UpdateACUnitStatus",type:"POST",data:JSON.stringify(b),dataType:"json",traditional:true,contentType:"application/json; charset=utf-8",success:function(f){if(f.ReturnCode==ReturnCode.Success){prompt.notify({question:"Account unit(s) were "+(f.ReturnCode==ReturnCode.Success?"":"not")+" successfully "+(a?"activated.":"deactivated."),type:(!this.Value?"success":"error")})}else{prompt.clientResponseError(f)}var e=$(c.options.gridViewSelector).getKendoGrid();e.dataSource.read();e.refresh(true)}});$.fancybox.close()};AccountUnitGridView.prototype.getSelectedRecords=function(){var c=this;var b=[];var a=$(c.options.gridViewSelector).getKendoGrid();$(a.select()).each(function(d){b.push(a.dataItem(this))});return b};AccountUnitGridView.prototype.getDataSource=function(a){var b=this,c;if(b.options.type==="admin"){c="/DataView/GetAccountUnits"}else{c="/DataView/GetAvailableAccountUnitsForUser"}$.extend(true,b.dataSourceOpts,_defaultDataSourceConfig,a);b.dataSourceOpts.transport={read:function(d){var e={};$.extend(true,e,kendoOptionsToObject(d),b.searchCriteria,b.options);$.ajax({url:c,dataType:"json",data:e,success:function(f){if(f.ReturnCode==ReturnCode.Failed){handleDataSourceException(f)}else{d.success(f)}}})}};b.dataSourceOpts.schema={data:function(d){return d.Records},total:function(d){return d.TotalRecords}};b.dataSourceOpts.serverPaging=true;b.dataSourceOpts.pageSize=20;return new kendo.data.DataSource(b.dataSourceOpts)};AccountUnitGridView.prototype.dataSourceOpts={};function AddEditCompanyUsersPartLimit(a){var b=this;$.extend(true,b.options,b.baseOptions,a);$(document).bind(argosyEvents.SEARCH_PAGE_GRID,function(d,c){b.refineSearch(c)});b.refineSearch({})}AddEditCompanyUsersPartLimit.prototype.options={};AddEditCompanyUsersPartLimit.prototype.baseOptions={gridViewSelector:"div[data-argosy-view=AddEditCompanyUsersPartLimit]",};AddEditCompanyUsersPartLimit.prototype.searchCriteria={};AddEditCompanyUsersPartLimit.prototype.refineSearch=function(a){var b=this;b.searchCriteria=a;b.setupGrid()};AddEditCompanyUsersPartLimit.prototype.setupGrid=function(){var c=this;if($(c.options.gridViewSelector).getKendoGrid()==null){var b={dataSource:c.getDataSource({}),groupable:false,sortable:true,exportToExcel:false,scrollable:false,pageable:{refresh:true,pageSizes:false,buttonCount:1},columns:[{title:"~{Name}~",field:"FullName"},{title:"<span class='floatr textr'>~{ProductLimitQuantity}~<b class='co-warning'>*</b></span>",template:'<div class=\'textr\'><input  min=\'0\' max=\'9999999\'class="numericText textr" onblur="javascript:editPartLimitsQuantityForCompanyUser(this)" id="txtLimitUserGroupQty"  name="txtLimitQty" value="#if (LimitQuantity == null) {#0#} else {#${LimitQuantity}#}#"/>   </div>',},{title:"~{TimeFrame}~",template:'<select class="time-frame" onChange="javascript:editPartLimitsTimeFrameForCompanyUser(this)"><option selected="selected" value="null">select one</option><option #if (Days == 1) {# selected="selected" #}# value="1">Daily</option><option #if (Days == 7) {# selected="selected" #}#  value="7">7 Days</option><option #if (Days == 30) {# selected="selected" #}#  value="30">30 Days</option><option #if (Days == 60) {# selected="selected" #}#  value="60">60 Days</option><option #if (Days == 90) {# selected="selected" #}#  value="90">90 Days</option><option #if (Days == 120) {# selected="selected" #}#  value="120">120 Days</option><option #if (Days == 160) {# selected="selected" #}#  value="160">160 Days</option><option #if (Days == 180) {# selected="selected" #}#  value="180">180 Days</option></select>'},{title:"~{AllowApprovals}~",template:'<select class="allow-approvals" onChange="javascript:editPartLimitsTimeFrameForCompanyUser(this)"><option #if (GotoApprovalIfOverLimit) {# selected="selected" #}# value="true">Yes</option><option #if (!GotoApprovalIfOverLimit) {# selected="selected" #}#  value="false">No</option></select>'}],checkboxes:false,search:[{name:"UserKeywords",type:"text",placeholder:"~{SearchByUserFirstLastUsername}~",toolbar:true}],dataBinding:function(d){},dataBound:function(d){var g=$(d.sender.element);var f=g.getKendoGrid();g.find("tbody tr[role=row]").each(function(){var e=f.dataItem(this);var h=$(this).find(".numericText");$(h).kendoNumericTextBox({min:$(this).attr("min"),max:$(this).attr("max"),format:"#",decimal:0,spinners:false})})}};$(c.options.gridViewSelector).kendoArgosyGrid(b)}else{var a=$(c.options.gridViewSelector).getKendoGrid();a.dataSource.read();a.refresh()}};AddEditCompanyUsersPartLimit.prototype.getDataSource=function(a){var b=this;$.extend(true,b.dataSourceOpts,_defaultDataSourceConfig,a);b.dataSourceOpts.pageSize=5;b.dataSourceOpts.transport={read:function(c){var d=b.options;$.extend(true,d,kendoOptionsToObject(c),b.searchCriteria);$.ajax({url:"/Admin/Parts/GetCompanyUsersPartLimit",dataType:"json",data:d,success:function(e){if(e.ReturnCode==ReturnCode.Failed){handleDataSourceException(e)}else{c.success(e)}}})}};return new kendo.data.DataSource(b.dataSourceOpts)};AddEditCompanyUsersPartLimit.prototype.dataSourceOpts={};function AddEditUserGroupPartLimits(a){var b=this;$.extend(true,b.options,b.baseOptions,a);$(document).bind(argosyEvents.SEARCH_PAGE_GRID,function(d,c){b.refineSearch(c)});b.refineSearch({})}AddEditUserGroupPartLimits.prototype.options={};AddEditUserGroupPartLimits.prototype.baseOptions={gridViewSelector:"div[data-argosy-view=AddEditUserGroupPartLimits]",};AddEditUserGroupPartLimits.prototype.searchCriteria={};AddEditUserGroupPartLimits.prototype.refineSearch=function(a){var b=this;b.searchCriteria=a;b.setupGrid()};AddEditUserGroupPartLimits.prototype.setupGrid=function(){var c=this;if($(c.options.gridViewSelector).getKendoGrid()==null){var b={dataSource:c.getDataSource({}),groupable:false,sortable:true,exportToExcel:false,scrollable:false,pageable:{refresh:true,pageSizes:false,buttonCount:1},columns:[{title:"~{Name}~",field:"GroupName"},{title:"<span class='floatr textr'>~{ProductLimitQuantity}~<b class='co-warning'>*</b></span>",template:'<div class=\'textr\'><input  min=\'0\' max=\'9999999\'class="numericText textr" onblur="javascript:editPartLimitsQuantityForUserGroup(this)" id="txtLimitUserGroupQty"  name="txtLimitQty" value="#if (LimitQuantity == null) {#0#} else {#${LimitQuantity}#}#"/>   </div>',},{title:"~{TimeFrame}~",template:'<select class="time-frame" onChange="javascript:editPartLimitsTimeFrameForUserGroup(this)"><option selected="selected" value="null">select one</option><option #if (Days == 1) {# selected="selected" #}# value="1">Daily</option><option #if (Days == 7) {# selected="selected" #}#  value="7">7 Days</option><option #if (Days == 30) {# selected="selected" #}#  value="30">30 Days</option><option #if (Days == 60) {# selected="selected" #}#  value="60">60 Days</option><option #if (Days == 90) {# selected="selected" #}#  value="90">90 Days</option><option #if (Days == 120) {# selected="selected" #}#  value="120">120 Days</option><option #if (Days == 160) {# selected="selected" #}#  value="160">160 Days</option><option #if (Days == 180) {# selected="selected" #}#  value="180">180 Days</option></select>'},{title:"~{AllowApprovals}~",template:'<select class="allow-approvals" onChange="javascript:editPartLimitsTimeFrameForUserGroup(this)"><option #if (GotoApprovalIfOverLimit) {# selected="selected" #}# value="true">Yes</option><option #if (!GotoApprovalIfOverLimit) {# selected="selected" #}#  value="false">No</option></select>'}],checkboxes:false,search:[{name:"UserGroupKeywords",type:"text",placeholder:"~{SearchByGroupNameDescription}~",toolbar:true}],dataBinding:function(d){},dataBound:function(d){var g=$(d.sender.element);var f=g.getKendoGrid();g.find("tbody tr[role=row]").each(function(){var e=f.dataItem(this);var h=$(this).find(".numericText");$(h).kendoNumericTextBox({min:$(this).attr("min"),max:$(this).attr("max"),format:"#",decimal:0,spinners:false})})}};$(c.options.gridViewSelector).kendoArgosyGrid(b)}else{var a=$(c.options.gridViewSelector).getKendoGrid();a.dataSource.read();a.refresh()}};AddEditUserGroupPartLimits.prototype.showDeletePartLimitModal=function(a){var c=this;var b={question:"",description:"",button:"",type:"warning",yes:function(d){c.DeletePartLimitFromUser(a)}};b.question="~{WantToRemoveSelection}~";b.description="~{CanNotRecoverProductLimit~}";b.button="~{Remove}~";prompt.alert(b)};AddEditUserGroupPartLimits.prototype.DeletePartLimitFromUser=function(b){var c=this;var a={partLimit:b};$.ajax({url:"/Admin/Users/DeleteUserPartLimit",type:"POST",data:JSON.stringify(a),dataType:"json",traditional:true,contentType:"application/json; charset=utf-8",success:function(e){var d=$(this.options.gridViewSelector).getKendoGrid();if(e.ReturnCode==ReturnCode.Success){$(e.Records).each(function(){prompt.notify({question:this.Key+" was "+(!this.Value?"":"not")+" successfully deleted.",type:(!this.Value?"success":"error")})})}else{prompt.clientResponseError(e)}d.dataSource.read()}});$.fancybox.close()};AddEditUserGroupPartLimits.prototype.getDataSource=function(a){var b=this;$.extend(true,b.dataSourceOpts,_defaultDataSourceConfig,a);b.dataSourceOpts.pageSize=5;b.dataSourceOpts.transport={read:function(c){var d=b.options;$.extend(true,d,kendoOptionsToObject(c),b.searchCriteria);$.ajax({url:"/Admin/Parts/GetCompanyUserGroupPartLimits",dataType:"json",data:d,success:function(e){if(e.ReturnCode==ReturnCode.Failed){handleDataSourceException(e)}else{c.success(e)}}})}};return new kendo.data.DataSource(b.dataSourceOpts)};AddEditUserGroupPartLimits.prototype.dataSourceOpts={};function AddPartCategoryToUserGroupGridView(a){var b=this;$.extend(true,b.options,b.baseOptions,a);$(document).bind(argosyEvents.SEARCH_PAGE_GRID,function(d,c){b.refineSearch(c)});b.refineSearch({})}AddPartCategoryToUserGroupGridView.prototype.options={};AddPartCategoryToUserGroupGridView.prototype.baseOptions={gridViewSelector:"div[data-argosy-view=AddPartCategoryToUserGroupGridView]",};AddPartCategoryToUserGroupGridView.prototype.searchCriteria={};AddPartCategoryToUserGroupGridView.prototype.refineSearch=function(a){var b=this;b.searchCriteria=a;b.setupGrid()};AddPartCategoryToUserGroupGridView.prototype.setupGrid=function(){var c=this;if($(c.options.gridViewSelector).getKendoGrid()==null){var b={scrollable:false,editable:false,autoBind:true,dataSource:c.getDataSource({}),groupable:false,exportToExcel:false,sortable:true,selectable:"multiple, row",pageable:{refresh:false,pageSizes:false,buttonCount:1},columns:[{title:"~{CategoryName}~",field:"GroupName"},{title:"~{Description}~",field:"GroupDescrip"}],checkboxes:true,search:[{name:"Keyword",type:"text",placeholder:"~{SearchCategoryNameDescription}~",toolbar:true}],};$(c.options.gridViewSelector).kendoArgosyGrid(b)}else{var a=$(c.options.gridViewSelector).getKendoGrid();a.dataSource.read();a.refresh()}};AddPartCategoryToUserGroupGridView.prototype.getDataSource=function(a){var b=this;$.extend(true,b.dataSourceOpts,_defaultDataSourceConfig,a);b.dataSourceOpts.pageSize=5;b.dataSourceOpts.transport={read:function(c){var d=b.options;$.extend(true,d,kendoOptionsToObject(c),b.searchCriteria);$.ajax({url:"/DataView/GetUserGroupAvailablePartCategories",dataType:"json",data:d,success:function(e){if(e.ReturnCode==ReturnCode.Failed){handleDataSourceException(e)}else{c.success(e)}}})}};return new kendo.data.DataSource(b.dataSourceOpts)};AddPartCategoryToUserGroupGridView.prototype.dataSourceOpts={};function AddPartToBuyerGroup(a){var b=this;$.extend(true,b.options,b.baseOptions,a);$(document).bind(argosyEvents.SEARCH_PAGE_GRID,function(d,c){b.refineSearch(c)});b.refineSearch({})}AddPartToBuyerGroup.prototype.options={};AddPartToBuyerGroup.prototype.baseOptions={gridViewSelector:"div[data-argosy-view=AddPartToBuyerGroup]"};AddPartToBuyerGroup.prototype.searchCriteria={};AddPartToBuyerGroup.prototype.refineSearch=function(a){var b=this;b.searchCriteria=a;b.setupGrid()};AddPartToBuyerGroup.prototype.setupGrid=function(){var c=this,a=$(c.options.gridViewSelector).getKendoGrid();if(a==null){var b={dataSource:c.getDataSource({}),scrollable:false,editable:false,autoBind:true,groupable:false,sortable:true,selectable:"multiple, row",pageable:{refresh:true,pageSizes:[50,100,500],buttonCount:5},columns:[{title:"~{SKU}~",field:"Sku"},{title:"~{Product}~",template:"<div> #if (PartName != null && PartName.trim().length > 0) {#   #= PartName # #}else{# #= Sku # #}#    </div>"},{title:"~{Description}~",field:"Description",width:"20%"}],checkboxes:true,dataBinding:function(){},search:[{name:"Keyword",type:"text",placeholder:"~{SearchSkuProductDescription}~",toolbar:true}]};$(c.options.gridViewSelector).kendoArgosyGrid(b)}else{a.dataSource.read()}};AddPartToBuyerGroup.prototype.getDataSource=function(a){var b=this;$.extend(true,b.dataSourceOpts,_defaultDataSourceConfig,a);b.dataSourceOpts.pageSize=10,b.dataSourceOpts.transport={read:function(c){var d=b.options;$.extend(true,d,kendoOptionsToObject(c),b.searchCriteria);$.ajax({url:"/DataView/GetBuyerGroupAvailableParts",dataType:"json",data:d,success:function(e){if(e.ReturnCode===ReturnCode.Failed){handleDataSourceException(e)}else{c.success(e)}}})}};return new kendo.data.DataSource(b.dataSourceOpts)};AddPartToBuyerGroup.prototype.dataSourceOpts={};function AddressVerification(b){var c=this;var a=new ControlLoader();$.extend(true,c.options,c.baseOptions,b);a.loadTemplate("AddressVerification",function(d){$(document.body).append(d);c.options.templateLoaded=true});$(document).bind(argosyEvents.VERIFY_ADDRESS,function(){c.verifyAddress()})}AddressVerification.prototype.options={url:"",type:""};AddressVerification.prototype.dataSourceOpts={};AddressVerification.prototype.baseOptions={templateLoaded:false,addressNotVerifiedTemplate:"#_AddressNotVerified",addressNotVerifiedSection:"#addressNotVerifiedSection",addressCorrectedTemplate:"#_AddressCorrected",addressCorrectedSection:"#addressCorrectedSection"};AddressVerification.prototype.searchCriteria={};AddressVerification.prototype.verifyAddress=function(){var j=this;var i=null;var f;var b;var c;var d;var e;var h=$("[data-role='states']").getKendoStates();var k;switch(j.options.type){case"checkout":f=$("#checkoutForm");var g=f.getKendoValidator();i=function(){if(f.valid()){g.destroy();f.submit();$(document).trigger(argosyEvents.START_LOADING,{element:$(".main-div-submit"),message:"~{MsgHeadingToCheckout}~"})}};b=$("input[id='ShipToAddress_AddressLine1']");c=$("input[id='ShipToAddress_AddressLine2']");d=$("input[id='ShipToAddress_AddressLine3']");e=$("input[id='ShipToAddress_City']");k=$("input[id='ShipToAddress_ZipCode']");break;case"addAddress":f=$("form.add-address");i=function(){f.submit()};b=$("input[id='AddressLine1']");c=$("input[id='AddressLine2']");d=$("input[id='AddressLine3']");e=$("input[id='City']");k=$("input[id='ZipCode']");break}var a={AddressLine1:b.val(),AddressLine2:c.val(),AddressLine3:d.val(),City:e.val(),ZipCode:k.val(),StateId:h.value()};$(document).trigger(argosyEvents.START_LOADING,{element:$(".main-div-submit"),message:"~{MsgHeadingToCheckout}~"});$.ajax({url:j.options.url,data:JSON.stringify(a),type:"POST",dataType:"json",contentType:"application/json; charset=utf-8",success:function(o){var n=o.Records.OriginalAddress;var m=o.Records.CorrectedAddress;var l=kendo.observable({correctedAddress:m,originalAddress:n,closeAddressNotVerified:function(){$.fancybox.close()},useOriginalAddress:function(){this.useAddress(n)},useCorrectedAddress:function(){this.useAddress(m)},useAddress:function(p){b.val(p.Address1);c.val(p.Address2);d.val(p.Address3);e.val(p.City);h.value(p.State);k.val(p.ZipCode);i()},isAddressChanged:function(){return(this.isAddress1Changed()||this.isCityChanged()||this.isStateChanged()||this.isZipCodeChanged())},isAddress1Changed:function(){return(this.originalAddress.Address1!==this.correctedAddress.Address1)},isCityChanged:function(){return(this.originalAddress.City!==this.correctedAddress.City)},isStateChanged:function(){return this.originalAddress.State!==this.correctedAddress.State},isZipCodeChanged:function(){return(this.originalAddress.ZipCode.substring(0,5)!==this.correctedAddress.ZipCode.substring(0,5))},address1FontWeight:function(){if(this.isAddress1Changed()){return"bold"}else{return""}},cityFontWeight:function(){if(this.isCityChanged()){return"bold"}else{return""}},stateFontWeight:function(){if(this.isStateChanged()){return"bold"}else{return""}},zipCodeFontWeight:function(){if(this.isZipCodeChanged()){return"bold"}else{return""}},type:function(){switch(j.options.type){case"checkout":return"shipping";case"addAddress":return"new"}}});$(document).trigger(argosyEvents.END_LOADING,{element:$(".main-div-submit")});switch(o.Records.Status){case 0:$(j.options.addressNotVerifiedSection).html($(j.options.addressNotVerifiedTemplate).html());kendo.bind(j.options.addressNotVerifiedSection,l);$.fancybox({href:j.options.addressNotVerifiedSection,autoHeight:true,minWidth:500,closeBtn:true,modal:false});break;case 1:if(l.isAddressChanged()){$(j.options.addressCorrectedSection).html($(j.options.addressCorrectedTemplate).html());kendo.bind(j.options.addressCorrectedSection,l);$.fancybox({href:j.options.addressCorrectedSection,autoSize:true,minWidth:450,closeBtn:true,modal:false})}else{if(l.originalAddress.ZipCode!==l.correctedAddress.ZipCode){k.val(m.ZipCode)}i()}break;case 4:i();break}}})};function AddUserForCoopDollars(a){$.extend(true,this.options,a);this.setupGrid()}AddUserForCoopDollars.prototype.options={};AddUserForCoopDollars.prototype.setupGrid=function(){var c=this,a=$("div[data-argosy-view='AddUserForCoopDollars']").data("kendoGrid");if(a==null){var b={dataSource:new kendo.data.DataSource({pageSize:5}),sortable:true,scrollable:false,exportToExcel:false,selectable:"multiple, row",pageable:{refresh:false,pageSizes:false,buttonCount:1},columns:[{template:"<i class='fa la fa-times _deleteMeRow'></i>",width:"10%"},{title:"~{UserName}~",field:"Username",width:"45%"},{title:"~{FullName}~",template:"${FirstName} ${LastName}",width:"45%"}],title:"~{AssignToUsers}~",dataBound:function(d){$.each(d.sender.items(),function(e,g){$(g).find("._deleteMeRow").parent().click(function(){c.deleteUser(d.sender.dataItem(g))})});var f=$("div[data-argosy-view='AddUserGroupForCoopDollars']").data("kendoGrid");if(d.sender.dataSource.total()<1&&(f==null||f.dataSource.total()<1)){$("#addUsersMessage").show();$("button[data-bind$='saveAdjustment']").attr("disabled",true)}else{$("#addUsersMessage").hide();$("button[data-bind$='saveAdjustment']").attr("disabled",false)}}};$("div[data-argosy-view='AddUserForCoopDollars']").kendoGrid(b)}else{a.dataSource.read()}};AddUserForCoopDollars.prototype.deleteUser=function(d){$(document).trigger(argosyEvents.START_LOADING);var a=$("div[data-argosy-view='AddUserToAdjustment']").data("kendoGrid"),c=$("div[data-argosy-view='AddUserForCoopDollars']").data("kendoGrid"),b=AddUserToAdjustment.prototype.options.excludeUserIds.indexOf(d.UserId);if(b>=0){AddUserToAdjustment.prototype.options.excludeUserIds.splice(b,1)}a.dataSource.read();c.dataSource.remove(d);$(document).trigger(argosyEvents.END_LOADING)};AddUserForCoopDollars.prototype.addUsersToAdjustment=function(){$(document).trigger(argosyEvents.START_LOADING);var a=$("div[data-argosy-view='AddUserToAdjustment']").data("kendoGrid"),b=$("div[data-argosy-view='AddUserForCoopDollars']").data("kendoGrid");if(a.select().length>0){$.each(a.select(),function(c,d){d=a.dataItem(d);b.dataSource.add(d);AddUserToAdjustment.prototype.options.excludeUserIds.push(d.UserId)});a.dataSource.read();$.fancybox.close()}$(document).trigger(argosyEvents.END_LOADING)};function AddUserGroupForCoopDollars(a){$.extend(true,this.options,a);this.setupGrid()}AddUserGroupForCoopDollars.prototype.options={};AddUserGroupForCoopDollars.prototype.setupGrid=function(){var c=this,a=$("div[data-argosy-view='AddUserGroupForCoopDollars']").data("kendoGrid");if(a==null){var b={dataSource:new kendo.data.DataSource({pageSize:5}),sortable:true,scrollable:false,exportToExcel:false,selectable:"multiple, row",pageable:{refresh:false,pageSizes:false,buttonCount:1},columns:[{template:"<i class='fa la fa-times _deleteMeRow'></i>",width:"10%"},{title:"~{UserGroup}~",field:"GroupName",width:"90%"}],dataBound:function(d){$.each(d.sender.items(),function(e,g){$(g).find("._deleteMeRow").parent().click(function(){c.deleteUserGroup(d.sender.dataItem(g))})});var f=$("div[data-argosy-view='AddUserForCoopDollars']").data("kendoGrid");if(d.sender.dataSource.total()<1&&(f==null||f.dataSource.total()<1)){$("#addUsersMessage").show();$("button[data-bind$='saveAdjustment']").attr("disabled",true)}else{$("#addUsersMessage").hide();$("button[data-bind$='saveAdjustment']").attr("disabled",false)}}};$("div[data-argosy-view='AddUserGroupForCoopDollars']").kendoGrid(b)}else{a.dataSource.read()}};AddUserGroupForCoopDollars.prototype.deleteUserGroup=function(d){$(document).trigger(argosyEvents.START_LOADING);var a=$("div[data-argosy-view='AddUserGroupToAdjustment']").data("kendoGrid"),c=$("div[data-argosy-view='AddUserGroupForCoopDollars']").data("kendoGrid"),b=AddUserGroupToAdjustment.prototype.options.excludeUserGroupIds.indexOf(d.UserGroupId);if(b>=0){AddUserGroupToAdjustment.prototype.options.excludeUserGroupIds.splice(b,1)}a.dataSource.read();c.dataSource.remove(d);$(document).trigger(argosyEvents.END_LOADING)};AddUserGroupForCoopDollars.prototype.addUserGroupsToAdjustment=function(){$(document).trigger(argosyEvents.START_LOADING);var a=$("div[data-argosy-view='AddUserGroupToAdjustment']").data("kendoGrid"),b=$("div[data-argosy-view='AddUserGroupForCoopDollars']").data("kendoGrid");if(a.select().length>0){$.each(a.select(),function(c,d){d=a.dataItem(d);b.dataSource.add(d);AddUserGroupToAdjustment.prototype.options.excludeUserGroupIds.push(d.UserGroupId)});a.dataSource.read();$.fancybox.close()}$(document).trigger(argosyEvents.END_LOADING)};function AddUserGroupToAccountUnitGrid(a){var b=this;$.extend(true,b.options,b.baseOptions,a);$(document).bind(argosyEvents.SEARCH_PAGE_GRID,function(d,c){b.refineSearch(c)});b.refineSearch({})}AddUserGroupToAccountUnitGrid.prototype.options={};AddUserGroupToAccountUnitGrid.prototype.baseOptions={gridViewSelector:"div[data-argosy-control=AddUserGroupToAccountUnitGrid]"};AddUserGroupToAccountUnitGrid.prototype.searchCriteria={};AddUserGroupToAccountUnitGrid.prototype.refineSearch=function(a){var b=this;b.searchCriteria=a;b.setupGrid()};AddUserGroupToAccountUnitGrid.prototype.setupGrid=function(){var c=this;if($(c.options.gridViewSelector).getKendoGrid()==null){var b={scrollable:false,autoBind:true,editable:false,dataSource:c.getDataSource({}),groupable:false,sortable:true,exportToExcel:false,selectable:"multiple, row",pageable:{refresh:true,pageSizes:[50,100,500],buttonCount:2},columns:[{title:"Name",field:"GroupName"}],checkboxes:true,dataBinding:function(d){},search:[{name:"Keyword",type:"text",placeholder:"Search by UserGroup name",toolbar:true}]};$(c.options.gridViewSelector).kendoArgosyGrid(b)}else{var a=$(c.options.gridViewSelector).getKendoGrid();a.dataSource.read();a.refresh()}};AddUserGroupToAccountUnitGrid.prototype.getDataSource=function(a){var b=this;$.extend(true,b.dataSourceOpts,_defaultDataSourceConfig,a);b.dataSourceOpts.pageSize=10;b.dataSourceOpts.serverPaging=true;b.dataSourceOpts.serverSorting=true;b.dataSourceOpts.serverFiltering=true;b.dataSourceOpts.schema={data:function(c){return c.Records},total:function(c){return c.TotalRecords}};b.dataSourceOpts.transport={read:function(c){var d=b.options;$.extend(true,d,kendoOptionsToObject(c),b.searchCriteria);$.ajax({url:"/DataView/GetUserGroupsAvailableForAccountingUnit",dataType:"json",data:d,type:"POST",success:function(e){if(e.ReturnCode===ReturnCode.Failed){handleDataSourceException(e)}else{c.success(e)}}})}};return new kendo.data.DataSource(b.dataSourceOpts)};AddUserGroupToAccountUnitGrid.prototype.dataSourceOpts={};function AddUserGroupToAdjustment(a){var b=this;$.extend(true,b.options,b.baseOptions,a);$(document).bind(argosyEvents.SEARCH_PAGE_GRID,function(d,c){;b.refineSearch(c)});b.refineSearch({})}AddUserGroupToAdjustment.prototype.options={excludeUserGroupIds:[]};AddUserGroupToAdjustment.prototype.searchCriteria={};AddUserGroupToAdjustment.prototype.refineSearch=function(a){var b=this;b.searchCriteria=a;b.setupGrid()};AddUserGroupToAdjustment.prototype.setupGrid=function(){var c=this,a=$("div[data-argosy-view='AddUserGroupToAdjustment']").data("kendoGrid");if(a==null){var b={scrollable:false,dataSource:c.getDataSource({}),sortable:true,exportToExcel:false,autoBind:true,selectable:"multiple, row",pageable:true,columns:[{title:"~{UserGroup}~",field:"GroupName",width:"500px"}],checkboxes:true,search:[{name:"Keyword",type:"text",placeholder:"Search by UserGroup Name or Description",toolbar:true}]};$("div[data-argosy-view='AddUserGroupToAdjustment']").kendoArgosyGrid(b)}else{a.dataSource.read()}};AddUserGroupToAdjustment.prototype.getDataSource=function(){var a=this;return new kendo.data.DataSource({transport:{read:{url:"/DataView/GetUserGroups",dataType:"json"},parameterMap:function(b){b.Keyword=a.searchCriteria.Keyword;b.Active=true;b.excludeUserGroupIds=a.options.excludeUserGroupIds;return b}},schema:{data:function(b){return b.Records},total:function(b){return b.TotalRecords}},serverFiltering:true,serverSorting:true,serverPaging:true,pageSize:10})};function AddUserGroupToGlobalProfile(a){var b=this;$.extend(true,b.options,b.baseOptions,a);$(document).bind(argosyEvents.SEARCH_PAGE_GRID,function(d,c){b.refineSearch(c)});b.refineSearch({})}AddUserGroupToGlobalProfile.prototype.options={};AddUserGroupToGlobalProfile.prototype.baseOptions={gridViewSelector:"div[data-argosy-view=AddUserGroupToGlobalProfile]",};AddUserGroupToGlobalProfile.prototype.searchCriteria={};AddUserGroupToGlobalProfile.prototype.refineSearch=function(a){var b=this;b.searchCriteria=a;b.setupGrid()};AddUserGroupToGlobalProfile.prototype.setupGrid=function(){var c=this;if($(c.options.gridViewSelector).getKendoGrid()==null){var b={scrollable:false,editable:false,autoBind:true,dataSource:c.getDataSource({}),groupable:false,sortable:true,exportToExcel:false,selectable:"multiple, row",pageable:{refresh:true,pageSizes:[50,100,500],buttonCount:2},columns:[{title:"Name",field:"GroupName",width:"300px"},{title:"Description",field:"GroupDescription",width:"500px"}],checkboxes:true,dataBinding:function(d){},search:[{name:"Keyword",type:"text",placeholder:"Search by Group Name, Description",toolbar:true}],};$(c.options.gridViewSelector).kendoArgosyGrid(b)}else{var a=$(c.options.gridViewSelector).getKendoGrid();a.dataSource.read();a.refresh()}};AddUserGroupToGlobalProfile.prototype.getDataSource=function(a){var b=this;$.extend(true,b.dataSourceOpts,_defaultDataSourceConfig,a);b.dataSourceOpts.pageSize=10;b.dataSourceOpts.transport={read:function(c){var d=b.options;$.extend(true,d,kendoOptionsToObject(c),b.searchCriteria);$.ajax({url:"/Admin/GlobalProfiles/GetUserGroupsAvailableForGlobalProfile",dataType:"json",data:d,success:function(e){if(e.ReturnCode==ReturnCode.Failed){handleDataSourceException(e)}else{c.success(e)}}})}};return new kendo.data.DataSource(b.dataSourceOpts)};AddUserGroupToGlobalProfile.prototype.dataSourceOpts={};function AddUserToAccountUnitGridView(a){var b=this;$.extend(true,b.options,b.baseOptions,a);$(document).bind(argosyEvents.SEARCH_PAGE_GRID,function(d,c){b.refineSearch(c)});b.refineSearch({})}AddUserToAccountUnitGridView.prototype.options={};AddUserToAccountUnitGridView.prototype.baseOptions={gridViewSelector:"div[data-argosy-view=AddUserToAccountUnitGridView]",};AddUserToAccountUnitGridView.prototype.searchCriteria={};AddUserToAccountUnitGridView.prototype.refineSearch=function(a){var b=this;b.searchCriteria=a;b.setupGrid()};AddUserToAccountUnitGridView.prototype.setupGrid=function(){var c=this;if($(c.options.gridViewSelector).getKendoGrid()==null){var b={scrollable:false,editable:false,autoBind:true,dataSource:c.getDataSource({}),groupable:false,sortable:true,exportToExcel:false,selectable:"multiple, row",pageable:{refresh:true,pageSizes:[50,100,500],buttonCount:2},columns:[{title:"User Name",field:"Username",width:"300px"},{title:"Name",field:"LastName",template:"${FirstName} ${LastName}",width:"500px"}],checkboxes:true,dataBinding:function(d){},search:[{name:"Keyword",type:"text",placeholder:"Search by First/Last Name or Username",toolbar:true}],};$(c.options.gridViewSelector).kendoArgosyGrid(b)}else{var a=$(c.options.gridViewSelector).getKendoGrid();a.dataSource.read();a.refresh()}};AddUserToAccountUnitGridView.prototype.getDataSource=function(a){var b=this;$.extend(true,b.dataSourceOpts,_defaultDataSourceConfig,a);b.dataSourceOpts.pageSize=10;b.dataSourceOpts.transport={read:function(c){var d=b.options;$.extend(true,d,kendoOptionsToObject(c),b.searchCriteria);$.ajax({url:"/DataView/GetusersAvailableForAccountingUnit",dataType:"json",data:d,success:function(e){if(e.ReturnCode==ReturnCode.Failed){handleDataSourceException(e)}else{c.success(e)}}})}};return new kendo.data.DataSource(b.dataSourceOpts)};AddUserToAccountUnitGridView.prototype.dataSourceOpts={};function AddUserToAdjustment(a){var b=this;$.extend(true,b.options,b.baseOptions,a);$(document).bind(argosyEvents.SEARCH_PAGE_GRID,function(d,c){b.refineSearch(c)});b.refineSearch({})}AddUserToAdjustment.prototype.options={excludeUserIds:[]};AddUserToAdjustment.prototype.searchCriteria={};AddUserToAdjustment.prototype.refineSearch=function(a){var b=this;b.searchCriteria=a;b.setupGrid()};AddUserToAdjustment.prototype.setupGrid=function(){var c=this,a=$("div[data-argosy-view='AddUserToAdjustment']").data("kendoGrid");if(a==null){var b={scrollable:false,dataSource:c.getDataSource({}),sortable:true,exportToExcel:false,autoBind:true,selectable:"multiple, row",pageable:true,columns:[{title:"User Name",field:"Username",width:"300px"},{title:"Name",field:"LastName",template:"${FirstName} ${LastName}",width:"500px"}],checkboxes:true,search:[{name:"Keyword",type:"text",placeholder:"Search by First/Last Name or Username",toolbar:true}]};$("div[data-argosy-view='AddUserToAdjustment']").kendoArgosyGrid(b)}else{a.dataSource.read()}};AddUserToAdjustment.prototype.getDataSource=function(){var a=this;return new kendo.data.DataSource({transport:{read:{url:"/DataView/GetUsers",dataType:"json"},parameterMap:function(b){b.Keyword=a.searchCriteria.Keyword;b.Active=true;b.ExcludeUserIds=a.options.excludeUserIds;return b}},schema:{data:function(b){return b.Records},total:function(b){return b.TotalRecords}},serverFiltering:true,serverSorting:true,serverPaging:true,pageSize:10})};function AddUserToBuyerGroupGridView(a){var b=this;$.extend(true,b.options,b.baseOptions,a);$(document).bind(argosyEvents.SEARCH_PAGE_GRID,function(d,c){b.refineSearch(c)});b.refineSearch({})}AddUserToBuyerGroupGridView.prototype.options={};AddUserToBuyerGroupGridView.prototype.baseOptions={gridViewSelector:"div[data-argosy-view=AddUserToBuyerGroupGridView]"};AddUserToBuyerGroupGridView.prototype.searchCriteria={};AddUserToBuyerGroupGridView.prototype.refineSearch=function(a){var b=this;b.searchCriteria=a;b.setupGrid()};AddUserToBuyerGroupGridView.prototype.setupGrid=function(){var c=this,a=$(c.options.gridViewSelector).getKendoGrid();if(a==null){var b={scrollable:false,editable:false,autoBind:true,dataSource:c.getDataSource({}),groupable:false,sortable:true,selectable:"multiple, row",pageable:{refresh:true,pageSizes:[50,100,500],buttonCount:2},columns:[{title:"~{UserName}~",field:"Username",width:"300px"},{title:"~{Name}~",field:"LastName",template:"${FirstName} ${LastName}",width:"500px"}],checkboxes:true,dataBinding:function(){},search:[{name:"Keyword",type:"text",placeholder:"~{SearchByUsernameFirstLast}~",toolbar:true}]};$(c.options.gridViewSelector).kendoArgosyGrid(b)}else{a.dataSource.read()}};AddUserToBuyerGroupGridView.prototype.getDataSource=function(a){var b=this;$.extend(true,b.dataSourceOpts,_defaultDataSourceConfig,a);b.dataSourceOpts.pageSize=10;b.dataSourceOpts.transport={read:function(c){var d=b.options;$.extend(true,d,kendoOptionsToObject(c),b.searchCriteria);$.ajax({url:"/DataView/GetusersAvailableForBuyerGroup",dataType:"json",data:d,success:function(e){if(e.ReturnCode===ReturnCode.Failed){handleDataSourceException(e)}else{c.success(e)}}})}};return new kendo.data.DataSource(b.dataSourceOpts)};AddUserToBuyerGroupGridView.prototype.dataSourceOpts={};function AddUserToGlobalProfile(a){var b=this;$.extend(true,b.options,b.baseOptions,a);$(document).bind(argosyEvents.SEARCH_PAGE_GRID,function(d,c){b.refineSearch(c)});b.refineSearch({})}AddUserToGlobalProfile.prototype.options={};AddUserToGlobalProfile.prototype.baseOptions={gridViewSelector:"div[data-argosy-view=AddUserToGlobalProfile]",};AddUserToGlobalProfile.prototype.searchCriteria={};AddUserToGlobalProfile.prototype.refineSearch=function(a){var b=this;b.searchCriteria=a;b.setupGrid()};AddUserToGlobalProfile.prototype.setupGrid=function(){var c=this;if($(c.options.gridViewSelector).getKendoGrid()==null){var b={scrollable:false,editable:false,autoBind:true,dataSource:c.getDataSource({}),groupable:false,sortable:true,exportToExcel:false,selectable:"multiple, row",pageable:{refresh:true,pageSizes:[50,100,500],buttonCount:2},columns:[{title:"User Name",field:"Username",width:"300px"},{title:"Name",field:"LastName",template:"${FirstName} ${LastName}",width:"500px"}],checkboxes:true,dataBinding:function(d){},search:[{name:"Keyword",type:"text",placeholder:"Search by First/Last Name or Username",toolbar:true}],};$(c.options.gridViewSelector).kendoArgosyGrid(b)}else{var a=$(c.options.gridViewSelector).getKendoGrid();a.dataSource.read();a.refresh()}};AddUserToGlobalProfile.prototype.getDataSource=function(a){var b=this;$.extend(true,b.dataSourceOpts,_defaultDataSourceConfig,a);b.dataSourceOpts.pageSize=10;b.dataSourceOpts.transport={read:function(c){var d=b.options;$.extend(true,d,kendoOptionsToObject(c),b.searchCriteria);$.ajax({url:"/Admin/GlobalProfiles/GetUsersAvailableForGlobalProfile",dataType:"json",data:d,success:function(e){if(e.ReturnCode==ReturnCode.Failed){handleDataSourceException(e)}else{c.success(e)}}})}};return new kendo.data.DataSource(b.dataSourceOpts)};AddUserToGlobalProfile.prototype.dataSourceOpts={};function AddUserToUserGroupGridView(a){var b=this;$.extend(true,b.options,b.baseOptions,a);$(document).bind(argosyEvents.SEARCH_PAGE_GRID,function(d,c){b.refineSearch(c)});b.refineSearch({})}AddUserToUserGroupGridView.prototype.options={};AddUserToUserGroupGridView.prototype.baseOptions={gridViewSelector:"div[data-argosy-view=AddUserToUserGroupGridView]",};AddUserToUserGroupGridView.prototype.searchCriteria={Username:null};AddUserToUserGroupGridView.prototype.refineSearch=function(a){var b=this;b.searchCriteria=a;b.setupGrid()};AddUserToUserGroupGridView.prototype.setupGrid=function(){var c=this;if($(c.options.gridViewSelector).getKendoGrid()==null){var b={scrollable:false,editable:false,autoBind:true,dataSource:c.getDataSource({}),groupable:false,sortable:true,selectable:"multiple, row",pageable:{refresh:true,pageSizes:[50,100,500],buttonCount:2},columns:[{title:"~{UserName}~",field:"Username",width:"300px"},{title:"~{Name}~",field:"LastName",template:"${FirstName} ${LastName}",width:"500px"}],checkboxes:true,dataBinding:function(d){},search:[{name:"Keyword",type:"text",placeholder:"~{SearchByUserFirstLastUsername}~",toolbar:true},{name:"Active",type:"select",toolbar:true,data:[{value:"Y",text:"Active",selected:true},{value:"N",text:"Inactive"},{value:"",text:"All"}]}],};$(c.options.gridViewSelector).kendoArgosyGrid(b)}else{var a=$(c.options.gridViewSelector).getKendoGrid();a.dataSource.read();a.refresh()}};AddUserToUserGroupGridView.prototype.getDataSource=function(a){var b=this;$.extend(true,b.dataSourceOpts,_defaultDataSourceConfig,a);b.dataSourceOpts.pageSize=10;b.dataSourceOpts.transport={read:function(c){var d=b.options;$.extend(true,d,kendoOptionsToObject(c),b.searchCriteria);$.ajax({url:"/DataView/GetUsersToAdd",dataType:"json",data:d,success:function(e){if(e.ReturnCode==ReturnCode.Failed){handleDataSourceException(e)}else{c.success(e)}}})}};return new kendo.data.DataSource(b.dataSourceOpts)};AddUserToUserGroupGridView.prototype.dataSourceOpts={};function BulkOrderUserGrid(a){var b=this;$.extend(true,b.options,b.baseOptions,a);$(document).bind(argosyEvents.SEARCH_PAGE_GRID,function(d,c){b.refineSearch(c)});b.refineSearch({})}BulkOrderUserGrid.prototype.options={};BulkOrderUserGrid.prototype.baseOptions={gridViewSelector:"div[data-argosy-view=BulkOrderUserGrid]",};BulkOrderUserGrid.prototype.searchCriteria={Username:null};BulkOrderUserGrid.prototype.refineSearch=function(a){var b=this;b.searchCriteria=a;b.setupGrid()};BulkOrderUserGrid.prototype.setupGrid=function(){var c=this;if($(c.options.gridViewSelector).getKendoGrid()==null){var b={scrollable:false,editable:false,autoBind:true,dataSource:c.getDataSource({}),exportToExcel:false,groupable:false,sortable:true,selectable:"multiple, row",pageable:{refresh:true,pageSizes:[50,100,500],buttonCount:2},columns:[{title:"User",field:"Username",template:"${FirstName} ${LastName}<br/>${Username}"},{title:"Address",field:"Address1",template:"123 Any Street Way<br/>Suite 123<br/>Townsville, ST 54321"},{title:"",template:"<div class='floatr'><a class='btn btn-default'><i class='fa fa-plus'></i> Add</a></div>"}],checkboxes:true,dataBinding:function(d){},dataBound:function(g){var h=$(g.sender.element);var d=h.find(".k-button.k-button-icontext.k-grid-activate");var f=h.find(".k-button.k-button-icontext.k-grid-deactivate");d.unbind("click");f.unbind("click");d.click(function(e){c.showUpdateUserModal(c.getSelectedRecords(),true)});f.click(function(e){c.showUpdateUserModal(c.getSelectedRecords(),false)})},search:[{name:"Username",type:"text",placeholder:"Username",toolbar:false},{name:"FirstName",type:"text",placeholder:"First Name",toolbar:false},{name:"LastName",type:"text",placeholder:"Last Name",toolbar:false},{name:"Keyword",type:"text",placeholder:"Search by First/Last Name or Username",toolbar:true},{name:"Active",type:"select",placeholder:"-- Status --",toolbar:true,data:[{value:"true",text:"Active",selected:true},{value:"false",text:"Inactive"},{value:"",text:"All"}]},{name:"Email",type:"text",placeholder:"Email",toolbar:false},{name:"PhoneNumber",type:"text",placeholder:"Phone",toolbar:false},{name:"DivisionName",type:"text",placeholder:"Division",toolbar:false}],toolbar:[{name:"AddSelected",text:"Add Selected","class":"fa fa-plus"}],};$(c.options.gridViewSelector).kendoArgosyGrid(b)}else{var a=$(c.options.gridViewSelector).getKendoGrid();a.dataSource.read();a.refresh()}};BulkOrderUserGrid.prototype.showUpdateUserModal=function(d,a){var c=this;var b={question:"",description:"",button:"",type:"warning",yes:function(f){c.updateUserState(d,a)}};prompt.alert(b)};BulkOrderUserGrid.prototype.getSelectedRecords=function(){var c=this;var b=[];var a=$(c.options.gridViewSelector).getKendoGrid();$(a.select()).each(function(d){b.push(a.dataItem(this))});return b};BulkOrderUserGrid.prototype.getDataSource=function(a){var b=this;$.extend(true,b.dataSourceOpts,_defaultDataSourceConfig,a);b.dataSourceOpts.transport={read:function(c){var d={};$.extend(true,d,kendoOptionsToObject(c),b.searchCriteria);$.ajax({url:"/DataView/GetUsers",dataType:"json",data:d,success:function(e){if(e.ReturnCode==ReturnCode.Failed){handleDataSourceException(e)}else{c.success(e)}}})}};return new kendo.data.DataSource(b.dataSourceOpts)};BulkOrderUserGrid.prototype.dataSourceOpts={};function BundleBuilder(a){var b=this;$.extend(true,b.options,b.baseOptions,a);b.ControlLoader=new ControlLoader();b.ControlLoader.loadTemplate("BundleBuilder",function(c){$(document.body).append(c);$(document).trigger(b.EVENT_TEMPLATE_LOADED);b.initialize();b.setupEvents()})}BundleBuilder.prototype.options={};BundleBuilder.prototype.baseOptions={dataSource:{}};BundleBuilder.prototype.templates={proofingFormTemplate:"#_BundleBuilderProofingFormTemplate",productDisplayTemplate:"#_BundleBuilderProductDisplayTemplate",};BundleBuilder.prototype.EVENT_TEMPLATE_LOADED="BUNDLE_BUILDER_TEMPLATES_LOADED";BundleBuilder.prototype.initialize=function(){var b=this,a=b.getElement();b.options.dataSource=b.getDataSource();b.createBaseWrapper(a);kendo.bind(a,{});b.taskHub=new TaskHub(function(c){b.update(c)},function(c){b.complete(c)},function(c){b.error(c)})};BundleBuilder.prototype.setupEvents=function(){var a=this;$(document).bind(argosyEvents.EVENT_SHOW_PROOFING_FORM,function(c,b){a.getElement().find("[data-role=proofingvariables]").show();a.getElement().find("[data-argosy-control=KitBuilder]").hide()});$(document).bind(argosyEvents.EVENT_BUILD_PROOF,function(c,b){if(b.isValid){a.options.dataSource.variables=b.variables;var d=Proofing.prototype.getProofName(a.options.dataSource.variables);a.taskHub.generateBundles(b.part.Sku,b.variables,userSettings.PriceListId,d)}else{prompt.alert({question:"You are missing required fields to generate this bundle.",description:"Please update the form and continue.",type:"warning"})}})};BundleBuilder.prototype.showKitBuilder=function(){var b=this;window.bundleKitData=b.options.dataSource.kitData;window.variables=b.options.dataSource.variables;b.getVariablesElement().hide();var a=b.getKitBuilderElement();if(a.length!=0){a.remove()}b.getElement().append($(b.templates.productDisplayTemplate).html());a=b.getKitBuilderElement();b.ControlLoader.processControlElement(a[0],function(c){})};BundleBuilder.prototype.createBaseWrapper=function(a){var b=this;a=a==null?b.getElement():a;a.append($(b.templates.proofingFormTemplate).html())};BundleBuilder.prototype.getKitBuilderElement=function(){var a=this;return a.getElement().find("[data-argosy-control=KitBuilder]")};BundleBuilder.prototype.getVariablesElement=function(){var a=this;return a.getElement().find("[data-role=proofingvariables]")};BundleBuilder.prototype.getElement=function(){var a=this;return $("*[data-argosy-uuid="+a.options.uuid+"]")};BundleBuilder.prototype.getDataSource=function(){var a=this;return window[a.options.dataSource]};BundleBuilder.prototype.update=function(a){this.task=a};BundleBuilder.prototype.complete=function(a){var b=this;b.task=a;if(a.ErrorGuid!=null){}else{b.options.dataSource.proofingResponse=JSON.parse(a.Data.bundle);b.options.dataSource.Groups=JSON.parse(a.Data.Groups);b.options.dataSource.GroupNames=JSON.parse(a.Data.GroupNames);b.options.dataSource.kitData={GroupNames:b.options.dataSource.GroupNames,Groups:b.options.dataSource.Groups,Kit:b.options.dataSource.Part,KitParts:[],KitState:b.options.dataSource.proofingResponse};$.fancybox.close();b.showKitBuilder()}};BundleBuilder.prototype.error=function(a){this.task=a};function BuyerGroupGridView(a){var b=this;$.extend(true,b.options,b.baseOptions,a);$(document).bind(argosyEvents.SEARCH_PAGE_GRID,function(d,c){b.refineSearch(c)});b.refineSearch({})}BuyerGroupGridView.prototype.options={};BuyerGroupGridView.prototype.baseOptions={gridViewSelector:"div[data-argosy-view=BuyerGroupGridView]",};BuyerGroupGridView.prototype.searchCriteria={Username:null};BuyerGroupGridView.prototype.refineSearch=function(a){var b=this;b.searchCriteria=a;b.setupGrid()};BuyerGroupGridView.prototype.setupGrid=function(){var c=this;if($(c.options.gridViewSelector).getKendoGrid()==null){var b={scrollable:false,editable:false,autoBind:true,dataSource:c.getDataSource({}),groupable:false,sortable:true,selectable:"multiple, row",pageable:{refresh:true,pageSizes:[50,100,500],buttonCount:5},columns:[{title:"~{GroupName}~",field:"BuyerGroupName",template:"<a href='/Admin/BuyerGroups/Edit/${PartBuyerGroupId}'>${BuyerGroupName}<a>",width:"300px"},{title:"~{Description}~",field:"BuyerGroupDescription"},{title:"<div class='text-center'>~{Active}~</div>",field:"IsActive",template:"<div class='bold text-center'>#if (IsActive) {#<span>YES</span>#} else {#<span>NO</span>#}#</div>"}],checkboxes:true,dataBinding:function(d){},dataBound:function(g){var h=$(g.sender.element);var d=h.find(".k-button.k-button-icontext.k-grid-activate");var f=h.find(".k-button.k-button-icontext.k-grid-deactivate");d.unbind("click");f.unbind("click");d.click(function(e){c.showUpdateBuyerGpStateModal(c.getSelectedRecords(),true)});f.click(function(e){c.showUpdateBuyerGpStateModal(c.getSelectedRecords(),false)})},toolbar:[{name:"deactivate",text:"<i class='fa fa-close'></i><span class='resp-hidden'> ~{Deactivate}~</span>"},{name:"activate",text:"<i class='fa fa-check'></i><span class='resp-hidden'> ~{Activate}~</span>"}],search:[{name:"Keyword",type:"text",placeholder:"~{SearchByGroupName}~",toolbar:true},{name:"IsActive",type:"select",toolbar:true,data:[{value:"true",text:"~{Active}~",selected:true},{value:"false",text:"~{Inactive}~"},{value:"null",text:"~{All}~"}]}],};$(c.options.gridViewSelector).kendoArgosyGrid(b)}else{var a=$(c.options.gridViewSelector).getKendoGrid();a.dataSource.read();a.refresh()}};BuyerGroupGridView.prototype.showUpdateBuyerGpStateModal=function(b,a){var d=this;var c={question:"",description:"",button:"",type:"warning",yes:function(f){d.updateBuyerGpState(b,a)}};if(a){c.question="~{WantToActivateSelection}~";c.description="~{ActiveBuyerGroupsIgnored}~";c.button="~{Activate}~"}else{c.question="~{WantToDeactivateSelection}~";c.description="~{InactiveBuyerGroupsIgnored}~";c.button="~{Deactivate}~"}prompt.alert(c)};BuyerGroupGridView.prototype.updateBuyerGpState=function(b,a){var d=this;var c={buyerGps:b,activate:a};$.ajax({url:"/Admin/BuyerGroups/UpdateBuyerGroupStatus",type:"POST",data:JSON.stringify(c),dataType:"json",traditional:true,contentType:"application/json; charset=utf-8",success:function(f){if(f.ReturnCode==ReturnCode.Success){$(f.Records).each(function(){prompt.notify({question:this.Key+" was "+(!this.Value?"":"not")+" successfully "+(a?"activated.":"deactivated."),type:(!this.Value?"success":"error")})})}else{prompt.clientResponseError(f)}var e=$(d.options.gridViewSelector).getKendoGrid();e.dataSource.read();e.refresh(true)}});$.fancybox.close()};BuyerGroupGridView.prototype.getSelectedRecords=function(){var c=this;var b=[];var a=$(c.options.gridViewSelector).getKendoGrid();$(a.select()).each(function(d){b.push(a.dataItem(this))});return b};BuyerGroupGridView.prototype.getDataSource=function(a){var b=this;$.extend(true,b.dataSourceOpts,_defaultDataSourceConfig,a);b.dataSourceOpts.transport={read:function(c){var d={};$.extend(true,d,kendoOptionsToObject(c),b.searchCriteria);$.ajax({url:"/DataView/GetBuyerGroups",dataType:"json",data:d,success:function(e){if(e.ReturnCode==ReturnCode.Failed){handleDataSourceException(e)}else{c.success(e)}}})}};return new kendo.data.DataSource(b.dataSourceOpts)};BuyerGroupGridView.prototype.dataSourceOpts={};function BuyerGroupPartsGridView(a){var b=this;$.extend(true,b.options,b.baseOptions,a);b.setupGrid()}BuyerGroupPartsGridView.prototype.options={};BuyerGroupPartsGridView.prototype.baseOptions={gridViewSelector:"div[data-argosy-view=BuyerGroupPartsGridView]"};BuyerGroupPartsGridView.prototype.setupGrid=function(){var c=this,a=$(c.options.gridViewSelector).getKendoGrid();if(a==null){var b={scrollable:false,editable:false,autoBind:true,dataSource:c.getDataSource({}),groupable:false,sortable:true,pageable:{refresh:true,pageSizes:[50,100,500],buttonCount:5},columns:[{template:"<i class='fa la fa-times'></i>",width:"10%"},{title:"~{SKU}~",field:"Sku"},{title:"~{Product}~",template:"<div>#if (PartName != null && PartName.trim().length > 0) {#   #= PartName # #}else{# #= Sku # #}#   </div>",width:"20%"},{title:"~{Description}~",field:"Description",width:"50%"}],toolbar:[{name:"addPart",text:" ~{AddEdit}~","class":"fa fa-plus"}],addPart:function(){showAddPartToBuyerGroupModal()},title:"~{PartsForBuyerGroup}~",dataBound:function(d){var f=$(d.sender.element);f.find("tbody tr[role=row]").each(function(){var e=d.sender.dataItem(this);var g=$(this).find(".fa.la.fa-times").parent();g.unbind("click");g.click(function(){c.showDeletePartModal(e)})})}};$(c.options.gridViewSelector).kendoCollapseGrid(b)}else{a.dataSource.read()}};BuyerGroupPartsGridView.prototype.showDeletePartModal=function(a){var c=this;var b={question:"",description:"",button:"",type:"warning",yes:function(d){if(typeof(d.preventDefault)==="function"){c.deletePartFromBuyerGroup(a)}}};b.question="~{WantToRemoveSelection}~";b.button="~{Remove}~";prompt.alert(b)};BuyerGroupPartsGridView.prototype.deletePartFromBuyerGroup=function(a){var c=this;var b={parts:[a],buyerGroupId:null};$.ajax({url:"/Admin/Parts/UpdateBuyerGroup",type:"POST",data:JSON.stringify(b),dataType:"json",traditional:true,contentType:"application/json; charset=utf-8",success:function(d){if(d.ReturnCode===ReturnCode.Success){$(d.Records).each(function(){prompt.notify({question:"Part(s) successfully removed.",type:"success"})})}else{prompt.clientResponseError(d)}$(c.options.gridViewSelector).find(".k-collapse-grid").getKendoGrid().dataSource.read();$("div[data-argosy-view=AddPartToBuyerGroup]").getKendoGrid().dataSource.read()}});$.fancybox.close()};BuyerGroupPartsGridView.prototype.getSelectedRecords=function(){var c=this;var b=[];var a=$(c.options.gridViewSelector).getKendoGrid();$(a.select()).each(function(){b.push(a.dataItem(this))});return b};BuyerGroupPartsGridView.prototype.getDataSource=function(a){var b=this;$.extend(true,b.dataSourceOpts,_defaultDataSourceConfig,a);b.dataSourceOpts.transport={read:function(c){var d=b.options;$.extend(true,d,kendoOptionsToObject(c),b.searchCriteria);$.ajax({url:"/DataView/GetParts",dataType:"json",data:d,success:function(e){if(e.ReturnCode===ReturnCode.Failed){handleDataSourceException(e)}else{c.success(e)}}})}};b.dataSourceOpts.pageSize=5;return new kendo.data.DataSource(b.dataSourceOpts)};BuyerGroupPartsGridView.prototype.dataSourceOpts={};function BuyerGroupReports(a){var b=this;$.extend(true,b.options,b.baseOptions,a);b.Frequency=b.options.frequency;b.DayOfMonth=b.options.dayOfMonth;b.setUpControls()}BuyerGroupReports.prototype.options={};BuyerGroupReports.prototype.baseOptions={ddlSelector:"div[data-argosy-view=BuyerGroupReports]"};BuyerGroupReports.prototype.setUpControls=function(){var b=this;var a=[{value:"W",text:"~{Weekly}~"},{value:"B",text:"~{Bi-Weekly}~"},{value:"M",text:"~{Monthly}~"}];$(b.options.ddlSelector).kendoDropDownList({dataTextField:"text",dataValueField:"value",dataSource:a,change:function(){if(this.value()=="M"){b.setUpMonthDdl();$("#divSelectMonthDays").show();$("#divSelectWeekDays").hide()}else{$("#ChkSunday").attr("checked",false);$("#ChkSunday").val(false);$("#ChkMonday").attr("checked",false);$("#ChkMonday").val(false);$("#ChkTuesday").attr("checked",false);$("#ChkTuesday").val(false);$("#ChkWednesday").attr("checked",false);$("#ChkWednesday").val(false);$("#ChkThursday").attr("checked",false);$("#ChkThursday").val(false);$("#ChkFriday").attr("checked",false);$("#ChkFriday").val(false);$("#ChkSaturday").attr("checked",false);$("#ChkSaturday").val(false);$("#divSelectMonthDays").hide();$("#divSelectWeekDays").show()}}});$(b.options.ddlSelector).getKendoDropDownList().value(b.options.frequency);b.setControlValues(b.options.frequency)};BuyerGroupReports.prototype.setUpMonthDdl=function(){var b=this;var a=[{value:"1",text:"1"},{value:"2",text:"2"},{value:"3",text:"3"},{value:"4",text:"4"},{value:"5",text:"5"},{value:"6",text:"6"},{value:"7",text:"7"},{value:"8",text:"8"},{value:"9",text:"9"},{value:"10",text:"10"},{value:"11",text:"11"},{value:"12",text:"12"},{value:"13",text:"13"},{value:"14",text:"14"},{value:"15",text:"15"},{value:"16",text:"16"},{value:"17",text:"17"},{value:"18",text:"18"},{value:"19",text:"19"},{value:"20",text:"20"},{value:"21",text:"21"},{value:"22",text:"22"},{value:"23",text:"23"},{value:"24",text:"24"},{value:"25",text:"25"},{value:"26",text:"26"},{value:"27",text:"27"},{value:"28",text:"28"},{value:"29",text:"29"},{value:"30",text:"30"},{value:"31",text:"31"}];$("#ddlDayOfMonth").kendoDropDownList({dataTextField:"text",dataValueField:"value",dataSource:a})};BuyerGroupReports.prototype.setControlValues=function(a){var b=this;if(a=="M"){b.setUpMonthDdl();$("#divSelectMonthDays").show();$("#divSelectWeekDays").hide()}else{$("#divSelectMonthDays").hide();$("#divSelectWeekDays").show()}};function BuyerGroupUserGridView(a){var b=this;$.extend(true,b.options,b.baseOptions,a);b.setupGrid()}BuyerGroupUserGridView.prototype.options={};BuyerGroupUserGridView.prototype.baseOptions={gridViewSelector:"div[data-argosy-view=BuyerGroupUserGridView]"};BuyerGroupUserGridView.prototype.setupGrid=function(){var c=this,a=$(c.options.gridViewSelector).getKendoGrid();if(a==null){var b={scrollable:false,editable:false,autoBind:true,dataSource:c.getDataSource({}),groupable:false,sortable:true,pageable:{refresh:true,pageSizes:[50,100,500],buttonCount:5},columns:[{template:"<i class='fa la fa-times'></i>",width:"10%"},{title:"~{UserName}~",field:"UserName"},{title:"<div class='text-center'>~{FirstName}~</div>",field:"FirstName"},{title:"<div class='text-center'>~{LastName}~</div>",field:"LastName"}],toolbar:[{name:"addUser",text:" ~{AddEdit}~","class":"fa fa-plus"}],addUser:function(){showAddUserToBuyerGroupModal()},title:"~{UsersBuyerGroup}~",dataBound:function(d){var f=$(d.sender.element);f.find("tbody tr[role=row]").each(function(){var e=d.sender.dataItem(this);var g=$(this).find(".fa.la.fa-times").parent();g.unbind("click");g.click(function(){c.showDeleteUserModal(e)})})}};$(c.options.gridViewSelector).kendoCollapseGrid(b)}else{a.dataSource.read()}};BuyerGroupUserGridView.prototype.showDeleteUserModal=function(a){var c=this;var b={question:"",description:"",button:"",type:"warning",yes:function(d){if(typeof(d.preventDefault)==="function"){c.deleteUserFromBuyerGroup(a)}}};b.question="~{WantToRemoveSelection}~";b.button="~{Remove}~";prompt.alert(b)};BuyerGroupUserGridView.prototype.deleteUserFromBuyerGroup=function(a){var c=this;var b={buyerGroupUser:a};$.ajax({url:"/Admin/BuyerGroups/DeleteBuyerGroupUser",type:"POST",data:JSON.stringify(b),dataType:"json",traditional:true,contentType:"application/json; charset=utf-8",success:function(d){if(d.ReturnCode===ReturnCode.Success){$(d.Records).each(function(){prompt.notify({question:"User(s) successfully removed.",type:"success"})})}else{prompt.clientResponseError(d)}$(c.options.gridViewSelector).find(".k-collapse-grid").getKendoGrid().dataSource.read();$("div[data-argosy-view=AddUserToBuyerGroupGridView]").getKendoGrid().dataSource.read()}});$.fancybox.close()};BuyerGroupUserGridView.prototype.getDataSource=function(a){var b=this;$.extend(true,b.dataSourceOpts,_defaultDataSourceConfig,a);b.dataSourceOpts.transport={read:function(c){var d=b.options;$.extend(true,d,kendoOptionsToObject(c),b.searchCriteria);$.ajax({url:"/DataView/GetBuyerGroupUsers",dataType:"json",data:d,success:function(e){if(e.ReturnCode===ReturnCode.Failed){handleDataSourceException(e)}else{c.success(e)}}})}};b.dataSourceOpts.pageSize=5;return new kendo.data.DataSource(b.dataSourceOpts)};BuyerGroupUserGridView.prototype.dataSourceOpts={};function CarePlus(b){var c=this,a=new ControlLoader();$.extend(true,c.options,c.baseOptions,b);c.options.element=$("[data-argosy-uuid="+c.options.uuid+"]");a.loadTemplate("CarePlus",function(d){$("#_CarePlusContent").html(d);c.options.viewModel=c.setupViewModel();kendo.bind($("#_CarePlusContent"),c.options.viewModel)})}CarePlus.prototype.options={element:null,viewModel:null};CarePlus.prototype.setupViewModel=function(){var a=this,b=kendo.observable({carePlusModel:{SystemAssignNumber:null,LastName:"",CountryId:219},loginModel:{RegistrationUser:{User:{FirstName:"",LastName:"",Address1:"",Address2:"",City:"",State:{StateId:0},Country:{CountryId:0},ZipCode:"",PhoneNumber:0,Fax:0,Email:""}}},data:{AGT_CNT:0},getData:function(){var e=this,d=$("#txtSAN").val(),c=function(f){return !$.isArray(f)&&(f-parseFloat(f)+1)>=0};e.carePlusModel.LastName=$("#txtLName").val();if(!c(parseInt(d))||d===""){prompt.notify({question:"SAN is numbers only",type:"error"})}else{e.carePlusModel.SystemAssignNumber=parseInt(d);$(document).trigger(argosyEvents.START_LOADING);$.ajax({url:"/DataView/GetCarePlusData?systemAssignNumber="+e.carePlusModel.SystemAssignNumber,dataType:"json",type:"POST",contentType:"application/json; charset=utf-8",success:function(f){$(document).trigger(argosyEvents.END_LOADING);if(f.ReturnCode===ReturnCode.Success){e.set("data",kendo.observable(f.Records));CarePlus.prototype.options.viewModel.getUser()}else{prompt.notify({question:f.Message,type:"error"})}}})}},getUser:function(){var c=this;$(document).trigger(argosyEvents.START_LOADING);$.ajax({url:"/DataView/GetCarePlusUser",dataType:"json",type:"POST",contentType:"application/json; charset=utf-8",data:JSON.stringify({data:c.data,lastName:c.carePlusModel.LastName}),success:function(d){$(document).trigger(argosyEvents.END_LOADING);if(d.Records!==null){prompt.notify({question:d.Message,type:"success"});c.set("loginModel",kendo.observable({RegistrationUser:{User:d.Records}}));CarePlus.prototype.options.viewModel.loginModel.RegistrationUser.User=d.Records;CarePlus.prototype.options.viewModel.loginModel.RegistrationUser.User.Custom01=c.data.AGT_SYS_ASSGN_NBR;CarePlus.prototype.options.viewModel.loginModel.RegistrationUser.User.Custom02=c.data.SAN_TYPE.toUpperCase();if(CarePlus.prototype.options.viewModel.loginModel.RegistrationUser.User.Custom02==="AGCY"){CarePlus.prototype.options.viewModel.loginModel.RegistrationUser.User.Custom03=$("#txtAgentCount").val()}$("div[data-role='states']").getKendoStates().value(CarePlus.prototype.options.viewModel.loginModel.RegistrationUser.User.StateId);if(d.ReturnCode===ReturnCode.Success){CarePlus.prototype.options.viewModel.getLoginModel()}else{CarePlus.prototype.options.viewModel.setupRegister()}}else{prompt.notify({question:d.Message,type:"error"})}}})},getLoginModel:function(){var d=this,c=d.loginModel.RegistrationUser.User;$(document).trigger(argosyEvents.START_LOADING);$.ajax({url:"/Register/CarePlusGetLoginModel",dataType:"json",type:"POST",contentType:"application/json; charset=utf-8",data:JSON.stringify({user:c}),success:function(e){$(document).trigger(argosyEvents.END_LOADING);d.loginModel=e.Records;if(e.ReturnCode===ReturnCode.Success){d.login()}else{prompt.notify({question:e.Message,type:"error"})}}})},login:function(){var c=this;$(document).trigger(argosyEvents.START_LOADING);$.ajax({url:"/Register/CarePlusLogin",dataType:"json",type:"POST",data:JSON.stringify(c.loginModel),contentType:"application/json; charset=utf-8",success:function(d){$(document).trigger(argosyEvents.END_LOADING);a.loginModel=d.Records;if(d.ReturnCode===ReturnCode.Success){window.location=a.loginModel.ReturnUrl}else{prompt.notify({question:d.Message,type:"error"})}}})},register:function(){var c=this;$(document).trigger(argosyEvents.START_LOADING);$.ajax({url:"/Register/CarePlusRegister",dataType:"json",type:"POST",data:JSON.stringify({model:c.loginModel,data:c.data}),contentType:"application/json; charset=utf-8",success:function(d){$(document).trigger(argosyEvents.END_LOADING);CarePlus.prototype.options.viewModel.loginModel=d.Records;if(d.ReturnCode===ReturnCode.Success){CarePlus.prototype.options.viewModel.login()}else{prompt.notify({question:d.Message,type:"error"})}}})},setupRegister:function(){var c=this;$("#_VerifyTemplate").hide();$("#_RegisterTemplate").show();if(c.data.SAN_TYPE==="AGCY"){$("#divAgency").show();$("#divAgentMessage").hide()}else{$("#divAgency").hide();$("#divAgentMessage").show()}},verifyInputs:function(){var c=this;if($("#txtFirstName").val()===""){prompt.notify({question:"First Name is required",type:"error"});$("#txtFirstName").focus();return}if($("#txtLastName").val()===""){prompt.notify({question:"LastName is required",type:"error"});$("#txtLastName").focus();return}if($("#txtAddress1").val()===""){prompt.notify({question:"Address Line 1 is required",type:"error"});$("#txtAddress1").focus();return}if($("#txtCity").val()===""){prompt.notify({question:"City is required",type:"error"});$("#txtCity").focus();return}if($("#txtZip").val()===""){prompt.notify({question:"ZIP Code is required",type:"error"});$("#txtZip").focus();return}if(parseInt($("#txtPhone").val())<=0){prompt.notify({question:"Phone is required",type:"error"});$("#txtPhone").focus();return}if($("#txtEmail").val()===""){prompt.notify({question:"Email is required",type:"error"});$("#txtEmail").focus();return}c.register()}});return b};function CollapseBox(a){var b=this;$.extend(true,b.options,b.baseOptions,a);b.element=$("*[data-argosy-uuid="+a.uuid+"]");b.setupCollapseBox();b.setupAnimation();if(b.options.open){b.show()}else{b.hide()}}CollapseBox.prototype.options={};CollapseBox.prototype.baseOptions={title:"No Title",open:false};CollapseBox.prototype.setupCollapseBox=function(){var a=this;a.element.addClass("summary-information");a.setupTitle()};CollapseBox.prototype.setupTitle=function(){var b=this;var a=$("<div />",{"class":"collapse-box-title"});a.append($('<h3 class="nopad"><i class="fa fa-minus-circle"></i> '+b.options.title+"</h3>"));b.element.prepend(a)};CollapseBox.prototype.show=function(){var a=this;a.button.removeClass("fa-plus-circle").addClass("fa-minus-circle");$(a.element.children()).each(function(){var b=$(this);if(!b.hasClass("collapse-box-title")){b.show()}})};CollapseBox.prototype.hide=function(){var a=this;a.button.removeClass("fa-minus-circle").addClass("fa-plus-circle");$(a.element.children()).each(function(){var b=$(this);if(!b.hasClass("collapse-box-title")){b.hide()}})};CollapseBox.prototype.setupAnimation=function(){var a=this;a.button=a.element.find(".fa-minus-circle");a.button.unbind("click");a.button.click(function(b){if(a.button.hasClass("fa-minus-circle")){a.hide()}else{a.show()}})};function CompanyAddressAddUserGroupsGridView(a){var b=this;$.extend(true,b.options,b.baseOptions,a);$(document).bind(argosyEvents.SEARCH_PAGE_GRID,function(d,c){b.refineSearch(c)}).bind(argosyEvents.ADDRESS_USER_GROUPS_LOADED,function(d,c){b.options.user_groups=c.user_groups;b.refineSearch({})})}CompanyAddressAddUserGroupsGridView.prototype.options={user_groups:null,companyId:0,addressId:0};CompanyAddressAddUserGroupsGridView.prototype.baseOptions={gridViewSelector:"div[data-argosy-view=CompanyAddressAddUserGroupsGridView]"};CompanyAddressAddUserGroupsGridView.prototype.searchCriteria={};CompanyAddressAddUserGroupsGridView.prototype.refineSearch=function(a){var b=this;b.searchCriteria=a;b.setupGrid()};CompanyAddressAddUserGroupsGridView.prototype.setupGrid=function(){var c=this;if($(c.options.gridViewSelector).getKendoGrid()==null){var b={scrollable:false,editable:false,dataSource:c.getDataSource(),groupable:false,exportToExcel:false,sortable:true,selectable:"multiple, row",pageable:{refresh:true,pageSizes:[50,100,500],buttonCount:5},checkboxes:true,columns:[{title:"~{GroupName}~",field:"GroupName",template:"<div> #if (GroupName != null && GroupName.trim().length > 0) {#   #= GroupName # #}else{##}# </div>",encoded:false}],search:[{name:"Keyword",type:"text",placeholder:"~{SearchByUserGroupName}~",toolbar:true}]};$(document).trigger(argosyEvents.START_LOADING,{name:c.constructor.name});$(c.options.gridViewSelector).kendoArgosyGrid(b);$(document).trigger(argosyEvents.END_LOADING)}else{var a=$(c.options.gridViewSelector).getKendoGrid();a.dataSource.read();a.refresh()}};CompanyAddressAddUserGroupsGridView.prototype.getDataSource=function(a){var b=this;$.extend(true,b.dataSourceOpts,_defaultDataSourceConfig,a);b.dataSourceOpts.pageSize=5;b.dataSourceOpts.transport={read:function(e){var f=b.options;if(f.user_groups!=null){var c=[];for(var d=0;d<f.user_groups.Records.length;d++){c.push(f.user_groups.Records[d].UserGroupId)}f.excludeUserGroupIds=c}$.extend(true,f,kendoOptionsToObject(e),b.searchCriteria);$.ajax({url:"/DataView/GetUserGroups",dataType:"json",data:f,success:function(g){if(g.ReturnCode===ReturnCode.Failed){handleDataSourceException(g)}else{e.success(g)}}})}};return new kendo.data.DataSource(b.dataSourceOpts)};CompanyAddressAddUserGroupsGridView.prototype.dataSourceOpts={};function CompanyAddressAddUsersGridView(a){var b=this;$.extend(true,b.options,b.baseOptions,a);$(document).bind(argosyEvents.SEARCH_PAGE_GRID,function(d,c){b.refineSearch(c)}).bind(argosyEvents.ADDRESS_USERS_LOADED,function(d,c){b.options.users=c.users;b.refineSearch({})})}CompanyAddressAddUsersGridView.prototype.options={users:null,companyId:0,addressId:0};CompanyAddressAddUsersGridView.prototype.baseOptions={gridViewSelector:"div[data-argosy-view=CompanyAddressAddUsersGridView]"};CompanyAddressAddUsersGridView.prototype.searchCriteria={};CompanyAddressAddUsersGridView.prototype.refineSearch=function(a){var b=this;b.searchCriteria=a;b.setupGrid()};CompanyAddressAddUsersGridView.prototype.setupGrid=function(){var c=this;if($(c.options.gridViewSelector).getKendoGrid()==null){var b={scrollable:false,editable:false,dataSource:c.getDataSource(),groupable:false,exportToExcel:false,sortable:true,selectable:"multiple, row",pageable:{refresh:true,pageSizes:[50,100,500],buttonCount:5},checkboxes:true,columns:[{title:"~{Name}~",field:"FullName",template:"<div> #if (FullName != null && FullName.trim().length > 0) {#   #= FullName # #}else{##}# </div>",encoded:false}],search:[{name:"Keyword",type:"text",placeholder:"~{SearchByUserName}~",toolbar:true}]};$(document).trigger(argosyEvents.START_LOADING,{name:c.constructor.name});$(c.options.gridViewSelector).kendoArgosyGrid(b);$(document).trigger(argosyEvents.END_LOADING)}else{var a=$(c.options.gridViewSelector).getKendoGrid();a.dataSource.read();a.refresh()}};CompanyAddressAddUsersGridView.prototype.getDataSource=function(a){var b=this;$.extend(true,b.dataSourceOpts,_defaultDataSourceConfig,a);b.dataSourceOpts.pageSize=5;b.dataSourceOpts.transport={read:function(e){var f=b.options;if(f.users!=null){var c=[];for(var d=0;d<f.users.Records.length;d++){c.push(f.users.Records[d].UserId)}f.excludeUserIds=c}$.extend(true,f,kendoOptionsToObject(e),b.searchCriteria);$.ajax({url:"/DataView/GetUsers",dataType:"json",data:f,success:function(g){if(g.ReturnCode===ReturnCode.Failed){handleDataSourceException(g)}else{e.success(g)}}})}};return new kendo.data.DataSource(b.dataSourceOpts)};CompanyAddressAddUsersGridView.prototype.dataSourceOpts={};function CompanyAddresses(a){var b=this;$.extend(true,b.options,b.baseOptions,a);$(document).bind(argosyEvents.SEARCH_PAGE_GRID,function(d,c){b.searchCriteria=c;b.setupGrid()});b.setupGrid()}CompanyAddresses.prototype.options={};CompanyAddresses.prototype.baseOptions={gridViewSelector:"div[data-argosy-control='CompanyAddresses']",companyId:0};CompanyAddresses.prototype.searchCriteria={Keyword:null};CompanyAddresses.prototype.setupGrid=function(){var c=this;var a=$(c.options.gridViewSelector).data("kendoGrid");if(a==null){var b={scrollable:false,editable:false,autoBind:true,dataSource:c.getDataSource({}),groupable:false,sortable:true,selectable:false,pageable:{refresh:true,pageSizes:[50,100,500],buttonCount:2},columns:[{title:"~{AttnContact}~",field:"Name"},{field:"~{Company}~",template:"<a href='/Admin/AddressBook/Edit/${AddressId}'>${Company}<a>"},{title:"~{Address}~",template:'${AddressLine1}, ${AddressLine2.length > 0 ? AddressLine2 + ", " : ""} ${City}, ${State.Name} ${ZipCode}'}],dataBinding:function(){},search:[{name:"Keyword",type:"text",placeholder:"~{SearchByNameAddress}~",toolbar:true}]};$(c.options.gridViewSelector).kendoArgosyGrid(b)}else{a.dataSource.read()}};CompanyAddresses.prototype.getDataSource=function(a){var b=this;$.extend(true,b.dataSourceOpts,_defaultDataSourceConfig,a);b.dataSourceOpts.pageSize=50;b.dataSourceOpts.serverPaging=true;b.dataSourceOpts.serverSorting=true;b.dataSourceOpts.serverFiltering=true;b.dataSourceOpts.transport={read:function(c){var d=b.options;$.extend(true,d,kendoOptionsToObject(c),b.searchCriteria);$.ajax({url:"/DataView/GetCompanyAddresses",dataType:"json",data:d,success:function(e){if(e.ReturnCode===ReturnCode.Failed){handleDataSourceException(e)}else{c.success(e)}}})}};b.dataSourceOpts.schema={data:function(c){return c.Records},total:function(c){return c.TotalRecords}};b.dataSourceOpts.requestStart=function(){$(document).trigger(argosyEvents.START_LOADING,{name:b.constructor.name})};b.dataSourceOpts.requestEnd=function(){$(document).trigger(argosyEvents.END_LOADING,{name:b.constructor.name})};return new kendo.data.DataSource(b.dataSourceOpts)};CompanyAddresses.prototype.dataSourceOpts={};function CompanyAddressSearch(b){var c=this;$.extend(true,c.options,c.baseOptions,b);var a=new ControlLoader();a.loadTemplate("CompanyAddressSearch",function(d){$(document.body).append(d);c.initialize();$(document).trigger(c.EVENT_TEMPLATE_LOADED)})}CompanyAddressSearch.prototype.EVENT_TEMPLATE_LOADED="COMPANY_ADDRESS_SEARCH_TEMPLATES_LOADED";CompanyAddressSearch.prototype.options={};CompanyAddressSearch.prototype.baseOptions={viewTemplate:"#_CompanyAddressSearchViewTemplate",modelBindSelector:"#_CompanyAddressBindContainer",orderAddressSelector:"#_OrderAddressContainer",addressSelector:"#_AddressContainer",userId:0,userGroupId:0,companyId:0,addressSearchViewModel:null,keyword:""};CompanyAddressSearch.prototype.searchCriteria={Keyword:null,};CompanyAddressSearch.prototype.getElement=function(){var a=this;return $("*[data-argosy-uuid="+a.options.uuid+"]")};CompanyAddressSearch.prototype.addressSearchViewModel=null;CompanyAddressSearch.prototype.initialize=function(){var a=this,b=a.getElement();b.append($(a.options.viewTemplate).html());kendo.bind(b,kendo.observable({showAddressBook:function(c){var d=kendo.observable({addresses:a.getDataSource({}),orderAddressDataSource:a.getOrderAddressDataSource({}),searchAddress:function(g){var h=this,f=h.get("addresses");a.options.keyword=$("#_AddressSearchText").val();f.read()},updateAddress:function(f){f.data.userName=a.options.userName;$(document).trigger(argosyEvents.EVENT_USER_SELECTED_ADDRESS,f.data);$.fancybox.close()},onChange:function(f){var g=$("#_AddresslistView").data("kendoListView");g.dataSource.page(f.sender.page())}});$.fancybox({content:$("#_CompanyAddressSearchModal").html(),afterShow:function(){kendo.bind(this.wrap,d)}})}}))};CompanyAddressSearch.prototype.getOrderAddressDataSource=function(b){var c=this,a={};$.extend(true,a,_defaultDataSourceConfig,b);a.autoBind=true;a.transport={read:function(d){var f=c.options,e=$(c.options.orderAddressSelector);$.ajax({url:"/DataView/GetOrderAddresses",dataType:"text json",data:f,type:"GET",contentType:"application/json; charset=utf-8",success:function(g){if(g.ReturnCode===ReturnCode.Failed){handleDataSourceException(g)}else{if(g.Records&&g.Records.length===0){e.hide()}else{e.show()}d.success(g)}}})}};return new kendo.data.DataSource(a)};CompanyAddressSearch.prototype.getDataSource=function(a){var b=this;$.extend(true,b.dataSourceOpts,_defaultDataSourceConfig,a);b.dataSourceOpts.autoBind=false;b.dataSourceOpts.transport={read:function(d){var e=b.options,c=$(b.options.addressSelector);$.extend(true,e,kendoOptionsToObject(d),b.searchCriteria);$.ajax({url:"/DataView/GetCompanyAddresses",dataType:"json",data:e,success:function(f){if(f.ReturnCode===ReturnCode.Failed){handleDataSourceException(f)}else{if(f.Records&&f.Records.length===0){c.hide()}b.options.initialLoad=false;d.success(f)}}})}};b.dataSourceOpts.requestStart=function(c){$(document).trigger(argosyEvents.START_LOADING,{name:b.constructor.name})};b.dataSourceOpts.requestEnd=function(c){$(document).trigger(argosyEvents.END_LOADING,{name:b.constructor.name});if(c.hasOwnProperty("response")){if(c.response.TotalRecords<=6){$("#_AddressPager").addClass("hidden")}else{$("#_AddressPager").removeClass("hidden")}if(c.response.TotalRecords<=0){$(".empty-address").removeClass("hidden")}else{$(".empty-address").addClass("hidden")}}};return new kendo.data.DataSource(b.dataSourceOpts)};CompanyAddressSearch.prototype.dataSourceOpts={};function CompanyAddressShowUserGroupsGridView(a){var b=this;$.extend(true,b.options,b.baseOptions,a);b.dataSource=b.getDataSource();b.dataSource.read();b.setupGrid({})}CompanyAddressShowUserGroupsGridView.prototype.options={};CompanyAddressShowUserGroupsGridView.prototype.baseOptions={gridViewSelector:"div[data-argosy-view=CompanyAddressShowUserGroupsGridView]"};CompanyAddressShowUserGroupsGridView.prototype.searchCriteria={};CompanyAddressShowUserGroupsGridView.prototype.setupGrid=function(){var c=this;if($(c.options.gridViewSelector).getKendoGrid()==null){var b={autoBind:false,dataSource:c.dataSource,groupable:false,editable:false,sortable:true,scrollable:false,exportToExcel:false,pageable:{pageSize:5,refresh:true,pageSizes:false,buttonCount:1},columns:[{template:"<i class='fa la fa-times'></i>",width:"10%"},{title:"~{UserGroupName}~",field:"GroupName"}],title:"~{AddressUserGroups}~",toolbar:[{name:"addUserGroups",text:" ~{Add}~","class":"fa fa-plus"}],addUserGroups:function(){showAddUserGroupsModal()},dataBound:function(d){var g=$(d.sender.element);var f=g.getKendoGrid();g.find("tbody tr[role=row]").each(function(){var e=f.dataItem(this);var h=$(this).find(".fa.la.fa-times").parent();h.unbind("click");h.click(function(){c.showDeleteUserGroupModal(e)})})}};$(document).trigger(argosyEvents.START_LOADING,{name:c.constructor.name});$(c.options.gridViewSelector).kendoCollapseGrid(b);$(document).trigger(argosyEvents.END_LOADING)}else{var a=$(c.options.gridViewSelector).getKendoCollapseGrid();a.dataSource.read()}};CompanyAddressShowUserGroupsGridView.prototype.showDeleteUserGroupModal=function(a){var c=this;var b={question:"Are you sure you want to remove "+a.GroupName+" from this Address?",button:"Remove",type:"warning",yes:function(d){if(typeof(d.preventDefault)==="function"){c.deleteAddressUserGroup(a)}}};prompt.alert(b)};CompanyAddressShowUserGroupsGridView.prototype.getDataSource=function(a){var b=this;$.extend(true,b.dataSourceOpts,_defaultDataSourceConfig,a);b.dataSourceOpts.pageSize=5;b.dataSourceOpts.transport={read:function(c){var d=b.options;$.extend(true,d,kendoOptionsToObject(c),b.searchCriteria);$.ajax({url:"/Admin/AddressBook/GetUserGroups",dataType:"json",data:d,success:function(e){if(e.ReturnCode===ReturnCode.Failed){handleDataSourceException(e)}else{$(document).trigger(argosyEvents.ADDRESS_USER_GROUPS_LOADED,{user_groups:e});c.success(e)}}})}};return new kendo.data.DataSource(b.dataSourceOpts)};CompanyAddressShowUserGroupsGridView.prototype.deleteAddressUserGroup=function(c){var b=this;var a={userGroupId:c.UserGroupId,addressId:b.options.addressId};$(document).trigger(argosyEvents.START_LOADING,{name:b.constructor.name});$.ajax({url:"/Admin/AddressBook/DeleteAddressUserGroup",type:"POST",data:JSON.stringify(a),dataType:"json",traditional:true,contentType:"application/json; charset=utf-8",success:function(e){var d=$(b.options.gridViewSelector).find(".k-collapse-grid").getKendoGrid();if(e.ReturnCode===ReturnCode.Success){$(e.Records).each(function(){prompt.notify({question:this.Key+" was removed from this Address.",type:("success")})});d.dataSource.read()}else{prompt.clientResponseError(e)}}});$(document).trigger(argosyEvents.END_LOADING);$.fancybox.close()};CompanyAddressShowUserGroupsGridView.prototype.dataSourceOpts={};function CompanyAddressShowUsersGridView(a){var b=this;$.extend(true,b.options,b.baseOptions,a);b.dataSource=b.getDataSource();b.dataSource.read();b.setupGrid({})}CompanyAddressShowUsersGridView.prototype.options={};CompanyAddressShowUsersGridView.prototype.baseOptions={gridViewSelector:"div[data-argosy-view=CompanyAddressShowUsersGridView]"};CompanyAddressShowUsersGridView.prototype.searchCriteria={};CompanyAddressShowUsersGridView.prototype.setupGrid=function(){var c=this;if($(c.options.gridViewSelector).getKendoGrid()==null){var b={autoBind:false,dataSource:c.dataSource,groupable:false,editable:false,sortable:true,scrollable:false,exportToExcel:false,pageable:{pageSize:5,refresh:true,pageSizes:false,buttonCount:1},columns:[{template:"<i class='fa la fa-times'></i>",width:"10%"},{title:"~{UserName}~",field:"FullName"}],title:"~{AddressUsers}~",toolbar:[{name:"addUsers",text:" ~{Add}~","class":"fa fa-plus"}],addUsers:function(){showAddUsersModal()},dataBound:function(d){var g=$(d.sender.element);var f=g.getKendoGrid();g.find("tbody tr[role=row]").each(function(){var e=f.dataItem(this);var h=$(this).find(".fa.la.fa-times").parent();h.unbind("click");h.click(function(){c.showDeleteUserModal(e)})})}};$(document).trigger(argosyEvents.START_LOADING,{name:c.constructor.name});$(c.options.gridViewSelector).kendoCollapseGrid(b);$(document).trigger(argosyEvents.END_LOADING)}else{var a=$(c.options.gridViewSelector).getKendoCollapseGrid();a.dataSource.read()}};CompanyAddressShowUsersGridView.prototype.showDeleteUserModal=function(a){var c=this;var b={question:"Are you sure you want to remove "+a.FullName+" from this Address?",button:"Remove",type:"warning",yes:function(d){if(typeof(d.preventDefault)==="function"){c.deleteAddressUser(a)}}};prompt.alert(b)};CompanyAddressShowUsersGridView.prototype.getDataSource=function(a){var b=this;$.extend(true,b.dataSourceOpts,_defaultDataSourceConfig,a);b.dataSourceOpts.pageSize=5;b.dataSourceOpts.transport={read:function(c){var d=b.options;$.extend(true,d,kendoOptionsToObject(c),b.searchCriteria);$.ajax({url:"/Admin/AddressBook/GetUsers",dataType:"json",data:d,success:function(e){if(e.ReturnCode===ReturnCode.Failed){handleDataSourceException(e)}else{$(document).trigger(argosyEvents.ADDRESS_USERS_LOADED,{users:e});c.success(e)}}})}};return new kendo.data.DataSource(b.dataSourceOpts)};CompanyAddressShowUsersGridView.prototype.deleteAddressUser=function(c){var b=this;var a={userId:c.UserId,addressId:b.options.addressId};$(document).trigger(argosyEvents.START_LOADING,{name:b.constructor.name});$.ajax({url:"/Admin/AddressBook/DeleteAddressUser",type:"POST",data:JSON.stringify(a),dataType:"json",traditional:true,contentType:"application/json; charset=utf-8",success:function(e){var d=$(b.options.gridViewSelector).find(".k-collapse-grid").getKendoGrid();if(e.ReturnCode===ReturnCode.Success){$(e.Records).each(function(){prompt.notify({question:this.Key+" was removed from this Address.",type:("success")})});d.dataSource.read()}else{prompt.clientResponseError(e)}}});$(document).trigger(argosyEvents.END_LOADING);$.fancybox.close()};CompanyAddressShowUsersGridView.prototype.dataSourceOpts={};function CompanyCategoriesGridView(a){var b=this;$.extend(true,b.options,b.baseOptions,a);$(document).bind(argosyEvents.SEARCH_PAGE_GRID,function(d,c){b.refineSearch(c)});b.refineSearch({})}CompanyCategoriesGridView.prototype.options={};CompanyCategoriesGridView.prototype.baseOptions={gridViewSelector:"div[data-argosy-view=CompanyCategoriesGridView]",showActiveOnly:false};CompanyCategoriesGridView.prototype.searchCriteria={PartId:null};CompanyCategoriesGridView.prototype.refineSearch=function(a){var b=this;b.searchCriteria=a;b.setupGrid()};CompanyCategoriesGridView.prototype.setupGrid=function(){var c=this;if($(c.options.gridViewSelector).getKendoGrid()==null){var b={scrollable:false,editable:false,autoBind:true,dataSource:c.getDataSource({}),groupable:false,exportToExcel:false,sortable:true,selectable:"multiple, row",pageable:{pageSizes:[50,100,500],buttonCount:5},columns:[{title:"~{Name}~",field:"GroupName"},{title:"~{Description}~",field:"GroupDescrip"}],checkboxes:true,search:[{name:"Keyword",type:"text",placeholder:"~{SearchCategoryNameDescription}~",toolbar:true}],};$(c.options.gridViewSelector).kendoArgosyGrid(b)}else{var a=$(c.options.gridViewSelector).getKendoGrid();a.dataSource.read();a.refresh()}};CompanyCategoriesGridView.prototype.getDataSource=function(a){var b=this;$.extend(true,b.dataSourceOpts,_defaultDataSourceConfig,a);b.dataSourceOpts.pageSize=5;b.dataSourceOpts.transport={read:function(c){var d=b.options;if(b.options.showActiveOnly){b.searchCriteria.IsActive=true}$.extend(true,d,kendoOptionsToObject(c),b.searchCriteria);$.ajax({url:"/DataView/GetAllCompanyPartCategories",dataType:"json",data:d,success:function(e){if(e.ReturnCode==ReturnCode.Failed){handleDataSourceException(e)}else{c.success(e)}}})}};return new kendo.data.DataSource(b.dataSourceOpts)};CompanyCategoriesGridView.prototype.dataSourceOpts={};function CompanyGlobalFormsDropDown(a){var b=this;$.extend(true,b.options,b.baseOptions,a);b.refineSearch({})}CompanyGlobalFormsDropDown.prototype.options={};CompanyGlobalFormsDropDown.prototype.searchCriteria={};CompanyGlobalFormsDropDown.prototype.baseOptions={ddlViewSelector:"select[data-argosy-view=CompanyGlobalFormsDropDown]"};CompanyGlobalFormsDropDown.prototype.refineSearch=function(a){var b=this;b.searchCriteria=a;b.setupDropDown()};CompanyGlobalFormsDropDown.prototype.setupDropDown=function(){var c=this;if($(c.options.ddlViewSelector).getKendoDropDownList()==null){var b={serverPaging:false,serverSorting:false,dataTextField:"FormName",dataValueField:"GlobalFormsId",optionLabel:"-- Select Global Form --",dataSource:c.getDataSource({}),suggest:true,autoBind:true};$(c.options.ddlViewSelector).kendoDropDownList(b)}else{var a=$(c.options.ddlViewSelector).getKendoDropDownList();a.dataSource.read();a.refresh()}};CompanyGlobalFormsDropDown.prototype.getDataSource=function(a){var b=this;$.extend(true,b.dataSourceOpts,_defaultDataSourceConfig,a);b.dataSourceOpts.transport={read:function(c){var d=b.options;$.extend(true,d,kendoOptionsToObject(c),b.searchCriteria);$.ajax({url:"/DataView/GetGlobalFormsForCompany/",dataType:"json",data:d,success:function(e){if(e.ReturnCode==ReturnCode.Failed){handleDataSourceException(e)}else{c.success(e)}}})},schema:{data:"d.Data",total:"d.TotalRecords"},pageSize:99999};return new kendo.data.DataSource(b.dataSourceOpts)};CompanyGlobalFormsDropDown.prototype.dataSourceOpts={};function CompanyPartsGridView(a){var b=this;$.extend(true,b.options,b.baseOptions,a);$(document).bind(argosyEvents.SEARCH_PAGE_GRID,function(d,c){b.refineSearch(c)});b.refineSearch({})}CompanyPartsGridView.prototype.options={};CompanyPartsGridView.prototype.baseOptions={gridViewSelector:"div[data-argosy-view=CompanyPartsGridView]",};CompanyPartsGridView.prototype.searchCriteria={PartId:null};CompanyPartsGridView.prototype.refineSearch=function(a){var b=this;b.searchCriteria=a;b.setupGrid()};CompanyPartsGridView.prototype.setupGrid=function(){var c=this;if($(c.options.gridViewSelector).getKendoGrid()==null){var b={scrollable:false,editable:false,autoBind:true,dataSource:c.getDataSource({}),groupable:false,exportToExcel:false,sortable:true,selectable:"multiple, row",pageable:{refresh:true,pageSizes:[50,100,500],buttonCount:5},columns:[{title:"~{SKU}~",field:"Sku",template:"<div><a href='/Admin/Parts/Edit/${PartId}'>#= Sku #</a></div>"},{title:"~{Name}~",field:"PartName",template:"<div> #if (PartName != null && PartName.trim().length > 0) {#   #= PartName # #}else{# #= Sku # #}# </div>",encoded:false},{title:"~{Description}~",template:"#=Description#"}],checkboxes:true,search:[{name:"Keyword",type:"text",placeholder:"~{SearchSkuProductDescription}~",toolbar:true}],};$(c.options.gridViewSelector).kendoArgosyGrid(b)}else{var a=$(c.options.gridViewSelector).getKendoGrid();a.dataSource.read();a.refresh()}};CompanyPartsGridView.prototype.getDataSource=function(a){var b=this;$.extend(true,b.dataSourceOpts,_defaultDataSourceConfig,a);b.dataSourceOpts.pageSize=5;b.dataSourceOpts.transport={read:function(c){var d=b.options;$.extend(true,d,kendoOptionsToObject(c),b.searchCriteria);$.ajax({url:"/DataView/GetParts",dataType:"json",data:d,success:function(e){if(e.ReturnCode===ReturnCode.Failed){handleDataSourceException(e)}else{c.success(e)}}})}};return new kendo.data.DataSource(b.dataSourceOpts)};CompanyPartsGridView.prototype.dataSourceOpts={};function CompanyUserSearch(b){var c=this;$.extend(true,c.options,c.baseOptions,b);var a=new ControlLoader();$(document).bind(argosyEvents.CLEAR_SELECTED_USER,function(d){if(c.options.userSearchViewModel){c.options.userSearchViewModel.clearSelectedUser()}});$(document).bind(argosyEvents.SEARCH_PAGE_GRID,function(f,d){if($("#_CompanySearchModal").css("display")!=="none"||c.options.initialLoad===true){c.refineSearch(d)}});a.loadTemplate("CompanyUserSearch",function(d){$(document.body).append(d);$("*[data-argosy-uuid='"+c.options.uuid+"']").append($(c.options.viewTemplate).html());c.refineSearch({});c.loaded=true;$(document).trigger(c.EVENT_TEMPLATE_LOADED)})}CompanyUserSearch.prototype.EVENT_TEMPLATE_LOADED="COMPANY_USER_SEARCH_TEMPLATES_LOADED";CompanyUserSearch.prototype.options={};CompanyUserSearch.prototype.baseOptions={viewTemplate:"#_CompanyUserSearchViewTemplate",gridViewSelector:"div[data-argosy-view=CompanyUserSearch]",modelBindSelector:"#_CompanyUserBindContainer",valueSelector:"#_hiddenUserId",userSearchViewModel:null,addBtn:"#addUserBtn",clearBtn:"#clearUserBtn",searchBtn:"#searchUserBtn",UserNameLabel:"#UsersFullName",initialLoad:true};CompanyUserSearch.prototype.searchCriteria={Keyword:null,};CompanyUserSearch.prototype.refineSearch=function(a){var b=this;b.searchCriteria=a;b.setupGrid()};CompanyUserSearch.prototype.updateBtns=function(b){var a=this;if(b===true){$(a.options.clearBtn+","+a.options.searchBtn).removeClass("hidden");$(a.options.addBtn).addClass("hidden")}else{$(a.options.clearBtn+","+a.options.searchBtn).addClass("hidden");$(a.options.addBtn).removeClass("hidden")}};CompanyUserSearch.prototype.setupGrid=function(){$("#_CompanySearchAlert").addClass("hidden");var c=this;c.options.userSearchViewModel=kendo.observable({clearSelectedUser:function(d){$(c.options.UserNameLabel).html("");c.updateBtns(false);$(c.options.valueSelector).val(0);if($("#SessionUserId")){getUser($("#SessionUserId").val(),function(e){$(document).trigger(argosyEvents.SELECTED_USER,e)})}},addUsers:function(d){var g=null;var f=$(c.options.gridViewSelector).getKendoGrid();$(f.select()).each(function(e){g=f.dataItem(this)});if(g!==null){c.updateBtns(true);$(document).trigger(argosyEvents.SELECTED_USER,g);$(c.options.valueSelector).val(g.UserId);$(c.options.UserNameLabel).html(g.FullName);$.fancybox.close()}else{$("#_CompanySearchAlert").removeClass("hidden")}}});if($(c.options.gridViewSelector).getKendoGrid()==null){var b={scrollable:false,editable:false,autoBind:true,dataSource:c.getDataSource({}),groupable:false,exportToExcel:false,sortable:true,selectable:"single, row",pageable:{refresh:false,pageSizes:false,buttonCount:1},columns:[{title:"~{UserName}~",field:"Username"},{title:"~{FirstName}~",field:"FirstName"},{title:"~{LastName}~",field:"LastName"}],checkboxes:true,search:[{name:"Keyword",type:"text",placeholder:"~{SearchByUsernameFirstLast}~",toolbar:true}],};$(c.options.gridViewSelector).kendoArgosyGrid(b);kendo.bind($(c.options.modelBindSelector),c.options.userSearchViewModel)}else{var a=$(c.options.gridViewSelector).getKendoGrid();a.dataSource.read();a.refresh()}};CompanyUserSearch.prototype.getDataSource=function(a){var b=this;$.extend(true,b.dataSourceOpts,_defaultDataSourceConfig,a);b.dataSourceOpts.pageSize=5;b.dataSourceOpts.transport={read:function(c){var d=b.options;$.extend(true,d,kendoOptionsToObject(c),b.searchCriteria);$.ajax({url:"/DataView/GetFullUsers",dataType:"json",data:d,success:function(e){if(e.ReturnCode===ReturnCode.Failed){handleDataSourceException(e)}else{b.options.initialLoad=false;c.success(e)}}})}};return new kendo.data.DataSource(b.dataSourceOpts)};CompanyUserSearch.prototype.dataSourceOpts={};function ConsumerGridview(a){var b=this;$.extend(true,b.options,b.baseOptions,a);$(document).bind(argosyEvents.SEARCH_PAGE_GRID,function(d,c){b.refineSearch(c)});b.refineSearch({})}ConsumerGridview.prototype.options={};ConsumerGridview.prototype.baseOptions={gridViewSelector:"div[data-argosy-view=ConsumerGridview]",};ConsumerGridview.prototype.searchCriteria={};ConsumerGridview.prototype.refineSearch=function(a){var b=this;b.searchCriteria=a;b.setupGrid()};ConsumerGridview.prototype.setupGrid=function(){var c=this;if($(c.options.gridViewSelector).getKendoGrid()==null){var b={scrollable:false,editable:false,autoBind:true,dataSource:c.getDataSource({}),groupable:false,sortable:true,dataBound:function(f){var g=f.sender;if(g.dataSource.total()==0){var d=g.columns.length;$(f.sender.wrapper).find("tbody").append('<tr class="kendo-data-row"><td colspan="'+d+'" class="no-data">'+loadEmptyGridTemplate("There were no consumers returned.")+"</td></tr>")}$("div[data-argosy-view=ConsumerGridview] th:eq(3) ,div[data-argosy-view=ConsumerGridview]  tr td:nth-child(4)").addClass("hidden-sm hidden-xs");$("div[data-argosy-view=ConsumerGridview] th:eq(4) ,div[data-argosy-view=ConsumerGridview]  tr td:nth-child(5)").addClass("hidden-xs")},pageable:{refresh:true,pageSizes:[50,100,500],buttonCount:5},columns:[{title:"~{Name}~",template:"<a href='/Tools/Consumers/Edit/${ConsumerId}'>${ConsumerFirstName} ${ConsumerLastName}<a>",},{title:"~{Company}~",field:"ConsumerCompanyName"},{title:"~{Phone}~",field:"ConsumerPhone"},{title:"~{Email}~",field:"ConsumerEmail"}],dataBinding:function(d){},search:[{name:"Keyword",type:"text",placeholder:"~{SearchByNameCompany}~",toolbar:true},],};$(c.options.gridViewSelector).kendoArgosyGrid(b)}else{var a=$(c.options.gridViewSelector).getKendoGrid();a.dataSource.read();a.refresh()}};ConsumerGridview.prototype.getDataSource=function(a){var b=this;$.extend(true,b.dataSourceOpts,_defaultDataSourceConfig,a);b.dataSourceOpts.transport={read:function(c){var d={};$.extend(true,d,kendoOptionsToObject(c),b.searchCriteria);$.ajax({type:"POST",url:"/DataView/GetConsumers",dataType:"json",data:d,success:function(e){if(e.ReturnCode==ReturnCode.Failed){handleDataSourceException(e)}else{c.success(e)}}})}};return new kendo.data.DataSource(b.dataSourceOpts)};ConsumerGridview.prototype.dataSourceOpts={};function ConsumerOrdersGridView(a){var b=this;$.extend(true,b.options,b.baseOptions,a);b.setupGrid({})}ConsumerOrdersGridView.prototype.options={};ConsumerOrdersGridView.prototype.baseOptions={gridViewSelector:"div[data-argosy-view=ConsumerOrdersGridView]",};ConsumerOrdersGridView.prototype.searchCriteria={};ConsumerOrdersGridView.prototype.setupGrid=function(){var b=this;if(b.kendoGrid==null){var a={dataSource:b.getDataSource({}),groupable:false,sortable:true,scrollable:false,exportToExcel:false,pageable:{refresh:true,pageSizes:false,buttonCount:1},columns:[{title:"~{OrderNumber}~",field:"OrderNumber",template:"<a href='/Account/Orders/Edit/${OrderNumber}'>${OrderNumber}</a>",},{title:"~{OrderDate}~",field:"OrderDate",template:'${kendo.toString(kendo.parseDate(OrderDate),"MM/dd/yyyy")}',width:"200px"},{title:"<div>~{Status}~</div>",field:"Status",template:"<span class='bold'>${Status}</span>"}],title:"~{ConsumerOrders}~"};$(b.options.gridViewSelector).kendoCollapseGrid(a);b.kendoGrid=$(b.options.gridViewSelector).getKendoCollapseGrid().getKendoGrid()}else{b.kendoGrid.dataSource.read();b.kendoGrid.refresh()}};ConsumerOrdersGridView.prototype.getDataSource=function(a){var b=this;$.extend(true,b.dataSourceOpts,_defaultDataSourceConfig,a);b.dataSourceOpts.pageSize=5;b.dataSourceOpts.transport={read:function(c){var d=b.options;$.extend(true,d,kendoOptionsToObject(c),b.searchCriteria);$.ajax({url:"/DataView/GetOrders",dataType:"json",data:d,success:function(e){if(e.ReturnCode==ReturnCode.Failed){handleDataSourceException(e)}else{c.success(e)}}})}};return new kendo.data.DataSource(b.dataSourceOpts)};ConsumerOrdersGridView.prototype.dataSourceOpts={};function ConsumerUserSearch(b){var c=this;$.extend(true,c.options,c.baseOptions,b);var a=new ControlLoader();$(document).bind(argosyEvents.SEARCH_PAGE_GRID,function(f,d){if($("#_ConsumerSearchModal").css("display")!=="none"||c.options.initialLoad===true){c.refineSearch(d)}});$(document).bind(argosyEvents.CLEAR_SELECTED_CONSUMER,function(d){if(c.options.userSearchViewModel){c.options.userSearchViewModel.clearSelectedUser()}});$(document).bind(argosyEvents.EVENT_CONSUMER_UPDATED,function(f,d){c.refineSearch({})});a.loadTemplate("ConsumerUserSearch",function(d){$(document.body).append(d);$("*[data-argosy-uuid='"+c.options.uuid+"']").append($(c.options.viewTemplate).html());c.refineSearch({});c.loaded=true;$(document).trigger(c.EVENT_TEMPLATE_LOADED)})}ConsumerUserSearch.prototype.EVENT_TEMPLATE_LOADED="CONSUMER_USER_SEARCH_TEMPLATES_LOADED";ConsumerUserSearch.prototype.options={};ConsumerUserSearch.prototype.baseOptions={viewTemplate:"#_ConsumerUserSearchViewTemplate",gridViewSelector:"div[data-argosy-view=ConsumerUserSearch]",modelBindSelector:"#_ConsumerUserBindContainer",addBtn:"#addConsumerBtn",clearBtn:"#clearConsumerBtn",searchBtn:"#searchConsumerBtn",AddNewBtn:"#_ConsumerUserCreateModal",valueSelector:"#_hiddenConsumerId",consumerNameLabel:"#ConsumersFullName",userSearchViewModel:null,initialLoad:true};ConsumerUserSearch.prototype.searchCriteria={Keyword:null,recordSizeCategory:0};ConsumerUserSearch.prototype.refineSearch=function(a){var b=this;b.searchCriteria=a;b.setupGrid()};ConsumerUserSearch.prototype.setupGrid=function(){$("#_ConsumerSearchAlert").addClass("hidden");var c=this;c.options.userSearchViewModel=kendo.observable({clearSelectedUser:function(d){$(c.options.consumerNameLabel).html("");c.updateBtns(false);$(c.options.valueSelector).val(0)},addUsers:function(d){var g=null;var f=$(c.options.gridViewSelector).getKendoGrid();$(f.select()).each(function(e){g=f.dataItem(this)});if(g!==null){$(c.options.valueSelector).val(g.ConsumerId);c.updateBtns(true);$(document).trigger(argosyEvents.SELECTED_CONSUMER,g);$(c.options.consumerNameLabel).html(g.ConsumerFirstName+" "+g.ConsumerLastName);$.fancybox.close()}else{$("#_ConsumerSearchAlert").removeClass("hidden")}}});if($(c.options.gridViewSelector).getKendoGrid()==null){var b={scrollable:false,editable:false,autoBind:true,dataSource:c.getDataSource({}),groupable:false,exportToExcel:false,sortable:true,selectable:"single, row",pageable:{refresh:false,pageSizes:false,buttonCount:1},columns:[{title:"~{Consumer}~",template:"${ConsumerFirstName} ${ConsumerLastName} <br/> ${ConsumerCompanyName}"},{title:"~{Address}~",template:"${ConsumerAddress1} <br/>${ConsumerCity},${ConsumerStateCode} ${ConsumerZip}"}],checkboxes:true,search:[{name:"Keyword",type:"text",placeholder:"~{SearchByNameCompany}~",toolbar:true}],};$(c.options.gridViewSelector).kendoArgosyGrid(b);kendo.bind($(c.options.modelBindSelector),c.options.userSearchViewModel)}else{var a=$(c.options.gridViewSelector).getKendoGrid();a.dataSource.read();a.refresh();a.dataSource.sort({});a.dataSource.filter({})}};ConsumerUserSearch.prototype.updateBtns=function(c){var b=this,a=b.options.clearBtn+","+b.options.searchBtn;if(c===true){$(a).removeClass("hidden");$(b.options.addBtn).addClass("hidden")}else{$(a).addClass("hidden");$(b.options.addBtn).removeClass("hidden")}};ConsumerUserSearch.prototype.getDataSource=function(a){var b=this;$.extend(true,b.dataSourceOpts,_defaultDataSourceConfig,a);b.dataSourceOpts.pageSize=10;b.dataSourceOpts.transport={read:function(c){var d=b.options;$.extend(true,d,kendoOptionsToObject(c),b.searchCriteria);$.ajax({url:"/DataView/GetConsumers",dataType:"json",data:d,success:function(e){if(e.ReturnCode===ReturnCode.Failed){handleDataSourceException(e)}else{b.options.initialLoad=false;c.success(e);$.fancybox.update()}}})}};return new kendo.data.DataSource(b.dataSourceOpts)};ConsumerUserSearch.prototype.dataSourceOpts={};function ContainerBuilder(b){var c=this;$.extend(true,c.options,c.baseOptions,b);var a=new ControlLoader();a.loadTemplate("ContainerBuilder",function(d){$(document.body).append(d);$(document).trigger(argosyEvents.START_LOADING,{name:c.constructor.name});$.ajax({url:"/store/part/PartPackDimensions?partGroupId="+c.options.partCategoryId,dataType:"json",success:function(f){var e=[];$(f.Parts.Records).each(function(h,j){if(j.PackDimension!=null&&j.PackDimension.DefaultPerBox!=null&&j.PackDimension.DefaultBox!=null){var g=f.Cart[j.PartId];if(g==null){g=0}j.CartQuantity=g;e.push(j)}});c.initialize(e,f.Cart);$(document).trigger(argosyEvents.END_LOADING,{name:c.constructor.name})}})})}ContainerBuilder.prototype.options={};ContainerBuilder.prototype.baseOptions={templates:{contentTemplate:"#_ContainerBuilderTemplate"}};ContainerBuilder.prototype.initialize=function(c,a){var d=this;var e=new kendo.data.ObservableObject({totalCases:0,totalPallets:0,totalWeight:0,totalSquareFeet:0,parentContainers:[],parts:c,cart:a,updateQuantity:function(){var h=0,i=0,j=0,k=0,g=[],f=this;$(f.parts).each(function(n,o){var l=0;l=f.cart[o.PartId];if(l==null){l=0}o.set("NumberOfPallets",f.getNumberOfPallets(o));o.set("PalletWeight",f.getPalletWeight(o));o.set("FeetCubed",f.getFeetCubed(o));h+=l;i+=(l/o.PackDimension.DefaultPerBox);j+=(l*(o.PackDimension.Length*o.PackDimension.Width*o.PackDimension.Height));k+=(o.PackDimension.Weight*l);var m=o.PackDimension.DefaultBox.Containers;$(m).each(function(r,q){var p=$.grep(g,function(s){return s.BoxId===q.BoxId});if(p.length>0){}else{g.push(q)}})});f.set("totalCases",kendo.toString(h,"n0"));f.set("totalPallets",kendo.toString(i,"n2"));f.set("totalSquareFeet",kendo.toString(j/(12*12*12),"n2"));f.set("totalWeight",kendo.toString(k,"n0")+" lbs");f.set("parentContainers",g);this.updateSelectedContainer()},updateSelectedContainer:function(){var h=this,f=$("*[data-max-size]"),g=false,j=parseFloat(h.totalWeight.replace(/,/g,"")),i=parseFloat(h.totalSquareFeet.replace(/,/g,""));$(f).each(function(l,k){if(!g){var o=$(k),m=parseFloat(o.attr("data-max-size")),n=parseFloat(o.attr("data-max-weight"));if(i<=m&&j<=n){o.addClass("bg-success");g=true}}})},updateCart:function(g){var h=this;var f={cartData:JSON.stringify(h.cart.toJSON())};$.ajax({url:"/store/cart/UpdateCartQuantity",data:f,dataType:"json",method:"POST",success:function(){window.location="/Store/Cart"}})},changeQuantity:function(f){var g=this;g.cart[f.data.PartId]=f.data.CartQuantity;g.updateQuantity()},getNumberOfPallets:function(f){return kendo.toString(f.CartQuantity/f.PackDimension.DefaultPerBox,"n2")},getPalletWeight:function(f){return kendo.toString(f.PackDimension.Weight*f.CartQuantity,"n0")},getFeetCubed:function(f){return kendo.toString(((f.PackDimension.Length*f.PackDimension.Width*f.PackDimension.Height)*f.CartQuantity)/(12*12*12),"n2")},getWeight:function(f){return kendo.toString(f.PackDimension.Weight,"n1")},getDimensions:function(f){return kendo.toString((f.PackDimension.Length*f.PackDimension.Width*f.PackDimension.Height)/(12*12*12),"n1")},getDefaultPerBox:function(f){return kendo.toString(f.PackDimension.DefaultPerBox,"n0")},getCubicFeet:function(f,g){if(g==null){g=true}var h=(f.Length*f.Width*f.Height)/(12*12*12);if(g){return kendo.toString(h,"n2")}else{return h}}});var b=kendo.Template.compile($(d.options.templates.contentTemplate).html())({});d.getElement().append(b);e.updateQuantity();kendo.bind(d.getElement(),e);setTimeout(function(){$("input[data-role=numerictextbox]").bind("focus",function(){var f=$(this);clearTimeout(f.data("selectTimeId"));var g=setTimeout(function(){f.select()});f.data("selectTimeId",g)}).blur(function(f){clearTimeout($(this).data("selectTimeId"))});e.updateSelectedContainer();$("*[data-part-id]").each(function(f){var g=$(this);g.addClass("finger");g.click(function(h){var i=g.attr("data-part-id");$(document).trigger(argosyEvents.SHOW_PART_DETAILS_MODAL,{partId:i,showAddToCart:false})})})},1000)};ContainerBuilder.prototype.getElement=function(){var a=this;return $("*[data-argosy-uuid="+a.options.uuid+"]")};function CustomizedReportsGridView(a){var b=this;$.extend(true,b.options,b.baseOptions,a);$(document).bind(argosyEvents.SEARCH_PAGE_GRID,function(d,c){b.search({})});b.search({})}CustomizedReportsGridView.prototype.options={};CustomizedReportsGridView.prototype.baseOptions={gridViewSelector:"div[data-argosy-view=CustomizedReportsGridView]"};CustomizedReportsGridView.prototype.search=function(){var c=this;if($(c.options.gridViewSelector).getKendoGrid()==null){var b={scrollable:false,editable:"inline",autoBind:true,dataSource:c.getDataSource({}),groupable:false,sortable:false,selectable:false,exportToExcel:false,schema:{model:{id:"ReportConfigId",fields:{ReportConfigId:{editable:false,nullable:true},ReportViewName:{validation:{required:true}},DateCreated:{editable:false}}}},columns:[{field:"ReportName",hidden:true,groupHeaderTemplate:"#if(value != null) { #  #= value # # } else {#Items#}  # "},{title:" ",template:"<i class='fa fa-times'></i>",width:"5%"},{title:" ",field:"ReportViewName",template:"<a href='/Admin/Reports/Details/${ReportConfigId}'>${ReportViewName}</a>",width:"65%"},{title:" ",template:'${kendo.toString(kendo.parseDate(DateCreated),"MM/dd/yyyy")}',width:"15%"},{command:["edit"],title:"&nbsp;",width:"15%"}],edit:function(d){},save:function(d){var g=d.container.find("input[name=ReportViewName]");var f=this.dataItem($(g).closest("tr"));f.ReportViewName=g.val();var i=f;var h={reportConfigId:i.ReportConfigId,reportViewName:i.ReportViewName};$.ajax({url:"/Admin/Reports/UpdateReportViewName",type:"POST",data:JSON.stringify(h),dataType:"json",traditional:true,contentType:"application/json; charset=utf-8",success:function(e){if(!e.IsError){$(e.Data).each(function(){prompt.notify({question:e.Message,type:(!this.Value?"success":"error")});var j=$(c.options.gridViewSelector).getKendoGrid();j.refresh()})}else{prompt.clientResponseError(e)}}})},dataBound:function(f){var h=$(f.sender.element);var d=h.find(".k-icon.k-i-collapse");d.click();var g=h.getKendoGrid();h.find("tbody tr[role=row]").each(function(){var e=g.dataItem(this);var i=$(this).find(".fa.fa-times").parent();i.unbind("click");i.click(function(){c.showDeleteModal(e)})})}};$(c.options.gridViewSelector).kendoArgosyGrid(b)}else{var a=$(c.options.gridViewSelector).getKendoGrid();a.dataSource.read();a.refresh()}};CustomizedReportsGridView.prototype.showDeleteModal=function(b){var d=this;var a=false;var c={question:"",description:"",button:"",type:"warning",yes:function(f){if(!a){d.deleteReportFromGroup(b);a=true}}};c.question="Are you sure you want to delete this custom report?";c.button="Delete";prompt.alert(c)};CustomizedReportsGridView.prototype.deleteReportFromGroup=function(b){var c=this;var a={report:b};$.ajax({url:"/Admin/Reports/DeleteReportFromGroup",type:"POST",data:JSON.stringify(a),dataType:"json",traditional:true,contentType:"application/json; charset=utf-8",success:function(e){if(e.ReturnCode==ReturnCode.Success){$(e.Records).each(function(){prompt.notify({question:this.Key+" was "+(!this.Value?"":"not")+" successfully deleted",type:(!this.Value?"success":"error")})})}else{prompt.clientResponseError(e)}var d=$(c.options.gridViewSelector).getKendoGrid();d.dataSource.read();d.refresh(true)}});$.fancybox.close()};CustomizedReportsGridView.prototype.getDataSource=function(a){var b=this;$.extend(true,b.dataSourceOpts,_defaultDataSourceConfig,a);b.dataSourceOpts.group={field:"ReportName"};b.dataSourceOpts.transport={read:function(c){var d=b.options;$.extend(true,d,kendoOptionsToObject(c),b.searchCriteria);$.ajax({url:"/DataView/GetUserReportViews",dataType:"json",data:d,success:function(e){if(e.ReturnCode==ReturnCode.Failed){handleDataSourceException(e)}else{c.success(e)}}})}};return new kendo.data.DataSource(b.dataSourceOpts)};CustomizedReportsGridView.prototype.dataSourceOpts={};CustomizedReportsGridView.prototype.getStatus=function(){};function DamAssetImportExportOptions(a){var b=this;$.extend(true,b.options,b.baseOptions,a);b.setupSearch();b.setupGrid()}DamAssetImportExportOptions.prototype.options={};DamAssetImportExportOptions.prototype.baseOptions={gridViewSelector:"div[data-argosy-view=DamAssetImportExportOptionsView]",};DamAssetImportExportOptions.prototype.dataSourceOpts={};DamAssetImportExportOptions.prototype.getDataSource=function(a){var b=this;b.dataSourceOpts.transport={read:function(c){var d=b.options;d.inputExtensionId=$("#ddlInputExtensions").val();d.outputExtensionId=$("#ddlOutputExtensions").val();d.active=$("#ddlActive").val();$.ajax({url:"/Tools/DigitalAssets/GetAssetInputOutputFormats",dataType:"json",data:d,success:function(e){if(e.ReturnCode==ReturnCode.Failed){handleDataSourceException(e)}else{c.success(e.Records)}},error:function(f){}})},update:function(c){$.ajax({url:"/Tools/DigitalAssets/UpdateInputOutputFormat",dataType:"json",data:c.data,method:"POST",success:function(d){if(d.ReturnCode==ReturnCode.Success){DamAssetImportExportOptions.prototype.setupGrid()}else{c.error()}}})}};b.dataSourceOpts.schema={model:{id:"Id",fields:{Id:{editable:false},CompanyId:{type:"number"},Dpi:{type:"number",validation:{required:true,min:1}},Comments:{type:"string",validation:{required:false}},IsActive:{type:"boolean"}}}};return new kendo.data.DataSource(b.dataSourceOpts)};DamAssetImportExportOptions.prototype.setupGrid=function(){var c=this;if($(c.options.gridViewSelector).getKendoGrid()==null){var b={scrollable:false,editable:"inline",autoBind:true,dataSource:c.getDataSource({}),sortable:true,columns:[{field:"Id",hidden:true},{title:"Input Extension",field:"InputTypeExtension",editable:function(d){return false},width:"75px"},{title:"Output Extension",field:"OutputTypeExtension",editable:function(d){return false},width:"75px"},{title:"DPI",field:"Dpi",width:"50px",attributes:{style:"text-align: right;"},headerAttributes:{style:"text-align:right;"},editor:DamAssetImportExportOptions.prototype.NumericEditor},{title:"Comments",field:"Comments",},{title:"Active",field:"IsActive",width:"100px",editor:DamAssetImportExportOptions.prototype.activeDropDownEditor},{command:["edit"],width:"200px"}],dataBound:function(g){$(c.options.gridViewSelector).find("input[type=number]").kendoNumericTextBox({min:0,spinners:false,step:1,format:"n0"});var j=g.sender;var k=j.dataSource.view();for(var l=0;l<k.length;l++){var f=k[l].uid;var d=j.table.find("tr[data-uid='"+f+"']");var h=$(d).find(".k-grid-edit");if(k[l].Dpi==null){h.hide()}}}};$(c.options.gridViewSelector).kendoArgosyGrid(b)}var a=$(c.options.gridViewSelector).getKendoGrid();a.dataSource.read();a.refresh()};DamAssetImportExportOptions.prototype.setupSearch=function(){$("#ddlInputExtensions").kendoDropDownList({dataSource:InputExtensions,dataTextField:"text",dataValueField:"value"}).data("kendoDropDownList");$("#ddlOutputExtensions").kendoDropDownList({dataSource:OutputExtensions,dataTextField:"text",dataValueField:"value"}).data("kendoDropDownList");$("#ddlActive").kendoDropDownList({dataSource:ActiveStates,dataTextField:"text",dataValueField:"value"}).data("kendoDropDownList").value("")};DamAssetImportExportOptions.prototype.search=function(){var b=this;var a=$(b.options.gridViewSelector).getKendoGrid();a.dataSource.read();a.refresh()};DamAssetImportExportOptions.prototype.activeDropDownEditor=function(a,b){$('<input required name="'+b.field+'"/>').appendTo(a).kendoDropDownList({autoBind:false,dataTextField:"text",dataValueField:"value",dataSource:[{value:true,text:"True"},{value:false,text:"False"}],}).data("kendoDropDownList").value(b.model.IsActive)};DamAssetImportExportOptions.prototype.NumericEditor=function(a,b){$("<input required name='"+b.field+"'/>").appendTo(a).kendoNumericTextBox({min:0,spinners:false,step:1,format:"n0"})};function DamAssetView(){}DamAssetView.prototype.options={};DamAssetView.prototype.baseOptions={listViewHref:"div[data-argosy-view=MvcAssetListView]",};DamAssetView.prototype.EVENT_TEMPLATE_LOADED="TEMPLATE_ASSET_VIEW_LOADED";DamAssetView.prototype.EVENT_LISTENERS_LOADED="ASSET_VIEW_LISTENERS_LOADED";DamAssetView.prototype.EVENT_DATABOUND="ASSET_VIEW_DATABOUND";DamAssetView.prototype.assetDetailControl=null;DamAssetView.prototype.assetUsageControl=null;DamAssetView.prototype.assetShareControl=null;DamAssetView.prototype.loaded=false;function DamDirectoryView(b){var c=this,a=new ControlLoader();$.extend(true,c.options,c.baseOptions,b);c.setupEventListeners();a.loadTemplate("DamDirectoryView",function(d){$(document.body).append(d);c.init()})}DamDirectoryView.prototype.options={viewModel:null,dropTarget:null,enableDragAndDrop:true};DamDirectoryView.prototype.setupEventListeners=function(){$(document).bind(argosyEvents.ASSET_DIRECTORY_CREATED,function(a,b){DamDirectoryView.prototype.options.viewModel.directories.read()})};DamDirectoryView.prototype.init=function(){var a=this;if(a.options.viewModel==null){a.options.viewModel=new kendo.data.ObservableObject({directories:new kendo.data.HierarchicalDataSource({transport:{read:{url:"/Tools/DigitalAssets/GetDirectories"}},schema:{model:{id:"ID",hasChildren:"HasChildren"},data:"Records",total:"Records.length"}}),change:function(d){var f=DamFolderRights.prototype,h=null;if(f!=null){h=f.options.viewModel}if(d.sender.select().length>0){var g=d.sender.select()[0],c=d.sender.dataItem(g);d.sender.expand(g);if(c.hasChildren&&(c.children.data()==null||c.children.data().length===0)){c.load()}if(c.ID>0){if(MvcAssetView.prototype!=null){MvcAssetView.prototype.options.includeFolders=false}$("div[data-id='damListView'], #divDAMResults").show();$("div[data-id='addFolder']").hide();var b;if(h!=null){b=h.get("currentAssetGroup");if(b!=null){if(b.dirty){prompt.alert({question:"You have unsaved changes.",description:"Are you sure you want to continue?",type:"warning",button:"Save Changes",buttonNo:"Continue",buttonNoHidden:false,yes:function(){h.assetGroupSource.sync();$.fancybox.close()},no:function(){h.assetGroupSource.read();$.fancybox.close()}})}else{if(b.ID!==c.Id){h.assetGroupSource.read()}}}else{h.assetGroupSource.read()}}else{$(document).trigger(argosyEvents.ASSET_DIRECTORY_CHANGED,{Id:c.ID,Name:c.Text,Description:c.Description,uid:c.uid})}}else{if(c.ID===0){if(MvcAssetView.prototype!=null){MvcAssetView.prototype.options.includeFolders=true}_.forEach(c.children.data(),function(e){var i=d.sender.findByUid(e.uid);d.sender.collapse(i)});$(document).trigger(argosyEvents.ASSET_DIRECTORY_CHANGED,{Id:c.ID,Name:c.Text,Description:c.Description,uid:c.uid})}}}},dataBound:function(d){$.each(d.sender.items(),function(e,j){if(e===0){d.sender.expand(j)}if(a.options.enableDragAndDrop){$(j).kendoDropTarget({drop:function(l){var p=$("div[data-argosy-view='MvcAssetListView']").data("kendoListView"),m=$("div[data-argosy-view='MvcAssetGridView']").data("kendoGrid"),o=p.dataItem(l.draggable.currentTarget),n=m.dataItem(l.draggable.currentTarget),r=$("ul[data-argosy-control='DamDirectoryView']").data("kendoTreeView"),q=null,i=null,k=r.dataItem(l.dropTarget);if(o!=null){i=o.AssetItemType;q=r.dataSource.get(o.AssetGroupId)}else{if(n!=null){i=n.AssetItemType;q=r.dataSource.get(n.AssetGroupId)}}switch(i){case"File":$(document).trigger(argosyEvents.MOVE_ASSETS_TO_FOLDER,k);break;case"Folder":a.options.viewModel.moveAssetFolder(k,q);break}}})}});if(d.sender.select().length===0){var f=DamFolderRights.prototype,h=null,b=null;if(f!=null){h=f.options.viewModel}if(h!=null){b=h.get("currentAssetGroup")}if(b!=null){var c=d.sender.dataSource.get(b.get("ID")),g=null;if(c!=null){g=d.sender.findByUid(c.uid)}if(g!=null){d.sender.select(g)}}else{d.sender.select(d.sender.items()[0])}}},treeView:null,drop:function(b){if(DamDirectoryView.prototype.options.enableDragAndDrop){DamDirectoryView.prototype.options.dropTarget=$.extend(true,b);var c={question:"Do you want to move this asset?",description:"",button:"Confirm",buttonNo:"Cancel",buttonNoHidden:false,type:"warning",yes:function(g){if(typeof(g.preventDefault)==="function"){var j=DamDirectoryView.prototype.options;var h=j.dropTarget;var i=h.sender.dataItem(h.sourceNode),d=h.sender.dataItem(h.destinationNode);h.data.moveAssetFolder(d,i)}},no:function(d){DamDirectoryView.prototype.options.dropTarget.preventDefault();DamDirectoryView.prototype.options.viewModel.directories.read();$.fancybox.close()}};prompt.alert(c)}else{b.preventDefault()}},moveAssetFolder:function(c,b){$(document).trigger(argosyEvents.START_LOADING);$.ajax({url:"/tools/digitalassets/MoveAssetFolder",dataType:"json",method:"POST",data:{parentAssetGroupId:c.ID,assetGroupId:b.ID},success:function(d){if(d.ReturnCode!=="200"){prompt.clientResponseError(d)}else{prompt.notify({question:"Your folder was moved successfully!",type:"success"})}},error:function(d){options.error(d)},complete:function(){$(document).trigger(argosyEvents.END_LOADING)}})},addFolder:function(){if(MvcAssetView.prototype!=null){MvcAssetView.prototype.addFolder()}}});kendo.bind($("div[data-id='damTreeView'], div[data-id='addFolder']"),a.options.viewModel)}};function DamFileUpload(b){var c=this;$.extend(true,c.options,c.baseOptions,b);var a=new ControlLoader();a.loadTemplate("DamFileUpload",function(d){$(document.body).append(d);c.init();c.setupEventListers();$(document).trigger(c.EVENT_TEMPLATE_LOADED)})}DamFileUpload.prototype.options={};DamFileUpload.prototype.baseOptions={};DamFileUpload.prototype.EVENT_TEMPLATE_LOADED="TEMPLATE_DAM_FILE_UPLOAD_LOADED";DamFileUpload.prototype.EVENT_DATABOUND="EVENT_DAM_FILE_UPLOAD_DATABOUND";DamFileUpload.prototype.setupEventListers=function(){var a=this;$(document).bind(argosyEvents.SHOW_ASSET_UPLOAD_MODAL,function(c,b){a.options.currentAssetGroupId=b;$.fancybox({href:"#DamFileUpload",beforeClose:function(d){$(document).trigger(argosyEvents.REFRESH_ASSET_DIRECTORY);a.getElement().find("table tbody.files").empty()}})})};DamFileUpload.prototype.init=function(){var c=this;var b=$("#upload-template-form").html();c.fileCounter=0;var a=true;c.getElement().append(b);c.getElement().fileupload({autoUpload:true,url:"/UploadHandler.ashx?ValidationKey="+validationKey,maxChunkSize:5000000,change:function(d){$.fancybox.update();$.fancybox.reposition()},submit:function(f,d){c.fileCounter++},fail:function(f,d){c.fileCounter--;if(c.fileCounter==0){$.fancybox.close();prompt.notify("The items uploaded may take up to 5 minutes to appear.")}},done:function(f,d){if(f.type=="fileuploaddone"){var g=[];g.push(d.files[0].name);$.ajax({url:"/tools/digitalassets/CreateAssets",dataType:"json",method:"POST",data:{assetGroupId:c.options.currentAssetGroupId,files:g},success:function(e){if(e.ReturnCode!="200"){prompt.error(e.Message+"  Code: "+e.Guid)}},error:function(e){options.error(e)}});c.fileCounter--}if(c.fileCounter==0&&!a){$.fancybox.close();prompt.notify("Your files have been uploaded.");prompt.notify("The items uploaded may take up to 5 minutes to appear.")}if(a){a=false}}});c.getElement().fileupload("option","redirect",window.location.href.replace(/\/[^\/]*$/,"/cors/result.html?%s"));c.getElement().addClass("fileupload-processing");$.ajax({url:c.getElement().fileupload("option","url"),dataType:"json",context:c.getElement()[0]}).always(function(){$(this).removeClass("fileupload-processing")}).done(function(d){$(this).fileupload("option","done").call(this,$.Event("done"),{result:d})})};DamFileUpload.prototype.getElement=function(){var a=this;return $("*[data-argosy-uuid="+a.options.uuid+"]")};function DamFolderRights(b){var c=this,a=new ControlLoader();$.extend(true,c.options,c.baseOptions,b);a.loadTemplate("DamFolderRights",function(d){$(document.body).append(d);c.options.viewModel=c.getViewModel();c.initialize()})}DamFolderRights.prototype.options={viewModel:null,isBound:false};DamFolderRights.prototype.initialize=function(){var b=this,a=$(".btn-success");a.click(function(){var e=$("ul[data-role='treeview']").data("kendoTreeView"),c=e.select()[0],d=e.dataItem(c);if(d.hasChildren){prompt.alert({question:"Apply changes to all sub directores?",type:"warning",buttonNoHidden:false,buttonNo:"Just this Directory",button:"Apply to All",yes:function(f){if(typeof(f.preventDefault)==="function"){b.options.viewModel.set("cascadeChanges",true);b.options.viewModel.assetGroupSource.sync();$.fancybox.close()}},no:function(f){if(typeof(f.preventDefault)==="function"){b.options.viewModel.set("cascadeChanges",false);b.options.viewModel.assetGroupSource.sync();$.fancybox.close()}}})}else{b.options.viewModel.assetGroupSource.sync()}});$(document).bind(argosyEvents.KENDO_EDITOR_IMAGE_UPLOADED,function(f,d,c){if(DamFolderRights.prototype.options.viewModel.assetGroupSource.data()[0]!=undefined){DamFolderRights.prototype.options.viewModel.assetGroupSource.data()[0].set("IMAGE_FILE_PATH",d.UploadFileUrl)}});$(document).bind(argosyEvents.KENDO_EDITOR_IMAGE_REMOVED,function(f,d,c){if(DamFolderRights.prototype.options.viewModel.assetGroupSource.data()[0]!=undefined){DamFolderRights.prototype.options.viewModel.assetGroupSource.data()[0].set("IMAGE_FILE_PATH","")}})};DamFolderRights.prototype.getViewModel=function(){var a=this,b=kendo.observable({click:function(c){var f=$("tbody[data-id='assetPermissionsListView']").data("kendoListView"),g=f.dataSource.get(c.data.RoleId),h=$(c.target).data("property"),d=g[h];if(!g.IsAdmin){g.set(h,!d);f.dataSource.sync()}},assetGroupSource:new kendo.data.DataSource({transport:{read:{url:"/tools/digitalassets/GetAssetGroup/",dataType:"json",complete:function(){var c=a.options.viewModel.assetGroupSource.data()[0];a.options.viewModel.set("currentAssetGroup",c);a.options.viewModel.updateView()}},update:{url:"/tools/digitalassets/UpdateAssetGroupDetails/",dataType:"json",contentType:"application/json",method:"POST",complete:function(d){if(d.status===200){var c=a.options.viewModel.get("currentAssetGroup"),e=$("ul[data-role='treeview']").data("kendoTreeView");if(c==null){c=a.options.viewModel.assetGroupSource.data()[0];a.options.viewModel.set("currentAssetGroup",c)}a.options.viewModel.assetGroupSource.read();e.dataSource.read();prompt.notify({question:"Access group details updated successfully",type:"success"})}else{prompt.clientResponseError(result)}}},parameterMap:function(c,g){if(g==="read"){var f=$("ul[data-role='treeview']").data("kendoTreeView"),e=f.select()[0],d=f.dataItem(e);c.id=d.ID}else{c.assetGroupId=a.options.viewModel.currentAssetGroup.ID;c.cascadeChanges=a.options.viewModel.cascadeChanges;c=kendo.stringify(c)}return c}},schema:{data:function(c){return[c.Records]},total:function(c){return[c.Records].length},model:{id:"ID"}},requestEnd:function(c){}}),permissionSource:new kendo.data.DataSource({transport:{read:{url:"/tools/digitalassets/GetAssetGroupPermissions/",dataType:"json"},update:{url:"/tools/digitalassets/UpdateAssetGroupPermissions/",dataType:"json",contentType:"application/json",method:"POST",complete:function(c){if(c.status===200){prompt.notify({question:"Access group permission updated successfully",type:"success"})}else{prompt.clientResponseError(result)}}},parameterMap:function(c,g){if(g==="read"){var f=$("ul[data-role='treeview']").data("kendoTreeView"),e=f.select()[0],d=f.dataItem(e);c.assetGroupId=d.ID}else{c=kendo.stringify({assetGroupId:a.options.viewModel.currentAssetGroup.ID,permissions:[c],cascadeChanges:a.options.viewModel.cascadeChanges})}return c}},schema:{data:function(c){return c.Records},total:function(c){return c.Records.length},model:{id:"RoleId"}}}),cascadeChanges:false,currentAssetGroup:null,updateView:function(){var c=a.options.viewModel.get("currentAssetGroup"),g=$("div[data-id='damListView']"),h=$("ul[data-role='treeview']").data("kendoTreeView"),d=$(".btn-success");if(c!=null){if(c.get("ID")>0){g.empty();g.append(kendo.Template.compile($("#_assetGroupDetailsTemplate").html())(a.options.viewModel));kendo.bind(g,a.options.viewModel);a.options.viewModel.permissionSource.read();g.show();d.show()}}else{if(h!=null&&h.select().length>0){var f=h.select()[0],e=h.dataItem(f);if(e.Id>0){a.options.viewModel.assetGroupSource.read()}}g.hide();d.hide()}}});return b};function DamRoleGroupsManager(b){var c=this,a=new ControlLoader();$.extend(true,c.options,c.baseOptions,b);a.loadTemplate("DamRoleGroupsManager",function(d){$(document.body).append(d);c.setupTemplate();c.setupEventListeners();c.initialize()})}DamRoleGroupsManager.prototype.options={};DamRoleGroupsManager.prototype.baseOptions={assetRoleId:0,title:"",templateLoaded:false,templates:{baseTemplate:"#_DamRoleGroupsManagerBaseTemplate"}};DamRoleGroupsManager.prototype.searchCriteria={};DamRoleGroupsManager.prototype.getElement=function(){var a=this;return $("*[data-argosy-uuid="+a.options.uuid+"]")};DamRoleGroupsManager.prototype.setupEventListeners=function(){var a=this};DamRoleGroupsManager.prototype.setupTemplate=function(){var a=this;if(!a.options.templateLoaded){a.getElement().append($(a.options.templates.baseTemplate).html());a.options.templateLoaded=true}};DamRoleGroupsManager.prototype.initialize=function(){var c=this;var b=function(d){};var a={dataSource:c.getDataSource(),groupable:false,sortable:true,scrollable:false,exportToExcel:false,rows:10,pageable:{refresh:false,pageSizes:false,buttonCount:1},columns:[{title:"Group",field:"GroupName",width:"80%"},{command:{text:"Remove",click:b},title:" ",width:"20%"}],title:"User Groups",toolbar:[{text:"Add User Group"}]};c.getElement().find("*[data-role=collapsegrid]").kendoCollapseGrid(a)};DamRoleGroupsManager.prototype.dataSourceOpts={};DamRoleGroupsManager.prototype.getDataSource=function(){var a=this;$.extend(true,a.dataSourceOpts,_defaultDataSourceConfig,{});a.dataSourceOpts.transport={read:function(b){var c={IsActive:true,AssetRoleId:a.options.assetRoleId};$.extend(true,c,kendoOptionsToObject(b),a.searchCriteria);$.ajax({url:"/DataView/GetUserGroups",dataType:"json",data:c,success:function(d){if(d.ReturnCode===ReturnCode.Failed){handleDataSourceException(d)}else{b.success(d)}}})}};a.dataSourceOpts.pageSize=10;a.dataSourceOpts.serverFiltering=true;return a.dataSourceOpts};function DamRoleUsersManager(b){var c=this,a=new ControlLoader();$.extend(true,c.options,c.baseOptions,b);a.loadTemplate("DamRoleUsersManager",function(d){$(document.body).append(d);c.setupTemplate();c.setupEventListeners();c.initialize()})}DamRoleUsersManager.prototype.options={};DamRoleUsersManager.prototype.baseOptions={assetRoleId:0,title:"",templateLoaded:false,templates:{baseTemplate:"#_DamUserRoleManagerBaseTemplate"}};DamRoleUsersManager.prototype.searchCriteria={};DamRoleUsersManager.prototype.getElement=function(){var a=this;return $("*[data-argosy-uuid="+a.options.uuid+"]")};DamRoleUsersManager.prototype.setupEventListeners=function(){var a=this};DamRoleUsersManager.prototype.setupTemplate=function(){var a=this;if(!a.options.templateLoaded){a.getElement().append($(a.options.templates.baseTemplate).html());a.options.templateLoaded=true}};DamRoleUsersManager.prototype.initialize=function(){var c=this;var b=function(d){};var a={dataSource:c.getDataSource(),groupable:false,sortable:true,scrollable:false,exportToExcel:false,rows:10,pageable:{refresh:false,pageSizes:false,buttonCount:1},pageSize:10,columns:[{title:"User",field:"Username",width:"40%"},{title:"Name",field:"FullName",width:"40%"},{command:{text:"Remove",click:b},title:" ",width:"20%"}],title:"Users",toolbar:[{text:"Add User"}]};c.getElement().find("*[data-role=collapsegrid]").kendoCollapseGrid(a)};DamRoleUsersManager.prototype.dataSourceOpts={};DamRoleUsersManager.prototype.getDataSource=function(){var a=this;$.extend(true,a.dataSourceOpts,_defaultDataSourceConfig,{});a.dataSourceOpts.transport={read:function(b){var c={IsActive:true,AssetRoleId:a.options.assetRoleId};$.extend(true,c,kendoOptionsToObject(b),a.searchCriteria);$.ajax({url:"/DataView/GetUsers",dataType:"json",data:c,success:function(d){if(d.ReturnCode===ReturnCode.Failed){handleDataSourceException(d)}else{b.success(d)}}})}};a.dataSourceOpts.pageSize=10;a.dataSourceOpts.serverFiltering=true;return a.dataSourceOpts};function DamUserManagement(b){var c=this;var a=new ControlLoader();$.extend(true,c.options,c.baseOptions,b);a.loadTemplate("DamUserManagement",function(d){$(document.body).append(d);c.setupTemplate();c.setupEventListeners();c.initialize()})}DamUserManagement.prototype.options={};DamUserManagement.prototype.controlLoader=new ControlLoader();DamUserManagement.prototype.baseOptions={assetGroupId:null,directoryName:"",templateLoaded:false,directoryNameHref:"#_DamUserManagementRoleName",templates:{baseTemplate:"#_DamUserManagementBaseTemplate",addRoleModalTemplate:"#_DamUserManagementAddRole",}};DamUserManagement.prototype.searchCriteria={};DamUserManagement.prototype.getElement=function(){var a=this;return $("*[data-argosy-uuid="+a.options.uuid+"]")};DamUserManagement.prototype.setupEventListeners=function(){var a=this;$(document).bind(argosyEvents.EVENT_ADD_DAM_ROLE,function(b){a.showCreateRole()})};DamUserManagement.prototype.showCreateRole=function(){var b=this;var a=$(b.options.templates.addRoleModalTemplate).html();$.fancybox({content:a,afterShow:function(c){kendo.bind($(".fancybox-inner"),kendo.observable({createRole:function(d){b.createRole()}}))}})};DamUserManagement.prototype.createRole=function(){var d=this,f=$(".fancybox-inner"),c=f.find("input[type=text]"),e=f.find("#addRoleSysAdmin").getKendoToggleSwitch(),a=e.value(),b=c.val();$.ajax({url:"/Tools/DigitalAssets/CreateAssetRole",dataType:"json",data:{isSysAdmin:a,roleName:b},success:function(g){if(g.ReturnCode==ReturnCode.Failed){prompt.alert({question:g.Message,description:"Ref: "+g.Guid,type:"warning",yes:function(h){}})}else{d.viewModel.getRoles.read();$.fancybox.close()}}})};DamUserManagement.prototype.setupTemplate=function(){var a=this;if(!a.options.templateLoaded){a.getElement().append($(a.options.templates.baseTemplate).html());a.options.templateLoaded=true}};DamUserManagement.prototype.initialize=function(){var a=this;$(document).bind(argosyEvents.SEARCH_PAGE_GRID,function(c,b){if(b.ExcludeAssetRoleIds!=null&&b.ExcludeAssetRoleIds.length>0){a.currentAssetRoleId=JSON.parse(b.ExcludeAssetRoleIds)[0]}});a.viewModel=a.viewModel==null?a.getViewModel():a.viewModel;kendo.bind(a.getElement(),a.viewModel)};DamUserManagement.prototype.getViewModel=function(){var a=this,b=kendo.observable({currentRole:null,getRoles:new kendo.data.DataSource({transport:{read:function(c){var d={};$.extend(true,d,kendoOptionsToObject(c),a.searchCriteria);$.ajax({url:"/Tools/DigitalAssets/GetAssetRoles",dataType:"json",data:d,success:function(e){if(e.ReturnCode==ReturnCode.Failed){handleDataSourceException(e)}else{c.success(e)}}})}},schema:{data:"Records",total:"TotalRecords",model:{id:"Id"}},pageSize:20,serverPaging:true,serverFiltering:true,serverSorting:true}),getCurrentAdminStatus:function(){if(this.currentRole!=null){return this.currentRole.IsAdmin}else{return false}},showDetails:function(d){var f=$(d.currentTarget).closest("[data-role=grid]");var g=$(d.currentTarget).closest("tr");var c=g.next();this.currentRole=f.getKendoGrid().dataItem(g);f.find(".k-master-row").show();f.find(".k-detail-row").hide();g.hide();c.show();if(c.attr("data-initialized")!="true"){kendo.bind(c,this);c.attr("data-initialized",true)}else{this.getRoleGroups().read()}},hideDetails:function(d){var c=$(d.currentTarget).closest("tr");var f=c.prev();f.show();c.hide()},dataBound:function(c){$("#_DamUserManagementModals").find("[data-argosy-control]").each(function(d){a.controlLoader.processControlElement(this)})},addSelectedUsers:function(d){var f=$(d.currentTarget).closest(".fancybox-inner").find(".k-widget").getKendoGrid();var g=f.select();var c=[];$(g).each(function(e){var h=f.dataItem(this);c.push(h.UserId)});if(c.length>0){$.ajax({url:"/Tools/DigitalAssets/UpdateAssetRoleUsers",dataType:"json",data:{userIds:c,assetRoleId:a.currentAssetRoleId},success:function(e){if(e.ReturnCode==ReturnCode.Failed){handleDataSourceException(e)}else{$(document).trigger(argosyEvents.EVENT_RELOAD_ASSET_USERS,{assetRoleId:a.currentAssetRoleId})}}})}$.fancybox.close()},showUpdateRole:function(c){var f=this,d=$("#_DamUserManagementUpdateRole").html(),g=kendo.observable({data:new kendo.data.ObservableObject(c.data),updateRole:function(i){$.fancybox.close();var h=i.data.data,k=$("#updateRoleSysAdmin").data("kendoToggleSwitch"),j=k.value();h.IsSystemAdministrator=j;$(document).trigger(argosyEvents.START_LOADING,{element:$("#wrapcontainer"),message:"~{MsgDamUpdatingRole}~"});$.ajax({url:"/Tools/DigitalAssets/UpdateAssetRole",dataType:"json",type:"POST",traditional:true,contentType:"application/json; charset=utf-8",data:JSON.stringify(h),success:function(l){if(l.ReturnCode==ReturnCode.Failed){$(document).trigger(argosyEvents.END_LOADING,{element:$("#wrapcontainer")});var e={question:l.Message,type:"warning",};prompt.alert(e)}else{a.viewModel.getRoles.read();$(document).trigger(argosyEvents.END_LOADING,{element:$("#wrapcontainer")})}}})},});$.fancybox({content:d,afterShow:function(h){kendo.bind($("#_updateRole"),g);$(".focus-me").focus().select()}})},addSelectedUserGroups:function(d){var f=$(d.currentTarget).closest(".fancybox-inner").find(".k-widget").getKendoGrid();var g=f.select();var c=[];$(g).each(function(e){var h=f.dataItem(this);c.push(h.UserGroupId)});if(c.length>0){$.ajax({url:"/Tools/DigitalAssets/UpdateAssetRoleUserGroups",dataType:"json",data:{userGroupIds:c,assetRoleId:a.currentAssetRoleId},success:function(e){if(e.ReturnCode==ReturnCode.Failed){handleDataSourceException(e)}else{$(document).trigger(argosyEvents.EVENT_RELOAD_ASSET_USERGROUPS,{assetRoleId:a.currentAssetRoleId})}}})}$.fancybox.close()}});return b};function DamViewCart(b){var c=this,a=new ControlLoader();$.extend(true,c.options,c.baseOptions,b);a.loadTemplate("DamViewCart",function(d){$(document.body).append(d);c.setupEventListeners();c.init();$(document).trigger(c.EVENT_TEMPLATE_LOADED)})}DamViewCart.prototype.options={};DamViewCart.prototype.baseOptions={};DamViewCart.prototype.EVENT_TEMPLATE_LOADED="TEMPLATE_DAM_VIEW_CART_LOADED";DamViewCart.prototype.EVENT_LISTENERS_LOADED="DAM_DIRECTORY_VIEW_CART_LOADED";DamViewCart.prototype.EVENT_DATABOUND="DAM_VIEW_CART_DATABOUND";DamViewCart.prototype.dataSourceOpts={};DamViewCart.prototype.setupEventListeners=function(){};DamViewCart.prototype.init=function(){var b=this;var a=b.getElement();b.grid=a.kendoGrid({scrollable:false,editable:false,autoBind:true,dataSource:b.getDataSource({}),groupable:false,sortable:false,selectable:false,pageable:false,noRecords:true,messages:{noRecords:"There are no assets in your cart."},toolbar:[{name:"place-order",template:"<button class='btn btn-primary k-grid-place-order pull-right maru10'>~{PlaceOrder}~</button>"}],columns:[{title:" ",template:'<img class="img-border img-responsive" style="max-height: 100px;" alt="Asset" src="${Thumbnail}">',width:"150px"},{title:"~{Name}~",field:"Name"},{title:"~{Width}~",field:"Width",template:"${kendo.toString(Width, 'n0')} px",width:"10%"},{title:"~{Height}~",field:"Height",template:"${kendo.toString(Height, 'n0')} px",width:"10%"},{title:"~{DPI}~",field:"Dpi",width:"10%"},{title:" ",template:'<a data-argosy-action="removeFromAssetCart" data-argosy-id="${Id}" class="co-warning"><i class="fa fa-times-circle"></i><span class="resp-hidden"> ~{Remove}~</span></a>',width:"10%"}],dataBound:function(c){var f=c.sender.element.find("*[data-argosy-action=removeFromAssetCart]");f.click(function(g){var h=$(this).attr("data-argosy-id");b.removeFromCart(h)});var d=c.sender.element.find(".k-grid-place-order");d.unbind("click");d.click(function(g){$(document).trigger(argosyEvents.START_LOADING);$.ajax({url:"/Tools/DigitalAssets/PlaceOrder",dataType:"json",success:function(e){if(e.ReturnCode==ReturnCode.Failed){handleDataSourceException(e)}else{prompt.alert({question:"~{OrderSuccessfullyPlaced}~",description:"",type:"success",yes:function(h){window.location="/Tools/DigitalAssets/Orders"}})}},complete:function(e){$(document).trigger(argosyEvents.END_LOADING)}})});if(c.sender.element.getKendoGrid().dataItems().length>0){d.removeAttr("disabled")}else{d.attr("disabled","disabled")}}})};DamViewCart.prototype.removeFromCart=function(a){var b=this;$.ajax({url:"/tools/digitalassets/RemoveAssetFromCart",dataType:"json",method:"POST",data:{assetCartLineId:a},success:function(c){prompt.alert({question:"~{AssetRemovedFromCart}~",description:"",type:"success",yes:function(d){$.fancybox.close()}});b.getElement().getKendoGrid().dataSource.read()},error:function(c){prompt.alert({question:"~{ErrorRemovingAssetsFromCart}~",description:"Ref: "+c,type:"error",yes:function(d){$.fancybox.close()}})}})};DamViewCart.prototype.getElement=function(){var a=this;return $("*[data-argosy-uuid="+a.options.uuid+"]")};DamViewCart.prototype.getDataSource=function(a){var b=this;$.extend(true,b.dataSourceOpts,_defaultDataSourceConfig,a);b.dataSourceOpts.transport={read:function(c){var d={};$.extend(true,d,kendoOptionsToObject(c),b.searchCriteria);$.ajax({url:"/Tools/DigitalAssets/GetCart",dataType:"json",data:d,success:function(e){if(e.ReturnCode==ReturnCode.Failed){handleDataSourceException(e)}else{c.success(e)}}})}};return new kendo.data.DataSource(b.dataSourceOpts)};function DamViewOrders(b){var c=this,a=new ControlLoader();$.extend(true,c.options,c.baseOptions,b);a.loadTemplate("DamViewOrders",function(d){$(document.body).append(d);c.setupEventListeners();c.init();$(document).trigger(c.EVENT_TEMPLATE_LOADED)})}DamViewOrders.prototype.options={detailsModalHref:"#_DamViewOrderDetailsModal",buttonsTemplateHref:"#_DamViewOrderButtonsTemplate"};DamViewOrders.prototype.baseOptions={};DamViewOrders.prototype.EVENT_TEMPLATE_LOADED="TEMPLATE_DAM_VIEW_CART_LOADED";DamViewOrders.prototype.EVENT_LISTENERS_LOADED="DAM_DIRECTORY_VIEW_CART_LOADED";DamViewOrders.prototype.EVENT_DATABOUND="DAM_VIEW_CART_DATABOUND";DamViewOrders.prototype.dataSourceOpts={};DamViewOrders.prototype.setupEventListeners=function(){};DamViewOrders.prototype.init=function(){var b=this;var a=b.getElement();a.kendoArgosyGrid({scrollable:false,editable:false,autoBind:true,dataSource:b.getDataSource({}),groupable:false,sortable:false,selectable:"multiple, row",checkboxes:true,exportToExcel:false,pageable:{refresh:true,pageSizes:[50,100,200],buttonCount:3},columns:[{title:"~{DateOrdered}~",field:"OrderDate",template:"#= kendo.toString(kendo.parseDate(OrderDate, 'yyyy-MM-dd'), 'MM/dd/yyyy') #"},{title:"~{OrderNumber}~",field:"OrderNumber",template:"<a data-argosy-action='show-details-modal' data-argosy-id='${Id}'>${OrderNumber}</a>"},{title:"~{Status}~",field:"Status",},{title:"~{Expiration}~",field:"ExpirationDate",template:"#= kendo.toString(kendo.parseDate(ExpirationDate, 'yyyy-MM-dd'), 'MM/dd/yyyy') #"},{title:"<div class='textr'>~{Assets}~</div>",template:"<div class='textr'>${kendo.toString(OrderLines.length, 'n0')}</div>"},{title:"",template:$(b.options.buttonsTemplateHref).html()}],dataBound:function(f){var c=f.sender.element.find("*[data-argosy-action=show-details-modal]");c.click(function(h){var k=h.target.closest("tr");var g=b.getElement().getKendoGrid().dataItem(k);var i=$(b.options.detailsModalHref).html();var l=kendo.template(i);var j=l(g);$.fancybox({content:j});$.fancybox.wrap.find("*[data-argosy-action=download-file]").click(function(n){var m=$(this).attr("data-argosy-path");downloadFile(m,true,"")})});var d=f.sender.element.find("*[data-argosy-action=download-file]");d.click(function(h){var g=$(this).attr("data-argosy-path");downloadFile(g,true,"")});b.setAutoRefresh()}});a.getKendoGrid().dataSource.read()};DamViewOrders.prototype.setAutoRefresh=function(){var c=this;var b=false;var a=c.getElement().getKendoGrid();$(a.dataItems()).each(function(d){if(this.Status=="Processing"){b=true}});if(b){setTimeout(function(d){a.dataSource.read()},60*1000)}};DamViewOrders.prototype.getElement=function(){var a=this;return $("*[data-argosy-uuid="+a.options.uuid+"]")};DamViewOrders.prototype.getDataSource=function(a){var b=this;$.extend(true,b.dataSourceOpts,_defaultDataSourceConfig,a);b.dataSourceOpts.transport={read:function(c){var d={};$.extend(true,d,kendoOptionsToObject(c),b.searchCriteria);$.ajax({url:"/Tools/DigitalAssets/GetOrders",dataType:"json",data:c.data,success:function(e){if(e.ReturnCode==ReturnCode.Failed){handleDataSourceException(e)}else{c.success(e)}}})}};return new kendo.data.DataSource(b.dataSourceOpts)};function DashboardGridView(a){var b=this;$.extend(true,b.options,b.baseOptions,a);$(document).bind(argosyEvents.SEARCH_PAGE_GRID,function(d,c){b.refineSearch(c)});b.refineSearch()}DashboardGridView.prototype.options={};DashboardGridView.prototype.baseOptions={gridViewSelector:"div[data-argosy-view=DashboardGridView]"};DashboardGridView.prototype.searchCriteria={};DashboardGridView.prototype.refineSearch=function(a){var b=this;b.searchCriteria=a;b.setupGrid()};DashboardGridView.prototype.setupGrid=function(){var c=this;if($(c.options.gridViewSelector).getKendoListView()==null){var b={dataSource:c.getDataSource({}),template:kendo.template($("#template").html())};$(c.options.gridViewSelector).kendoListView(b)}else{var a=$(c.options.gridViewSelector).getKendoListView();a.dataSource.read();a.refresh()}};DashboardGridView.prototype.getDataSource=function(a){var b=this;$.extend(true,b.dataSourceOpts,_defaultDataSourceConfig,a);b.dataSourceOpts.pageSize=21;b.dataSourceOpts.transport={read:function(c){var d={};$.extend(true,d,kendoOptionsToObject(c),b.searchCriteria);$.ajax({url:"/DataView/GetDashboards",dataType:"json",data:d,success:function(e){if(e.ReturnCode==ReturnCode.Failed){handleDataSourceException(e)}else{c.success(e)}}})}};return new kendo.data.DataSource(b.dataSourceOpts)};DashboardGridView.prototype.dataSourceOpts={};DashboardGridView.prototype.getStatus=function(){};function DashboardReportView(b){var c=this;$.extend(true,c.options,c.baseOptions,b);var a=new ControlLoader();a.addScriptWithPath("OrderHistoryChartWidget.js","/Scripts/Dashboards/Widgets/");a.loadTemplate("DashboardReportView",function(d){$(document.body).append(d);c.loaded=true})}DashboardReportView.prototype.options={};function GlobalAccountUnitDropDown(a){var b=this;$.extend(true,b.options,b.baseOptions,a);b.refineSearch({})}GlobalAccountUnitDropDown.prototype.options={};GlobalAccountUnitDropDown.prototype.baseOptions={ddlViewSelector:"select[data-argosy-view=GlobalAccountUnitDropDown]",hiddenFieldName:null};GlobalAccountUnitDropDown.prototype.refineSearch=function(a){var b=this;b.searchCriteria=a;b.setupDropDown()};GlobalAccountUnitDropDown.prototype.setupDropDown=function(){var d=this;if($(d.options.ddlViewSelector).getKendoDropDownList()==null){var c={dataTextField:"AccountUnitDesc",dataValueField:"AccountingUnitId",optionLabel:"-- Select an Account Unit --",dataSource:d.getDataSource({}),cascade:function(f){if(d.options.hiddenFieldName!=null){$("#"+d.options.hiddenFieldName).val($(d.options.ddlViewSelector).val())}}};$(d.options.ddlViewSelector).kendoDropDownList(c);var b=$(d.options.ddlViewSelector).getKendoDropDownList();b.value(AccountingUnitId.value)}else{var a=$(d.options.ddlViewSelector).getKendoDropDownList();a.dataSource.read();a.refresh()}};GlobalAccountUnitDropDown.prototype.getDataSource=function(a){var b=this;$.extend(true,b.dataSourceOpts,_defaultDataSourceConfig,a);b.dataSourceOpts.transport={read:function(c){var d={};$.extend(true,d,kendoOptionsToObject(c),b.searchCriteria);$.ajax({url:"/DataView/GetAccountUnits",dataType:"json",data:d,success:function(e){if(e.ReturnCode==ReturnCode.Failed){handleDataSourceException(e)}else{c.success(e)}}})},pageSize:99999};return new kendo.data.DataSource(b.dataSourceOpts)};GlobalAccountUnitDropDown.prototype.dataSourceOpts={};function GlobalApprovingManagerDropDown(a){var b=this;$.extend(true,b.options,b.baseOptions,a);b.refineSearch({})}GlobalApprovingManagerDropDown.prototype.options={};GlobalApprovingManagerDropDown.prototype.baseOptions={ddlViewSelector:"select[data-argosy-view=GlobalApprovingManagerDropDown]",hiddenFieldName:null,};GlobalApprovingManagerDropDown.prototype.refineSearch=function(a){var b=this;b.searchCriteria=a;b.setupDropDown()};GlobalApprovingManagerDropDown.prototype.setupDropDown=function(){var d=this;if($(d.options.ddlViewSelector).getKendoDropDownList()==null){var c={filter:"contains",serverPaging:true,serverFiltering:true,serverSorting:false,dataTextField:"FullName",dataValueField:"UserId",optionLabel:"-- Select a Manager --",autoBind:true,suggest:true,dataSource:d.getDataSource({}),cascade:function(f){if(d.options.hiddenFieldName!=null){$("#"+d.options.hiddenFieldName).val(this.value())}}};$(d.options.ddlViewSelector).kendoDropDownList(c);var b=$(d.options.ddlViewSelector).getKendoDropDownList();b.value(d.options.approvingManagerId)}else{var a=$(d.options.ddlViewSelector).getKendoDropDownList();a.dataSource.read();a.refresh()}};GlobalApprovingManagerDropDown.prototype.getDataSource=function(a){var b=this;$.extend(true,b.dataSourceOpts,_defaultDataSourceConfig,a);b.dataSourceOpts.transport={read:function(c){var d={SelectedAccountManagerId:b.options.approvingManagerId};$.extend(true,d,kendoOptionsToObject(c),b.searchCriteria);$.ajax({url:"/DataView/GetApprovingUser",dataType:"json",data:d,success:function(e){if(e.ReturnCode===ReturnCode.Failed){handleDataSourceException(e)}else{c.success(e)}}})},};b.dataSourceOpts.pageSize=20;return new kendo.data.DataSource(b.dataSourceOpts)};GlobalApprovingManagerDropDown.prototype.dataSourceOpts={};function GlobalConsumerTypeDropDown(a){var b=this;$.extend(true,b.options,b.baseOptions,a);b.refineSearch({});$(document).bind(argosyEvents.EVENT_CONSUMER_UPDATED,function(d,c){b.refineSearch({})})}GlobalConsumerTypeDropDown.prototype.options={};GlobalConsumerTypeDropDown.prototype.baseOptions={ddlViewSelector:"select[data-argosy-view=GlobalConsumerTypeDropDown]",hiddenFieldName:null};GlobalConsumerTypeDropDown.prototype.refineSearch=function(a){var b=this;b.searchCriteria=a;b.setupDropDown()};GlobalConsumerTypeDropDown.prototype.setupDropDown=function(){var c=this;if($(c.options.ddlViewSelector).getKendoDropDownList()==null){var b={dataTextField:"ConsumerTypeDesc",dataValueField:"ConsumerTypeId",value:c.options.consumerTypeId,optionLabel:"-- Select a Type --",dataSource:c.getDataSource({}),cascade:function(d){if(c.options.hiddenFieldName!=null){var f=$(c.options.ddlViewSelector).getKendoDropDownList().value();if(f&&f.length>0){$("#"+c.options.hiddenFieldName).val(f)}else{$("#"+c.options.hiddenFieldName).val(c.options.consumerTypeId)}}}};$(c.options.ddlViewSelector).kendoDropDownList(b)}else{var a=$(c.options.ddlViewSelector).getKendoDropDownList();a.dataSource.read();a.refresh()}};GlobalConsumerTypeDropDown.prototype.getDataSource=function(a){var b=this;$.extend(true,b.dataSourceOpts,_defaultDataSourceConfig,a);b.dataSourceOpts.transport={read:function(c){var d={};$.extend(true,d,kendoOptionsToObject(c),b.searchCriteria);$.ajax({url:"/DataView/GetConsumerTypes",dataType:"json",data:d,success:function(e){if(e.ReturnCode==ReturnCode.Failed){handleDataSourceException(e)}else{c.success(e)}}})},pageSize:99999};return new kendo.data.DataSource(b.dataSourceOpts)};GlobalConsumerTypeDropDown.prototype.dataSourceOpts={};function GlobalFormsDataStructView(b){var c=this;$.extend(true,c.options,c.baseOptions,b);var a=new ControlLoader();c.setupEventListeners();a.loadTemplate("GlobalFormsDataStructView",function(d){$(document.body).append(d);c.initialize();$(document).trigger(c.EVENT_TEMPLATE_LOADED)})}GlobalFormsDataStructView.prototype.EVENT_TEMPLATE_LOADED="TEMPLATE_GLOBAL_FORMS_DATA_STRUCT_LOADED";GlobalFormsDataStructView.prototype.setupEventListeners=function(){var a=this;$(document).one(a.EVENT_TEMPLATE_LOADED,function(){a.refineSearch({})})};GlobalFormsDataStructView.prototype.options={};GlobalFormsDataStructView.prototype.initialize=function(){var c=this;$(c.options.menuTemplateHref).html($(c.options.menuTemplate).html());var a=c.getDataSource();var b=kendo.observable({categories:new kendo.data.ObservableArray(a),menuClicked:function(f){var d=f.data;$(".gfsContainer").hide();$("#container_"+d.GlobalFormStructId).show()}});kendo.bind($(c.options.menuBindSection),b)};GlobalFormsDataStructView.prototype.baseOptions={globalFormsDataStructView:"div[data-argosy-control=GlobalFormsDataStructView]",listViewTemplate:"#_gfsTemplate",gridRowTemplate:"#_rowTemplate",menuTemplateHref:"#_GlobalFormsNavigationMenu",menuTemplate:"#_gfsMenuTemplate",menuBindSection:"#_gfsMenuBindContainer",categoryDataSource:null,categories:[]};GlobalFormsDataStructView.prototype.refineSearch=function(a){var b=this;b.searchCriteria=a;b.setupList()};GlobalFormsDataStructView.prototype.setupList=function(){var c=this;if($(c.options.globalFormsDataStructView).getKendoListView()==null){var b={scrollable:false,editable:false,autoBind:true,dataSource:c.getDataSource(),groupable:false,sortable:false,exportToExcel:false,template:kendo.template($(c.options.listViewTemplate).html()),dataBound:function(f){var d=1,h=0,g=false;if(f.sender.dataSource._data.length<=1){$(c.options.menuTemplateHref).hide()}else{$(c.options.menuTemplateHref).show()}$(".k-grid",this.element).each(function(){var i=$(this),e=i.data("id"),j=i.data("form");if(d===1){d++;h=j}i.kendoGrid({dataSource:c.getGridDataSource({},e),scrollable:false,sortable:false,pageable:false,rowTemplate:kendo.template($(c.options.gridRowTemplate).html()),dataBound:function(k){var l=this;l.tbody.find(">tr").each(function(){var m=l.dataItem(this);kendo.bind(this,m)});if(h>0&&g===false){g=true;$("#container_"+h).show()}$(".loading-"+j).hide()}})})}};$(c.options.globalFormsDataStructView).kendoListView(b)}else{var a=$(c.options.globalFormsDataStructView).getKendoListView();a.dataSource.read();a.refresh()}};GlobalFormsDataStructView.prototype.getDataSource=function(a){var b=this;return window[b.options.categoryDataSource]};GlobalFormsDataStructView.prototype.getGridDataSource=function(b,a){var c=this;$.extend(true,c.dataSourceOpts,_defaultDataSourceConfig,b);c.dataSourceOpts.transport={read:function(d){var e={globalFormsId:c.options.globalFormsId,globalFormsProfileId:c.options.id,category:a};$.extend(true,e,kendoOptionsToObject(d),c.searchCriteria);$.ajax({url:"/DataView/GetGlobalFormsStructAndData",dataType:"json",data:e,success:function(f){if(f.ReturnCode==ReturnCode.Failed){handleDataSourceException(f)}else{d.success(f)}}})}};c.dataSourceOpts.pageSize=1000;return new kendo.data.DataSource(c.dataSourceOpts)};GlobalFormsDataStructView.prototype.dataSourceOpts={};GlobalFormsDataStructView.prototype.saveGlobalProfileDetails=function(){var b=this;var a={globalFormsData:b.getGlobalFormaDataValuesFromUi()};block(null,"~{MsgSavingProfile}~");$.ajax({url:"/DataView/UpdateGlobalFormsStructData",dataType:"json",contentType:"application/json; charset=utf-8",data:JSON.stringify(a),method:"POST",success:function(d){if(d.ReturnCode===ReturnCode.Success){var c=$(b.options.globalFormsDataStructView).getKendoListView();c.dataSource.read();c.refresh()}else{prompt.alert({question:d.Message,description:"Ref: "+d.Guid,type:"warning",yes:function(f){$.fancybox.close()}})}unblock()}});return false};GlobalFormsDataStructView.prototype.getGlobalFormaDataValuesFromUi=function(){var b=this;var a=[];$(".k-grid").each(function(){var c=$(this);var d=c.getKendoGrid();if(d!=null){d.tbody.find(">tr").each(function(){var g=d.dataItem(this);var j=new Object();j.GlobalFormDataId=g.GlobalFormsDataId;j.GlobalFormStructId=g.GlobalFormStructId;j.GlobalFormsProfileId=g.GlobalFormsProfileId;j.DataSource=null;var f=(g.ControlType!=null&&g.ControlType!="")?g.ControlType.toUpperCase():"";switch(f){case"TEXTAREA":var l=$("#struct_"+g.GlobalFormStructId);j.Value=l.val();break;case"CALENDAR":var e=$("#struct_"+g.GlobalFormStructId).getKendoDateTimePicker();j.Value=e.value();break;case"TEXTBOX":var m;if(g.Mask!=null&&g.Mask.ControlType!="NumericTextBox"){m=$("#struct_"+g.GlobalFormStructId).getKendoMaskedTextBox();j.Value=m.value()}else{if(g.Mask!=null&&g.Mask.ControlType=="NumericTextBox"){m=$("#struct_"+g.GlobalFormStructId).getKendoNumericTextBox();j.Value=m.value()}else{m=$("#struct_"+g.GlobalFormStructId);j.Value=m.val()}}break;case"IMAGEUPLOAD":var k=$("#struct_"+g.GlobalFormStructId).getKendoImageEditor();if(k!=null){j.Value=k.value()}else{j.Value=""}break;case"IMAGEBANK":j.Value=qualifyURL($("#struct_"+g.GlobalFormStructId).val());j.DataSource=$("#struct_"+g.GlobalFormStructId+"_dataSource").val();break;case"DROPDOWNLIST":var i=$("#struct_"+g.GlobalFormStructId).getKendoDropDownList();j.Value=i.value();break;default:var h;if(g.Mask!=null&&g.Mask.ControlType!="NumericTextBox"){h=$("#struct_"+g.GlobalFormStructId).getKendoMaskedTextBox();j.Value=h.value()}else{if(g.Mask!=null&&g.Mask.ControlType=="NumericTextBox"){h=$("#struct_"+g.GlobalFormStructId).getKendoNumericTextBox();j.Value=h.value()}else{h=$("#struct_"+g.GlobalFormStructId);j.Value=h.val()}}break}if(j.GlobalFormsStructId==1311){}if(j.GlobalFormsProfileId!=null){a.push(j)}})}});return a};function GlobalMultiUpload(b){var c=this;$.extend(true,c.options,c.baseOptions,b);c.files=new Array();var a=new ControlLoader();a.loadTemplate("DamFileUpload",function(d){$(document.body).append(d);c.init();c.setupEventListers();$(document).trigger(c.EVENT_TEMPLATE_LOADED)})}GlobalMultiUpload.prototype.options={};GlobalMultiUpload.prototype.baseOptions={finalUploadEvent:argosyEvents.EVENT_GLOBAL_MULTI_UPLOAD_COMPLETE,showUploadEvent:argosyEvents.EVENT_SHOW_GLOBAL_MULTI_UPLOAD};GlobalMultiUpload.prototype.EVENT_TEMPLATE_LOADED="TEMPLATE_DAM_FILE_UPLOAD_LOADED";GlobalMultiUpload.prototype.EVENT_DATABOUND="EVENT_DAM_FILE_UPLOAD_DATABOUND";GlobalMultiUpload.prototype.setupEventListers=function(){var a=this;$(document).bind(a.options.showUploadEvent,function(b){$.fancybox({href:"#GlobalMultiUpload",beforeClose:function(c){a.getElement().find("table tbody.files").empty()}})})};GlobalMultiUpload.prototype.init=function(){var c=this;var b=$("#upload-template-form").html();c.fileCounter=0;var a=true;c.getElement().append(b);c.getElement().fileupload({method:"POST",autoUpload:true,url:"/UploadHandler.ashx?ValidationKey="+validationKey,maxChunkSize:5000000,change:function(d){$.fancybox.update();$.fancybox.reposition()},submit:function(f,d){c.fileCounter++},fail:function(f,d){c.fileCounter--;if(c.fileCounter==0){$.fancybox.close()}},done:function(f,d){if(f.type=="fileuploaddone"){c.files.push(d.files[0].name);c.fileCounter--}if(c.fileCounter==0&&!a){$(document).trigger(c.options.finalUploadEvent,{files:c.files});prompt.notify("Your files have been uploaded.")}if(a){a=false}}});c.getElement().fileupload("option","redirect",window.location.href.replace(/\/[^\/]*$/,"/cors/result.html?%s"));c.getElement().addClass("fileupload-processing");$.ajax({method:"POST",url:c.getElement().fileupload("option","url"),dataType:"json",context:c.getElement()[0]}).always(function(){$(this).removeClass("fileupload-processing")}).done(function(d){$(this).fileupload("option","done").call(this,$.Event("done"),{result:d})})};GlobalMultiUpload.prototype.getElement=function(){var a=this;return $("*[data-argosy-uuid="+a.options.uuid+"]")};function GlobalPartCategorySelect(a){var b=this;$.extend(true,b.options,b.baseOptions,a);b.search();$(document).bind(argosyEvents.SEARCH_PAGE_GRID,function(d,c){b.refineSearch(c)})}GlobalPartCategorySelect.prototype.options={};GlobalPartCategorySelect.prototype.baseOptions={gridViewSelector:"div[data-argosy-view=GlobalPartCategorySelect]",};GlobalPartCategorySelect.prototype.searchCriteria={Sku:null};GlobalPartCategorySelect.prototype.refineSearch=function(a){var c=this;c.searchCriteria=a;var b=$(c.options.gridViewSelector).getKendoGrid();b.dataSource.read();b.refresh()};GlobalPartCategorySelect.prototype.search=function(){var c=this;if($(c.options.gridViewSelector).getKendoGrid()==null){var b={scrollable:false,editable:false,autoBind:false,dataSource:c.getDataSource({}),groupable:false,sortable:true,selectable:true,pageable:{refresh:true,buttonCount:5},columns:[{title:"Category Name",field:"GroupName"},{title:"Description",field:"GroupDescrip"}],checkboxes:true,dataBinding:function(d){},dataBound:function(d){},toolbar:[],search:[{name:"Keyword",type:"text",placeholder:"Search by Category Name or Description",toolbar:true}],};$(c.options.gridViewSelector).kendoArgosyGrid(b)}else{var a=$(c.options.gridViewSelector).getKendoGrid();a.dataSource.read();a.refresh()}};GlobalPartCategorySelect.prototype.getSelectedRecords=function(){var c=this;var b=[];var a=$(c.options.gridViewSelector).getKendoGrid();$(a.select()).each(function(d){b.push(a.dataItem(this))});return b};GlobalPartCategorySelect.prototype.getDataSource=function(a){var b=this;$.extend(true,b.dataSourceOpts,_defaultDataSourceConfig,a);b.dataSourceOpts.pageSize=10;b.dataSourceOpts.transport={read:function(c){var d={};$.extend(true,d,kendoOptionsToObject(c),b.searchCriteria);$.ajax({url:"/DataView/GetPartCategories",dataType:"json",data:d,success:function(e){if(e.ReturnCode==ReturnCode.Failed){handleDataSourceException(e)}else{c.success(e)}}})}};return new kendo.data.DataSource(b.dataSourceOpts)};GlobalPartCategorySelect.prototype.dataSourceOpts={};function GlobalProfilesGridView(a){var b=this;$.extend(true,b.options,b.baseOptions,a);$(document).bind(argosyEvents.SEARCH_PAGE_GRID,function(d,c){b.refineSearch(c)});b.refineSearch({})}GlobalProfilesGridView.prototype.options={};GlobalProfilesGridView.prototype.baseOptions={gridViewSelector:"div[data-argosy-view=GlobalProfilesGridView]",adminGridView:false,customGlobalFormsId:0,customProfileUrl:"",};GlobalProfilesGridView.prototype.searchCriteria={Username:null};GlobalProfilesGridView.prototype.refineSearch=function(a){var b=this;b.searchCriteria=a;b.setupGrid()};GlobalProfilesGridView.prototype.setupGrid=function(){var c=this;if($(c.options.gridViewSelector).getKendoGrid()==null){var b={scrollable:false,editable:false,autoBind:true,dataSource:c.getDataSource({}),groupable:false,sortable:true,selectable:"multiple, row",pageable:{refresh:true,pageSizes:[50,100,500],buttonCount:5},columns:[{title:"~{ProfileName}~",field:"Name",template:"#if(GlobalFormsId =="+c.options.customGlobalFormsId+"){#<a href='"+(c.options.adminGridView?String(c.options.customProfileUrl).replace("account","admin"):c.options.customProfileUrl)+"/${Id}'>${Name}</a> #}else{# <a href='/"+(c.options.adminGridView?"Admin":"Account")+"/GlobalProfiles/Edit/${Id}'>${Name}</a> #}#",},{title:"~{FormName}~",field:"GlobalFormName",},{title:"~{LastModified}~",field:"DateModified",template:'${kendo.toString(kendo.parseDate(DateModified),"MM/dd/yyyy")}'},{title:"~{Status}~",field:"IsActive",template:"#if (IsActive == true) {#<b>Active</b>#} else {# In-Active #}#"}],dataBound:function(g){var h=g.sender,i=$(h.element);var d=i.find(".k-button.k-button-icontext.k-grid-activate");var f=i.find(".k-button.k-button-icontext.k-grid-deactivate");d.unbind("click");f.unbind("click");d.click(function(e){c.showUpdateProfileModal(c.getSelectedRecords(),true)});f.click(function(e){c.showUpdateProfileModal(c.getSelectedRecords(),false)});$("div[data-argosy-view=GlobalProfilesGridView] th:eq(3) ,div[data-argosy-view=GlobalProfilesGridView]  tr td:nth-child(4)").addClass("hidden-sm hidden-xs")},toolbar:[{name:"deactivate",text:"<i class='fa fa-close'></i><span class='resp-hidden'> ~{Deactivate}~</span>"},{name:"activate",text:"<i class='fa fa-check'></i><span class='resp-hidden'> ~{Activate}~</span>"}],checkboxes:true,search:[{name:"Keyword",type:"text",placeholder:"~{SearchByProfileFormName}~",toolbar:true},{name:"Name",type:"text",placeholder:"~{ProfileName}~",toolbar:false},{name:"CompanyUserGroupId",type:"argosy","data-argosy-control":"GlobalUserGroupDropDown"},{name:"CompanyUserId",type:"select",toolbar:false,data:[{value:"",text:"All"}]},{name:"DateModifiedStart",type:"date",placeholder:"From",toolbar:false},{name:"DateModifiedEnd",type:"date",placeholder:"To",toolbar:false},{name:"IsGlobalFormsProfileActive",type:"select",toolbar:true,data:[{value:true,text:"~{Active}~",selected:true},{value:false,text:"~{Inactive}~"}]}]};$(c.options.gridViewSelector).kendoArgosyGrid(b)}else{var a=$(c.options.gridViewSelector).getKendoGrid();a.dataSource.read()}};GlobalProfilesGridView.prototype.showUpdateProfileModal=function(c,a){var d=this;var b={question:"",description:"",button:"",type:"warning",yes:function(f){d.updateProfile(c,a)}};if(a){b.question="~{WantToActivateSelection}~";b.description="~{ActiveProfilesIgnored}~";b.button="~{Activate}~"}else{b.question="~{WantToDeactivateSelection}~";b.description=" ~{InactiveProfilesIgnored}~ ";b.button="~{Deactivate}~"}prompt.alert(b)};GlobalProfilesGridView.prototype.updateProfile=function(c,a){var d=this;var b={profiles:c,activate:a};$.ajax({url:"/DataView/UpdateGlobalProfilesStatus",type:"POST",data:JSON.stringify(b),dataType:"json",traditional:true,contentType:"application/json; charset=utf-8",success:function(f){if(f.ReturnCode==ReturnCode.Success){$(f.Records).each(function(){prompt.notify({question:"Global Profile "+this.Key+" was "+(!this.Value?"":"not")+" successfully "+(a?"activated.":"deactivated."),type:(!this.Value?"success":"error")})})}else{prompt.clientResponseError(f)}var e=$(d.options.gridViewSelector).getKendoGrid();e.dataSource.read();e.refresh(true)}});$.fancybox.close()};GlobalProfilesGridView.prototype.getSelectedRecords=function(){var c=this;var b=[];var a=$(c.options.gridViewSelector).getKendoGrid();$(a.select()).each(function(d){b.push(a.dataItem(this))});return b};GlobalProfilesGridView.prototype.getDataSource=function(a){var b=this;$(document).trigger(argosyEvents.START_LOADING);$.extend(true,b.dataSourceOpts,_defaultDataSourceConfig,a);b.dataSourceOpts.transport={read:function(c){var d=b.options;$.extend(true,d,kendoOptionsToObject(c),b.searchCriteria);$.ajax({url:"/DataView/GetGlobalFormProfiles",dataType:"json",data:d,success:function(e){$(document).trigger(argosyEvents.END_LOADING);if(e.ReturnCode==ReturnCode.Failed){handleDataSourceException(e)}else{c.success(e)}}})}};return new kendo.data.DataSource(b.dataSourceOpts)};GlobalProfilesGridView.prototype.dataSourceOpts={};GlobalProfilesGridView.prototype.getStatus=function(){};function GlobalProfileUploads(a){var b=this;b.globalFormsStructId=a.globalFormsStructId;b.globalFormsProfileId=a.globalFormsProfileId;$.extend(true,b.options,b.baseOptions,a);b.element=$("*[data-argosy-uuid="+b.options.uuid+"]");b.setupGrid({});b.setupEvents()}GlobalProfileUploads.prototype.options={};GlobalProfileUploads.prototype.baseOptions={globalProfileThumbnailEvent:"EVENT_GLOBAL_PROFILE_IMAGE_UPLOADED"};GlobalProfileUploads.prototype.setupEvents=function(){var a=this;$(document).bind("EVENT_GLOBAL_PROFILE_IMAGE_UPLOADED",function(b,c){a.handleUserImageUploaded(c)})};GlobalProfileUploads.prototype.handleGlobalProfileImageUploaded=function(a){var c=this;if(a!=""&&a!=null){var b={userId:c.userId,filePath:a.uploadPath};$.ajax({url:"/DataView/UpdateGlobalProfileImage",type:"POST",data:JSON.stringify(b),dataType:"json",traditional:true,contentType:"application/json; charset=utf-8",success:function(d){if(!d.IsError){prompt.notify({question:"User profile image successfully updated.",type:("success")});$.fancybox.close()}else{prompt.clientResponseError(d.Message);$.fancybox.close()}location.reload()}})}else{prompt.notify({question:"Please select and upload global profile image",type:"error"})}};GlobalProfileUploads.prototype.setupGrid=function(){var b=this;if($(b.element).getKendoGrid()==null){var a={dataSource:[{title:"Upload "+b.options.title,globalFormsStructId:b.options.globalFormsStructId,globalFormsProfileId:b.options.globalFormsProfileId,thumbnail:b.options.thumbnail,event:"EVENT_GLOBAL_PROFILE_IMAGE_UPLOADED"}],exportToExcel:false,groupable:false,sortable:false,scrollable:false,template:'<div class="col-sm-6" data-argosy-control="GlobalUploadControl" data-argosy-options-title="${title}" data-argosy-options-global-forms-struct-id="${globalFormsStructId}" data-argosy-options-global-forms-profile-id="${globalFormsProfileId}" data-argosy-options-thumbnail="${thumbnail}" data-argosy-options-upload-success-event="${event}"></div>'};$(b.element).kendoGrid(a)}};function GlobalProfileUserGroupsGridView(a){var b=this;$.extend(true,b.options,b.baseOptions,a);b.setupGrid({})}GlobalProfileUserGroupsGridView.prototype.options={};GlobalProfileUserGroupsGridView.prototype.baseOptions={gridViewSelector:"div[data-argosy-view=GlobalProfileUserGroupsGridView]"};GlobalProfileUserGroupsGridView.prototype.searchCriteria={};GlobalProfileUserGroupsGridView.prototype.setupGrid=function(){var c=this,a=$(c.options.gridViewSelector).getKendoGrid();if(a==null){var b={dataSource:c.getDataSource({}),groupable:false,sortable:true,scrollable:false,exportToExcel:false,selectable:"multiple, row",pageable:{refresh:false,pageSizes:false,buttonCount:1},columns:[{template:"<i class='fa la fa-times'></i>",width:"10%"},{title:"~{Name}~",field:"GroupName"}],title:"~{AssignToUserGroups}~",toolbar:[{name:"addProfileUserGroups",text:" ~{Add}~","class":"fa fa-plus"}],addProfileUserGroups:function(d){$.fancybox({href:"#AddUserGroupToGlobalProfile"})},dataBinding:function(d){},dataBound:function(d){var g=$(d.sender.element);var f=g.getKendoGrid();g.find("tbody tr[role=row]").each(function(){var e=f.dataItem(this);var h=$(this).find(".fa.la.fa-times").parent();h.unbind("click").click(function(){c.showDeleteUserGroupFromProfile(e)})})}};$(c.options.gridViewSelector).kendoCollapseGrid(b)}else{a.dataSource.read()}};GlobalProfileUserGroupsGridView.prototype.showDeleteUserGroupFromProfile=function(a){var d=this;var b=false;var c={question:"",description:"",button:"",type:"warning",yes:function(f){if(!b){d.deleteUserFromProfile(a);b=true}}};c.question="Are you sure you want to remove this user group from this profile?";c.button="Remove";prompt.alert(c)};GlobalProfileUserGroupsGridView.prototype.deleteUserFromProfile=function(c){var b=this;var a={userGroup:c};$.ajax({url:"/Admin/GlobalProfiles/DeleteUserGroupFromProfile",type:"POST",data:JSON.stringify(a),dataType:"json",traditional:true,contentType:"application/json; charset=utf-8",success:function(f){if(f.ReturnCode==ReturnCode.Success){$(f.Records).each(function(){prompt.notify({question:"User Group "+this.Key+" was "+(!this.Value?"":"not")+" successfully deleted.",type:(!this.Value?"success":"error")})})}else{prompt.clientResponseError(f)}var d=$(b.options.gridViewSelector).find(".k-collapse-grid").getKendoGrid();d.dataSource.read();d.refresh(true);var e=$("div[data-argosy-view=AddUserGroupToGlobalProfile]").getKendoGrid();e.dataSource.read();e.refresh(true)}});$.fancybox.close()};GlobalProfileUserGroupsGridView.prototype.getDataSource=function(a){var b=this;$.extend(true,b.dataSourceOpts,_defaultDataSourceConfig,a);b.dataSourceOpts.pageSize=5;b.dataSourceOpts.serverPaging=true;b.dataSourceOpts.transport={read:function(c){var d=b.options;d.IsUserSearch=false;$.extend(true,d,kendoOptionsToObject(c),b.searchCriteria);$.ajax({url:"/Admin/GlobalProfiles/GetGlobalProfileUsers",dataType:"json",data:d,success:function(e){if(e.ReturnCode==ReturnCode.Failed){handleDataSourceException(e)}else{c.success(e)}}})}};b.dataSourceOpts.schema={id:"GlobalFormsUsersId",data:function(c){return c.Records},total:function(c){return c.TotalRecords}};return new kendo.data.DataSource(b.dataSourceOpts)};GlobalProfileUserGroupsGridView.prototype.dataSourceOpts={};GlobalProfileUserGroupsGridView.prototype.addUserGroupsToProfile=function(){var c=this;var b=c.getSelectedUserGroups();if(b.length>0){var a={globalFormsProfileId:$("#Id").val(),userGroupIds:b};$.ajax({url:"/Admin/GlobalProfiles/AddUserGroupsToGlobalProfile",type:"POST",data:JSON.stringify(a),dataType:"json",traditional:true,contentType:"application/json; charset=utf-8",success:function(f){if(f.ReturnCode==ReturnCode.Success){prompt.notify({question:"User Groups were "+(!this.Value?"":"not")+" successfully added to the Profile.",type:(!this.Value?"success":"error")})}else{prompt.clientResponseError(f)}var d=$("div[data-argosy-view=GlobalProfileUserGroupsGridView]").find(".k-collapse-grid").getKendoGrid();d.dataSource.read();d.refresh(true);var e=$("div[data-argosy-view=AddUserGroupToGlobalProfile]").getKendoGrid();e.dataSource.read();e.refresh(true)}})}else{prompt.notify({question:"No items selected.",type:"error"})}$.fancybox.close()};GlobalProfileUserGroupsGridView.prototype.getSelectedUserGroups=function(){var c=this;var b=[];var a=$("div[data-argosy-view=AddUserGroupToGlobalProfile]").getKendoGrid();$(a.select()).each(function(d){b.push(a.dataItem(this).UserGroupId)});return b};function GlobalProfileUsersGridView(a){var b=this;$.extend(true,b.options,b.baseOptions,a);b.setupGrid({})}GlobalProfileUsersGridView.prototype.options={};GlobalProfileUsersGridView.prototype.baseOptions={gridViewSelector:"div[data-argosy-view=GlobalProfileUsersGridView]",};GlobalProfileUsersGridView.prototype.searchCriteria={};GlobalProfileUsersGridView.prototype.setupGrid=function(){var c=this,a=$(c.options.gridViewSelector).getKendoGrid();if(a==null){var b={dataSource:c.getDataSource({}),groupable:false,sortable:true,scrollable:false,exportToExcel:false,selectable:"multiple, row",pageable:{refresh:false,pageSizes:false,buttonCount:1},columns:[{template:"<i class='fa la fa-times'></i>",width:"10%"},{title:"~{UserName}~",field:"UserName",width:"40%"},{title:"~{FullName}~",template:"${FirstName} ${LastName}",width:"40%"}],title:"~{AssignToUsers}~",toolbar:[{name:"addProfileUsers",text:" ~{Add}~","class":"fa fa-plus"}],addProfileUsers:function(d){$.fancybox({href:"#AddUserToGlobalProfile"})},dataBinding:function(d){},dataBound:function(d){var g=$(d.sender.element);var f=g.getKendoGrid();g.find("tbody tr[role=row]").each(function(){var e=f.dataItem(this);var h=$(this).find(".fa.la.fa-times").parent();h.unbind("click").click(function(){c.showDeleteUserFromProfile(e)})})}};$(c.options.gridViewSelector).kendoCollapseGrid(b)}else{a.dataSource.read()}};GlobalProfileUsersGridView.prototype.showDeleteUserFromProfile=function(a){var d=this;var b=false;var c={question:"",description:"",button:"",type:"warning",yes:function(f){if(!b){d.deleteUserFromProfile(a);b=true}}};c.question="Are you sure you want to remove this user from this profile?";c.button="Remove";prompt.alert(c)};GlobalProfileUsersGridView.prototype.deleteUserFromProfile=function(c){var b=this;var a={user:c};$.ajax({url:"/Admin/GlobalProfiles/DeleteUserFromProfile",type:"POST",data:JSON.stringify(a),dataType:"json",traditional:true,contentType:"application/json; charset=utf-8",success:function(f){if(f.ReturnCode==ReturnCode.Success){$(f.Records).each(function(){prompt.notify({question:"User "+this.Key+" was "+(!this.Value?"":"not")+" successfully deleted.",type:(!this.Value?"success":"error")})})}else{prompt.clientResponseError(f)}var d=$(b.options.gridViewSelector).find(".k-collapse-grid").getKendoGrid();d.dataSource.read();var e=$("div[data-argosy-view=AddUserToGlobalProfile]").getKendoGrid();e.dataSource.read()}});$.fancybox.close();return false};GlobalProfileUsersGridView.prototype.getDataSource=function(a){var b=this;$.extend(true,b.dataSourceOpts,_defaultDataSourceConfig,a);b.dataSourceOpts.pageSize=5;b.dataSourceOpts.serverPaging=true;b.dataSourceOpts.transport={read:function(c){var d=b.options;d.IsUserSearch=true;$.extend(true,d,kendoOptionsToObject(c),b.searchCriteria);$.ajax({url:"/Admin/GlobalProfiles/GetGlobalProfileUsers",dataType:"json",data:d,success:function(e){if(e.ReturnCode==ReturnCode.Failed){handleDataSourceException(e)}else{c.success(e)}}})}};b.dataSourceOpts.schema={id:"GlobalFormsUsersId",data:function(c){return c.Records},total:function(c){return c.TotalRecords}};return new kendo.data.DataSource(b.dataSourceOpts)};GlobalProfileUsersGridView.prototype.dataSourceOpts={};GlobalProfileUsersGridView.prototype.addUsersToProfile=function(){var c=this;var b=c.getSelectedUsers();if(b.length>0){var a={globalFormsProfileId:$("#Id").val(),userIds:b};$.ajax({url:"/Admin/GlobalProfiles/AddUsersToGlobalProfile",type:"POST",data:JSON.stringify(a),dataType:"json",traditional:true,contentType:"application/json; charset=utf-8",success:function(f){if(f.ReturnCode==ReturnCode.Success){prompt.notify({question:"Users were "+(!this.Value?"":"not")+" successfully added to the Profile.",type:(!this.Value?"success":"error")})}else{prompt.clientResponseError(f)}var d=$("div[data-argosy-view=GlobalProfileUsersGridView]").find(".k-collapse-grid").getKendoGrid();d.dataSource.read();d.refresh(true);var e=$("div[data-argosy-view=AddUserToGlobalProfile]").getKendoGrid();e.dataSource.read();e.refresh(true)}})}else{prompt.notify({question:"No items selected.",type:"error"})}$.fancybox.close()};GlobalProfileUsersGridView.prototype.getSelectedUsers=function(){var c=this;var b=[];var a=$("div[data-argosy-view=AddUserToGlobalProfile]").getKendoGrid();$(a.select()).each(function(d){b.push(a.dataItem(this).UserId)});return b};var GlobalUploadControl=(getFunctions=function(){return{configureControl:function(a){this.options={};this.baseOptions={acceptedFormats:".pdf,.eps,.jpg,.tif,.tiff,.gif,.png",thumbnail:null,title:null,description:"You will be allowed to crop and resize after you upload a file.",allowCrop:true,allowResize:true,onUploadComplete:function(b){},maxFileSize:1024*1024*1024,uploadSuccessEvent:"EVENT_UPLOAD_SUCCESS",uploadFailedEvent:"EVENT_UPLOAD_FAILED"};this.fileTypes=[{extension:".tif",text:"PC or Mac TIFF files"},{extension:".pdf",text:"Adobe PDF"},{extension:".eps",text:"Composite Postscript files"},{extension:".jpg",text:"JPEG image"},{extension:".tiff",text:"PC or Mac TIFF files"},{extension:".gif",text:"GIF image"},{extension:".png",text:"PNG image"}];this.options.uploadSuccessEvent=a.uuid+this.options.uploadSuccessEvent;this.options.uploadFailedEvent=a.uuid+this.options.uploadFailedEvent;$.extend(true,this.options,this.baseOptions,a);this.element=$("*[data-argosy-uuid="+this.options.uuid+"]")},buildUploadControl:function(){var b=this;b.element.append(b.buildVisibleControl());b.element.append(b.buildModalControl());b.uploader=new ChunkedUploader("*[data-argosy-uuid="+b.options.uuid+"] .chunked-uploader",b.getAccceptedFormatsString(),b.options.maxFileSize,false);b.uploader.EVENT_FILE_SUCCESS=b.options.uploadSuccessEvent;b.uploader.EVENT_FILE_FAIL=b.options.uploadFailedEvent;$(b.uploader).bind(b.options.uploadSuccessEvent,function(c,d){$(".global-upload-continue-button").show()});$(b.uploader).bind(b.options.uploadFailedEvent,function(c,d){$(".global-upload-continue-button").hide()});var a=b.element.find(".fa-cloud-upload").closest("a");a.unbind("click");a.click(function(c){$.fancybox({href:"#"+b.options.uuid+"-modal",afterShow:function(d){$(".fancybox-inner").find(".col-sm-6").css("min-height",$(".fancybox-inner").find(".col-sm-4").height()+"px")},beforeShow:function(d){b.uploader.clearFiles();var e=$(".fancybox-inner").find(".global-upload-continue-button");e.hide();e.unbind("click");e.click(function(f){$(document).trigger(b.options.uploadSuccessEvent,b.uploader.getFiles())})}})});b.element.find("img").css("max-width","215px")},buildVisibleControl:function(){var a=this;var d=$("<div class='w100'/>");var c=a.options.title==null?"Upload Image":a.options.title;d.append('<a><i title="'+c+'" class="fa fa-cloud-upload"></i> '+c+"</a>");var b=a.options.thumbnail!=null?a.options.thumbnail:"";d.append('<img class="information img-responsive" src="'+b+'" alt="">');return d},buildModalControl:function(){var c=this;var b=$("<div />",{"class":"hide modalUploadControl",id:c.options.uuid+"-modal"});var a=$("<div />",{"class":"w100 row"});b.append($("<h3>"+c.options.title+"</h3>"));b.append($("<p class='padb10'>"+c.options.description+"</p>"));a.append(c.buildModalThumbnailControl());a.append(c.buildModalUploadControl());a.append(c.buildModalAllowedTypesControl());b.append(a);return b},buildModalUploadControl:function(){var a=this;var b=$("<div>",{"class":"chunked-uploader col-sm-6 padl10"});return b},buildModalAllowedTypesControl:function(){var b=this;var a=$("<div>",{"class":"col-sm-4 padl10"});a.append("<p><b>Allowed File Formats</b></p>");$(b.getAllowedFormats()).each(function(d){var c=b.getFormatInfo(this);a.append("<p>(*"+c.extension+") - "+c.text+"</p>")});a.append($('<div class="hide bottom-right clear pull-right global-upload-continue-button"><a class="btn btn-default">Continue</a></div>'));return a},buildModalThumbnailControl:function(){var a=this;var b=$("<div>",{"class":"padr10 col-sm-2"});b.append('<p class="small_txt">Current Image:</p>');var c=a.options.thumbnail!=null?a.options.thumbnail:"";b.append('<img class="information img-responsive padb10" title="Enlarge Image" src="'+c+'" />');return b},getFormatInfo:function(a){var b=this;var c={extension:a,text:"No information found."};$(b.fileTypes).each(function(d){if(this.extension==a){c=this}});return c},getAllowedFormats:function(){var a=this;if($.type(a.options.acceptedFormats)==="string"){return a.options.acceptedFormats.split(",")}else{if($.isArray(a.options.acceptedFormats)){return a.options.acceptedFormats}}return[]},getAccceptedFormatsString:function(){var a=this;if($.type(a.options.acceptedFormats)==="string"){return a.options.acceptedFormats}else{if($.isArray(a.options.acceptedFormats)){return a.options.acceptedFormats.join()}}return""}}},function(a){this.fn=getFunctions();this.fn.configureControl(a);this.fn.buildUploadControl()});function GlobalUserDropDown(a){var b=this;$.extend(true,b.options,b.baseOptions,a);b.element=$("*[data-argosy-uuid="+b.options.uuid+"]");b.searchCriteria.Active="Y";b.setupEventListeners();b.refineSearch({});$(document).bind(argosyEvents.USER_GROUP_CHANGE,function(d,c){b.searchCriteria.UserGroup=c;if(b.searchCriteria.UserGroup!=null||b.searchCriteria.UserGroup!=""){b.searchCriteria.Active="Y";b.refineSearch(b.searchCriteria)}})}GlobalUserDropDown.prototype.options={};GlobalUserDropDown.prototype.searchCriteria={};GlobalUserDropDown.prototype.baseOptions={ddlViewSelector:"select[data-argosy-view=GlobalUserDropDown]",selectedCompanyId:0,selectedSiteId:0,hiddenFieldName:null,recordSizeCategory:0};GlobalUserDropDown.prototype.setupEventListeners=function(){var a=this;$(document).bind(argosyEvents.CLEAR_SELECTED_USER,function(c){var b=$(a.options.ddlViewSelector).getKendoDropDownList();if(b!=null){b.select(0)}if(a.options.hiddenFieldName!=null){$("#"+a.options.hiddenFieldName).val(0)}})};GlobalUserDropDown.prototype.refineSearch=function(a){var b=this;b.searchCriteria=a;b.setupDropDown()};GlobalUserDropDown.prototype.createDropDownList=function(){var a=this;if($(a.options.ddlViewSelector).length==0){a.element.append("<select data-argosy-view='GlobalUserDropDown' />")}};GlobalUserDropDown.prototype.setCompanyId=function(a){var b=this;b.options.selectedCompanyId=a};GlobalUserDropDown.prototype.setSiteId=function(a){var b=this;b.options.selectedSiteId=a};GlobalUserDropDown.prototype.setupDropDown=function(){var c=this;c.createDropDownList();if($(c.options.ddlViewSelector).getKendoDropDownList()==null){var b={filter:"contains",serverPaging:false,serverSorting:false,dataTextField:"FullName",dataValueField:"UserId",optionLabel:"-- ~{SelectUser}~ --",autoBind:false,minLength:3,dataSource:c.getDataSource({}),change:function(d){var f=this.select();if(f&&f>0){$(document).trigger(argosyEvents.SELECTED_USER,this.dataItem())}},cascade:function(d){if(c.options.hiddenFieldName!=null){$("#"+c.options.hiddenFieldName).val($(c.options.ddlViewSelector).val())}}};$(c.options.ddlViewSelector).kendoDropDownList(b)}else{var a=$(c.options.ddlViewSelector).getKendoDropDownList();a.dataSource.read();a.refresh()}};GlobalUserDropDown.prototype.getDataSource=function(a){var b=this;$.extend(true,b.dataSourceOpts,_defaultDataSourceConfig,a);b.dataSourceOpts.transport={read:function(c){var d={IsActive:true,CompanyId:b.options.selectedCompanyId,SiteId:b.options.selectedSiteId,RecordSizeCategory:b.options.recordSizeCategory};$.extend(true,d,kendoOptionsToObject(c),b.searchCriteria);$.ajax({url:"/DataView/GetUsersForDropDownList",dataType:"json",data:d,success:function(e){if(e.ReturnCode==ReturnCode.Failed){handleDataSourceException(e)}else{c.success(e)}}})},};b.dataSourceOpts.serverFiltering=true;return new kendo.data.DataSource(b.dataSourceOpts)};GlobalUserDropDown.prototype.dataSourceOpts={};function GlobalUserGroupDropDown(a){var b=this;$.extend(true,b.options,b.baseOptions,a);b.element=$("*[data-argosy-uuid="+b.options.uuid+"]");b.refineSearch({})}GlobalUserGroupDropDown.prototype.options={};GlobalUserGroupDropDown.prototype.baseOptions={ddlViewSelector:"select[data-argosy-view=GlobalUserGroupDropDown]",hiddenFieldName:null,userGroupId:null,companyId:0,showOnlyPublicOptions:false,isRequired:false,labelRename:"User Group"};GlobalUserGroupDropDown.prototype.refineSearch=function(a){var b=this;b.searchCriteria=a;b.setupDropDown()};GlobalUserGroupDropDown.prototype.createDropDownList=function(){var a=this;if($(a.options.ddlViewSelector).length===0){a.element.append("<select required = 'required' data-argosy-view='GlobalUserGroupDropDown' />")}};GlobalUserGroupDropDown.prototype.setupDropDown=function(){var c=this;c.createDropDownList();if($(c.options.ddlViewSelector).getKendoDropDownList()==null){var b={filter:"contains",serverPaging:false,serverSorting:false,dataTextField:"GroupName",dataValueField:"UserGroupId",optionLabel:"- ~{SelectA}~ "+c.options.labelRename+" -",autoBind:true,value:c.options.userGroupId,dataSource:c.getDataSource({}),cascade:function(d){if(c.options.hiddenFieldName!=null){$("#"+c.options.hiddenFieldName).val(this.value())}$(document).trigger(argosyEvents.USER_GROUP_CHANGE,this.value())}};$(c.options.ddlViewSelector).kendoDropDownList(b);var a=$(c.options.ddlViewSelector).getKendoDropDownList();a.value(c.options.userGroupId)}};GlobalUserGroupDropDown.prototype.getDataSource=function(a){var b=this;$.extend(true,b.dataSourceOpts,_defaultDataSourceConfig,a);b.dataSourceOpts.transport={read:function(c){var d={IsActive:true,CompanyId:b.options.companyId,ShowOnlyPublicGroups:b.options.showOnlyPublicOptions};$.extend(true,d,kendoOptionsToObject(c),b.searchCriteria);$.ajax({url:"/DataView/GetUserGroups",dataType:"json",data:d,success:function(e){if(e.ReturnCode==ReturnCode.Failed){handleDataSourceException(e)}else{c.success(e)}}})},};b.dataSourceOpts.serverFiltering=true;return new kendo.data.DataSource(b.dataSourceOpts)};GlobalUserGroupDropDown.prototype.dataSourceOpts={};function GlobalUserGroupSelect(a){var b=this;$.extend(true,b.options,b.baseOptions,a);b.search();$(document).bind(argosyEvents.SEARCH_PAGE_GRID,function(d,c){b.refineSearch(c)})}GlobalUserGroupSelect.prototype.options={};GlobalUserGroupSelect.prototype.baseOptions={gridViewSelector:"div[data-argosy-view=GlobalUserGroupSelect]",};GlobalUserGroupSelect.prototype.searchCriteria={};GlobalUserGroupSelect.prototype.refineSearch=function(a){var c=this;c.searchCriteria=a;var b=$(c.options.gridViewSelector).getKendoGrid();b.dataSource.read();b.refresh()};GlobalUserGroupSelect.prototype.search=function(){var c=this;if($(c.options.gridViewSelector).getKendoGrid()==null){var b={scrollable:false,editable:false,autoBind:false,dataSource:c.getDataSource({}),groupable:false,sortable:true,selectable:"multiple, row",pageable:{refresh:true,buttonCount:5},columns:[{title:"Group name",field:"GroupName",width:"300px"},{title:"Description",field:"GroupDescription",width:"900px"}],checkboxes:true,dataBinding:function(d){},dataBound:function(d){$.fancybox.reposition()},toolbar:[],search:[{name:"GroupName",type:"text",placeholder:"Search by Group Name",toolbar:true},],};$(c.options.gridViewSelector).kendoArgosyGrid(b)}else{var a=$(c.options.gridViewSelector).getKendoGrid();a.dataSource.read();a.refresh()}};GlobalUserGroupSelect.prototype.getSelectedRecords=function(){var c=this;var b=[];var a=$(c.options.gridViewSelector).getKendoGrid();$(a.select()).each(function(d){b.push(a.dataItem(this))});return b};GlobalUserGroupSelect.prototype.getDataSource=function(a){var b=this;$.extend(true,b.dataSourceOpts,_defaultDataSourceConfig,a);b.dataSourceOpts.pageSize=10;b.dataSourceOpts.transport={read:function(c){var d={};$.extend(true,d,kendoOptionsToObject(c),b.searchCriteria);$.ajax({url:"/DataView/GetUserGroups",dataType:"json",data:d,success:function(e){if(e.ReturnCode==ReturnCode.Failed){handleDataSourceException(e)}else{c.success(e)}}})}};return new kendo.data.DataSource(b.dataSourceOpts)};GlobalUserGroupSelect.prototype.dataSourceOpts={};function GlobalUserSelect(a){var b=this;$.extend(true,b.options,b.baseOptions,a);b.search();$(document).bind(argosyEvents.SEARCH_PAGE_GRID,function(d,c){b.refineSearch(c)})}GlobalUserSelect.prototype.options={};GlobalUserSelect.prototype.baseOptions={gridViewSelector:"div[data-argosy-view=GlobalUserSelect]",};GlobalUserSelect.prototype.searchCriteria={};GlobalUserSelect.prototype.refineSearch=function(a){var c=this;c.searchCriteria=a;var b=$(c.options.gridViewSelector).getKendoGrid();b.dataSource.read();b.refresh()};GlobalUserSelect.prototype.search=function(){var c=this;if($(c.options.gridViewSelector).getKendoGrid()==null){var b={scrollable:false,editable:false,autoBind:false,dataSource:c.getDataSource({}),groupable:false,sortable:true,selectable:"multiple, row",pageable:{refresh:true,buttonCount:5},columns:[{title:"Username",field:"Username",width:"400px"},{title:"Name",template:"${FirstName} ${LastName}",width:"400px"},{title:"Email",field:"Email",width:"400px"}],checkboxes:true,dataBinding:function(d){},dataBound:function(d){$.fancybox.reposition()},toolbar:[],search:[{name:"GlobalKeyword",type:"text",placeholder:"Search by First/Last Name, Username or Email",toolbar:true}],};$(c.options.gridViewSelector).kendoArgosyGrid(b)}else{var a=$(c.options.gridViewSelector).getKendoGrid();a.dataSource.read();a.refresh()}};GlobalUserSelect.prototype.getSelectedRecords=function(){var c=this;var b=[];var a=$(c.options.gridViewSelector).getKendoGrid();$(a.select()).each(function(d){b.push(a.dataItem(this))});return b};GlobalUserSelect.prototype.getDataSource=function(a){var b=this;$.extend(true,b.dataSourceOpts,_defaultDataSourceConfig,a);b.dataSourceOpts.pageSize=10;b.dataSourceOpts.transport={read:function(c){var d={IsActive:true,RecordSizeCategory:b.options.recordSizeCategory};$.extend(true,d,kendoOptionsToObject(c),b.searchCriteria);$.ajax({url:"/DataView/GetUsersForDropDownList",dataType:"json",data:d,success:function(e){if(e.ReturnCode==ReturnCode.Failed){handleDataSourceException(e)}else{c.success(e)}}})},};return new kendo.data.DataSource(b.dataSourceOpts)};GlobalUserSelect.prototype.dataSourceOpts={};function HashFilter(a){var b=this;$.extend(true,b.options,b.baseOptions,a)};function HdTicketIssueTypeDropDown(a){var b=this;$.extend(true,b.options,b.baseOptions,a);b.setUpDropDown()}HdTicketIssueTypeDropDown.prototype.options={};HdTicketIssueTypeDropDown.prototype.baseOptions={ddlViewSelector:"select[data-argosy-view=HdTicketIssueTypeDropDown]"};HdTicketIssueTypeDropDown.prototype.setUpDropDown=function(){var a=this;if($(a.options.ddlViewSelector).getKendoDropDownList()==null){$(a.options.ddlViewSelector).kendoDropDownList({dataSource:{data:HDIssueTypes},dataTextField:"text",dataValueField:"value",optionLabel:"-- Select Issue Type --",})}};function HdTicketPriorityDropDown(a){var b=this;$.extend(true,b.options,b.baseOptions,a);b.setUpDropDown()}HdTicketPriorityDropDown.prototype.options={};HdTicketPriorityDropDown.prototype.baseOptions={ddlViewSelector:"select[data-argosy-view=HdTicketPriorityDropDown]"};HdTicketPriorityDropDown.prototype.setUpDropDown=function(){var a=this;if($(a.options.ddlViewSelector).getKendoDropDownList()==null){$(a.options.ddlViewSelector).kendoDropDownList({dataSource:{data:HDTicketPriority},dataTextField:"text",dataValueField:"value"});$(a.options.ddlViewSelector).getKendoDropDownList().value(2)}};function HelpDeskGridView(a){var b=this;$.extend(true,b.options,b.baseOptions,a);$(document).bind(argosyEvents.SEARCH_PAGE_GRID,function(d,c){b.refineSearch(c)});b.refineSearch({})}HelpDeskGridView.prototype.options={};HelpDeskGridView.prototype.baseOptions={gridViewSelector:"div[data-argosy-view=HelpDeskGridView]"};HelpDeskGridView.prototype.searchCriteria={HdStatus:null};HelpDeskGridView.prototype.refineSearch=function(a){var b=this;b.searchCriteria=a;b.setupGrid()};HelpDeskGridView.prototype.setupGrid=function(){var d=this;var a=d.options.controller;if($(d.options.gridViewSelector).getKendoGrid()==null){var c={scrollable:false,editable:false,autoBind:true,dataSource:d.getDataSource({}),groupable:false,sortable:true,exportToExcel:false,pageable:{refresh:true,pageSizes:[50,100,500],buttonCount:5},columns:[{title:"~{TicketNumber}~",field:"TicketId"},{title:"~{Date}~",field:"HdDateCreated",template:'${kendo.toString(kendo.parseDate(HdDateCreated),"MM/dd/yyyy")}',},{title:"~{Subject}~",field:"Subject",template:"<div><a href='/"+a+"/HelpDesk/Edit/${TicketId}'>${Subject}</a></div>"},{title:"<div class='text-center'>~{Status}~</div>",field:"HdStatus",template:"<div class='bold text-center'>${HdStatus}</div>"},{title:"~{IssueType}~",field:"HdProbelmType"},{title:"~{Priority}~",field:"HdPriority",template:"#switch (HdPriority) {case 1: #High# break;case 2: #Medium# break;case 3: #Low# break;}#"},{title:"~{CreatedBy}~",field:"CreatedByUser"}],dataBinding:function(f){},dataBound:function(f){$("div[data-argosy-view=HelpDeskGridView] th:eq(1) ,div[data-argosy-view=HelpDeskGridView]  tr td:nth-child(2)").addClass("hidden-sm hidden-xs");$("div[data-argosy-view=HelpDeskGridView] th:eq(5) ,div[data-argosy-view=HelpDeskGridView]  tr td:nth-child(6)").addClass("hidden-sm hidden-xs");$("div[data-argosy-view=HelpDeskGridView] th:eq(6) ,div[data-argosy-view=HelpDeskGridView]  tr td:nth-child(7)").addClass("hidden-sm hidden-xs");$("div[data-argosy-view=HelpDeskGridView] th:eq(7) ,div[data-argosy-view=HelpDeskGridView]  tr td:nth-child(8)").addClass("hidden-sm hidden-xs")},toolbar:[],search:[{name:"Subject",type:"text",placeholder:"~{Subject}~",toolbar:false},{name:"TicketNo",type:"text",placeholder:"~{TicketNumber}~",toolbar:false},{name:"Keyword",type:"text",placeholder:"~{SearchBySubjectStatusPriority}~",toolbar:true},{name:"HdStatusId",type:"select",toolbar:true,autoSubmit:true,data:HDTicketStatuses},{name:"HdProblemTypeId",type:"select",toolbar:true,autoSubmit:true,data:HDIssueTypes},{name:"HdUserName",type:"text",placeholder:"~{CreatedBy}~",toolbar:false},{name:"TicketCreatedDateStart",type:"date",placeholder:"~{From}~",toolbar:false},{name:"TicketCreatedDateEnd",type:"date",placeholder:"~{To}~",toolbar:false}]};$(d.options.gridViewSelector).kendoArgosyGrid(c)}else{var b=$(d.options.gridViewSelector).getKendoGrid();b.dataSource.read();b.refresh()}};HelpDeskGridView.prototype.getDataSource=function(a){var b=this;$.extend(true,b.dataSourceOpts,_defaultDataSourceConfig,a);b.dataSourceOpts.transport={read:function(c){var d=b.options;$.extend(true,d,kendoOptionsToObject(c),b.searchCriteria);$.ajax({url:"/DataView/GetHelpDeskTickets",dataType:"json",data:d,success:function(e){if(e.ReturnCode==ReturnCode.Failed){handleDataSourceException(e)}else{c.success(e)}}})}};return new kendo.data.DataSource(b.dataSourceOpts)};HelpDeskGridView.prototype.dataSourceOpts={};HelpDeskGridView.prototype.getStatus=function(){};(function(a){var c=window.kendo,d=c.ui,e=d.Widget;var b=e.extend({init:function(f,g){var h=this;e.fn.init.call(this,f,g);controlLoader.loadTemplate("AddressPicker",function(i){a(document.body).append(i);h._initialize()})},options:{name:"AddressPicker",keyword:"",addToBook:null,userId:null,userName:"",billTo:null,shipTo:null,companyId:null,isBilling:false,isUserlevel:null,templates:{link:"#_AddressPickerLink",modal:"#_AddressPickerModal",item:"#_AddressPickerItem"}},value:function(f){var g=this;if(f==null){return null}else{}},_initialize:function(){var f=this;a(f.element).append(a(f.options.templates.link).html());c.bind(f.element,c.observable({companyAddressDataSource:f._getCompanyAddressDataSource(),orderAddressDataSource:f._getOrderAddressDataSource(),keyword:"",onAddressSelect:function(g){g.data.userName=f.options.userName;if(f.options.isBilling){a(document).trigger(argosyEvents.EVENT_USER_SELECTED_BILLING_ADDRESS,g.data)}else{a(document).trigger(argosyEvents.EVENT_USER_SELECTED_ADDRESS,g.data)}a.fancybox.close()},searchAddress:function(g){f.options.keyword=this.keyword;this.companyAddressDataSource.read();if(f.options.showOrderAddresses){this.orderAddressDataSource.read()}},onDataBound:function(h){var g=h.sender.dataSource._total;if(g>0){h.sender.wrapper.closest(".listViewWrapper").removeClass("hide").show()}else{h.sender.wrapper.closest(".listViewWrapper").removeClass("show").hide()}if(g>50){h.sender.wrapper.closest(".listViewWrapper").find("*[data-role=pager]").removeClass("hide").show()}else{h.sender.wrapper.closest(".listViewWrapper").find("*[data-role=pager]").removeClass("show").hide()}a.fancybox.update()},onPreviousDataBound:function(h){var g=h.sender.dataSource.total();if(!f.options.isBilling&&g>0){h.sender.wrapper.closest(".listViewWrapper").removeClass("hide").show()}else{h.sender.wrapper.closest(".listViewWrapper").removeClass("show").hide()}if(!f.options.isBilling&&g>50){h.sender.wrapper.closest(".listViewWrapper").find("*[data-role=pager]").removeClass("hide").show()}else{h.sender.wrapper.closest(".listViewWrapper").find("*[data-role=pager]").removeClass("show").hide()}a.fancybox.update()},showAddressBook:function(h){var i=this,g=a(f.options.templates.modal).html();a.fancybox({content:g,afterShow:function(){c.bind(this.wrap,i);a.fancybox.update()}})}}))},_getCompanyAddressDataSource:function(){var g=this,f={requestStart:function(){block()},requestEnd:function(){unblock()},autoBind:true,transport:{read:function(h){var i={userId:g.options.userId,companyId:g.options.companyId,keyword:g.options.keyword,shipTo:g.options.shipTo,billTo:g.options.billTo};a.extend(true,i,kendoOptionsToObject(h),{});a.ajax({url:"/DataView/GetAvailableAddressesForUser",dataType:"text/json",data:i,type:"POST",complete:function(j){h.success(JSON.parse(j.responseText))}})}},serverPaging:true,pageSize:10,serverFiltering:true};a.extend(true,f,_defaultDataSourceConfig);return new c.data.DataSource(f)},_getOrderAddressDataSource:function(){var g=this,f={autoBind:false,transport:{read:function(h){var i={userId:g.options.userId,userGroupId:g.options.userGroupId,companyId:g.options.companyId,addToAddressBook:g.options.addToBook,userName:g.options.userName,keyword:g.options.keyword};a.extend(true,i,kendoOptionsToObject(h),{});a.ajax({url:"/DataView/GetOrderAddresses",dataType:"text/json",data:i,type:"POST",complete:function(j){h.success(JSON.parse(j.responseText))}})}}};a.extend(true,f,_defaultDataSourceConfig);return new c.data.DataSource(f)}});d.plugin(b)})(jQuery);(function(a){var c=window.kendo,d=c.ui,e=d.Widget;var b=e.extend({init:function(f,g){e.fn.init.call(this,f,g);this.setupSearch(g);this.setupExcelToolbar(g);this.setupDataBoundEvent(g);this.setupKendoGrid(g,f);addArgosyActions(this.element.parent().parent());c.bind(this.element.parent().parent().find(".search-grid"))},options:{name:"ArgosyGrid",search:[],checkboxes:true,exportToExcel:true,excel:{allPages:true},useEventToGetExcelData:false},setupKendoGrid:function(j,g){var k=this;var h=a(g);var f=j.autoBind;j.autoBind=false;k.setupExportColumns(j);k.exportFlag=false;h.kendoCustomGrid(j);var i=h.getKendoGrid();i.bind("preExcelExport",function(l){k.showExportColumns(i)});i.bind("postExcelExport",function(l){k.hideExportColumns(i)});if(j.dataSource!=null){j.dataSource.bind("requestStart",function(l){var m=j.dataSource.requestStart;a(document).trigger(argosyEvents.START_LOADING,{element:h.parent().parent()});if(m!=null){m(l)}});j.dataSource.bind("requestEnd",function(l){var m=j.dataSource.requestEnd;a(document).trigger(argosyEvents.END_LOADING,{element:h.parent().parent()});if(m!=null){m(l)}})}if(f){k.searchGrid(false)}},setupExportColumns:function(f){var g=this;g.hiddenColumns=[];a(f.columns).each(function(h){if(this.hidden){g.hiddenColumns.push(h)}})},setupExcelToolbar:function(h){var i=this;if(i.options.exportToExcel){var f=-1;if(h.toolbar!=null){a(h.toolbar).each(function(j){if((a(this).is("string")&&this.toLowerCase()=="excel")||this.name.toLowerCase()=="excel"){f=j}})}else{h.toolbar=[]}var g="<a class='k-button k-button-icontext k-grid-export-excel hidden-sm hidden-xs '><span class=''></span><i class='fa fa-file-excel-o'></i></a> ";if(f>-1){h.toolbar.splice(f,1,{template:g})}else{h.toolbar.splice(0,0,{template:g})}h.excel={fileName:location.pathname.substring(1).replace(/\//,"-")+"."+c.toString(new Date(),"MM-dd-yyyy")+".xlsx",proxyURL:"/DataView/ExportExcelSave",filterable:true,allPages:true}}},showExportColumns:function(f){var g=this;a(g.hiddenColumns).each(function(){f.showColumn(parseInt(this.toString()))})},hideExportColumns:function(f){var g=this;a(g.hiddenColumns).each(function(){f.hideColumn(parseInt(this.toString()))})},setupDataBoundEvent:function(f){var h=this;var g=null;if(f.dataBound!=null){g=f.dataBound}f.dataBound=function(i){h.setupAdvancedSearchButtons(i);h.setupExportToExcelButton(i);if(g!=null){g(i)}}},setupExportToExcelButton:function(f){var i=this;var h=f.sender.element;var g=h.find(".fa-file-excel-o").parent();g.unbind("click");g.click(function(j){i.exportToExcelQuestion(j)})},exportToExcelQuestion:function(f){var i=this;var g=a(f.currentTarget).closest(".k-grid");var h=g.getKendoGrid();var j=h.dataSource._total;if(j>500&&j<=10000){prompt.alert({question:"Are you sure you want to export all "+c.toString(j,"n0")+" records to excel?",description:"This process may take a long time to complete.",button:"Export to Excel",type:"warning",yes:function(k){if(typeof(k.preventDefault)==="function"){a.fancybox.close();i.exportToExcel(h)}}})}else{if(j>10000){prompt.alert({question:"You are limited to exporting 10,000 records at a time.  There are "+c.toString(j,"n0")+" records total.",description:"Please use advanced search to refine your results or create a custom report.",button:"Close",type:"warning",yes:function(k){if(typeof(k.preventDefault)==="function"){a.fancybox.close();i.exportToExcel(h)}}})}else{i.exportToExcel(h)}}},exportToExcel:function(f){var g=this;if(g.options.useEventToGetExcelData){a(document).one(argosyEvents.EVENT_SEND_EXCEL_DATASOURCE,function(m,k){var q=k.records;var h=new Array();var o=new Array();var j=new Array();for(var p in q[0]){if(q[0].hasOwnProperty(p)){o.push(p);j.push({autoWidth:true});h.push({value:p})}}var r=[{cells:h}];for(var n=0;n<q.length;n++){var l=new Array();for(var t=0;t<o.length;t++){l.push({value:q[n][o[t]]})}r.push({cells:l})}var s=new c.ooxml.Workbook({sheets:[{columns:j,title:"DataExport",rows:r}]});c.saveAs({dataURI:s.toDataURL(),fileName:location.pathname.substring(1).replace(/\//,"-")+"."+c.toString(new Date(),"MM-dd-yyyy")+".xlsx"})});a(document).trigger(argosyEvents.EVENT_REQUEST_EXCEL_DATASOURCE)}else{a.blockUI({message:"<h1>Generating Excel...</h1>"});f.saveAsExcel();setTimeout(function(h){a.unblockUI()},2000);a.fancybox.close()}},setupAdvancedSearchButtons:function(f){var l=this;var g=f.sender.element;var i=g.parent().parent().find(".search-grid");var k=g.find(".showAdvancedSearch");var h=i.parent().find(".hideSearchCriteria");var j=g.find(".k-keyword-search-button");j.unbind("click");j.click(function(m){l.searchGrid(false)});g.find("*[data-argosy-search]").each(function(){var n=a(this);if(n.is("div")&&a(n).find("input[type='checkbox']").length>0){var m=a(n).find("input[type='checkbox']");m.unbind("change");m.change(function(o){l.searchGrid(true)})}else{if(n.is("select")){n.unbind("change");n.change(function(o){l.searchGrid(false)})}else{n.unbind("keypress");n.keypress(function(o){l.setFormSubmit(o,false)})}}});k.unbind("click");k.click(function(m){var n=l.getWrapperColumnWidth();l.setupToolbarInputLinkage(true);g.parent().removeClass("col-sm-"+n).addClass("col-sm-"+(n-2));i.parent().css("padding-top",l.getToolbarHeight(g));i.parent().show("slow");k.closest(".k-keyword-search").hide("slow")});h.unbind("click");h.click(function(m){var n=l.getWrapperColumnWidth();l.setupToolbarInputLinkage(false);g.parent().removeClass("col-sm-"+n).addClass("col-sm-"+(n+2));g.parent().parent().find(".search-grid").parent().hide("slow");k.closest(".k-keyword-search").show("slow")})},getToolbarHeight:function(f){if(screen.width>480){return f.find(".k-grid-toolbar").height()+parseInt(f.find("table[role=grid]").css("margin-top"))+parseInt(f.find(".k-grid-toolbar").css("margin-bottom"))}},setupSearch:function(g){if(g.search!=null&&g.search.length>0){var f=[];var h=[];a(g.search).each(function(j){if(this.toolbar!=null&&this.toolbar){h.push(this)}else{f.push(this)}});this.setupSearchToolbar(g,h,f.length>0);this.setupAdvancedSearch(g,g.search)}},setupToolbarInputLinkage:function(g){var h=this;var i=h.element.find(".k-grid-toolbar");var f=h.element.parent().parent().find(".search-grid");if(g){i.find("*[data-argosy-search]").each(function(){var j=a(this);var k=f.find("*[data-argosy-search="+j.attr("data-argosy-search")+"]");if(k.length>0){h.updateInputValue(k[0],j)}})}else{f.find("*[data-argosy-search]").each(function(){var j=a(this);var k=i.find("*[data-argosy-search="+j.attr("data-argosy-search")+"]");if(k.length>0){h.updateInputValue(k[0],j)}})}},setupAdvancedSearch:function(g,h){var j=this;if(h.length>0){var i=a("<div />",{"class":"search-grid"});i.append(a("<h4 />",{text:"~{Search}~","class":"text-center"}));a(h).each(function(l){var n=a("<div />",{"class":(l==0?"padb5 padu10 w100":"padb5 w100")});var m;if(this["data-role"]!=null){m=a("<"+this.type+" />",{"data-role":this["data-role"],"data-argosy-search":this.name})}else{m=a(j.getInput(this,false));if(m.is("div")&&a(m).find("input[type='checkbox']").length>0){var k=a(m).find("input[type='checkbox']");k.unbind("change");k.change(function(o){j.searchGrid(true)})}else{if(m.is("select")){m.unbind("change");m.change(function(o){j.searchGrid(true)})}else{m.unbind("keypress");m.keypress(function(o){j.setFormSubmit(o,true)})}}}m.addClass("w90");n.append(m);i.append(n)});var f=a("<div />",{"class":"hide col-sm-2 padr20"});f.append(i);f.append(this.buildSearchButton());f.append(this.buildHideSearchLink());f.find(".search-grid-btn").click(function(k){j.searchGrid(true)});this.element.parent().before(f)}},setFormSubmit:function(f,g){var h=this;if(f.keyCode==13){h.searchGrid(g);if(f.preventDefault()){f.preventDefault()}else{f.returnValue=false}}f.returnValue=true},getSearchObject:function(g){var j=this;var h=(!g)?j.element.find(".k-keyword-search"):j.element.parent().parent().find(".search-grid");var f=h.find("*[data-argosy-search]");var i={};a(f).each(function(k){var l=a(this);var m=l.attr("data-argosy-search");i[m]=getInputValue(l)});return i},getWrapperColumnWidth:function(){var f=this.element.parent().attr("class").split(" ");var g=0;a(f).each(function(){if(this.indexOf("col-sm-")>-1){g=parseInt(this.replace("col-sm-",""))}else{if(this.indexOf("col-md-")>-1){g=parseInt(this.replace("col-md-",""))}}});return g},buildSearchButton:function(){var h=this;var f=a("<div />",{"class":"search-grid-btn finger"});var g=a("<a />",{"class":"btn btn-primary btn-block",text:"~{Search}~"});f.append(g);return f},buildHideSearchLink:function(){var h=this;var f=a("<div />",{"class":"padu10 hideSearchCriteria finger show"});var g=a("<a />",{html:"<i class='fa fa-chevron-circle-left'></i> ~{HideSearchCriteria}~"});f.append(g);return f},setupSearchToolbar:function(g,h,f){if(h.length>0){if(g.toolbar==null){g.toolbar=[]}g.toolbar.splice(0,0,this.buildSearchToolbar(h,f))}},buildSearchToolbar:function(h,f){var i=this;var j=a("<div />",{"class":"k-keyword-search"});a(h).each(function(k){var l=a(i.getInput(this,true));l.unbind("keypress");l.keypress(function(m){i.setFormSubmit(m)});j.append(l)});var g=a("<a class='k-button-nbkg k-keyword-search-button'><i class='fa fa-search'></i></a>");j.append(g);if(f){j.append(a("<a class='nowrap k-link floatl showAdvancedSearch padl20'><span class='hidden-sm hidden-xs'>~{AdvancedSearch}~ <i class='fa fa-plus-circle'></i></span></a>"))}return{name:"grid-search",template:j.outerHtml()}},searchGrid:function(f){var g=this;a(document).trigger(argosyEvents.SEARCH_PAGE_GRID,g.getSearchObject(f))},updateInputValue:function(h,f){var g=this;h=a(h);f=a(f);setInputValue(h,getInputValue(f))},getInput:function(g,f){if(g.placeholder!=null&&(g.type=="text"||g.type=="number")){g.placeholder=this.getPlaceholder(g,f)}g.dataArgosySearch=g.name;return getInputControl(g.type,g)},getPlaceholder:function(g,f){if(g.placeholder!=null){return(g.placeholder.length>20&&!f?g.name:g.placeholder)}else{return g.name}}});d.plugin(b)})(jQuery);(function(a){var c=window.kendo,d=c.ui,e=d.Widget;var b=e.extend({init:function(f,g){e.fn.init.call(this,f,g);this._initialize()},options:{name:"AssetRoleUserGrid",dataSource:{},assetRoleId:0},removeUser:function(f,g){var h=this;a.ajax({url:"/Tools/DigitalAssets/RemoveUserFromRole",dataType:"json",data:{userId:f.UserId,assetRoleId:h.options.assetRoleId},success:function(i){if(i.ReturnCode===ReturnCode.Failed){prompt.clientResponseError(i)}else{h.options.dataSource.read();g.refresh()}}})},_initialize:function(){var h=this;var g=function(j){var l=j.currentTarget.closest(".k-widget");var k=a(l).getKendoGrid();var m=j.currentTarget.closest("tr");var i=k.dataItem(m);h.removeUser(i,k)};var f={dataSource:h._getDataSource(),groupable:false,sortable:true,scrollable:false,exportToExcel:false,rows:10,pageable:{refresh:false,pageSizes:false,buttonCount:1},columns:[{title:"User",field:"Username",width:"40%"},{title:"Name",field:"FullName",width:"40%"},{command:{text:"Remove",click:g},title:" ",width:"20%"}],title:"Users",toolbar:[{name:"addUsers",text:" Add User","class":"fa fa-plus","data-id":h.options.assetRoleId}],addUsers:function(j){var i=a(j.currentTarget).data("id");a(document).trigger(argosyEvents.SEARCH_PAGE_GRID,{ExcludeAssetRoleIds:JSON.stringify([i])});a.fancybox({href:"#_DamUserSelect"})}};a(document).bind(argosyEvents.EVENT_RELOAD_ASSET_USERS,function(j,i){if(i.assetRoleId==h.options.assetRoleId){var k=h.element.find(".k-grid").getKendoGrid();k.dataSource.read();k.refresh()}});h.element.kendoCollapseGrid(f)},_getDataSource:function(){var f=this;a.extend(true,f.options.dataSource,_defaultDataSourceConfig,{});f.options.dataSource.transport={read:function(g){var h={IsActive:true,AssetRoleId:f.options.assetRoleId};a.extend(true,h,kendoOptionsToObject(g),{});a.ajax({url:"/DataView/GetUsers",dataType:"json",data:h,success:function(i){if(i.ReturnCode===ReturnCode.Failed){handleDataSourceException(i)}else{g.success(i)}}})}};f.options.dataSource.serverFiltering=true;f.options.dataSource=new c.data.DataSource(f.options.dataSource);return f.options.dataSource}});d.plugin(b)})(jQuery);(function(a){var c=window.kendo,d=c.ui,e=d.Widget;var b=e.extend({init:function(f,g){e.fn.init.call(this,f,g);this._initialize()},options:{name:"AssetRoleUserGroupGrid",dataSource:{},assetRoleId:0},removeUserGroup:function(f,g){var h=this;a.ajax({url:"/Tools/DigitalAssets/RemoveUserGroupFromRole",dataType:"json",data:{userGroupId:f.UserGroupId,assetRoleId:h.options.assetRoleId},success:function(i){if(i.ReturnCode===ReturnCode.Failed){prompt.clientResponseError(i)}else{h.options.dataSource.read();g.refresh()}}})},_initialize:function(){var h=this;var g=function(j){var l=j.currentTarget.closest(".k-widget");var k=a(l).getKendoGrid();var m=j.currentTarget.closest("tr");var i=k.dataItem(m);h.removeUserGroup(i,k)};var f={dataSource:h._getDataSource(),groupable:false,sortable:true,scrollable:false,exportToExcel:false,rows:10,pageable:{refresh:false,pageSizes:false,buttonCount:1},pageSize:10,columns:[{title:"Group",field:"GroupName",width:"80%"},{command:{text:"Remove",click:g},title:" ",width:"20%"}],title:"User Groups",toolbar:[{name:"addUserGroups",text:" Add User Groups","class":"fa fa-plus","data-id":h.options.assetRoleId}],addUserGroups:function(j){var i=a(j.currentTarget).data("id");a(document).trigger(argosyEvents.SEARCH_PAGE_GRID,{ExcludeAssetRoleIds:JSON.stringify([i])});a.fancybox({href:"#_DamUserGroupSelect"})}};a(document).bind(argosyEvents.EVENT_RELOAD_ASSET_USERGROUPS,function(j,i){if(i.assetRoleId==h.options.assetRoleId){var k=h.element.find(".k-grid").getKendoGrid();k.dataSource.read();k.refresh()}});h.element.kendoCollapseGrid(f)},_getDataSource:function(){var f=this;a.extend(true,f.options.dataSource,_defaultDataSourceConfig,{});f.options.dataSource.transport={read:function(g){var h={IsActive:true,AssetRoleId:f.options.assetRoleId};a.extend(true,h,kendoOptionsToObject(g),{});a.ajax({url:"/DataView/GetUserGroups",dataType:"json",data:h,success:function(i){if(i.ReturnCode===ReturnCode.Failed){handleDataSourceException(i)}else{g.success(i)}}})}};f.options.dataSource.serverFiltering=true;f.options.dataSource=new c.data.DataSource(f.options.dataSource);return f.options.dataSource}});d.plugin(b)})(jQuery);(function(a){var c=window.kendo,d=c.ui,e=d.Widget;var b=e.extend({init:function(f,g){e.fn.init.call(this,f,g);this.setupRequiredElements(f,g);this.setupToolbar(g);this.setupDataBoundEvent(g);this.setupView(f,g);this.setupAnimations(f);addArgosyActions(f)},setupView:function(f,g){switch(g.type){case"list":this.setupListView(f,g);break;default:this.setupGridView(f,g);break}},setupListView:function(f,h){var g=a(f).find(".k-collapse-grid");if(h.template==null){h.template='<label class="marr10 keyword-box"> <i class="fa fa-times co-warning" title="Delete Filter"></i> ${'+h.labelProperty+"}</label>"}var i=h.dataBound;h.dataBound=function(j){g.find(".keyword-box").each(function(l){var n=a(this).attr("data-uid");var k=null;a(j.sender.dataSource._data).each(function(){if(n==this.uid){k=this}});var m=a(this).find(".co-warning");m.unbind("click");m.click(function(o){if(h.remove!=null){h.remove({data:k})}})});if(i!=null){i(j)}};if(h.altTemplate==null){}g.kendoListView(h)},setupExportColumns:function(f){var g=this;g.exportFlag=false;g.hiddenColumns=[];a(f.columns).each(function(h){if(this.hidden){g.hiddenColumns.push(h)}})},setupGridView:function(f,i){var j=this;var g=a(f).find(".k-collapse-grid");j.setupExportColumns(i);if(i.pageable==null){i.pageable={}}if(i.pageable.messages==null){i.pageable.messages={}}if(i.type=="list"){i.selectable=false}i.pageable.numeric=false;i.pageable.pageSize=j.options.rows;i.dataSource.pageSize(j.options.rows);i.pageable.refresh=false;i.pageable.messages.itemsPerPage="";i.autoBind=false;j.exportFlag=false;g.kendoCustomGrid(i);var h=g.getKendoGrid();h.bind("preExcelExport",function(k){j.showExportColumns(h)});h.bind("postExcelExport",function(k){j.hideExportColumns(h)})},getKendoGrid:function(){switch(this.options.type){case"list":return null;default:return a(this.element).find(".k-collapse-grid").getKendoGrid()}},getKendoListView:function(){switch(this.options.type){case"list":return a(this.element).find(".k-collapse-grid").getKendoListView();default:return null}},toggle:function(){var f=this;var g=f.element.find(".k-command-expand-grid");g.click()},setupDataBoundEvent:function(f){var h=this;var g=null;if(f.dataBound!=null){g=f.dataBound}f.dataBound=function(i){h.setupExportToExcelButton(i);if(g!=null){g(i)}}},setupExportToExcelButton:function(f){var h=this;var g=h.options.toolbarElement.find(".fa-file-excel-o").parent();g.unbind("click");g.click(function(i){h.exportToExcelQuestion(i)})},exportToExcelQuestion:function(f){var h=this;var g=h.options.gridElement.getKendoGrid();var i=g.dataSource._total;if(i>500){prompt.alert({question:"Are you sure you want to export all "+c.toString(i,"n0")+" records to excel?",description:"This process may take a long time to complete.",button:"Export to Excel",type:"warning",yes:function(j){h.exportToExcel(g)}})}else{h.exportToExcel(g)}},showExportColumns:function(f){var g=this;a(g.hiddenColumns).each(function(){f.showColumn(parseInt(this.toString()))})},hideExportColumns:function(f){var g=this;a(g.hiddenColumns).each(function(){f.hideColumn(parseInt(this.toString()))})},exportToExcel:function(f){var g=this;a.blockUI({message:"<h1>Generating Excel...</h1>"});f.saveAsExcel();setTimeout(function(h){a.unblockUI()},2000);a.fancybox.close()},options:{name:"CollapseGrid",type:"grid",exportToExcel:true,rows:5},setupAnimations:function(h){h=a(h);var i=a(h).find(".k-collapse-grid");var k=a(h).find(".k-collapse-toolbar");var j=a(h).find(".k-collapse-list-toolbar");var g=k.find(".k-command-expand-grid").find("i.fa");var f=a(h).find(".k-collapse-toolbar").find(".k-command-expand-grid");f.unbind("click");f.click(function(l){if(!i.is(":visible")){g.removeClass("fa-plus-circle").addClass("fa-minus-circle");var m=a(h).find(".k-collapse-grid").getKendoGrid();if(m){m.dataSource.read();m.refresh()}i.show();j.show()}else{g.removeClass("fa-minus-circle").addClass("fa-plus-circle");i.hide();j.hide()}});i.hide();j.hide()},setupRequiredElements:function(f,i){f=a(f);f.addClass("maru10");var g=a("<div />",{"class":"k-collapse-grid maru10"});var j=a("<div />",{"class":"k-collapse-toolbar grid-information"});var h=a("<div />",{"class":"k-collapse-list-toolbar"});switch(i.type){case"list":f.append(j);f.append(h);f.append(g);this.options.gridElement=f.find(".k-collapse-grid");this.options.toolbarElement=f.find(".k-collapse-toolbar");this.options.listViewToolbarElement=f.find(".k-collapse-list-toolbar");break;default:f.append(j);f.append(g);this.options.gridElement=f.find(".k-collapse-grid");this.options.toolbarElement=f.find(".k-collapse-toolbar")}if(i.notes!=null){this.element.find(".grid-information").after("<em>"+i.notes+"</em>")}},setupToolbar:function(f){var g=this;this.title=f.title==null?"No Title":f.title;this.options.toolbarElement.append(this.getTitleElement());switch(f.type){case"list":g.setupListToolbar(f);break;default:g.setupGridToolbar(f)}},setupExcelToolbar:function(h){var i=this;if(i.options.exportToExcel){var f=-1;if(h.toolbar!=null){a(h.toolbar).each(function(j){if(a(this).is("string")){if((a(this).is("string")&&this.toLowerCase()=="excel")||this.name.toLowerCase()=="excel"||this.name.toLowerCase()=="exportexcel"){f=j}}})}else{h.toolbar=[]}var g={name:"export-excel",text:"","class":"fa fa-file-excel-o"};if(f>-1){h.toolbar.splice(f,1,g)}else{h.toolbar.splice(0,0,g)}h.excel={fileName:location.pathname.substring(1).replace(/\//,"-")+"."+c.toString(new Date(),"MM-dd-yyyy")+".xlsx",proxyURL:"/DataView/ExportExcelSave",filterable:true,allPages:true}}},setupListToolbar:function(g){var h=this;this.setupExcelToolbar(g);if(g.toolbar!=null){this.toolbar=g.toolbar;var f=a("<div />",{"class":"w100 padu8"});a(g.toolbar).each(function(){f.append(h.getListCommandElement(this))});this.options.listViewToolbarElement.append(f);h.setupCommandEvents(g);g.toolbar=null}},setupGridToolbar:function(g){var h=this;this.setupExcelToolbar(g);if(g.toolbar!=null){this.toolbar=g.toolbar;var f=a("<div />",{"class":"floatr padu8"});a(g.toolbar).each(function(){f.append(h.getCommandElement(this))});this.options.toolbarElement.append(f);h.setupCommandEvents(g);g.toolbar=null}},setupCommandEvents:function(f){a(f.toolbar).each(function(){var h=this.name;var g=".k-grid-"+h;if(f[h]!=null&&a.isFunction(f[h])){a(g).unbind("click");a(g).click(function(i){i.input=a(g).closest("div").find(".k-command-input-element");f[h](i)})}})},getListCommandElement:function(g){var i=a("<span />",{"class":"w85"}).append(getInputControl(g.input,{placeholder:g.placeholder,"class":"k-command-input-element"}));var f=a('<span class="padl10 padu5"><a class="k-grid-'+g.name+'">'+g.text+' <i class="'+g["class"]+'"></i></a></div>');var h=a("<div />");h.append(i);h.append(f);return h},getCommandElement:function(f){var g="";if(f.hasOwnProperty("data-id")){g='data-id="'+f["data-id"]+'"'}return a('<a class="k-grid-'+f.name+'" '+g+">"+f.text+' <i class="'+f["class"]+'"></i></a>')},getTitleElement:function(){var g=a("<div />",{"class":"floatl finger k-command-expand-grid"});var f=a("<h3 />",{"class":"nopad"});f.append('<i class="fa fa-plus-circle"></i> '+this.title);g.append(f);return g}});d.plugin(b)})(jQuery);(function(a){var c=window.kendo,d=c.ui,e=d.Widget;var b=e.extend({init:function(f,g){var h=this;e.fn.init.call(this,f,g);getCountryStateMap();if(countryStateMap==null){a(document).one(argosyEvents.EVENT_COUNTRY_STATE_MAP_LOADED,function(i){h._initialize()})}else{h._initialize()}},options:{name:"Countries",countryId:null,bindingGroup:"",dataSource:{},searchCriteria:{},stateId:null,inputId:"",needToClearState:false,disabled:false},findCountryFromStateCode:function(g){var h=this;if(countryStateMap!==null){var f=null;a(countryStateMap).each(function(i,j){if(j.Regions!==null&&j.Regions.length>0){var k=a.grep(j.Regions,function(l){return l.Code.toLowerCase()===g});if(k.length>0){f=k[0];return false}}});if(f){h.value(f.CountryId,f.Id);h._dropDownList.dataSource.read();h._dropDownList.refresh()}}},value:function(f,h){var i=this;i.options.stateId=h;if(f==null){return i._hiddenInput.val()}else{i._hiddenInput.val(f);i._dropDownList.value(f);var g={bindingGroup:i.options.bindingGroup,value:f,stateId:i.options.stateId};a(document).trigger(argosyEvents.COUNTRY_CHANGE,g)}},_initialize:function(){var f=this;f.element.append(f._createHiddenInput());f._hiddenInput=f.element.find("input[type=hidden]");f.element.append(f._createDropDownList());f.element.find("select").kendoDropDownList({autoBind:true,dataTextField:"Name",dataValueField:"Id",optionLabel:"-- ~{SelectCountry}~ --",dataSource:f._getDataSource({}),cascade:function(h){var i=h.sender.value();var g={bindingGroup:f.options.bindingGroup,value:i,stateId:f.options.stateId};f._hiddenInput.val(i);f.options.stateId=null;a(document).trigger(argosyEvents.COUNTRY_CHANGE,g)},value:f.options.countryId,enable:f.options.disabled!="disabled"});f._dropDownList=f.element.find("select").getKendoDropDownList()},_createHiddenInput:function(){var g=this;var f=a("<input />",{type:"hidden",id:g.options.inputId,name:g.options.inputId.replace("_",".")});return f},_createDropDownList:function(){var g=this;var f=a("<select data-role='dropdownlist' />");return f},_getDataSource:function(){var f=this;a.extend(true,f.options.dataSource,_defaultDataSourceConfig);f.options.dataSource.transport={read:function(g){g.success(countryStateMap)}};f.options.dataSource.schema={total:function(g){return g.length}};f.options.dataSource.pageSize=99999;f.options.dataSource.serverFiltering=true;return new c.data.DataSource(f.options.dataSource)}});d.plugin(b)})(jQuery);(function(a){var c=kendo.ui;var d=c.Widget;var b=d.extend({init:function(e,f){var g=this;d.fn.init.call(this,e,f);g.setupCheckBoxes(f);g.setupDataBoundEvent(f);g.setupChangeEvent(f);a(e).kendoGrid(f);g.kendoGrid=a(e).getKendoGrid();g.overrideSelectFunctionality()},options:{name:"CustomGrid",},setupCheckBoxes:function(f){var g=this;if(f.checkboxes){var e={template:g.rowCheckboxTemplate,headerTemplate:g.headerCheckboxTemplate,width:4};f.columns.splice(0,0,e)}},overrideSelectFunctionality:function(){var e=this;if(e.kendoGrid.selectable!=undefined){e.kendoGrid.selectable.userEvents.unbind("start");e.kendoGrid.selectable.userEvents.unbind("move");e.kendoGrid.selectable.userEvents.unbind("end");e.kendoGrid.selectable.userEvents.unbind("select")}},setupChangeEvent:function(e){var g=this;var f=null;if(e.change!=null){f=e.change}e.change=function(h){g.updateSelectAllCheckbox(h);if(f!=null){f(h)}}},setupDataBoundEvent:function(e){var g=this;var f=null;if(e.dataBound!=null){f=e.dataBound}e.dataBound=function(h){g.configureSelectAllCheckbox();g.configureSelectRowCheckbox();if(f!=null){f(h)}}},configureSelectRowCheckbox:function(){var e=this},handleRowChangeEvent:function(e){},updateSelectAllCheckbox:function(f){var h=this;var g=h.kendoGrid.thead.find("i.grid-select-all");if(g.is(":visible")){var e=true;h.kendoGrid.tbody.find("tr[role=row]").each(function(j){if(!a(this).hasClass("k-state-selected")){e=false}});if(e&&!g.hasClass("fa-check-square-o")){g.addClass("fa-check-square-o");g.removeClass("fa-square-o")}else{if(!e&&g.hasClass("fa-check-square-o")){g.removeClass("fa-check-square-o");g.addClass("fa-square-o")}}}},configureSelectAllCheckbox:function(){var f=this;var e=f.kendoGrid.thead.find("i.grid-select-all");if(f.kendoGrid.options!=null&&f.kendoGrid.options.selectable!=null){if(f.kendoGrid.options.selectable.toString().toLowerCase().indexOf("multiple")>-1){e.unbind("click");e.click(function(g){var h=a(this);if(h.hasClass("fa-square-o")){h.addClass("fa-check-square-o");h.removeClass("fa-square-o");f.kendoGrid.tbody.find("tr[role=row]").each(function(j){if(!a(this).hasClass("k-state-selected")){f.kendoGrid.select(this)}})}else{h.removeClass("fa-check-square-o");h.addClass("fa-square-o");f.kendoGrid.clearSelection()}})}else{e.hide()}}},rowCheckboxTemplate:'<i class="fa fa-square-o grid-select-row"></i>',headerCheckboxTemplate:'<i class="fa fa-square-o grid-select-all"></i>'});c.plugin(b)})(jQuery);(function(a){var f=window.kendo,g=f.ui,h=g.Widget,c="dataBinding",d="dataBound",b="change";var e=h.extend({init:function(i,j){var k=this;h.fn.init.call(this,i,j);k.options.inputId=k.options.argosyInputId;k._initialize()},options:{name:"DropDownListOrUpload",value:null,inputId:null,argosyInputId:null,optionLabel:"Select One",valueField:"value",valueTemplate:null,template:null,dataSource:null,variableId:null,controlType:null,displayName:null,variableName:null,required:false,disabled:false,minHeight:null,minWidth:null,fixedAspectRation:false,maxImageSize:null,showFancyBoxAfterEdit:false,fancyboxAfterEditHref:null,dropdownText:"Drop Down",uploadText:"Upload",appendAsSwitchId:"-kendoSwitch",appendAsDropDown:"-kendoDropDown",appendAsUpload:"-kendoImageEditor",appendAsUploadLink:"-kendoUploadLink",appendAsDropDownLink:"-kendoDropDownLink",appendAsTabStrip:"-kendoTabStrip"},events:[c,d],_initialize:function(){var i=this;i.element.append(i._createHiddenInput());i._hiddenInput=i.element.find("input[type=hidden]");i.element.append(i._createNavOptions());i._switch=i.element.find("#"+i.options.inputId+i.options.appendAsSwitchId);i._configureSwitch();i._configureUpload()},_configureUpload:function(){var i=this;a("#"+i.options.inputId+i.options.appendAsUpload).kendoImageEditor();i._imageUpload=a("#"+i.options.inputId+i.options.appendAsUpload).getKendoImageEditor()},_configureSwitch:function(){var i=this;a("#"+i.options.inputId+i.options.appendAsTabStrip).kendoTabStrip();i._tabStrip=a("#"+i.options.inputId+i.options.appendAsTabStrip).getKendoTabStrip()},_createNavOptions:function(){var p=this,m=a("<div />",{"data-role":"tabstrip",id:p.options.inputId+p.options.appendAsTabStrip}),l=a("<ul />",{id:p.options.inputId+p.options.appendAsSwitchId,}),j=a("<li />",{"class":"k-state-active",text:p.options.dropdownText}),k=a("<div />",{id:p.options.variableId+p.options.appendAsDropDownLink}),n=a("<li />",{text:p.options.uploadText}),o=a("<div />",{id:p.options.variableId+p.options.appendAsUploadLink}),i=a("<select />",{id:p.options.inputId+p.options.appendAsDropDown,"data-role":"dropdownlist"}),q=a("<div />",{id:p.options.inputId+p.options.appendAsUpload,"data-role":"imageeditor","data-min-height":p.options.minHeight,"data-min-width":p.options.minWidth,"data-fixed-aspect-ratio":p.options.fixedAspectRatio,"data-max-image-size":p.options.maxImageSize,"data-show-fancybox-after-edit":p.options.showFancyBoxAfterEdit,"data-fancybox-after-edit-href":p.options.fancyboxAfterEditHref,"data-variable-id":p.options.variableId,"data-control-type":p.options.controlType,"data-display-name":p.options.displayName,"data-variable-name":p.options.variableName});k.append(i);o.append(q);l.append(j);l.append(n);m.append(l);m.append(k);m.append(o);return m},_createHiddenInput:function(){var j=this;if(j.options.inputId==null){j.options.inputId=f.guid()}var i=a("<input />",{type:"hidden",id:j.options.inputId,name:j.options.inputId.replace("_","."),isUpload:"true"});return i},value:function(i,j){var k=this;k.options.stateId=j;if(i==null){return k._hiddenInput.val()}else{k._hiddenInput.val(i)}}});g.plugin(e)})(jQuery);6;(function(a){var c=window.kendo,d=c.ui,e=d.Widget;var b=e.extend({init:function(g,h){var i=this;e.fn.init.call(this,g,h);if(h.variableNameMap!==null){i.options.variableNameMap=h.variableNameMap}if(h.categoryName!==null){i.options.categoryName=h.categoryName}var f=new ControlLoader();f.loadTemplate("GlobalProfileDropDown",function(j){a(document.body).append(j);i._initialize()})},options:{name:"GlobalProfileDropDown",errorSpanId:"#_GlobalProfileDropDownErrorSpan",required:false,companyId:0,globalFormsId:0,validationMsg:"",category:"",label:"",variableNameMap:[],templates:{contentHref:"#_GlobalProfileDropDownTemplate",bindSection:"#_GlobalProfileDropDownBindSection"}},validate:function(){var i=this,g=i.viewModel,f=a(i.options.errorSpanId),h=i.options.validationMsg;if(h.length<=0){h=i.options.label+" is required."}if(g.profileHasbeenSelected===true){f.removeClass("field-validation-error").addClass("field-validation-valid");f.empty()}else{f.removeClass("field-validation-valid").addClass("field-validation-error").append("<span>"+h+"</span>")}return g.profileHasbeenSelected},viewModel:null,_initialize:function(){var f=this;f.viewModel=new c.observable({selectedProfile:null,selectedProfileId:0,variableNameMap:f.options.variableNameMap,profileHasbeenSelected:false,onGlobalProfileChange:function(h){var j=this;a(document).trigger(argosyEvents.START_LOADING,{element:a("._showLoadingOnMe"),message:"Loading..."});if(h.sender!==null){var g=h.sender.dataItem();if(g){var i=g.Id;this.set("selectedProfileId",i);var k={globalFormsId:f.options.globalFormsId,globalFormsProfileId:i,category:f.options.category};a.ajax({url:"/DataView/GetGlobalFormsStructAndData",dataType:"json",data:k,success:function(m){if(m.ReturnCode===ReturnCode.Failed){a(document).trigger(argosyEvents.END_LOADING,{element:a("._showLoadingOnMe")});handleDataSourceException(m)}else{j.updateUI(m);j.set("profileHasbeenSelected",true);var l=a(f.options.errorSpanId);l.removeClass("field-validation-error").addClass("field-validation-valid");l.empty();a(document).trigger(argosyEvents.END_LOADING,{element:a("._showLoadingOnMe")})}}})}else{a(document).trigger(argosyEvents.END_LOADING,{element:a("._showLoadingOnMe")})}}},updateUI:function(g){if(g.TotalRecords>0){var h=f.options.variableNameMap;a(g.Records).each(function(j,k){var m=k.StructName.toLowerCase(),n=a.grep(h,function(i){return i.Name.toLowerCase()===m});if(n.length>0){var l=n[0];if(l.hasOwnProperty("getValueFrom")){setInputValue(l.Selector,k[l.getValueFrom])}else{setInputValue(l.Selector,k.Value)}}})}},globalProfiles:new c.data.DataSource({serverFiltering:true,transport:{read:{url:"/DataView/GetGlobalFormProfiles",dataType:"json",contentType:"application/json; charset=utf-8",type:"POST",},parameterMap:function(i,h){var g={};g.Keyword=a("input[data-role='autocomplete']").val();g.GlobalFormsId=f.options.globalFormsId;g.CompanyId=f.options.companyId;g.IsGlobalFormsProfileActive=true;g.Take=15;return JSON.stringify(g)},},schema:{data:"Records",total:"TotalRecords",}})});f.element.append(f._buildContent());c.bind(a(f.options.templates.bindSection),f.viewModel)},_buildContent:function(){var h=this;var g=a(h.options.templates.contentHref).html();var f={label:h.options.label,required:h.options.required};return c.Template.compile(g)(f)}});d.plugin(b)})(jQuery);(function(a){var c=window.kendo,d=c.ui,e=d.Widget;var b=e.extend({init:function(f,g){var h=this;e.fn.init.call(this,f,g);h.template=c.template(h.options.template||h.templates.wrapper);h._initialize()},options:{name:"ImageBank",value:[]},templates:{wrapper:"<div class='row'><h2>Select an Image</h2><div class='col-md-12'>#for (var i = 0; i < data; i++) {#<div class='col-md-2'><img src='${data[i]}' /></div>#}#</div></div>"},_initialize:function(){var f=this},value:function(g){var f=this;if(g!==undefined){f.options.value=g}else{return f.options.value}}});d.plugin(b)})(jQuery);(function(a){var c=window.kendo,d=c.ui,e=d.Widget;var b=e.extend({init:function(f,g){e.fn.init.call(this,f,g);this._parseExtensions(g);this._create();this._setupEvents()},inputControls:null,options:{name:"ImageEditor",showFileName:true,allowUpload:true,images:[],minHeight:null,maxHeight:null,minWidth:null,maxWidth:null,previewHeight:150,previewWidth:150,resizePreviewImage:true,previewLeftClass:"col-md-6",previewRightClass:"col-md-6",fixedAspectRatio:false,maxImageSize:0,rotationDegrees:0,acceptedExtensions:[".jpg",".jpeg",".png",".eps",".jpg",".tiff",".tif",".gif",".pdf"],editableExtensions:[".jpg",".jpeg",".png",".jpg",".tiff",".tif",".gif"],previewExtensions:[".jpg",".jpeg",".png",".jpg",".tiff",".tif",".gif",".pdf",".eps"],defaultThumbnails:[{extension:"*.*",thumbnail:"/content/images/defaults/noselect.png"},{extension:".jpg",thumbnail:"/content/images/defaults/Jpg.png"},{extension:".bmp",thumbnail:"/content/images/defaults/uploaded.png"},{extension:".gif",thumbnail:"/content/images/defaults/uploaded.png"},{extension:".png",thumbnail:"/content/images/defaults/Png.png"},{extension:".tiff",thumbnail:"/content/images/defaults/Tiff.png"},{extension:".pdf",thumbnail:"/content/images/defaults/pdf.png"},{extension:".avi",thumbnail:"/content/images/defaults/video.png"},{extension:".wmv",thumbnail:"/content/images/defaults/video.png"},{extension:".mpg",thumbnail:"/content/images/defaults/video.png"},{extension:".mpeg",thumbnail:"/content/images/defaults/video.png"},{extension:".mov",thumbnail:"/content/images/defaults/video.png"},{extension:".rm",thumbnail:"/content/images/defaults/video.png"},{extension:".ram",thumbnail:"/content/images/defaults/video.png"},{extension:".swf",thumbnail:"/content/images/defaults/Swf.png"},{extension:".flv",thumbnail:"/content/images/defaults/Flv.png"},{extension:".mp4",thumbnail:"/content/images/defaults/video.png"},{extension:".mid",thumbnail:"/content/images/defaults/video.png"},{extension:".midi",thumbnail:"/content/images/defaults/audio.png"},{extension:".mp3",thumbnail:"/content/images/defaults/audio.png"},{extension:".wav",thumbnail:"/content/images/defaults/audio.png"},{extension:".wma",thumbnail:"/content/images/defaults/audio.png"},{extension:".doc",thumbnail:"/content/images/defaults/doc.png"},{extension:".docx",thumbnail:"/content/images/defaults/doc.png"},{extension:".xls",thumbnail:"/content/images/defaults/xls.png"},{extension:".xlsx",thumbnail:"/content/images/defaults/xls.png"},{extension:".ppt",thumbnail:"/content/images/defaults/ppt.png"},{extension:".pptx",thumbnail:"/content/images/defaults/ppt.png"},{extension:".csv",thumbnail:"/content/images/defaults/xls.png"},{extension:".tif",thumbnail:"/content/images/defaults/tiff.png"},{extension:".ai",thumbnail:"/content/images/defaults/ai.png"},{extension:".eps",thumbnail:"/content/images/defaults/eps.png"},{extension:".psd",thumbnail:"/content/images/defaults/psd.png"},{extension:".zip",thumbnail:"/content/images/defaults/Zip.png"}],showFancyboxAfterEdit:false,fancyboxAfterEditHref:null,hiddenFieldName:null,hiddenFieldId:null,defaultValue:null,currentScale:1,imageBankImages:[],previousImageValue:null,disabled:""},edit:function(l,g,f,i,j,k){var h=this;if(i!=null){h.options.fixedAspectRatio=i}if(h.options.fixedAspectRatio==null){h.options.fixedAspectRatio=false}if(j!=null&&j>0){h.options.minHeight=j}if(k!=null&&k>0){h.options.minWidth=k}h.editImage(l,g,f)},updateImageEditUrl:function(g,h){var f=this;a(f.options.images).each(function(i){if(this.uid==g){this.editedUrl=h}})},generatePreviewQuerystring:function(){var f=this;if(f.options.resizePreviewImage){return"w="+f.options.previewWidth+"&h="+f.options.previewHeight+"&format=png"}else{return""}},value:function(g){var f=this;if(g==null){return(f.hiddenInput==null)?"":f.hiddenInput.val()}else{f.options.previousImageValue=f.hiddenInput.val();f.hiddenInput.val(g);if(f.getFileExtension(g)==".pdf"||f.getFileExtension(g)==".eps"){f.generatePreviewImage(g,function(h){if(h!=null){if(f.getFileExtension(g)==".pdf"){h=h[0].href}}f.updateSelectedFile(g,h,false)})}else{f.updateSelectedFile(g,null,false)}}},setImageBankImages:function(h,j){var k=this;if(h==null){h=new Array()}k.options.imageBankImages=h;var f=c.Template.compile(k._templates.imageBankTemplate)({data:k.options.imageBankImages,structId:j==undefined?"":j});var l=a(k.element).find(".image-bank-wrapper");if(l.length>0){l.remove()}l=a("<div />",{"class":"hidden image-bank-wrapper"});var i=a("<div />",{id:k.element.attr("id")+"_image_bank_wrapper"});i.append(f);l.append(i);a(k.element).append(l);l=a(k.element).find(".image-bank-wrapper");var g=l.find("img.hand");a(g).each(function(m,n){n=a(n);n.click(function(o){var p=n[0].attributes["data-original"].value;if(k.getFileExtension(p)==".pdf"||k.getFileExtension(p)==".eps"){k.generatePreviewImage(p,function(q){if(k.getFileExtension(p)==".pdf"){q=q[0].href}k.updateSelectedFile(p,q);a.fancybox.close();a("a[href='#divPersonalize']").click()})}else{k.updateSelectedFile(n.attr("data-original"),n.attr("src"));k.element.find(".k-upload-action-edit").click()}})})},_templates:{kendoInputOptions:{async:{saveUrl:"/Upload/Save",removeUrl:"/Upload/Remove",autoUpload:true},multiple:false,template:"<div class='file-wrapper'>  <div class='floatl w50 h100 padu20'><img class='img-responsive' style='background-color:##f9f9f9;' /></div>    <div class='floatl w25 h100 padu20'><span class='text-center filename' /></div>    <div class='floatr w25 block padu20'>     <div>         <a class='k-upload-action-remove btn btn-default'><i class='fa fa-remove hidden-lg hidden-md hidden-sm'></i><span class='hidden-xs'> Remove</span></a>     </div>     <div>         <a class='k-upload-action-edit btn btn-default'><i class='fa fa-pencil hidden-lg hidden-md hidden-sm'></i><span class='hidden-xs'> Edit</span></a>     </div>     <div>         <a class='k-upload-action-upload btn btn-default'><i class='fa fa-pencil hidden-lg hidden-md hidden-sm'></i><span class='hidden-xs'> Upload</span></a>     </div>     <div>         <a class='k-upload-action-replace btn btn-default'><i class='fa fa-mail-reply hidden-lg hidden-md hidden-sm'></i><span class='hidden-xs'> Select</span></a>     </div>  </div></div>",success:function(g){if(g.operation=="upload"){if(g.response.ReturnCode==ReturnCode.Success){var h=a(g.sender.element).closest("*[data-role=imageeditor]").getKendoImageEditor();var f=g.response.Records;h.options.images.push({uid:g.files[0].uid,response:f});if(f.Extension.toLowerCase()===".pdf"){a(document).trigger(argosyEvents.START_LOADING);h.generatePreviewImage(f.UploadFileUrl,function(j){if(j!=null&&j.length>0){a("#previewPagesDiv").show();h.setupPreviewUrls(j)}else{a("#previewPagesDiv").hide()}a(document).trigger(argosyEvents.END_LOADING)})}var i;if(h.element[0]!=undefined){i=h.element[0].id}a(document).trigger(argosyEvents.KENDO_EDITOR_IMAGE_UPLOADED,{uid:g.files[0].uid,response:f,target:i,onSuccess:true})}else{prompt.notify({question:g.response.Message+"| Ref: "+g.response.Guid,type:"error"})}}},complete:function(f){var g=a(f.sender.element).closest("*[data-role=imageeditor]").getKendoImageEditor();var h=a(f.sender.wrapper);if(f.isDefaultImage==null){f.isDefaultImage=false}if(g){if(g.options.images!=null&&g.options.images.length>0){a(g.options.images).each(function(n){var j=this;g.response=j.response;var p=a.inArray(g.response.Extension,g.options.editableExtensions)>-1;var q=a.inArray(g.response.Extension,g.options.previewExtensions)>-1;var k=a.grep(g.options.defaultThumbnails,function(i){return i.extension==g.response.Extension});var r;if(f.isDefaultImage){r=h.find("li:first");this.uid=h.find("li:first").attr("data-uid")}else{r=h.find("li[data-uid='"+j.uid+"']")}var o=r.find("img");g.hiddenInput.val(g.response.UploadFileUrl);if(q){o.attr("src",g.response.PreviewFileUrl+"?"+g.generatePreviewQuerystring());if(g.response.Extension==".pdf"||g.response.Extension==".eps"){a(document).trigger(argosyEvents.KENDO_EDITOR_IMAGE_UPLOADED,{response:g.response,target:a(g.element).attr("id"),onSuccess:false})}}else{if(false){var m=r.find("span.filename");m.text(g.response.FileName)}else{if(k.length>0){o.attr("src",k[0].thumbnail+"?"+g.generatePreviewQuerystring())}else{o.attr("src",g.options.defaultThumbnails[0].thumbnail+"?"+g.generatePreviewQuerystring())}}}var l=r.find(".k-upload-action-edit");var t=r.find(".k-upload-action-replace");var s=r.find(".k-upload-action-remove");var u=r.find(".k-upload-action-upload");if(p){l.show()}else{l.hide()}if(g.options.allowUpload){u.show()}else{u.hide()}if(g.value()===""||(g.options.imageBankImages!=null&&g.options.imageBankImages.length>0)){s.hide()}else{s.show()}if((g.options.imageBankImages!=null&&g.options.imageBankImages.length>0)){t.show()}else{t.hide()}l.unbind("click");t.unbind("click");s.unbind("click");u.unbind("click");u.bind("click",function(i){var v=g.getUpload();a(v.element).click()});l.bind("click",function(i){g.edit(g.response.UploadFileUrl,function(v){g.croppedImage=v;o.attr("src",v.UploadFileUrl+"?"+g.generatePreviewQuerystring());g.hiddenInput.val(window.location.origin+g.croppedImage.UploadFileUrl);g.updateImageEditUrl(j.uid,g.response.UploadFileUrl);if(g.options.showFancyboxAfterEdit&&g.options.fancyboxAfterEditHref!=null){a.fancybox({href:"#"+g.options.fancyboxAfterEditHref})}else{a.fancybox.close()}},function(){if(g.options.showFancyboxAfterEdit&&g.options.fancyboxAfterEditHref!=null){a.fancybox({href:"#"+g.options.fancyboxAfterEditHref})}else{a.fancybox.close()}})});t.bind("click",function(i){if(g.options.imageBankImages.length>0){a.fancybox({href:"#"+g.element.attr("id")+"_image_bank_wrapper",modal:true})}else{g.options.images=[];h.find(".k-dropzone").find("input[type=file]").click()}});s.bind("click",function(i){h.find(".k-dropzone").show();g.options.images=[];r.remove();g.hiddenInput.val("");a(document).trigger(argosyEvents.KENDO_EDITOR_IMAGE_REMOVED,["",a(g.element).attr("id")])});if(!f.isDefaultImage&&p){l.click()}});h.find(".k-dropzone").hide()}else{h.find(".k-upload-files").empty();h.find(".k-dropzone").show();g.options.images=[]}}setTimeout(function(i){a.fancybox.reposition()},500);h.find(".k-upload-status").remove()},select:function(f){var g=a(f.sender.element).closest("*[data-role=imageeditor]").getKendoImageEditor();var h=false;a.each(f.files,function(i,k){var j=false;if(g.options.maxImageSize>0&&g.options.maxImageSize<k.size){prompt.error("Your file cannot be larger than "+formatBytes(g.options.maxImageSize,1));h=true}a(g.options.acceptedExtensions).each(function(l){if(k.extension.toLowerCase()==this){j=true}});if(!j){h=true}});if(h){f.preventDefault()}}},kendoInputBaseTemplate:"<input type='file' name='files' /><input type='hidden' value='' data-is-upload='true' />",imageBankTemplate:'<div class=\'row\'><h2>Select an Image</h2><div class=\'col-md-12\'>#if (data == null || data.length < 1) return;for (var i = 0; i < data.length; i++) {#<div id="divSelectDefault" class="pad10" style="display:inline-block;"><div style="max-width:150px; max-height:150px;"><img  data-original=\'${data[i]}\' id="${i}_imageBankUpload_${structId}" onload="getPreviewImage(\'${data[i]}\', \'${i}_imageBankUpload_${structId}\')" src="/Content/images/generic.gif" class="hover hand"/></div></div >#}#</div></div>',jQueryImageCropperTemplate:"<div class='row' style='width: ${width}px; height: ${height}px;'>   <div class='row'>       <div class='col-md-5'>           <h3 class='nobottommargin'>~{CropYourImage}~</h3>           <p class='padb10 hidden-xs'>~{UseToolsToEditImage}~</p>       </div>       <div class='col-md-7'>           <p class='text-danger' id='cropper-error-box'></p>       </div>   </div>   <div class='row'>       <div class='col-md-12' style='height: ${height-70}px'>           <img id='cropper-image-source' class='img-responsive' src='${image}' />       </div>   </div>       <div class='col_full padu20'>       <div class='crp-btn col_three_fourth padl20'>          <div class='floatl padr20'>               <a type='button' class='btn btn-default mobile100'><i class='fa fa-upload'></i><span class='hidden-md hidden-sm hidden-xs hidden-xxs'> ~{UploadNewImage}~</span></a>          </div>          <div class='floatl padr10'>               <a type='button' class='btn btn-default mobile100'><i class='fa fa-search-plus'></i><span class='hidden-md hidden-sm hidden-xs hidden-xxs'> ~{ZoomIn}~</span></a>          </div>          <div class='floatl padr10'>               <a type='button' class='btn btn-default mobile100'><i class='fa fa-search-minus'></i><span class='hidden-md hidden-sm hidden-xs hidden-xxs'> ~{ZoomOut}~</span></a>          </div>          <div class='floatl padr10 hidden-xs'>               <a type='button' class='btn btn-default mobile100'><i class='fa fa-rotate-left large'></i><span class='hidden-md hidden-sm hidden-xs hidden-xxs'> 15&deg;</span></a>          </div>          <div class='floatl padr10 hidden-xs'>               <a type='button' class='btn btn-default mobile100'><i class='fa fa-rotate-left small'></i><span class='hidden-md hidden-sm hidden-xs hidden-xxs'> 1&deg;</span></a>          </div>          <div class='floatl padr10 hidden-xs'>               <a type='button' class='btn btn-default mobile100'><i class='fa fa-rotate-right small'></i><span class='hidden-md hidden-sm hidden-xs hidden-xxs'> 1&deg;</span></a>          </div>          <div class='floatl padr10 hidden-xs'>               <a type='button' class='btn btn-default mobile100'><i class='fa fa-rotate-right large'></i><span class='hidden-md hidden-sm hidden-xs hidden-xxs'> 15&deg;</span></a>          </div>          <div class='floatl padr10 hidden-xs'>               <a type='button' class='btn btn-default mobile100'><i class='fa fa-refresh'></i><span class='hidden-md hidden-sm hidden-xs hidden-xxs'> ~{Reset}~</span></a>          </div>          </div>       <div class='crp-btn col_one_fourth col_last padr20'>           <div class='floatr'>               <a type='button' class='btn btn-primary mobile100'><i class='fa fa-save'></i><span class='hidden-md hidden-sm hidden-xs hidden-xxs'> ~{Save}~</span></a>          </div>           <div class='floatr padr20'>               <a type='button' class='btn btn-default mobile100'><i class='fa fa-minus-circle'></i><span class='hidden-md hidden-sm hidden-xs hidden-xxs'> ~{Cancel}~</span></a>           </div>           </div>       </div></div>"},_setupEvents:function(){var f=this;a(document).bind("cropper-image-load",function(g){})},_create:function(){var f=this;f.setupUpload()},_parseExtensions:function(f){var g=this;if(f!=null&&f.acceptedExtensions!=null&&a.isArray(f.acceptedExtensions)){g.options.acceptedExtensions=f.acceptedExtensions}},_generateFileTypesString:function(){var g=this;var f="";a(g.options.acceptedExtensions).each(function(h){f+=this;if(h!=g.options.acceptedExtensions.length-1){f+=","}});return f},_configureSaveUrl:function(){var g=this;var f=g._templates.kendoInputOptions.async.saveUrl+"?";if(g.options.minHeight!=null&&g.options.minHeight>0){f+="MinHeight="+g.options.minHeight+"&"}if(g.options.minWidth!=null&&g.options.minWidth>0){f+="MinWidth="+g.options.minWidth+"&"}if(g.options.maxHeight!=null&&g.options.maxHeight>0){f+="MaxHeight="+g.options.maxHeight+"&"}if(g.options.maxWidth!=null&&g.options.maxWidth>0){f+="MaxWidth="+g.options.maxWidth+"&"}g._templates.kendoInputOptions.async.saveUrl=f},getUpload:function(){var g=this;var f=a(g.element);return f.find("input[type=file]").getKendoUpload()},setupUpload:function(){var g=this;var f=g.wrapper=a(g.element);g.setupFileInput();g._configureSaveUrl();g.hiddenInput=f.find("input[type=hidden]");g.value(g.options.defaultValue?g.options.defaultValue:"")},setupFileInput:function(){var i=this;var f=i.element;if(f.find("input[type=hidden]").length==0){f.append(a(i._templates.kendoInputBaseTemplate));var h=f.find("input[type=hidden]");h.attr("id",i.options.hiddenFieldId);h.attr("name",i.options.hiddenFieldName);h.val(i.options.defaultValue);h.change(function(j){})}var g=f.find("input[type=file]");g.attr("accept",i._generateFileTypesString());g.attr("disabled",i.options.disabled)},compile:function(g,f){return c.Template.compile(g)(f)},generatePreviewImage:function(g,f){var h=this;if(g!=null&&g!=""){a.ajax({url:"/Upload/Preview?filePath="+g,dataType:"json",method:"POST",success:function(i){f(i)},error:function(i){f(null)},complete:function(i){}})}else{f(g)}},initializeImageList:function(f,h){var i=this;if(h==null){h=f}var g={uid:c.guid(),response:{UploadFileUrl:f,PreviewFileUrl:h,FileName:i.getFileName(f),Extension:i.getFileExtension(f),FileSize:0,IsMinHeight:true,IsMinWidth:true}};i.options.images=[g];i.options.response=g;i._templates.kendoInputOptions.files=[{name:g.response.FileName,extension:g.response.Extension,size:g.response.FileSize,uid:g.uid}];i.initializeInputControl()},initializeInputControl:function(){var f=this;if(f.inputControls!=null&&f.inputControls!=undefined){f.inputControls.destroy();a(f.element).find(".k-file-success").remove();a(f.element).find(".k-dropzone").remove();a(f.element).append("<input type='file' name='files' />")}f.inputControls=a(f.element).find("input[type=file]").kendoUpload(f._templates.kendoInputOptions);f.inputControls=f.inputControls.getKendoUpload();f.inputControls._events.complete[0]({sender:f.inputControls,isDefaultImage:true})},updateSelectedFile:function(f,g,i){var h=this;if(i==null||i){h.options.previousImageValue=h.hiddenInput.val()}if((h.options.imageBankImages!=null&&h.options.imageBankImages.length>0)||(f!=null&&f.trim().length>0)){h.initializeImageList(f,g)}else{h.options.images=[];h.options.response=null;h._templates.kendoInputOptions.files=[]}h.initializeInputControl()},getFileName:function(f){if(f==null){return""}return f.replace(/^.*[\\\/]/,"")},getFileExtension:function(g){var f="";if(g!=null){f="."+g.split(".").pop()}return f},editImage:function(i,l,f){var m=this;var g={image:i,height:a(window).height()*0.8,width:a(window).width()*0.8};var h=m._templates.jQueryImageCropperTemplate;var j=c.template(h);var k=j(g);a.fancybox({content:k,scrolling:"no",modal:true,afterShow:function(o){var p=a.fancybox.wrap;var n=m.getAspectRatio();p.find("#cropper-image-source").cropper({aspectRatio:(m.options.fixedAspectRatio?n.w/n.h:NaN),viewMode:1,guides:true,center:true,highlight:true,modal:true,scalable:true,zoomable:true,rotatable:true,responsive:true,cropBoxMovable:true,movable:true,zoomOnWheel:false,minCropBoxWidth:(m.options.minWidth!=null?m.options.minWidth:null),minCropBoxHeight:(m.options.minHeight!=null?m.options.minHeight:null),built:function(q){a("#cropper-image-source").cropper("zoom",0.1);a("#cropper-image-source").cropper("zoom",-0.1)},});p.find(".fa-search-plus").parent().click(function(q){if(m.canScale(0.1)){a("#cropper-image-source").cropper("zoom",0.1)}});p.find(".fa-search-minus").parent().click(function(q){if(m.canScale(-0.1)){a("#cropper-image-source").cropper("zoom",-0.1)}});p.find(".fa-rotate-left.large").parent().click(function(q){a("#cropper-image-source").cropper("rotate",-15)});p.find(".fa-rotate-right.large").parent().click(function(q){a("#cropper-image-source").cropper("rotate",15)});p.find(".fa-rotate-left.small").parent().click(function(q){a("#cropper-image-source").cropper("rotate",-1)});p.find(".fa-rotate-right.small").parent().click(function(q){a("#cropper-image-source").cropper("rotate",1)});p.find(".fa-upload").parent().click(function(q){m.options.images=[];m.element.find(".k-dropzone").find("input[type=file]").click()});p.find(".fa-refresh").parent().click(function(q){a("#cropper-image-source").cropper("reset");m.setupCanvasAndImage();p.find("[data-role=colorpicker]").getKendoColorPicker().value("transparent")});p.find("[data-role=colorpicker]").kendoColorPicker({value:"transparent",opacity:true,buttons:false,select:function(q){a(".cropper-wrap-box").css("background-color",q.value)},change:function(q){a(".cropper-wrap-box").css("background-color",q.value)}});p.find(".fa-save").parent().click(function(q){m.cropData=a("#cropper-image-source").cropper("getData");m.cropBoxData=a("#cropper-image-source").cropper("getCropBoxData");a(document).trigger(argosyEvents.START_LOADING);a.ajax({url:"/Upload/Crop",dataType:"json",method:"POST",data:{url:m.response.UploadFileUrl,x:m.cropData.x,y:m.cropData.y,x2:m.cropData.x+m.cropData.width,y2:m.cropData.y+m.cropData.height,height:m.cropBoxData.height,width:m.cropBoxData.width,rotate:m.cropData.rotate,scaleX:m.options.currentScale,scaleY:m.options.currentScale,format:".png",bgColor:"transparent",anchor:"topleft",quality:100},success:function(r){if(r.ReturnCode==ReturnCode.Success){l(r.Records);a(document).trigger(argosyEvents.KENDO_EDITOR_IMAGE_UPLOADED,[r.Records,a(m.element).attr("id")])}else{prompt.notify({type:"error",question:r.Message+" | Ref: "+r.Guid})}},complete:function(r){a(document).trigger(argosyEvents.END_LOADING);unblock()}})});p.find(".fa-minus-circle").parent().click(function(q){m.value(m.options.previousImageValue);f()})}})},canScale:function(f){var g=this;if(g.options.minimumScaleAmount!=null&&(g.options.currentScale+f)<g.options.minimumScaleAmount){return false}else{g.options.currentScale=g.options.currentScale+f;return true}},setupCanvasAndImage:function(){var q=this;var k=a("#cropper-image-source").cropper("getImageData");var h=a("#cropper-image-source").cropper("getCropBoxData");var g=a("#cropper-image-source").cropper("getContainerData");var f={left:q.calculateOffset(g.width,k.naturalWidth),top:q.calculateOffset(g.height,k.naturalHeight),height:k.naturalHeight,width:k.naturalWidth};var i={};if(q.options.minWidth!=null&&q.options.minWidth>0){i.width=q.options.minWidth}if(q.options.minHeight!=null&&q.options.minHeight>0){i.height=q.options.minHeight}if(k.naturalHeight>g.height||k.naturalWidth>g.width){var n=q.scaleImageToContainer(g,k);f={left:q.calculateOffset(g.width,n.width),top:q.calculateOffset(g.height,n.height),height:n.height,width:n.width};if(q.options.minWidth==null||q.options.minWidth<=0){i.width=f.width}if(q.options.minHeight==null||q.options.minHeight<=0){i.height=f.height}}jsConsole.log("canvas left  : "+f.left);jsConsole.log("canvas top   : "+f.top);jsConsole.log("canvas height: "+f.height);jsConsole.log("canvas width : "+f.width);a("#cropper-image-source").cropper("setCanvasData",f);if(i.width!=null){i.left=q.calculateOffset(g.width,i.width)}else{i.left=f.left}if(i.height!=null){i.top=q.calculateOffset(g.height,i.height)}else{i.top=f.top}a("#cropper-image-source").cropper("setCropBoxData",i);if(h.height>k.height||h.width>k.width){var o=h.height/k.height;var p=h.width/k.width;var j=(o>p?o:p);q.options.minimumScaleAmount=j;q.options.currentScale=j;a("#cropper-image-source").cropper("zoom",(j-1))}else{q.options.minimumScaleAmount=null;q.options.currentScale=1}var m=[];if(q.options.minWidth>k.naturalWidth&&q.options.minHeight>k.naturalHeight){m.push("The image does not meet the minimum size of "+q.options.minWidth+"px by "+q.options.minHeight+"px and has been scaled to fit.")}else{if(q.options.minWidth>k.naturalWidth||q.options.minHeight>k.naturalHeight){if(q.options.minWidth>k.naturalWidth){m.push("The image does not meet the minimum width of "+q.options.minWidth+"px and has been scaled to fit.")}if(q.options.minHeight>k.naturalHeight){m.push("The image does not meet the minimum height of "+q.options.minHeight+"px and has been scaled to fit.")}}}if(m.length>0){var l="";a(m).each(function(r){l+=this+"<br />"});a("#cropper-error-box").html(l)}},scaleImageToContainer:function(f,h){var j={height:f.height,width:f.width};var i=0;var k=h.naturalWidth;var g=h.naturalHeight;if(k>j.width){i=j.width/k;j.width=j.width;j.height=g*i}else{if(g>j.height){i=j.height/g;j.width=k*i;j.height=j.height}}return j},calculateOffset:function(g,f){return(g/2)-(f/2)},getAspectRatio:function(){var h=this;if(h.options.fixedAspectRatio){var f=function(i,j){return(j==0)?i:f(j,i%j)};var g=f(h.options.minWidth,h.options.minHeight);return{gcd:g,w:h.options.minWidth/g,h:h.options.minHeight/g}}else{return null}},setupPreviewUrls:function(f){a("#previewPagesLink").click(function(){a.fancybox(f,{nextEffect:"none",prevEffect:"none",padding:0,helpers:{title:{type:"over"},thumbs:{width:50,height:50,source:function(g){return g.href.replace("thumb_","small_")}}}})})}});d.plugin(b)})(jQuery);(function(a){var b=window.kendo,d=b.ui,e=d.Widget;var c=e.extend({init:function(g,h){var i=this;e.fn.init.call(this,g,h);if(h.sourceColumns!=null){i.options.sourceColumns=h.sourceColumns}var f=new ControlLoader();f.loadTemplate("ListMapper",function(j){a(document.body).append(j);i._initialize()})},options:{name:"ListMapper",sourceColumns:["First Name","Last Name","Address","City","State","ZIP Code","Middle Initial","Company","Email","Hobbies","Country"],ignoreColumns:["_____UID_____","Updated_Address","IsValid","MD5","Count","Duplicate"],destinationColumns:[{Name:"Full Name",ColumnName:"Full Name",Description:"(First, M. Last Name)",Required:true,Hint:["First Name","Last Name","Middle Name","Middle Initial","Middle","first_name","last_name","st_contact","Fullname"],},{Name:"Company",ColumnName:"Company",Description:"",Required:false,Hint:["st_company","Company"]},{Name:"Email",ColumnName:"Email",Description:"",Required:false,Hint:["email","st_email"],},{Name:"Address 1",ColumnName:"Address 1",Description:"",Required:true,Hint:["Address","st_Address1","st_Address","Street_Number","Street_Name","street","Address1","Address_1"],},{Name:"Address 2",ColumnName:"Address 2",Description:"",Required:false,Hint:["Address2","st_Address2","Street_Number2","Street_Name2","street2","Address_2"],},{Name:"Address 3",ColumnName:"Address 3",Description:"",Required:false,Hint:["Address3","st_Address3","Street_Number3","Street_Name3","street3","Address_3"],},{Name:"City",ColumnName:"City",Description:"",Required:true,Hint:["City","st_city"]},{Name:"State",ColumnName:"State",Description:"",Required:true,Hint:["State","St","st_state"],},{Name:"ZIP Code",ColumnName:"ZIP Code",Description:"",Required:true,Hint:["Zip","Postal Code","Postal","st_zip","st_zipcode","Zip_Code"],},],templates:{placeholder:"<li class='list-item' id='placeholder'>~{DropHere}~</li>",contentHref:"#_ListMapperTemplate"}},value:function(f){var g=this;if(f==null){return g.options.destinationColumns}else{g.options.destinationColumns=f}},isValid:function(){var g=this;var f=true;a(g.options.destinationColumns).each(function(h){if(this.Required&&(this.SourceColumns==null||this.SourceColumns.length<=0)){f=false}});if(!f){prompt.alert({question:"~{AllRequiredColumnsMustBeMapped}~",type:"warning"})}return f},getUnmappedColumns:function(h){var f=this;var g=[];h=(h==null?true:false);a(f.options.sourceColumns).each(function(j){var m=f.options.sourceColumns[j];var l=false;a(f.options.destinationColumns).each(function(o){var n=this;if(n.SourceColumns==null&&h){n.SourceColumns=[]}if(n.Id==null){n.Id=b.guid().replace(/[-]/g,"")}if(f.isAutoMapped(n.Name,m,n.Hint)){l=true;if(h){n.SourceColumns.push(m)}}});var k=a.grep(f.options.ignoreColumns,function(i){return i.toLowerCase()===m.toLowerCase()});if(!l&&k.length===0){g.push(m)}});return g},isAutoMapped:function(f,i,g){var h=f.Name===i;if(g!=null&&!h){a(g).each(function(k,j){if(i.toLowerCase()==j.toLowerCase()){h=true}})}return h},addColumn:function(f,h,g){var i=this;a(i.options.destinationColumns).each(function(j){if(this.Name===f){this.SourceColumns.splice(g,0,h)}})},removeColumn:function(f,g){var h=this;a(h.options.destinationColumns).each(function(j){if(this.Name===f){var k=a.inArray(g,this.SourceColumns);this.SourceColumns.splice(k,1)}})},updateDestinationColumns:function(g){var k=this,f=g.sender.element.attr("data-value"),j=g.item.text(),h=g.newIndex,i=g.oldIndex;switch(g.action){case"receive":k.addColumn(f,j,h);break;case"remove":k.removeColumn(f,j);break}},_initialize:function(){var f=this;f.element.append(f._buildContent());f._configureSortable()},_buildContent:function(){var h=this;var g=a(h.options.templates.contentHref).html();var f={destinationColumns:h.options.destinationColumns,unmappedColumns:h.getUnmappedColumns(),};return b.Template.compile(g)(f)},_configureSortable:function(){var g=this;var f=g._generateConnectWith();a(g.options.destinationColumns).each(function(h){a("#sortable-list_"+this.Id).kendoSortable({connectWith:f,placeholder:g.options.templates.placeholder,change:function(i){g.updateDestinationColumns(i)}})});a("#sortable-list_Unmapped").kendoSortable({connectWith:f,placeholder:g.options.templates.placeholder,change:function(h){g.updateDestinationColumns(h)}})},_generateConnectWith:function(){var g=this;var f="";a(g.options.destinationColumns).each(function(h){f+="#sortable-list_"+this.Id+", "});f+="#sortable-list_Unmapped";return f},_createHiddenInput:function(){var g=this;var f=a("<input />",{type:"hidden",id:g.options.inputId,name:g.options.inputId.replace("_",".")});return f},});d.plugin(c)})(jQuery);(function(a){var b=window.kendo,d=b.ui,e=d.Widget;var c=e.extend({init:function(f,g){e.fn.init.call(this,f,g);this._initialize()},options:{name:"LoadedImage",getUrl:null,width:250,height:250},_initialize:function(){var f=this;f.element.src="/LoadingImage";a.ajax({url:f.options.getUrl,dataType:"json",method:"GET",success:function(g){f.element.src=g+"?w="+f.options.width+"&h="+f.options.height}})},});d.plugin(c)})(jQuery);(function(a){var b=window.kendo,d=b.ui,e=d.Widget;var c=e.extend({init:function(f,g){e.fn.init.call(this,f,g);this._create()},options:{name:"MapImage",hiddenFieldName:null,hiddenFieldId:null,showFancyboxAfterEdit:false,fancyboxAfterEditHref:null,latitude:30.268107,longitude:-97.744821,zoom:12,markerInsertActive:false,defaultAddress:null},value:function(){var f=this;return f._input.val()},show:function(){var f=this;a.fancybox.open({content:f._map.element.closest(".map-wrapper").show(),afterShow:function(h){if(f.options.defaultAddress==null||f.options.defaultAddress==""){f._getGeoLocation();var g=f._map.center();f._map.center([g.lat,g.lng]);f._map.zoom(f._map.zoom())}else{f._geoCodeAddress(f.options.defaultAddress)}setTimeout(function(i){a(".k-attribution").show()},500)},modal:true,scrolling:"no"})},close:function(){var f=this;if(f.options.showFancyboxAfterEdit&&f.options.fancyboxAfterEditHref!=null){a.fancybox({href:"#"+f.options.fancyboxAfterEditHref})}else{a.fancybox.close()}},exportMap:function(){var f=this;block(null,"Generating your map...");b.drawing.drawDOM(f._map.element).then(function(g){return b.drawing.exportImage(g)}).done(function(i){var j=i;i=i.replace("data:","");i=i.split(";");var h=i[0];var g=i[1].replace("base64,","");a.ajax({url:"/Upload/Export",dataType:"json",method:"POST",data:{base64:g,contentType:h},success:function(k){if(k.ReturnCode==ReturnCode.Success){f._input.val(k.Records.UploadFileUrl);f._editMapButton.element.show();f._addMapButton.element.hide();f.close()}else{prompt.notify({type:"error",question:k.Message+" | Ref: "+k.Guid})}},complete:function(k){unblock()}})})},_input:null,_templates:{kendoMapOptions:{},insertMapButton:"<button>Insert Map</button>",editMapButton:'<button data-role="button"><i class="fa fa-map-o"></i> Edit Map</button>',kendoMapElement:'<div class="hide map-wrapper"><h3>Map Creator</h3>   <div class="clearfix">       <div class="btn_not_full">           <input type="text" class="k-textbox" placeholder="Enter Address Here...">           <button class="btn btn-link" data-role="button" class="floatl"><i class="fa fa-search"></i></button>       </div>   </div>   <div class="padb10 padu10 clearfix">       <div class="">           <div data-role="map"></div>       </div>   </div>   <div class="clearfix padb10 padu10">       <div class="">           <em>&copy; Microsoft Corporation. <a href="https://www.microsoft.com/maps/assets/docs/terms.aspx">Terms of Use</a> | <a href="https://www.microsoft.com/maps/product/print-rights.html">Print Rights</a></em>       </div>   </div>   <div class="clearfix">       <div class="pull-right btn_not_full">           <button class="btn btn-default"  data-role="button" class="floatr"><i class="fa fa-times"></i><span class="hidden-xs hidden-sm"> Cancel</span></button>&nbsp;           <button class="btn btn-default" data-role="button"><i class="fa fa-map-pin"></i><span class="hidden-xs hidden-sm"> Clear Marker</span></button>&nbsp;           <button class="btn btn-default" data-role="button"><i class="fa fa-map-o"></i><span class="hidden-xs hidden-sm"> Remove Map</span></button>&nbsp;           <button class="btn btn-primary" data-role="button"><i class="fa fa-chevron-right"></i><span class="hidden-xs hidden-sm"> Insert Map</span></button>       </div>   </div><div>',hiddenInput:"<input type='hidden' />"},_create:function(){var f=this;f._createHiddenInput();f._createInsertMapButton();f._createEditMapButton();f._createMapElement();f._mapKendoControls();f._setupKendoEvents()},_mapKendoControls:function(){var f=this;f._map=f._map.kendoMap({center:[f.options.latitude,f.options.longitude],zoom:f.options.zoom,layerDefaults:{bing:{opacity:1,}},controls:{attribution:true},layers:[{type:"bing",key:"AizA5aFF9XxV-yjC5T5nsQ0-YqsDqFsMFN84LoHy6IrT1aMlgBXaFLg05ZIKQhPP"}],click:function(g){var h=g.location.lat;var i=g.location.lng;f._map.markers.dataSource.data([{location:[h,i],shape:"pin"}])}}).getKendoMap();f._addMapButton=f._addMapButton.kendoButton({icon:"plus"}).getKendoButton();f._editMapButton=f._editMapButton.kendoButton().getKendoButton();f._insertMapButton=f.element.find(".map-wrapper").find(".fa-chevron-right").closest("button").kendoButton().getKendoButton();f._removeMapButton=f.element.find(".map-wrapper").find(".fa-map-o").closest("button").kendoButton().getKendoButton();f._cancelMapButton=f.element.find(".map-wrapper").find(".fa-times").closest("button").kendoButton().getKendoButton();f._clearMarkersButton=f.element.find(".map-wrapper").find(".fa-map-pin").closest("button").kendoButton().getKendoButton();f._searchMapButton=f.element.find(".map-wrapper").find(".fa-search").closest("button").kendoButton().getKendoButton()},_setupKendoEvents:function(){var f=this;f._addMapButton.bind("click",function(g){f.show()});f._editMapButton.bind("click",function(g){f.show()});f._insertMapButton.bind("click",function(g){f.exportMap()});f._removeMapButton.bind("click",function(g){f._input.val("");f._editMapButton.element.hide();f._addMapButton.element.show();f.close()});f._cancelMapButton.bind("click",function(g){f.close()});f._clearMarkersButton.bind("click",function(g){f._map.markers.dataSource.data([])});f._searchMapButton.bind("click",function(h){var g=h.sender.element.parent().parent().find("input").val();f._geoCodeAddress(g)})},_createHiddenInput:function(){var f=this;f._input=f.element.find("input");if(f._input.length==0){f._input=f.element.append(f._templates.hiddenInput)}},_createMapElement:function(){var g=this;var f=a(g._templates.kendoMapElement);g._map=g.element.append(f).find("*[data-role=map]");if(g.options.defaultAddress!=null){g.element.find("input[type=text]").val(g.options.defaultAddress)}g._resizeMapWrapper(g._map)},_createInsertMapButton:function(){var g=this;var f=a(g._templates.insertMapButton);if(g._input.is(":disabled")){f.attr("disabled","disabled")}g._addMapButton=g.element.append(f).find("button")},_createEditMapButton:function(){var g=this;var f=a(g._templates.editMapButton);if(g._input.is(":disabled")){f.attr("disabled","disabled")}g._editMapButton=g.element.append(f).find(".fa-map-o").closest("button");g._editMapButton.hide()},_resizeMapWrapper:function(f){var g=a(document).width();if(g<880){g=g*0.9}else{g=800}f.closest(".map-wrapper").css("min-width",g)},_getGeoLocation:function(){var f=this;if(navigator.geolocation){navigator.geolocation.getCurrentPosition(function(g){f.options.latitude=g.coords.latitude;f.options.longitude=g.coords.longitude})}else{prompt.notify({type:"error",question:"Geolocation is not supported by this browser."})}},_geoCodeAddress:function(f){var g=this;a.ajax({url:"/Store/Proofing/GeoCodeAddress?address="+f,dataType:"json",method:"GET",success:function(h){if(h.ReturnCode==ReturnCode.Success){if(h.Records.ErrorMessage==null&&h.Confidence!="No results"){g._map.markers.dataSource.data([{location:[h.Records.Latitude,h.Records.Longitude],shape:"pin"}]);g._map.center([h.Records.Latitude,h.Records.Longitude]);g._map.zoom(g._map.zoom())}else{if(h.Confidence=="No results"){prompt.notify({type:"error",question:"We were unabled to find a location for the information provided."})}else{prompt.notify({type:"error",question:h.Records.ErrorMessage})}}}else{prompt.notify({type:"error",question:h.Message+" | Ref: "+h.Guid})}},complete:function(h){unblock()}})}});d.plugin(c)})(jQuery);(function(a){var c=window.kendo,e=c.ui,f=e.Widget,b="change";var d=f.extend({init:function(g,h){var i=this;f.fn.init.call(i,g,h);i._initialize()},events:[b],options:{name:"PartPricing",partId:null,showPriceSummary:false,appendZeroDiscount:false,value:null},_templates:{preFetchTemplate:'<i class="fa fa-spinner fa-pulse fa-1x fa-fw margin-bottom"><span class="sr-only"> Loading...</span></i>',partTemplate:'<div>#if(!data.IsExpired && (!data.IsExpired && data.FlagOffered)){# <div data-template="_GlobalPricingTemplate" data-bind="source: this"></div>#if (showPriceSummary) {#<p class="product-price nowrap">#= renderProductPriceViewTemplate(data) #</p>#}#</div> #} else {#  #if(data.IsExpired) {#  Exp. ${kendo.toString(kendo.parseDate(data.ExpirationDate),"MM/dd/yyyy")}  #} else {#   Not offered #}#   #}#'},value:function(g){var j=this;var h=j.element.find("[data-cart-input=true]");var i=a.getKendoControl(h);if(g==null){if(i!=null){return i.value()}}else{i.value(g)}return 0},_initialize:function(){var g=this;g.element.append(g._templates.preFetchTemplate);if(g.options.partId>0){a.ajax({url:"/Store/Part/GetPartById/"+g.options.partId,type:"GET",dataType:"json",contentType:"application/json; charset=utf-8",success:function(h){g.updatePart(h)}})}else{g.element.empty()}},change:function(g){a(document).trigger(argosyEvents.EVENT_PART_INPUT_QTY_CHANGED,g)},updatePart:function(g){var j=this;var h=convertPartToPricing(g,{value:(j.options.value==null?g.DefaultQuantity:(parseInt(j.options.value)===0?null:j.options.value)),change:function(k){var l=0;switch(k.sender.ns){case".kendoDropDownList":l=k.sender.dataItem(k.item).Quantity;break;default:l=k.sender.value();break}j.change({partId:k.data.part.partId,value:l})},spin:function(k){if(!h.options.spinEventTriggered){h.options.spinEventTriggered=true;setTimeout(function(l){j.change({partId:parseInt(a(k.sender.element).attr("data-part-id")),value:k.sender.value()});h.options.spinEventTriggered=false},250)}},dataBound:function(m){var k=a(m.sender.element),l=70;k.data("kendoDropDownList").list.width("auto");k.closest(".k-widget").width(l)},appendZeroDiscount:j.options.appendZeroDiscount});g.showPriceSummary=j.options.showPriceSummary;j.options.part=g;j.element.empty();var i=c.Template.compile(j._templates.partTemplate)(j.options.part);j.element.append(i);c.bind(j.element,h)},items:function(){return this.element.children()}});e.plugin(d)})(jQuery);(function(a){var b=window.kendo,d=b.ui,e=d.Widget;var c=e.extend({init:function(f,g){var h=this;e.fn.init.call(this,f,g);h._initialize()},options:{name:"partAutoComplete",bindingGroup:"",dataSource:{},initialized:false,disabled:false,partId:0,inputId:"",companyId:0,siteId:0,userGroupId:0},value:function(f){var g=this;if(f==null){if(g._hiddenInput){return g._hiddenInput.val()}}else{g._hiddenInput.val(f.PartId);g._autoComplete.value(f.PartName)}},_initialize:function(){var f=this;f.element.append(f._createHiddenInput());f._hiddenInput=f.element.find("input[type=hidden]");f.element.append(a("<input id='partCompleteInput' data-role='autocomplete' />"));f.element.find("input[data-role=autocomplete]").kendoAutoComplete({dataTextField:"PartName",dataSource:f._getDataSource({}),enable:f.options.disabled!=="disabled",change:function(){var g=this.dataItem();f.value(g);a(document).trigger(argosyEvents.EVENT_AUTOCOMPLETE_PART_SELECTED,{part:g})}});f._autoComplete=f.element.find("input[data-role=autocomplete]").getKendoAutoComplete()},_createHiddenInput:function(){var h=this;var g=h.options.inputId;if(h.options.bindingGroup!=null&&h.options.bindingGroup!==""){g=h.options.bindingGroup+"_"+g}var f=a("<input />",{type:"hidden",id:g,name:g.replace(/_/g,"."),value:h.options.partId});return f},_getDataSource:function(){var f=this;a.extend(true,f.options.dataSource,_defaultDataSourceConfig);f.options.dataSource.transport={read:function(g){var h={UserGroup:f.options.userGroupId,CompanyId:f.options.companyId,SiteId:f.options.siteId,Take:10,RecordSizeCategory:f.options.recordSizeCategory};a.extend(true,h,kendoOptionsToObject(g),f.searchCriteria);h.Take=10;a.ajax({url:"/DataView/GetParts",dataType:"json",data:h,success:function(i){if(i.ReturnCode===ReturnCode.Failed){handleDataSourceException(i.Records)}else{g.success(i.Records)}}})}};f.options.dataSource.schema={total:function(g){return g.length}};f.options.dataSource.pageSize=99999;f.options.dataSource.serverFiltering=true;return new b.data.DataSource(f.options.dataSource)}});d.plugin(c)})(jQuery);(function(a){var c=window.kendo,e=c.ui,f=e.Widget,b="change";var d=f.extend({init:function(g,h){var i=this;f.fn.init.call(i,g,h);i._initialize()},events:[b],options:{name:"PartPricing",partId:null,showPriceSummary:false,appendZeroDiscount:false,value:null,cartId:null,rank:0,ignoreFirstChange:true},_templates:{preFetchTemplate:'<i class="fa fa-spinner fa-pulse fa-1x fa-fw margin-bottom"><span class="sr-only"> Loading...</span></i>',partTemplate:'<div>#if(!data.IsExpired && (!data.IsExpired && data.FlagOffered)){# <div data-template="_GlobalPricingTemplate" data-bind="source: this"></div>#if (showPriceSummary) {#<p class="product-price nowrap">#= renderProductPriceViewTemplate(data, null, true) #</p>#}#</div> #} else {#  #if(data.IsExpired) {#  Exp. ${kendo.toString(kendo.parseDate(data.ExpirationDate),"MM/dd/yyyy")}  #} else {#   Not offered #}#   #}#'},value:function(g){var j=this;var h=j.element.find("[data-cart-input=true]");var i=a.getKendoControl(h);if(g==null){if(i!=null){return i.value()}}else{i.value(g)}return 0},_initialize:function(){var g=this;g.element.append(g._templates.preFetchTemplate);if(g.options.partId>0){getPart(g.options.partId,function(h){g.updatePart(h)})}else{g.element.empty()}},change:function(g){a(document).trigger(argosyEvents.EVENT_PART_INPUT_QTY_CHANGED,g)},updatePart:function(g){var j=this;var h=convertPartToPricing(g,{value:(j.options.value==null?g.DefaultQuantity:(parseInt(j.options.value)===0?null:j.options.value)),change:function(k){var l=0;switch(k.sender.ns){case".kendoDropDownList":l=k.sender.dataItem(k.item).Quantity;break;default:l=k.sender.value();break}j.change({partId:k.data.part.partId,value:l,cartId:j.options.cartId})},spin:function(k){if(!h.options.spinEventTriggered){h.options.spinEventTriggered=true;setTimeout(function(l){j.change({partId:parseInt(a(k.sender.element).attr("data-part-id")),cartId:j.options.cartId,value:k.sender.value()});h.options.spinEventTriggered=false},250)}},dataBound:function(m){var k=a(m.sender.element),l=70,n=this;k.data("kendoDropDownList").list.width("auto");k.closest(".k-widget").width(l);if(!j.options.appendZeroDiscount&&n.value!=null&&n.value.toString()!==k.getKendoDropDownList().value().toString()){k.getKendoDropDownList().value(n.value);if(!j.options.ignoreFirstChange){n.change(m);j.options.ignoreFirstChange=false}}},appendZeroDiscount:j.options.appendZeroDiscount,cartId:j.options.cartId,rank:j.options.rank});g.showPriceSummary=j.options.showPriceSummary;j.options.part=g;j.element.empty();var i=c.Template.compile(j._templates.partTemplate)(j.options.part);j.element.append(i);c.bind(j.element,h);j.element.find("[data-role=numerictextbox]").focus(function(k){var l=a(this);setTimeout(function(){l.select()})})},items:function(){return this.element.children()}});e.plugin(d)})(jQuery);(function($){var kendo=window.kendo,ui=kendo.ui,Widget=ui.Widget;var ProofingVariables=Widget.extend({init:function(element,options){var that=this;Widget.fn.init.call(this,element,options);$.get(that.options.templatePath,function(template){$(document.body).append(template);that._dataSource();that._setupBindingModel();that._initialize();that._setupEvents()})},options:{name:"ProofingVariables",templatePath:"/scripts/controls/templates/proofingVariables.html",proofText:"~{Proof}~",actionText:"~{Build}~",title:"~{PersonalizeInformation}~",personalizeMessage:"~{EnterInformationToPersonalizeItems}~",fancybox:{showAfterEdit:false,fancyBoxHref:null},templates:{controls:{qrCode:"#_ProofingVariableQrCodeControl",imageBankListView:"#_ProofingVariableImageBankListControl",imageBankOrUpload:"#_ProofingVariableImageBankOrUpload",map:"#_ProofingVariableMapControl",textArea:"#_ProofingVariableTextAreaControl",prePopulate:"#_ProofingVariablePrePopulateControl",dateTime:"#_ProofingVariableDateTimeControl",textBox:"#_ProofingVariableTextBoxControl",sku:"#_ProofingVariableSkuControl",imageBank:"#_ProofingVariableImageBankControl",dropDownText:"#_ProofingVariableDropDownTextControl",imageUpload:"#_ProofingVariableImageUploadControl",dropDownList:"#_ProofingVariableDropDownListControl",},variableWrapperTemplate:"#_ProofingPersonalizeTemplate",variableControlTemplate:"#_ProofingVariableControlTemplate",variableNonGroupedTemplate:"#_ProofingNonGroupedVariables"}},setDataSource:function(dataSource){this.options.dataSource=dataSource;this._dataSource()},_dataSource:function(){var that=this;that.dataSource=that.options.dataSource==null?{}:that.options.dataSource;that.dataSource.proofText=that.options.proofText;that.dataSource.actionText=that.options.actionText;that.dataSource.title=that.options.title;that.dataSource.personalizeMessage=that.options.personalizeMessage},_controlTypes:{qrCode:"qrcode",imageBankListView:"imagebanklistview",imageBankOrUpload:"imagebankorupload",map:"map",textArea:"textarea",prePopulate:"prepopulate",dateTime:"datetime",textBox:"textbox",sku:"sku",imageBank:"imagebank",dropDownText:"dropdowntext",imageUpload:"imageupload",dropDownList:"dropdownlist",multiselect:"multiselect"},isValid:function(){var that=this,valid=true,variables=that.getVariables(true);$(variables).each(function(i){if(this.Required&&this.Value.trim().length==0){valid=false;if($.isKendo(this.Element)){$.getKendoControl(this.Element).wrapper.addClass("input-validation-error")}else{this.Element.addClass("input-validation-error")}}else{if($.isKendo(this.Element)){$.getKendoControl(this.Element).wrapper.removeClass("input-validation-error")}else{this.Element.removeClass("input-validation-error")}}});return valid},getVariables:function(includeRequired){var that=this,prefix="var_",argosyType="data-argosy-proofing",element=that.element;var variables=$(element).find("*["+argosyType+"]");var variableObject=[];$(variables).each(function(i){var propertyName=$(this).attr(argosyType).replace(prefix,""),isProofName=$(this).data("isProofName"),item={Name:propertyName,Value:"",IsProofName:isProofName};if($.isKendo($(this))){var kendoControl=$.getKendoControl($(this));var dataValueField=kendoControl.element.attr("data-text-value");if(dataValueField==null||dataValueField==""){item.Value=kendoControl.value();if(this.attributes["data-format"]!=null&&item.Value!=null&&item.Value!=""){item.Value=kendo.toString(item.Value,this.attributes["data-format"].value)}}else{var selectedIndex=kendoControl.selectedIndex;var naturalValue=kendoControl.value();if(selectedIndex!=null&&selectedIndex>-1){var dataItem=kendoControl.dataItem(selectedIndex);if(dataItem!=null){item.Value=kendoControl.dataItem(selectedIndex)[dataValueField]}}else{if($.type(naturalValue)=="string"||$.type(naturalValue)=="number"){item.Value=naturalValue}else{if($.type(naturalValue)=="array"){var data=[];$.each(naturalValue,function(i,item){data.push(item.Value)});item.Value=data.join()}}}}if(item.Value==null){item.Value=""}if($.type(item.Value)=="date"){item.Value=kendo.toString(item.Value,"d")}if($.type(item.Value)=="array"){item.Value=item.Value.join()}}else{item.Value=$(this).val()}if(includeRequired){item.Required=($(this).attr("required")!=null);item.Element=$(this)}if($(this).attr("data-is-upload")!=null){item.IsUpload=$(this).attr("data-is-upload")}else{item.IsUpload=false}if($(this).attr("data-variable-id")!=null){item.Id=$(this).attr("data-variable-id")}if($(this).attr("data-control-type")!=null){item.ControlType=$(this).attr("data-control-type")}if($(this).attr("data-display-name")!=null){item.DisplayName=$(this).attr("data-display-name")}if($(this).attr("data-name")!=null){item.Name=$(this).attr("data-name")}if(item.Name!=null&&item.Name.trim().length>0){variableObject.push(item)}});return variableObject},setVariables:function(variables){},_setupEvents:function(){var that=this;var buildProofButton=that.element.find(".btn-buildproof");buildProofButton.unbind("click");buildProofButton.click(function(e){$(document).trigger(argosyEvents.EVENT_BUILD_PROOF,{variables:that.getVariables(),isValid:that.isValid(),part:that.dataSource.Part})});$(document).bind(argosyEvents.EVENT_REGENERATE_VARIABLES,function(e,data){buildProofButton.click()});$("[data-role=datepicker]").keypress(function(e){return false});$("[data-role=datepicker]").focus(function(e){$(e.target).getKendoDatePicker().open()})},_initialize:function(){var that=this;that.element.append(kendo.Template.compile($(that.options.templates.variableWrapperTemplate).html())(that.dataSource));kendo.bind($(that.element),that._bindingModel);var globalProfiles=new kendo.data.ObservableObject({globalProfiles:that.dataSource.GlobalProfiles,globalProfile:null,globalProfileChange:function(e){var vm=this;if(e.data.globalProfile!=null){$.ajax({url:"/Store/Proofing/GetGlobalProfileVariablesForBundle",contentType:"application/json; charset=utf-8",dataType:"json",data:{globalFormsProfileId:e.data.globalProfile.GLOBAL_FORMS_PROFILE_ID},success:function(response){if(response.Records!=null){vm.updateVariables(response.Records)}},requestStart:function(){$(document).trigger(argosyEvents.START_LOADING)},requestEnd:function(){$(document).trigger(argosyEvents.END_LOADING)}})}},updateVariables:function(variables){var inputs=$("*[data-argosy-proofing^='var_']");_.forEach(inputs,function(input){input=$(input);var variableId=input.data("variableId"),record=variables[variableId];if(record!=null){var maskedTextBox=input.data("kendoMaskedTextBox"),imageEditor=input.data("kendoImageEditor");if(maskedTextBox!=null){maskedTextBox.value(record)}else{if(imageEditor!=null){var value=input.data("defaultValue"),index=value.lastIndexOf("/");record=value.substring(0,index+1)+record;imageEditor.value(record)}else{input.attr("value",record)}}input.data("defaultValue",record)}})}});kendo.bind($("div[data-id='profiles']"),globalProfiles);setTimeout(function(e){$.each($("select[data-control-type=MultiSelectText]"),function(i,element){element=$(element);element.kendoMultiSelect({noDataTemplate:$("#_proofingVariableAddText").html(),optionPlaceholder:"Enter values...",dataTextField:"text",dataValueField:"value",filtering:function(e){var data=e.filter.value;var dataSource=e.sender.dataSource;dataSource._data=[];dataSource.add({value:data,text:data})}})})},500)},_bindingModel:null,_setupBindingModel:function(){var that=this;if(that.options.dataSource==null){that.options.dataSource={DesignTemplates:[],GlobalProfiles:[],Part:null,Profiles:[],VariableGroupos:[],Variables:[]}}that.options.dataSource.Templates=that.options.templates;that.options.dataSource.FancyBox=that.options.fancybox;that._bindingModel={data:that.options.dataSource,onVariableUpdate:function(e){var model=this,kendo=e.currentTarget==null;element=!kendo?$(e.currentTarget):$(e.sender.element),value=!kendo?element.val():e.sender.value(),hiddenBys=that.element.find("*[data-hidden-by*='"+element.attr("data-variable-name")+"']");$.each(hiddenBys,function(e,hiddenBy){hiddenBy=$(hiddenBy);model.set("disable"+hiddenBy.attr("data-variable-id"),value!=null&&value.length>0)})},showGenerateQrCode:function(e){$.fancybox({href:that.options.proofingQrCodeGenerationModal,autoSize:true,scrolling:"no",modal:true,afterLoad:function(afterLoadEvent){kendo.bind($(that.options.proofingQrCodeGenerationModal),kendo.observable({onDropDownListDataBound:function(e){var defaultValue=e.sender.element.attr("data-value");e.sender.select(function(item){return item.name===defaultValue})},onCancelQRCode:function(onCancelQRCodeEvent){var originalInput=$(e.sender.element[0]);$("#qr_code_save").getKendoButton().enable(false);if(originalInput.attr("data-show-fancybox-after-edit")=="true"){$.fancybox({href:"#"+originalInput.attr("data-fancybox-after-edit-href")})}},onRemoveQRCode:function(onRemoveQRCodeEvent){var originalInput=$(e.sender.element[0]);$("#"+originalInput.attr("data-hidden-field-id")).val("");originalInput.text("Add QR Code");$("#qr_code_remove").getKendoButton().enable(false);$("#qr_code_save").getKendoButton().enable(false);$(that.options.proofingQrCodeGenerationModal).find("img").attr("src","/noimagefound.png?w=300&h=300");if(originalInput.attr("data-show-fancybox-after-edit")=="true"){$.fancybox({href:"#"+originalInput.attr("data-fancybox-after-edit-href")})}},onSaveQRCode:function(onSaveQRCodeEvent){var originalInput=$(e.sender.element[0]);$("#"+originalInput.attr("data-hidden-field-id")).val($(that.options.proofingQrCodeGenerationModal).find("#qr_final_url").val());originalInput.text("Edit QR Code");$("#qr_code_save").getKendoButton().enable(false);if(originalInput.attr("data-show-fancybox-after-edit")=="true"){$.fancybox({href:"#"+originalInput.attr("data-fancybox-after-edit-href")})}},onGenerateQRCode:function(onGenerateQRCodeEvent){if(that.isValidVariables(that.options.proofingQrCodeGenerationModal,"qr_","data-argosy-qrcode")){var variableObject=that.getVariables(false,that.options.proofingQrCodeGenerationModal,"qr_","data-argosy-qrcode");$(document).trigger(argosyEvents.START_LOADING,{name:"QrCode"});$.ajax({url:"/Store/Proofing/GenerateQrCode/",dataType:"json",method:"POST",data:{variables:JSON.stringify(variableObject)},success:function(result){$(document).trigger(argosyEvents.END_LOADING,{name:"QrCode"});if(result.ReturnCode==ReturnCode.Success){$(that.options.proofingQrCodeGenerationModal).find("img").attr("src",result.Records.Url+"?w=300&h=300");$(that.options.proofingQrCodeGenerationModal).find("#qr_final_url").val(result.Records.Url);$("#qr_code_remove").getKendoButton().enable(true);$("#qr_code_save").getKendoButton().enable(true)}else{prompt.alert({question:result.Message,description:"Ref: "+result.Guid,type:"warning",yes:function(e){$.fancybox({href:that.options.proofingQrCodeGenerationModal,autoSize:true,scrolling:"no"})}})}}})}else{prompt.alert({question:"You are missing required fields to generate this QR Code.",description:"Please update the form and continue.",type:"warning",yes:function(e){$.fancybox({href:that.options.proofingQrCodeGenerationModal,autoSize:true,scrolling:"no"})}})}},qrTypes:[{name:"Contact"},{name:"Email"},{name:"Phone"},{name:"Website"}],qrColors:[{name:"Black",value:"Black"},{name:"Deep Sky Blue",value:"DeepSkyBlue"},{name:"Red"},{name:"Green",value:"Green"},{name:"Red",value:"Red"}],qrStates:[{name:"AA"},{name:"AE"},{name:"AK"},{name:"AL"},{name:"AP"},{name:"AR"},{name:"AS"},{name:"AZ"},{name:"CA"},{name:"CO"},{name:"CT"},{name:"DC"},{name:"DE"},{name:"FL"},{name:"FM"},{name:"GA"},{name:"GU"},{name:"HI"},{name:"IA"},{name:"ID"},{name:"IL"},{name:"IN"},{name:"KS"},{name:"KY"},{name:"LA"},{name:"MA"},{name:"MD"},{name:"ME"},{name:"MH"},{name:"MI"},{name:"MN"},{name:"MO"},{name:"MP"},{name:"MS"},{name:"MT"},{name:"NA"},{name:"NC"},{name:"ND"},{name:"NE"},{name:"NH"},{name:"NJ"},{name:"NM"},{name:"NV"},{name:"NY"},{name:"OH"},{name:"OK"},{name:"OR"},{name:"PA"},{name:"PR"},{name:"PW"},{name:"RI"},{name:"SC"},{name:"SD"},{name:"TN"},{name:"TX"},{name:"UT"},{name:"VA"},{name:"VI"},{name:"VT"},{name:"WA"},{name:"WI"},{name:"WV"},{name:"WY"}],}))}})},onProofingPrePopChange:function(e){var selectedItem=e.sender.dataItem(e.sender.select());var variables=selectedItem.Variables;var clearValue=false;if(variables==null){variables=e.sender.dataItem(1).Variables;clearValue=true}if(variables!=null&&variables.length>0){$(variables).each(function(i){var input=$("#var_"+this.Key);input.val(clearValue?"":this.Value)})}},onDropDownListDataBound:function(e){var defaultValue=e.sender.element.attr("data-value");e.sender.select(function(item){return item.Value===defaultValue})},onComboBoxDataBound:function(e){},onProofingImageBankListOpen:function(e){if($(that.options.proofingImageBankListView)){$(that.options.proofingImageBankListView).remove()}var currentData=JSON.stringify(e.sender.dataSource.data());var controlType=$(e.sender.element[0]).attr("data-control-type");var html=$(that.options.proofingImageBankListViewModalTemplate).html();var kendoTemplate=kendo.template(html);var result=kendoTemplate(currentData);$(that.options.proofingModalWrapper).append(result);kendo.bind($(that.options.proofingImageBankListView));var ddl=$(e.sender.element).getKendoDropDownList();var listView=$(that.options.proofingImageBankListView).find("div[data-role=listview]").getKendoListView();listView.bind("change",function(ev){var val=listView.dataItem(listView.select());if(val!=null){ddl.value(val.Rule)}});$.fancybox({href:that.options.proofingImageBankListView,afterClose:function(e){setTimeout(function(e){$.fancybox({href:that.options.proofingCustomizationView})})},afterLoad:function(e){kendo.bind($(that.options.proofingImageBankListView))}});e.preventDefault()}};$(that.dataSource.Variables).each(function(e){that._bindingModel["var_"+this.Id+"_DataSourceJson"]=eval(this.DataSourceJson);that._bindingModel["var_"+this.Id+"_VariableOptionsJson"]=eval(this.VariableOptionsJson);that._bindingModel["disable"+this.Id]=false;if(this.TooltipText!=null){var tooltip=$("#tooltip_"+this.Id);tooltip.kendoTooltip({content:this.TooltipText,position:"top"})}})}});ui.plugin(ProofingVariables)})(jQuery);(function($){var kendo=window.kendo,ui=kendo.ui,Widget=ui.Widget;var StatementBuilder=Widget.extend({wrapper:null,currentStatement:"",init:function(element,options){var that=this;Widget.fn.init.call(this,element,options);that.wrapper=that.element;that._getData()},options:{name:"StatementBuilder",disabled:false,required:false,variableId:null,controlType:null,displayName:null,variableName:null,defaultStatementId:null,statementGroupId:null,fancyboxHref:null,templates:{statementWrapper:"#_StatementBuilderWrapper",}},getStatement:function(){},value:function(data){var that=this;if(data==null){return that.currentStatement}else{}},_getData:function(){var that=this;$.ajax({url:"/Store/Proofing/GetStatementGroup/"+that.options.statementGroupId,dataType:"json",success:function(data){that._initialize(data)}})},_initialize:function(data){var that=this;that.data=data;that.element.empty();that.element.append(kendo.Template.compile("<a>Build ${Name}</a>")(data));that.element.find("a").click(function(e){that.showModal()})},showModal:function(){var that=this;that.loadTemplates()},loadTemplates:function(){var that=this;if($(that.options.templates.statementWrapper).length==0){controlLoader.loadTemplate("StatementBuilder",function(template){if($(that.options.templates.statementWrapper).length==0){$(document.body).append(template);that.createModal()}})}else{that.createModal()}},createModal:function(){var that=this;$(that.data.Statements).each(function(i){$(this.Pieces).each(function(z){if(this.JsonValue!=null){this.DataSource=eval(this.JsonValue);if(this.DataSource!=null&&this.DataSource.length>0&&!this.IsRequired){this.DataSource.splice(0,0,"")}}else{this.DataSource=null}})});var viewModel=kendo.observable({group:that.data,onSelectDataBound:function(e){setTimeout(function(z){var dropdownlist=e.sender;dropdownlist.list.width("auto");dropdownlist.element.closest(".k-dropdown").width("auto");dropdownlist.select(0)},250)},onInputChange:function(e){if(e.data.IsRequired){var val=e.sender.value();if(val.toString().length>0){e.sender.element.closest(".input-group").removeClass("has-error").addClass("has-success");e.sender.element.closest(".input-group").find(".glyphicon-remove").hide();e.sender.element.closest(".input-group").find(".glyphicon-ok").show()}else{e.sender.element.closest(".input-group").removeClass("has-success").addClass("has-error");e.sender.element.closest(".input-group").find(".glyphicon-ok").hide();e.sender.element.closest(".input-group").find(".glyphicon-remove").show()}}},getValue:function(input){var val=input.val();if($.isKendo(input)){var control=$.getKendoControl(input);if(control.options.format!=null){val=kendo.toString(control.value(),control.options.format);if(val.substring(".00")>-1){val=val.substring(0,val.length-val.indexOf(".00"))}}}return val},onSelectStatment:function(e){var inputs=$(e.currentTarget).closest("[data-statement-id]").find("[data-statement-input]"),statement="",isError=false,model=this;$(inputs).each(function(i,input){input=$(input);var isRequired=input.attr("data-required")==="true",val=model.getValue(input);if(!isError){if(isRequired&&val!==null&&val.trim().length>0){statement+=" "+val.trim()}else{if(isRequired){isError=true}else{if(val!=null&&val.trim().length>0){statement+=" "+val.trim()}}}}});if(!isError){$(e.currentTarget).closest("[data-statement-id]").find(".text-danger").hide();that.currentStatement=statement.trim();that.element.find("a").text(that.currentStatement);if(that.options.fancyboxHref!=null&&that.options.fancyboxHref.trim().length>0){$.fancybox({href:that.options.fancyboxHref})}}else{$(e.currentTarget).closest("[data-statement-id]").find(".text-danger").show().text("Missing required fields to use this statement.")}}});var content=kendo.Template.compile($(that.options.templates.statementWrapper).html())(that.data);$.fancybox({content:content,beforeShow:function(e){var element=this.inner;kendo.bind(element,viewModel)}})}});ui.plugin(StatementBuilder)})(jQuery);(function(a){var b=window.kendo,d=b.ui,e=d.Widget;var c=e.extend({init:function(f,g){var h=this;e.fn.init.call(this,f,g);this._setupEvents();getCountryStateMap();if(countryStateMap==null){a(document).one(argosyEvents.EVENT_COUNTRY_STATE_MAP_LOADED,function(i){h._initialize()})}else{h._initialize()}},options:{name:"States",countryId:0,stateId:0,bindingGroup:"",dataSource:{},inputId:"",initialized:false,disabled:false},value:function(f){var h=this;if(f==null){if(h._hiddenInput){return h._hiddenInput.val()}}else{if(!a.isNumeric(f)){var g=a.grep(h._dropDownList._data(),function(i){return i.Code==f||i.Name==f});if(g.length>0){f=g[0].Id}}h._hiddenInput.val(f);h._dropDownList.value(f)}},_setupEvents:function(){var f=this;a(document).bind(argosyEvents.COUNTRY_CHANGE,function(h,g){if(f._dropDownList!=undefined){if(f.options.bindingGroup===g.bindingGroup){if(f.options.countryId!==g.value){f.options.countryId=g.value;f.options.stateId=g.stateId;f._dropDownList.dataSource.read();f._dropDownList.refresh()}f.value(g.stateId)}}})},_initialize:function(){var f=this;f.element.append(f._createHiddenInput());f._hiddenInput=f.element.find("input[type=hidden]");f.element.append(f._createDropDownList());f.element.find("select").kendoDropDownList({autoBind:true,dataTextField:"Name",dataValueField:"Id",optionLabel:"-- ~{SelectState}~ --",dataSource:f._getDataSource({}),change:function(g){a(document).trigger(argosyEvents.EVENT_STATE_CHANGED)},value:f.options.stateId,cascade:function(g){var h=g.sender.value();f._hiddenInput.val(h)},enable:f.options.disabled!="disabled"});f._dropDownList=f.element.find("select").getKendoDropDownList()},_createHiddenInput:function(){var h=this;var g=h.options.inputId;if(h.options.bindingGroup!=null&&h.options.bindingGroup!=""){g=h.options.bindingGroup+"_"+g}var f=a("<input />",{type:"hidden",id:g,name:g.replace(/_/g,"."),value:h.options.stateId});return f},_createDropDownList:function(){var g=this;var f=a("<select data-role='dropdownlist' />");return f},_getDataSource:function(){var f=this;a.extend(true,f.options.dataSource,_defaultDataSourceConfig);f.options.dataSource.transport={read:function(g){var h=a.grep(countryStateMap,function(i){return i.Id==f.options.countryId});if(h.length>0){g.success(h[0].Regions)}else{g.success([])}}};f.options.dataSource.schema={total:function(g){return g.length}};f.options.dataSource.pageSize=99999;f.options.dataSource.serverFiltering=true;return new b.data.DataSource(f.options.dataSource)}});d.plugin(c)})(jQuery);(function(a){var b=window.kendo,d=b.ui,e=d.Widget;var c=e.extend({init:function(f,g){var h=this;e.fn.init.call(this,f,g);h._initialize()},options:{name:"Textbox",value:""},_initialize:function(){a(this.element).addClass("k-textbox")},value:function(g){var f=this;if(g!==undefined){a(this.element).val(g)}else{return a(this.element).val()}}});d.plugin(c)})(jQuery);(function(a){var b=window.kendo,d=b.ui,e=d.Widget;var c=e.extend({init:function(f,g){e.fn.init.call(this,f,g);this._initialize()},options:{name:"ToggleSwitch",value:false,propertyName:null,onLabel:"On",offLabel:"Off",onChange:function(f){a(document).trigger(argosyEvents.TOGGLE_SWITCH_CHANGE,f)}},isChecked:function(){var f=this;return f.element.hasClass("toggle-switch-checked")},value:function(f){var g=this;if(f==null){return g.isChecked()}else{if(f){g.on()}else{g.off()}}},_initialize:function(){var f=this;if(f.options.propertyName==null){f.options.propertyName=b.guid()}f.element.append(a("<input />",{type:"hidden","class":"hidden",value:f.options.value,id:f.options.propertyName}));f.hiddenElement=f.element.find("input.hidden");f.element.addClass("toggle-switch");f.element.addClass("toggle-switch-wrapper");if(f.options.value){f.element.addClass("toggle-switch-checked")}f.element.append('<label class="toggle-switch toggle-switch-on" for="'+f.options.propertyName+'">'+f.options.onLabel+"</label>");f.element.append('<label class="toggle-switch toggle-switch-off" for="'+f.options.propertyName+'">'+f.options.offLabel+"</label>");f.element.append('<label class="toggle-switch toggle-switch-slider" for="'+f.options.propertyName+'"></label>');f.element.find(".toggle-switch-on").click(function(g){f.off()});f.element.find(".toggle-switch-off").click(function(g){f.on()});f.element.find(".toggle-switch-slider").click(function(g){if(f.element.hasClass("toggle-switch-checked")){f.off()}else{f.on()}})},on:function(){var f=this;f.element.addClass("toggle-switch-checked");if(f.hiddenElement){f.hiddenElement.val("true")}if(f.options.onChange!=null){f.options.onChange(f)}},off:function(){var f=this;f.element.removeClass("toggle-switch-checked");if(f.hiddenElement){f.hiddenElement.val("false")}if(f.options.onChange!=null){f.options.onChange(f)}}});d.plugin(c)})(jQuery);(function(a){var b=window.kendo,c=b.ui,e=c.Widget;var d=e.extend({init:function(f,g){var h=this;e.fn.init.call(this,f,g);h._initialize()},options:{name:"usersAutoComplete",bindingGroup:"",dataSource:{},initialized:false,disabled:false,userId:0,inputId:"",companyId:0,siteId:0,userGroupId:0},value:function(f){var g=this;if(f==null){if(g._hiddenInput){return g._hiddenInput.val()}}else{g._hiddenInput.val(f.UserId);g._autoComplete.value(f.FullName)}},_initialize:function(){var f=this;f.element.append(f._createHiddenInput());f._hiddenInput=f.element.find("input[type=hidden]");f.element.append(a("<input id='userCompleteInput' data-role='autocomplete' />"));f.element.find("input[data-role=autocomplete]").kendoAutoComplete({dataTextField:"FullName",dataSource:f._getDataSource({}),enable:f.options.disabled!=="disabled",change:function(){var g=this.dataItem();f.value(g);a(document).trigger(argosyEvents.EVENT_AUTOCOMPLETE_USER_SELECTED,{user:g})}});f._autoComplete=f.element.find("input[data-role=autocomplete]").getKendoAutoComplete()},_createHiddenInput:function(){var h=this;var g=h.options.inputId;if(h.options.bindingGroup!=null&&h.options.bindingGroup!==""){g=h.options.bindingGroup+"_"+g}var f=a("<input />",{type:"hidden",id:g,name:g.replace(/_/g,"."),value:h.options.userId});return f},_getDataSource:function(){var f=this;a.extend(true,f.options.dataSource,_defaultDataSourceConfig);f.options.dataSource.transport={read:function(g){var h={UserGroup:f.options.userGroupId,CompanyId:f.options.companyId,SiteId:f.options.siteId,RecordSizeCategory:f.options.recordSizeCategory};a.extend(true,h,kendoOptionsToObject(g),f.searchCriteria);a.ajax({url:"/DataView/GetUsers",dataType:"json",data:h,success:function(i){if(i.ReturnCode===ReturnCode.Failed){handleDataSourceException(i.Records)}else{g.success(i.Records)}}})}};f.options.dataSource.schema={total:function(g){return g.length}};f.options.dataSource.pageSize=20;f.options.dataSource.serverFiltering=true;return new b.data.DataSource(f.options.dataSource)}});c.plugin(d)})(jQuery);function KitBuilder(b){var c=this;$.extend(true,c.options,c.baseOptions,b);var a=new ControlLoader();a.loadControl("ModalProductDetail",{},function(d){c.productDetailControl=d});a.loadControl("ModalProductUsage",{},function(d){c.productUsageControl=d});a.loadControl("ModalProductViewingRights",{},function(d){c.productViewingRightsControl=d});c.setupEventListeners();a.loadTemplate("KitBuilder",function(d){$(document.body).append(d);c.initialize();c.updatePricing(0,0);$(document).trigger(c.EVENT_TEMPLATE_LOADED)})}KitBuilder.prototype.options={};KitBuilder.prototype.baseOptions={kitBuilderView:"div[data-argosy-control=KitBuilder]",kitBuilderPartList:"div[data-argosy-view=KitBuilderPartsList]",kitBuilderTemplate:"#_KitBuilderTemplate",kitBuilderStaticTemplate:"#_KitBuilderStaticTemplate",kitBuilderPersonalizedTemplate:"#_KitBuilderPersonalizedTemplate",kitBuilderPartListTemplate:"#_KitBuilderPartListTemplate",kitBuilderApproveProofTemplate:"#_ProofingApproveProofTemplate",approvalProofInitial:"#approvalProofInitial",approvalProofName:"#approvalProofName",approvalProofModalHref:"#divApproveProof",approvalProofAcceptButton:"#approvalProofAcceptButton",kitTerm:"Kit"};KitBuilder.prototype.EVENT_TEMPLATE_LOADED="TEMPLATE_KIT_BUILDER_LOADED";KitBuilder.prototype.EVENT_LISTENERS_LOADED="KIT_BUILDER_LISTENERS_LOADED";KitBuilder.prototype.kitViewModel=null;KitBuilder.prototype.kitDataSource={};KitBuilder.prototype.GroupData=null;KitBuilder.prototype.IsBuildAKit=null;KitBuilder.prototype.refreshGroupData=function(a){var g=this,c=[],f=(g.data.KitState!=null&&g.data.KitState.length>0);var b;if(a.GroupNames.length>0){for(var d=0;d<a.GroupNames.length;d++){var e=a.GroupNames[d].replace(/[^a-z0-9]/ig,"");b={id:e,name:a.GroupNames[d],items:a.Groups[a.GroupNames[d]],showGroupName:true,isBundle:f,IsBuildAKit:g.IsBuildAKit};c.push(b)}}else{b={id:"noNameGroup",name:"",items:a.KitParts,showGroupName:false,isBundle:f,IsBuildAKit:g.IsBuildAKit};c.push(b)}$(c).each(function(j,h){$(h.items).each(function(i,k){k.isBundle=f;if(k.ProofingThumbnailFile==undefined){k.ProofingThumbnailFile=null}})});return c};KitBuilder.prototype.getViewModel=function(a){var b=KitBuilder.prototype;var d=this,c=d.refreshGroupData(a);return kendo.observable({kitTerm:d.options.kitTerm,pendingProofCount:0,kitData:a,groupData:b.GroupData==null?c:b.GroupData,allParts:a.KitParts,enablePartInSource:function(f,e){$(e).each(function(){if(this.ChildPart.PartId===f){this.Disabled=false;this.Quantity=this.ChildPart.MinCartQty}});return e},enablePart:function(h){var i=this,j=h.data,g=i.get("groupData"),f=0;d.kitViewModel.kitData.kitParts=i.enablePartInSource(j.ChildPartId,d.kitViewModel.kitData.KitParts);i.set("kitData",d.kitViewModel.kitData);$(g).each(function(){$(this.items).each(function(k,l){if(l.ChildPart.PartId===j.ChildPartId){l.Disabled=false;f=this.Quantity}})});i.set("groupData",g);i.reBind();d.updatePricing(j.ChildPartId,f)},getKitData:function(){var e=this,f=e.get("kitData");return f},addToCurrentlyInKit:function(g){var f=this,e=f.get("allParts");e.push(g);f.set("allParts",e)},removeFromCurrentlyInKit:function(h){var g=this,e=g.get("allParts");var f=$.map(e,function(j,i){if(j.ChildPartId===h.ChildPartId){return i}});e.splice(f[0],1);g.set("allParts",e)},disablePartInSource:function(f,e){$(e).each(function(g,h){if(h.ChildPart.PartId===f){h.Disabled=true}});return e},disablePartGroupInSource:function(f,e){$(e).each(function(){$(this.items).each(function(g,h){if(h.ChildPart.PartId===f){h.Disabled=true}})});return e},editVariables:function(f){$(document).trigger(argosyEvents.EVENT_SHOW_PROOFING_FORM,{})},disablePart:function(g){var h=this,j=g.data,f=h.get("groupData"),i=h.get("kitData");f=h.disablePartGroupInSource(j.ChildPartId,f);i.kitParts=h.disablePartInSource(j.ChildPartId,i.KitParts);h.set("kitData",i);h.set("groupData",f);h.reBind();d.updatePricing(j.ChildPartId,0)},reBind:function(){var g=this,f=g.get("groupData");kendo.unbind($("#_kitContainer"));d.kitViewModel=d.getViewModel(g.get("kitData"));kendo.bind($("#_kitContainer"),d.kitViewModel);setTimeout(function(h){addArgosyActions(d.options.kitBuilderPartList);$(f).each(function(i,j){addArgosyActions("div[data-argosy-view=KitBuilder"+j.id+"]")})},500);var e=0;$(d.kitViewModel.kitData.KitParts).each(function(h,i){if(!i.Disabled){e++}});if(d.IsBuildAKit){if(d.kitViewModel.kitData.Kit.Options.ComponentMinCount!=undefined&&d.kitViewModel.kitData.Kit.Options.ComponentMinCount>0&&e<d.kitViewModel.kitData.Kit.Options.ComponentMinCount){$(".buildValidationMin").text("Select at least "+d.kitViewModel.kitData.Kit.Options.ComponentMinCount+" products ");$(".buildValidationMin").show()}else{$(".buildValidationMin").hide()}if(d.kitViewModel.kitData.Kit.Options.ComponentMaxCount!=undefined&&d.kitViewModel.kitData.Kit.Options.ComponentMaxCount>0&&e>d.kitViewModel.kitData.Kit.Options.ComponentMaxCount){$(".buildValidationMax").text("Select at most "+d.kitViewModel.kitData.Kit.Options.ComponentMaxCount+" products");$(".buildValidationMax").show()}else{$(".buildValidationMax").hide()}if(!$(".buildValidationMax").is(":hidden")||!$(".buildValidationMin").is(":hidden")){$(".btn-addtocart").attr("disabled",true);$(".btn-addtocart").removeAttr("onclick")}else{$(".btn-addtocart").attr("disabled",false);$(".btn-addtocart").attr("onclick","KitBuilder.prototype.kitViewModel.addToCart()")}}},priceBreakDataBound:function(h){var f=$(h.sender.element),g=70;f.data("kendoDropDownList").list.width("auto");f.closest(".k-widget").width(g)},variables:window.variables,approveProofs:function(g){var i=this;var f=$(d.options.approvalProofModalHref);if(f.length==0){var h=kendo.template($(d.options.kitBuilderApproveProofTemplate).html())({});$(document.body).append(h);var j=Proofing.prototype.getProofName(i.variables);$(d.options.approvalProofModalHref).find("#approvalProofName").val(j);if(userSettings.IsProofNameLocked){$("#approvalProofName").prop("disabled",true)}$(d.options.approvalProofAcceptButton).click(function(k){var l=$(d.options.approvalProofInitial).val();if(l.length>0){d.saveCustomizationSignature(i,l)}else{prompt.alert({question:"You must enter your initials to continue.  Please try again.",description:"",type:"warning",yes:function(m){$.fancybox({href:d.options.approvalProofModalHref})}})}})}$.fancybox({href:d.options.approvalProofModalHref})},addToCart:function(f){var k={},i=[],g=this,h=g.get("kitData"),j=h.KitParts;if(f!=null){f.preventDefault();block(f.sender,"",true)}else{block(null,"~{MsgAddingToCart}~")}$(j).each(function(e,l){if(!l.Disabled){i.push(l)}});k.part=h.Kit;k.qty=1;k.kitParts=i;sendPartToCart(k,h.Kit.PartName)},partListDataBound:function(f){addArgosyActions(d.options.kitBuilderPartList)},showKitItemTypeComponents:function(f){ModalProductView.prototype.baseOptions.searchTerm=kitData.Kit.Options.ComponentItemType;ModalProductView.prototype.baseOptions.ExcludedKitIds=[kitData.Kit.PartId];ModalProductView.prototype.baseOptions.ExcludeKit=true;ModalProductView.prototype.baseOptions.ExcludeAttributeParts=true;ModalProductView.prototype.baseOptions.ExcludeConfiguredParts=true;ModalProductView.prototype.setupListView()}})};KitBuilder.prototype.initialize=function(){var d=KitBuilder.prototype;d.data=d.getDataSource();d.kitViewModel=d.getViewModel(d.data);d.GroupData=d.kitViewModel.groupData;var a=$(d.options.kitBuilderTemplate).html();var b=kendo.template(a);var c=b(d.data);$("*[data-argosy-uuid='"+d.options.uuid+"']").append(c);kendo.bind($("#_kitContainer"),d.kitViewModel);setTimeout(function(f){addArgosyActions(d.options.kitBuilderPartList);$(d.GroupData).each(function(g,h){addArgosyActions("div[data-argosy-view=KitBuilder"+h.id+"]")});d.checkProofingStatus(d.kitViewModel);d.kitViewModel.reBind()},500)};KitBuilder.prototype.saveCustomizationSignature=function(b,c){var d=this;block(null,"~{MsgSavingSignature}~");var a=[];$(b.kitData.KitParts).each(function(e){if(this.CustomizationStateId!=null&&this.CustomizationStateId>0){a.push(this.CustomizationStateId)}});$.ajax({url:"/Store/Proofing/UpdateProofSignatures",dataType:"jsonp",data:{customizationStateIds:a,signature:c},method:"POST"});b.addToCart(null)};KitBuilder.prototype.checkProofingStatus=function(a){var b=this;if(!a.kitData.isProofingComplete){$(a.kitData.KitParts).each(function(c){b.checkProofStatus(a,this)})}};KitBuilder.prototype.checkProofStatus=function(b,a){var c=this;if(a.CustomizationStateId!=null&&a.CustomizationStateId>0){b.pendingProofCount++;$.ajax({url:"/Store/Proofing/GetKitProofImage/"+a.CustomizationStateId,method:"GET",success:function(e){if(e==null||e===""){c.checkProofStatus(b,a)}else{var d=$(document).find("img[data-customization-state-id="+a.CustomizationStateId+"]");d.attr("src",e);d.attr("data-loaded",true);d.parent().attr("data-argosy-datahref",e.replace());a.ChildPart.ProofingThumbnailFile=e.replace(/sbn_/g,"");a.ChildPart.LargeThumbnailFile=e.replace(/sbn_/g,"");b.pendingProofCount--;var f=c.getElement().find("img[data-loaded=false]");if(f.length==0){KitBuilder.prototype.GroupData=null;b.kitData.isProofingComplete=true;c.getElement().find(".btn-addtocart").removeAttr("disabled");b.reBind()}}}})}};KitBuilder.prototype.getElement=function(){var a=this;return $("*[data-argosy-uuid="+a.options.uuid+"]")};KitBuilder.prototype.setupEventListeners=function(){var a=this;$(document).bind(argosyEvents.SHOW_PART_USAGE_MODAL,function(b,c){if(a.productUsageControl!=null){a.productUsageControl.show(parseInt(c))}});$(document).bind(argosyEvents.SHOW_VIEWING_RIGHTS_MODAL,function(c,b){if(a.productViewingRightsControl!=null){a.productViewingRightsControl.init(b)}});$(document).bind(argosyEvents.UPDATE_PART_QUANTITIES,function(b,c){$(a.kitViewModel.kitData.KitParts).each(function(d){if(this.ChildPart.PartId==c.partId){if(this.Quantity!=c.value){this.Quantity=c.value}}});$(a.kitViewModel.groupData).each(function(d){$(this.items).each(function(e){if(this.ChildPart.PartId==c.partId){if(this.Quantity!=c.value){this.Quantity=c.value}}})});a.updatePricing(c.partId,c.value)});$(document).bind(argosyEvents.PART_ADDED_TO_CART,function(c,b){window.location="/Store/Cart/"})};KitBuilder.prototype.updatePricing=function(b,d){var e=this;var c=".part-price-wrapper-"+b.toString();var a=".kit-price-wrapper-"+e.kitViewModel.kitData.Kit.PartId.toString();$(c).each(function(){$(this).html("Loading...");block(this,"",true)});$(a).each(function(){$(this).html("Loading...");block(this,"",true)});pricingManager.getKitPricing(e.kitViewModel.kitData,1,function(f){$(a).each(function(g){$(this).html(kendo.toString(f.KitPrice,"C"))});if(f.Parts[b]!=undefined){$(c).html(kendo.toString(f.Parts[b],"C"))}else{$(e.kitViewModel.kitData.KitParts).each(function(h,g){if(g.ChildPartId==b){$(c).html(kendo.toString(g.ChildPart.Price,"C"))}})}unblock()})};KitBuilder.prototype.getPart=function(e){var f=this;var d=null;var c=f.kitViewModel.kitData.KitParts.length;for(var a=0;a<c;a++){var b=f.kitViewModel.kitData.KitParts[a];if(b.ChildPart.PartId===parseInt(e)){d=b.ChildPart;d.Price=b.StartingPrice;break}}return d};KitBuilder.prototype.updateView=function(a,b,c){var d=this};KitBuilder.prototype.updatePartStates=function(a){$(a.KitState).each(function(b){this.Part.CustomizationStateId=this.CustomizationStateId;this.Part.CartId=this.CartId;this.Part.ChildPart.CustomizationStateId=this.CustomizationStateId;this.Part.ChildPart.CartId=this.CartId;a.KitParts.push(this.Part)})};KitBuilder.prototype.getDataSource=function(b){var c=this;var a=window[c.options.dataSource];if(a!=null&&a.KitState!=null){c.updatePartStates(a);a.isProofingComplete=false}else{if(a!=null){a.isProofingComplete=true;a.KitState=null}}c.IsBuildAKit=a.Kit.IsBuildAKit;return a};KitBuilder.prototype.dataSourceOpts={pageSize:20};KitBuilder.prototype.newProductId=-1;KitBuilder.prototype.componentsAddedToKit=[];KitBuilder.prototype.AddComponentToKit=function(c){var f=this,a=KitBuilder.prototype;if($.inArray(c,a.componentsAddedToKit)==-1){var d=$.extend({},a.GroupData[0].items[0]);var b=a.kitViewModel;var e=ModalProductView.prototype.listView.dataSource.get(c);d.ChildPart=e;d.ChildPartDescription=e.Description;d.ChildPartId=e.PartId;d.ChildPartName=e.PartName.trim()!=""?e.PartName:e.Sku;d.ChildPartOffered=true;d.ChildPartSku=e.Sku;d.Quantity=e.MinCartQty;d.StartingPrice=e.MinPrice;d.IsRequired=false;d.Disabled=false;d.GroupName="Components Added To Kit";d.Id=a.newProductId;a.newProductId=a.newProductId-1;var g=false;var h=0;$.each(a.GroupData,function(j,i){if(i.id=="ComponentsAddedToKit"){g=true;h=j}});if(!g){a.GroupData.push({id:"ComponentsAddedToKit",items:[d],name:"Components Added To Kit",showGroupName:true,isBundle:false});a.kitViewModel.kitData.GroupNames.push("Components Added To Kit");a.kitViewModel.kitData.Groups["Components Added To Kit"]={0:d};h=a.GroupData.length-1}else{a.GroupData[h].items.push(d);a.kitViewModel.kitData.Groups["Components Added To Kit"][a.kitViewModel.kitData.Groups["Components Added To Kit"].length]=d}a.componentsAddedToKit.push(c);a.kitViewModel.kitData.KitParts.push(d);a.kitViewModel.reBind();f.updatePricing(d.ChildPartId,d.MinCartQty);prompt.notify({question:"Items(s) were successfully added.",type:"success"})}};function LandingPageHotProducts(b){var c=this;$.extend(true,c.options,c.baseOptions,b);var a=new ControlLoader();a.loadControl("ModalProductDetail",{},function(d){c.productDetailControl=d});a.loadControl("ModalProductUsage",{},function(d){c.productUsageControl=d});a.loadControl("ModalProductViewingRights",{},function(d){c.productViewingRightsControl=d});a.loadControl("ModalPartConfiguration",{},function(d){c.productConfigurationControl=d});a.loadTemplate("LandingPageHotProducts",function(d){if($(c.options.carouselViewTemplate).length===0){$(document.body).append(d)}c.setupEventListeners();c.loadCarousels();addArgosyActions(c.getElement());$(document).trigger(c.EVENT_TEMPLATE_LOADED)})}LandingPageHotProducts.prototype._initialized=false;LandingPageHotProducts.prototype.options={featuredParts:"featuredParts",hotParts:"hotParts",newParts:"newParts"};LandingPageHotProducts.prototype.baseOptions={carouselViewTemplate:"#_carouselTemplateView",controlHref:"div[data-argosy-view=MvcHotProductsView]",productListViewTemplate:"#_ProductListViewProductPanel",slideViewTemplate:"#_carouselSlideTemplateView",masonryViewTemplateWrapper:"#_masonryTemplateViewWrapper",masonryViewTemplatePanel:"#_masonryTemplateView",isCarousel:true};LandingPageHotProducts.prototype.searchDataForPartId=function(e,f){var g=this,c=f.length,d=null;for(var a=0;a<c;a++){var b=f[a];if(b.PartId===e){d=b;break}}return d};LandingPageHotProducts.prototype.setupEventListeners=function(){var a=this;$(document).bind(argosyEvents.SHOW_PART_USAGE_MODAL,function(c,b){if(a.productUsageControl!=null){a.productUsageControl.show(parseInt(b.partId));$(a.options.historyTitleElment).html(b.partName+"<br/>Usage History")}});$(document).bind(argosyEvents.SHOW_VIEWING_RIGHTS_MODAL,function(c,b){if(a.productViewingRightsControl!=null){a.productViewingRightsControl.init(b)}});$(document).bind(argosyEvents.SHOW_PART_CONFIGURATION_MODAL,function(b,d){if(a.productConfigurationControl!=null){var c=a.getPart(d);a.productConfigurationControl.show(c)}});$(document).bind(argosyEvents.SHOW_PART_QUANTITY_MODAL,function(b,d){var c=a.getPart(d);console.log(c);showPartQuantityModal(c)})};LandingPageHotProducts.prototype.getPart=function(c){var d=this,a=d.getDataSource(),b;b=d.searchDataForPartId(c,a.hotParts);if(b!==null){return b}b=d.searchDataForPartId(c,a.featuredParts);if(b!==null){return b}b=d.searchDataForPartId(c,a.newParts);if(b!==null){return b}return b};LandingPageHotProducts.prototype.EVENT_TEMPLATE_LOADED="TEMPLATE_HOT_PRODUCTS_LOADED";LandingPageHotProducts.prototype.loadCarousels=function(){var e=this,a=e.getDataSource(),c=kendo.observable({carouselHref:"#hotParts_carousel",parts:new kendo.data.ObservableArray(a.hotParts),slideModel:{index:0,type:"hotParts",active:"active",title:"Hot Products"}}),b=kendo.observable({carouselHref:"#featuredParts_carousel",parts:new kendo.data.ObservableArray(a.featuredParts),slideModel:{index:0,type:"featuredParts",active:"active",title:"Featured Products"}}),d=kendo.observable({carouselHref:"#newParts_carousel",parts:new kendo.data.ObservableArray(a.newParts),slideModel:{index:0,type:"newParts",active:"active",title:"New Products"}});if(!e._initialized){e.createSlidesFor(c);e.createSlidesFor(b);e.createSlidesFor(d);e._initialized=true;$(".next").click(function(){var f=$(this).data("control");var g=$("#"+f).data("owlCarousel");g.next()});$(".prev").click(function(){var f=$(this).data("control");var g=$("#"+f).data("owlCarousel");g.prev()})}};LandingPageHotProducts.prototype.loadMasonry=function(){var c=this,a=c.getDataSource();if(!c._initialized){a.allParts=[];$(a.hotParts).each(function(d){a.allParts.push(this)});$(a.featuredParts).each(function(d){a.allParts.push(this)});$(a.newParts).each(function(d){a.allParts.push(this)});if(a.allParts.length>0){c.getElement().show()}var b=kendo.template($(c.options.masonryViewTemplateWrapper).html());$(c.options.controlHref).append(b(a));$(c.options.controlHref).find(".masonry-grid").masonry({itemSelector:".masonry-panel",percentPosition:true});addArgosyActions(c.options.controlHref);c._initialized=true}};LandingPageHotProducts.prototype.createSlidesFor=function(g){var f=this,b={items:6,itemsCustom:[[0,1],[300,2],[500,3],[780,4],[900,4],[1100,5],[1200,6],],pagination:false,autoPlay:false,stopOnHover:true},d=0,c=$(f.options.controlHref);if(g.parts.length<=0){return}var e=$(f.options.carouselViewTemplate),a=kendo.Template.compile(e.html())(g.slideModel);c.append(a);$(g.parts).each(function(i,j){var l=kendo.Template.compile($(f.options.slideViewTemplate).html())(g.slideModel);$(g.carouselHref).append(l);var h=$("."+g.slideModel.type+"_"+d);var k=kendo.Template.compile($(f.options.productListViewTemplate).html())(j);h.append(k);d++;g.slideModel.index=d});$(g.carouselHref).owlCarousel(b)};LandingPageHotProducts.prototype.getDataSource=function(b){var c=this,a={};a.hotParts=window[c.options.hotParts];a.featuredParts=window[c.options.featuredParts];a.newParts=window[c.options.newParts];return a};LandingPageHotProducts.prototype.getElement=function(){var a=this;return $("*[data-argosy-uuid="+a.options.uuid+"]")};function MailingListAccudata(a){var b=this;$.extend(true,b.options,b.baseOptions,a);b.controlLoader=new ControlLoader();b.controlLoader.loadTemplate("MailingListAccudata",function(c){$(document.body).append(c);b.initialize()})}MailingListAccudata.prototype.options={};MailingListAccudata.prototype.baseOptions={dataSource:null,templates:{contentTemplate:"#_MailingListAccudataTemplate",variablesTemplate:"#_MailingListAccudataVariablesTemplate",countTemplate:"#_mailingListAccudataCountTemplate"}};MailingListAccudata.prototype.initialize=function(){var b=this;b.sku=b.options.sku==null?getQuerystring("sku"):b.options.sku;b.customizationStateId=b.options.customizationStateId==null?getQuerystring("customizationStateId"):b.options.customizationStateId;var a=kendo.Template.compile($(b.options.templates.contentTemplate).html())({Sku:b.sku,CustomizationStateId:b.customizationStateId,Name:b.options.displayName});b.getElement().append(a);b.getConfig()};MailingListAccudata.prototype.config=null;MailingListAccudata.prototype.variables=null;MailingListAccudata.prototype.getConfig=function(){var a=this;$(document).trigger(argosyEvents.START_LOADING);$.ajax({url:"/Tools/Mailing/GetDataProviderConfig?dataProvider=Accudata",dataType:"json",method:"POST",success:function(b){a.config=b;a.getVariables()}})};MailingListAccudata.prototype.getVariables=function(){var a=this;$.ajax({url:"/Tools/Mailing/GetDataProviderConfigVariables?dataProvider=Accudata&product="+a.config.product,dataType:"json",method:"POST",success:function(b){a.variables=b.variables;a.groups=b.groups;$.each(a.variables,function(c,d){this.IsUserVariable=true});getPartBySku(getQuerystring("sku"),function(d){a.part=d;a.setup();var c={variables:null,zeroCountRequest:true,isValid:true};$(document).trigger(argosyEvents.EVENT_BUILD_PROOF,c)})}})};MailingListAccudata.prototype.updateCountData=function(){var b=this;var a=$(b.getElement()).find(b.options.templates.countTemplate);a.empty();window.accudataResponse=b.result.ListData;a.append($("<div />",{"data-argosy-control":"MailingListShippingOptions","data-argosy-options-data-source":"accudataResponse","data-argosy-options-hide-title":"true","data-argosy-options-error-message":(b.result.Response!=null?b.result.Response.ErrorMessage:""),"data-argosy-options-horizontal":"true","data-argosy-options-display-name":b.options.displayName,"data-argosy-options-data-provider-config-id":b.config.dataProviderConfigId,"data-argosy-options-can-override-count":true,"data-argosy-options-show-multi-use-option":true,"data-argosy-options-single-use-cost":b.config.perListCost,"data-argosy-options-multi-use-cost":b.config.perListCostMultiUse,"data-argosy-options-single-per-record-cost":b.config.perRecordCost,"data-argosy-options-multi-per-record-cost":b.config.perRecordCostMultiUse}));controlLoader.processControlElement(a.find("[data-argosy-control=MailingListShippingOptions]")[0])};MailingListAccudata.prototype.setup=function(){var a=this;var b=$(a.getElement()).find(a.options.templates.variablesTemplate);$(document).bind(argosyEvents.EVENT_BUILD_PROOF,function(d,c){if(c.isValid){var f="dataProvider=Accudata&product="+a.config.product+"&sku="+a.sku+"&customizationStateId="+a.customizationStateId+"&zeroCountRequest="+(c.zeroCountRequest?true:false);$(document).trigger(argosyEvents.START_LOADING);$.ajax({url:"/Tools/Mailing/GetDataProviderCount?"+f,dataType:"json",method:"POST",data:{variables:c.variables!=null?JSON.stringify(c.variables):""},success:function(e){a.result=e;a.updateCountData();if(a.result.Response!=null&&a.result.Response.IsError){prompt.error(a.result.Response.ErrorMessage)}$(document).trigger(argosyEvents.END_LOADING)}})}});a.variablesControl=b.kendoProofingVariables({dataSource:{Variables:a.variables,Part:a.part,Profiles:[],VariableGroups:a.groups,GlobalProfiles:[],DesignTemplates:[],GroupColumnCount:1},title:"",personalizeMessage:"",proofText:"Count",actionText:"Generate"})};MailingListAccudata.prototype.getElement=function(){var a=this;return $("*[data-argosy-uuid="+a.options.uuid+"]")};function MailingListAddresses(b){var c=this;$.extend(true,c.options,c.baseOptions,b);var a=new ControlLoader();a.loadTemplate("MailingListAddresses",function(d){$(document.body).append(d);c.initialize(c.getDataSource())})}MailingListAddresses.prototype.options={};MailingListAddresses.prototype.baseOptions={dataSource:null,templates:{contentTemplate:"#_MailingListAddressesTemplate",editAddresseTemplate:"#_MailingListEditAddressForm"}};MailingListAddresses.prototype.setupContinueButton=function(){var a=this;a.getElement().find("[data-role=button]").click(function(b){})};MailingListAddresses.prototype.createPreviewGrid=function(){var a=this;a.getElement().find("[data-role=grid]").kendoGrid({dataSource:new kendo.data.DataSource({data:a.data.PreviewData}),groupable:false,sortable:true,selectable:true,scrollable:false,pageable:true,columns:a.getColumns(a.data.SourceColumns)})};MailingListAddresses.prototype.getColumns=function(b){var c=this;var a=new Array();$(b).each(function(e,d){a.push({title:d.Name.replace(/_/g," "),field:d.Name})});return a};MailingListAddresses.prototype.update=function(a){var b=this;b.getElement().find(".text-danger").text(kendo.toString(a.ErrorCount,"n0"));b.getElement().find(".text-success").text(kendo.toString(a.Executions,"n0"))};MailingListAddresses.prototype.complete=function(a){var b=this;b.getElement().find(".text-danger").text(kendo.toString(a.ErrorCount,"n0"));b.getElement().find(".text-success").text(kendo.toString(a.Count,"n0"));b.task=a;if(a.ErrorGuid!=null){}else{if(a.Type=="ListAddressVerification"&&a.ErrorCount>0){$.fancybox.close();b.createPreviewGrid();$(".continue").click(function(d){var f=b.getElement().find("[data-role=grid]").getKendoGrid();var g=b.getElement().find("[data-role=grid] tbody tr td input[type=checkbox]:checked").closest("tr");var c=new Array();$(g).each(function(e,h){c.push(f.dataItem(h).Id)});b.taskHub.removeBadAddresses(b.task.Data.addressVerifiedPath,c)})}else{$.submitAsForm("/Tools/Mailing/Deduplication?Sku="+getQuerystring("sku")+"&customizationStateId="+getQuerystring("customizationStateId"),a,"taskData")}}};MailingListAddresses.prototype.error=function(a){var b=this;b.getElement().find(".text-danger").text(a.ErrorCount);b.getElement().find(".text-success").text(a.Count)};MailingListAddresses.prototype.initialize=function(a){var b=this;b.data=a;b.getElement().append(kendo.template($(b.options.templates.contentTemplate).html())({Sku:getQuerystring("sku"),Name:b.options.displayName}));b.taskHub=new TaskHub(function(c){b.update(c)},function(c){b.complete(c)},function(c){b.error(c)});b.taskHub.verifyAddressList(b.data.TransformedFile,[{Column:"Full Name",Piece:"FullName"},{Column:"Address 1",Piece:"Address1"},{Column:"Address 2",Piece:"Address2"},{Column:"Address 3",Piece:"Address3"},{Column:"City",Piece:"City"},{Column:"State",Piece:"State"},{Column:"ZIP Code",Piece:"Zip"}])};MailingListAddresses.prototype.getElement=function(){var a=this;return $("*[data-argosy-uuid="+a.options.uuid+"]")};MailingListAddresses.prototype.getDataSource=function(a){var b=this;return window[b.options.dataSource]};MailingListAddresses.prototype.createPreviewGrid=function(){var that=this;var data=eval(that.task.Data.badAddresses);that.getElement().find("[data-role=grid]").kendoGrid({dataSource:new kendo.data.DataSource({data:data}),groupable:false,sortable:true,selectable:false,scrollable:false,pageable:false,columns:[{title:"~{Address}~",template:"#if (OriginalAddress.AttentionTo != null && OriginalAddress.AttentionTo.trim() != '') {#${OriginalAddress.AttentionTo}<br />#}##if (OriginalAddress.AddressLine1 != null && OriginalAddress.AddressLine1.trim() != '') {#${OriginalAddress.AddressLine1}<br />#}##if (OriginalAddress.AddressLine2 != null && OriginalAddress.AddressLine2.trim() != '') {#${OriginalAddress.AddressLine2}<br />#}##if (OriginalAddress.AddressLine3 != null && OriginalAddress.AddressLine3.trim() != '') {#${OriginalAddress.AddressLine3}<br />#}##if (OriginalAddress.City != null && OriginalAddress.City.trim() != '') {#${OriginalAddress.City} #}##if (OriginalAddress.State != null && OriginalAddress.State.trim() != '') {#${OriginalAddress.State} #}##if (OriginalAddress.Zip != null && OriginalAddress.Zip.trim() != '') {#, ${OriginalAddress.Zip} #}#"},{title:" ",template:'<input type="checkbox" id="remove_address_${Id}" checked /><label for="remove_address_${Id}">~{Remove}~</label>'}],dataBound:function(e){}})};MailingListAddresses.prototype.getColumns=function(b){var c=this;var a=new Array();$(b).each(function(e,d){a.push({title:d,field:d})});return a};function MailingListDeduplication(b){var c=this;$.extend(true,c.options,c.baseOptions,b);var a=new ControlLoader();a.loadTemplate("MailingListDeduplication",function(d){$(document.body).append(d);c.initialize(c.getDataSource())})}MailingListDeduplication.prototype.options={};MailingListDeduplication.prototype.baseOptions={dataSource:null,templates:{contentTemplate:"#_MailingListDeduplicationTemplate"}};MailingListDeduplication.prototype.setupContinueButton=function(b){var c=this;var a=c.getElement().find("[data-role=button]");a.prop("disabled",!b);if(b){a.click(function(d){c.removeDuplicatesFromList()})}else{a.unbind("click")}};MailingListDeduplication.prototype.removeDuplicatesFromList=function(){var d=this;var b=d.getElement().find("[data-role=grid]").getKendoGrid();block(null,"~{MsgGettingDups}~");var c=d.getElement().find("[data-role=grid] tbody tr td .checkbox_click.remove_dup .fa-check-square").closest("tr");var a=new Array();$(c).each(function(e,f){a.push(b.dataItem(f)["_____UID_____"])});unblock();d.taskHub.removeDuplicatesFromList(d.data.DeduplicatedFile,a)};MailingListDeduplication.prototype.getColumns=function(b){var c=this;var a=new Array();$(b).each(function(e,d){a.push({title:d.replace(/_/g," "),field:d})});return a};MailingListDeduplication.prototype.update=function(a){var b=this;b.getElement().find(".text-danger").text(kendo.toString(a.ErrorCount,"n0"));b.getElement().find(".text-success").text(kendo.toString(a.Count,"n0"))};MailingListDeduplication.prototype.complete=function(a){var b=this;if(a.Type=="ListDeduplication"){b.getElement().find(".text-danger").text(kendo.toString(a.ErrorCount,"n0"));b.getElement().find(".text-success").text(kendo.toString(a.Count,"n0"));b.task=a;b.data.Task=b.task;b.data.DeduplicatedFile=b.task.Data.deduplicatedPath;if(b.task.ErrorGuid==null){$.fancybox.close();b.createPreviewGrid();b.setupContinueButton(true);if(a.ErrorCount===0){b.removeDuplicatesFromList()}}}else{b.task=a;b.data.Task=b.task;b.data.NumberOfRows=b.task.Count;b.data.FinalFile=b.task.Data.finalPath;b.data.Part=null;$.submitAsForm("/Tools/Mailing/DeliveryOptions/?Sku="+getQuerystring("sku")+"&customizationStateId="+getQuerystring("customizationStateId"),b.data,"data")}};MailingListDeduplication.prototype.error=function(a){var b=this;b.getElement().find(".text-danger").text(a.ErrorCount);b.getElement().find(".text-success").text(a.Count);b.setupContinueButton(false)};MailingListDeduplication.prototype.initialize=function(a){var b=this;b.data=a;b.getElement().append(kendo.template($(b.options.templates.contentTemplate).html())({Sku:getQuerystring("sku"),Name:b.options.displayName}));b.taskHub=new TaskHub(function(c){b.update(c)},function(c){b.complete(c)},function(c){b.error(c)});b.taskHub.deduplicateList(b.data.AddressVerifiedPath,[{Column:"Full Name",Piece:"FullName"},{Column:"Address 1",Piece:"Address1"},{Column:"Address 2",Piece:"Address2"},{Column:"Address 3",Piece:"Address3"},{Column:"City",Piece:"City"},{Column:"State",Piece:"State"},{Column:"ZIP Code",Piece:"Zip"}]);b.setupContinueButton(false)};MailingListDeduplication.prototype.getElement=function(){var a=this;return $("*[data-argosy-uuid="+a.options.uuid+"]")};MailingListDeduplication.prototype.getDataSource=function(a){var b=this;return window[b.options.dataSource]};MailingListDeduplication.prototype.createPreviewGrid=function(){var a=this;a.getElement().find("[data-role=grid]").kendoGrid({dataSource:{transport:{read:function(b){var c="/Tools/Mailing/GetListPreview?orderBy=MD5&listPath="+a.task.Data.deduplicatedPath;$.ajax({url:c,dataType:"json",method:"GET",success:function(f){var e=function(g,i){var h=g.MD5.toLowerCase();var j=i.MD5.toLowerCase();return((h<j)?-1:((h>j)?1:0))};f.sort(e);var d=null;$(f).each(function(g,h){h.Keep=false;h.Last=false;if(d==null||d!=h.MD5){d=h.MD5;h.Keep=true;if(g>0){f[g-1].Last=true}}});b.success(f)}})}},group:{field:"MD5"}},dataBound:function(c){var b=a.getElement().find("[data-role=grid]").find(".checkbox_click");b.click(function(f){var d=$(this).find(".checkbox_status");var h=$(this).closest("tr");var g=null;var i=function(j,e){if(j.hasClass("fa-square-o")&&e){j.removeClass("fa-square-o").addClass("fa-check-square")}else{j.removeClass("fa-check-square").addClass("fa-square-o")}};if($(this).hasClass("remove_dup")){g=h.find(".checkbox_click.keep_dup").find(".checkbox_status")}else{g=h.find(".checkbox_click.remove_dup").find(".checkbox_status")}i(d,true);i(g,false)})},groupable:true,sortable:true,selectable:false,scrollable:false,pageable:false,columns:[{title:"~{FullName}~",field:"Fullname"},{title:"~{UploadedAddress}~",template:"#if (Address_1 != '') {#${Address_1}<br />#}##if (Address_2 != '') {#${Address_2}<br />#}##if (Address_3 != '') {#${Address_3}<br />#}##if (City != '') {#${City}, #}##if (State != '') {#${State} #}##if (ZIP_Code != '') {#${ZIP_Code}#}#"},{title:"~{NumberOfDuplicates}~",field:"Count",template:"${Count} records"},{template:"<a class='checkbox_click keep_dup'><i class='checkbox_status fa #if (Keep) {#fa-check-square#}else{#fa-square-o#}#'></i><a>",width:"150px",title:"~{Keep}~"},{template:"<a class='checkbox_click remove_dup'><i class='checkbox_status fa #if (!Keep) {#fa-check-square#}else{#fa-square-o#}#'></i><a>",width:"150px",title:"~{Remove}~"}]})};MailingListDeduplication.prototype.getColumns=function(b){var c=this;var a=new Array();$(b).each(function(e,d){a.push({title:d.replace(/_/g," "),field:d})});return a};function MailingListEdit(b){var c=this;$.extend(true,c.options,c.baseOptions,b);var a=new ControlLoader();a.loadTemplate("MailingListEdit",function(d){$(document.body).append(d);c.initialize()})}MailingListEdit.prototype.options={};MailingListEdit.prototype.baseOptions={dataSource:null,templates:{contentTemplate:"#_MailingListEditTemplate"}};MailingListEdit.prototype.initialize=function(){var d=this;var c=d.options.sku==null?getQuerystring("sku"):d.options.sku;var b=d.options.customizationStateId==null?getQuerystring("customizationStateId"):d.options.customizationStateId;var a=kendo.Template.compile($(d.options.templates.contentTemplate).html())({Sku:c,CustomizationStateId:b,Name:d.options.displayName});d.getElement().append(a)};MailingListEdit.prototype.getElement=function(){var a=this;return $("*[data-argosy-uuid="+a.options.uuid+"]")};function MailingListExisting(b){var c=this;$.extend(true,c.options,c.baseOptions,b);var a=new ControlLoader();a.loadTemplate("MailingListExisting",function(d){$(document.body).append(d);c.initialize();a.processControlElement($("[data-argosy-control=MailingListShippingOptions]"))})}MailingListExisting.prototype.options={};MailingListExisting.prototype.baseOptions={dataSource:null,gridSelector:"#_mailingListExistingWrapper",listNameSelector:".list-name",listRecordCountSelector:".record-count",listRecordsNeededSelector:"#records-needed",templates:{contentTemplate:"#_MailingListExistingTemplate"}};MailingListExisting.prototype.dataSourceOpts={};MailingListExisting.prototype.initialize=function(){var d=this;var c=d.options.sku==null?getQuerystring("sku"):d.options.sku;var b=d.options.customizationStateId==null?getQuerystring("customizationStateId"):d.options.customizationStateId;var a=kendo.Template.compile($(d.options.templates.contentTemplate).html())({Sku:c,CustomizationStateId:b,Name:d.options.displayName});d.getElement().append(a);d.getElement().find(d.options.listRecordsNeededSelector).kendoNumericTextBox({decimals:0,format:"n0",spinners:false});d.setupGrid()};MailingListExisting.prototype.setupGrid=function(){var a=this;a.grid=$(a.options.gridSelector);a.grid=a.grid.kendoGrid({dataSource:a.getDataSource(),groupable:false,sortable:true,selectable:true,scrollable:false,dataBound:function(){$(".k-grid table tbody tr").hover(function(){$(this).toggleClass("k-grid k-state-hover")});$("table.k-focusable tbody tr").hover(function(){$(this).toggleClass("k-state-hover")});$(".k-grid table tbody tr").dblclick(function(c){var b=a.grid.getKendoGrid().dataItem(this);var d=a.getElement();$.submitAsForm("/Tools/Mailing/Mapper?Sku="+getQuerystring("sku")+"&customizationStateId="+getQuerystring("customizationStateId"),b,"listData")})},pageable:{refresh:true,pageSizes:true,buttonCount:5},change:function(b){},columns:[{title:"~{DateCreated}~",template:"${kendo.toString(new Date(DateCreated),'d')}",field:"DateCreated"},{title:"~{ListName}~",field:"Name"},{title:"<div class='textr'>~{NumberOfRecords}~</div>",template:"<div class='textr'>${kendo.toString(TotalRecords,'n0')}</div>",field:"TotalRecords"}],search:[{name:"Name",type:"text",placeholder:"~{SearchByListName}~",toolbar:true},]})};MailingListExisting.prototype.getDataSource=function(a){var b=this;$.extend(true,b.dataSourceOpts,_defaultDataSourceConfig,a);b.dataSourceOpts.transport={read:function(c){var d=b.options;$.extend(true,d,kendoOptionsToObject(c),b.searchCriteria);$.ajax({url:"/DataView/GetMailLists",dataType:"json",data:d,success:function(e){if(e.ReturnCode==ReturnCode.Failed){handleDataSourceException(e)}else{c.success(e)}}})}};b.dataSourceOpts.pageSize=15;return new kendo.data.DataSource(b.dataSourceOpts)};MailingListExisting.prototype.getElement=function(){var a=this;return $("*[data-argosy-uuid="+a.options.uuid+"]")};function MailingListLeadsPlease(b){var c=this;$.extend(true,c.options,c.baseOptions,b);var a=new ControlLoader();a.loadTemplate("MailingListLeadsPlease",function(d){$(document.body).append(d);c.initialize()})}MailingListLeadsPlease.prototype.options={};MailingListLeadsPlease.prototype.baseOptions={dataSource:null,templates:{contentTemplate:"#_MailingListLeadsPleaseTemplate"}};MailingListLeadsPlease.prototype.initialize=function(){var d=this;var c=d.options.sku===null?getQuerystring("sku"):d.options.sku;var b=d.options.customizationStateId===null?getQuerystring("customizationStateId"):d.options.customizationStateId;var a=kendo.Template.compile($(d.options.templates.contentTemplate).html())({Sku:c,CustomizationStateId:b,Name:d.options.displayName});d.getElement().append(a);d.setupLeadsPlease()};MailingListLeadsPlease.prototype.setupLeadsPlease=function(){var a=this;if(window.LeadsPlease!==null){$.ajax({url:"/Tools/Mailing/GetDataProviderConfig/?dataProvider=Leads Please",dataType:"json",method:"POST",success:function(c){var b={widgetid:"leadsPleaseWidget",affiliatecode:c.affiliatecode,callback:function(d){$.submitAsForm("/Tools/Mailing/DeliveryOptions?Sku="+getQuerystring("sku")+"&customizationStateId="+getQuerystring("customizationStateId"),{PurchaseListId:d.criteriaid,DataProviderConfigId:c.dataProviderConfigId,Type:d.listtype==="consumer"?"Consumer":"Business",Provider:"LeadsPlease",Price:d.price,TotalCount:d.qtycount,RequestedCount:d.qtydesired},"leadsPleaseData")},skin:{buylistbtn:"Continue"},conclusionurl:"https://portal.mypropago.com/",sessionid:userId};a.leadsPlease=new LeadsPlease.Widget(b)}})}else{setTimeout(a.setupLeadsPlease,500)}};MailingListLeadsPlease.prototype.getElement=function(){var a=this;return $("*[data-argosy-uuid="+a.options.uuid+"]")};function MailingListMapper(b){var c=this;$.extend(true,c.options,c.baseOptions,b);var a=new ControlLoader();a.loadTemplate("MailingListMapper",function(d){$(document.body).append(d);c.initialize(c.getDataSource())})}MailingListMapper.prototype.options={};MailingListMapper.prototype.baseOptions={dataSource:null,ignoreColumns:["_____UID_____","Updated_Address","IsValid","MD5","Count","Duplicate"],templates:{contentTemplate:"#_MailingListMapperTemplate",previewGrid:"#previewgrid"}};MailingListMapper.prototype.initialize=function(a){var b=this;b.data=a;b.getElement().append(kendo.template($(b.options.templates.contentTemplate).html())({Sku:getQuerystring("sku"),Name:b.options.displayName}));b.createMapperElement();b.createPreviewGrid();b.taskHub=new TaskHub(b.update,b.complete,b.error);b.setupContinueButton()};MailingListMapper.prototype.update=function(a){var b=this};MailingListMapper.prototype.complete=function(a){var b=this;if(a.ErrorGuid!=null&&a.ErrorGuid!=""){}else{$.submitAsForm("/Tools/Mailing/Addresses?Sku="+getQuerystring("sku")+"&customizationStateId="+getQuerystring("customizationStateId"),a,"taskData")}};MailingListMapper.prototype.error=function(a){var b=this};MailingListMapper.prototype.setupContinueButton=function(){var a=this;a.getElement().find("[data-role=button]").click(function(c){var f=a.getElement().find("[data-role=listmapper]").getKendoListMapper();var d=f.isValid();if(d){var g=f.value();var h=f.getUnmappedColumns(false);var b=new Array();$(g).each(function(e,j){b.push({SourceColumns:j.SourceColumns,DestinationColumn:j.ColumnName})});$(h).each(function(e,j){b.push({SourceColumns:[j],DestinationColumn:j})});a.taskHub.transformList(a.data.FileData.UploadFileUrl,{Columns:b})}})};MailingListMapper.prototype.createPreviewGrid=function(){var a=this;a.getElement().find("[data-role=grid]").kendoGrid({dataSource:new kendo.data.DataSource({data:a.data.PreviewData}),groupable:false,sortable:true,selectable:true,scrollable:false,pageable:false,columns:a.getColumns(a.data.SourceColumns)})};MailingListMapper.prototype.getColumns=function(b){var c=this;var a=new Array();$(b).each(function(f,d){var e=$.grep(c.options.ignoreColumns,function(g){return d.toLowerCase()===g.toLowerCase()});if(e.length===0){a.push({title:d,field:d})}});return a};MailingListMapper.prototype.createMapperElement=function(){var a=this;a.getElement().find("[data-role=listmapper]").kendoListMapper({sourceColumns:a.data.SourceColumns})};MailingListMapper.prototype.getElement=function(){var a=this;return $("*[data-argosy-uuid="+a.options.uuid+"]")};MailingListMapper.prototype.getDataSource=function(a){var b=this;return window[b.options.dataSource]};function MailingListOptions(b){var c=this;$.extend(true,c.options,c.baseOptions,b);var a=new ControlLoader();a.loadTemplate("MailingListOptions",function(d){$(document.body).append(d);c.initialize()})}MailingListOptions.prototype.options={};MailingListOptions.prototype.baseOptions={dataSource:null,mailingListRequired:false,uploadList:false,corporateList:false,purchaseList:false,uploadOnly:false,templates:{contentTemplate:"#_MailingListOptionsTemplate"}};MailingListOptions.prototype.initialize=function(){var g=this;var f=g.options.sku==null?getQuerystring("sku"):g.options.sku;var d=g.options.customizationStateId==null?getQuerystring("customizationStateId"):g.options.customizationStateId;var e={Sku:f,CustomizationStateId:d,mailingListRequired:g.options.mailingListRequired,uploadList:g.options.uploadList,corporateList:false,purchaseList:g.options.purchaseList,directMail:false,Name:g.options.displayName,uploadOnly:g.options.uploadOnly};var c=function(h){return h?1:0};var b=0;b+=c(e.uploadList);b+=c(e.uploadList&&!e.uploadOnly);b+=c(e.directMail);b+=c(e.corporateList);b+=c(e.purchaseList);switch(b){case 1:e.colClass="col-sm-12";break;case 2:e.colClass="col-sm-6";break;case 3:e.colClass="col-sm-4";break;case 4:e.colClass="col-sm-3";break;case 5:e.colClass="col-sm-2";break}var a=kendo.Template.compile($(g.options.templates.contentTemplate).html())(e);g.getElement().append(a);$(".disabled").each(function(h){disable(this)});$(".skip-to-cart").click(function(h){$.submitAsForm("/Tools/Mailing/SkipToCart?customizationStateId="+getQuerystring("customizationStateId"))})};MailingListOptions.prototype.getElement=function(){var a=this;return $("*[data-argosy-uuid="+a.options.uuid+"]")};function MailingListPurchaseOptions(a){var b=this;$.extend(true,b.options,b.baseOptions,a);b.controlLoader=new ControlLoader();b.controlLoader.loadTemplate("MailingListPurchaseOptions",function(c){$(document.body).append(c);b.initialize()})}MailingListPurchaseOptions.prototype.options={};MailingListPurchaseOptions.prototype.baseOptions={displayName:"",showAccudata:false,showLeadsPlease:false,templates:{contentTemplate:"#_MailingListPurchaseOptionsTemplate"}};MailingListPurchaseOptions.prototype.configureAccudata=function(){var b=this,a=$("<div />",{"data-argosy-control":"MailingListAccudata","data-argosy-options-display-name":b.options.displayName});b.getElement().empty();b.getElement().append(a);b.controlLoader.processControlElement(b.getElement().find("div")[0],function(c){})};MailingListPurchaseOptions.prototype.configureLeadsPlease=function(){var b=this,a=$("<div />",{"data-argosy-control":"MailingListLeadsPlease","data-argosy-options-display-name":b.options.displayName});b.getElement().empty();b.getElement().append(a);b.controlLoader.processControlElement(b.getElement().find("div")[0],function(c){})};MailingListPurchaseOptions.prototype.initialize=function(){var c=this;if(c.options.showAccudata&&!c.options.showLeadsPlease){c.configureAccudata()}else{if(c.options.showLeadsPlease&&!c.options.showAccudata){c.configureLeadsPlease()}else{var b=kendo.observable({name:c.options.displayName,showAccudata:c.options.showAccudata,showLeadsPlease:c.options.showLeadsPlease,selectOption:function(d){switch($(d.currentTarget).attr("data-option")){case"accudata":c.configureAccudata();break;case"leadsplease":c.configureLeadsPlease();break}$.fancybox.close()}});var a=$(c.options.templates.contentTemplate).html();$.fancybox({content:a,modal:true,beforeShow:function(){kendo.bind(this.wrap,b)},afterShow:function(){setTimeout(function(){$.fancybox.update()},250)}})}}};MailingListPurchaseOptions.prototype.getElement=function(){var a=this;return $("*[data-argosy-uuid="+a.options.uuid+"]")};function MailingListShippingOptions(b){var c=this;$.extend(true,c.options,c.baseOptions,b);var a=new ControlLoader();a.loadTemplate("MailingListShippingOptions",function(d){$(document.body).append(d);c.initialize(c.getDataSource())})}MailingListShippingOptions.prototype.options={};MailingListShippingOptions.prototype.baseOptions={dataProviderConfigId:null,dataSource:null,errorMessage:null,displayName:null,addToCartEvent:null,hideTitle:false,horizontal:false,canOverrideCount:false,showMultiUseOption:false,isMultiUse:false,singleUseCost:0,multiUseCost:0,singlePerRecordCost:0,multiPerRecordCost:0,totalsHref:"#_mailingListShippingOptionsTotal",templates:{contentTemplate:"#_MailingListShippingOptionsTemplate",totalsTemplate:"#_MailingListShippingOptionsTotalTemplate"}};MailingListShippingOptions.prototype.initialize=function(b){var d=this;d.data=b;d.data.Name=d.options.displayName;d.data.hideTitle=d.options.hideTitle;d.data.errorMessage=d.options.errorMessage;d.data.horizontal=d.options.horizontal;d.data.singleUseCost=d.options.singleUseCost;d.data.multiUseCost=d.options.multiUseCost;d.data.isMultiUse=d.options.isMultiUse;d.data.singlePerRecordCost=d.options.singlePerRecordCost;d.data.multiPerRecordCost=d.options.multiPerRecordCost;d.data.showMultiUseOption=d.options.showMultiUseOption&&d.options.multiUseCost!=null&&d.options.multiUseCost>0;d.data.CanOverrideCount=d.options.canOverrideCount;d.data.RequestedCount=d.data.NumberOfRows;var a=kendo.Template.compile($(d.options.templates.contentTemplate).html())(d.data);d.getElement().append(a);var c=new kendo.observable({updateShippingOption:function(f){if(d.data.SelectMailingOption!=null){var g=parseInt($(f.target).val());if(d.data.SelectMailingOption.PartServiceId!=g){$(d.data.MailingOptions).each(function(e){if(this.PartServiceId==g){d.data.SelectMailingOption=this;d.updateTotals()}})}}else{d.data.SelectMailingOption=this}},regenerate:function(f){$(document).trigger(argosyEvents.EVENT_REGENERATE_VARIABLES)},updateTotals:function(f){var g=f.sender;if(d.data.ThirdPartyList!=null){d.data.ThirdPartyList.RequestedCount=g.value()}d.data.RequestedCount=g.value();d.data.PartPrice=d.data.RequestedCount*d.data.Part.Price;d.updateTotals()},updateListUseOption:function(f){d.data.isMultiUse=f.currentTarget.value==="true";if(d.data.ThirdPartyList!=null){d.data.ThirdPartyList.IsMultiUse=d.data.isMultiUse;d.data.ThirdPartyList.PerRecordCost=d.data.isMultiUse?d.data.multiPerRecordCost:d.data.singlePerRecordCost;d.data.ThirdPartyList.PerListCost=d.data.isMultiUse?d.data.multiUseCost:d.data.singleUseCost}d.updateTotals()},addToCart:function(f){$(document).trigger(argosyEvents.START_LOADING);if(d.options.addToCartEvent==null){d.data.Part=null;d.data.SuggestedFileName=$("#listSaveName").val();d.data.NumberOfRows=d.data.RequestedCount;$.submitAsForm("/Tools/Mailing/AddToCart/?Sku="+getQuerystring("sku")+"&customizationStateId="+getQuerystring("customizationStateId"),d.data,"data")}else{$(document).trigger(d.options.addToCartEvent,{sku:getQuerystring("sku"),customizationId:getQuerystring("customizationStateId"),fileName:$("#listSaveName").val(),extraData:d.data})}}});kendo.bind(d.getElement(),c);d.updateTotals()};MailingListShippingOptions.prototype.updateTotals=function(){var b=this;var a=kendo.Template.compile($(b.options.templates.totalsTemplate).html())(b.data);b.getElement().find(b.options.totalsHref).empty();b.getElement().find(b.options.totalsHref).append(a)};MailingListShippingOptions.prototype.getElement=function(){var a=this;return $("*[data-argosy-uuid="+a.options.uuid+"]")};MailingListShippingOptions.prototype.getDataSource=function(a){var b=this;return window[b.options.dataSource]};function MailingListUpload(b){var c=this;$.extend(true,c.options,c.baseOptions,b);var a=new ControlLoader();a.loadTemplate("MailingListUpload",function(d){$(document.body).append(d);c.initialize()})}MailingListUpload.prototype.options={};MailingListUpload.prototype.baseOptions={dataSource:null,uploadOnly:false,templates:{contentTemplate:"#_MailingListUploadTemplate"}};MailingListUpload.prototype.initialize=function(){var a=this;$(document).bind(argosyEvents.KENDO_EDITOR_IMAGE_UPLOADED,function(c,b){a.verifySpreadsheet(b)});a.getElement().append(kendo.template($(a.options.templates.contentTemplate).html())({AllowedExtensions:[".xls",".xlsx",".csv"],CustomizationState:null,Sku:getQuerystring("sku"),Name:a.options.displayName}));kendo.bind(a.getElement())};MailingListUpload.prototype.verifySpreadsheet=function(a){var b=this;$.ajax({url:"/Tools/Mailing/VerifySpreadsheet/?file="+a.response.UploadFileUrl+"&hasHeaders="+$("#listHasHeaders")[0].checked,dataType:"json",success:function(c){if(c.ReturnCode===ReturnCode.Success){if(b.options.uploadOnly){$.submitAsForm("/Tools/Mailing/UploadOnly?Sku="+getQuerystring("sku")+"&customizationStateId="+getQuerystring("customizationStateId"),a.response,"fileData")}else{$.submitAsForm("/Tools/Mailing/Mapper?Sku="+getQuerystring("sku")+"&customizationStateId="+getQuerystring("customizationStateId"),a.response,"fileData")}}else{prompt.alert({question:c.Message,description:"",type:"warning"})}}})};MailingListUpload.prototype.getElement=function(){var a=this;return $("*[data-argosy-uuid="+a.options.uuid+"]")};MailingListUpload.prototype.isAdvancedUpload=function(){var b=this,a=document.createElement("div");return(("draggable" in a)||("ondragstart" in a&&"ondrop" in a))&&"FormData" in window&&"FileReader" in window};function ManageCoopDollars(a){var b=this;$.extend(true,b.options,b.baseOptions,a);b.controlLoader=new ControlLoader();b.controlLoader.loadTemplate("ManageCoopDollars",function(c){$("*[data-argosy-uuid='"+b.options.uuid+"']").append(c);b.initialize();b.loaded=true})}ManageCoopDollars.prototype.options={companyId:0,siteId:0};ManageCoopDollars.prototype.baseOptions={baseTemplate:"#_manageCoopDollarsMainTemplate",bindContainer:"#_manageCoopDollarsContainer",viewModel:null};ManageCoopDollars.prototype.initialize=function(){var a=this;a.options.viewModel=new kendo.data.ObservableObject({companyId:a.options.companyId,bucketsKeyword:null,userKeyword:null,userGroupKeyword:null,addUsersKeyword:null,excludeUserIds:[],excludeUserGroupIds:[],addUserGroupsKeyword:null,siteId:a.options.siteId,newBucketName:"",userId:0,adjustmentAmount:null,adjustmentComments:"",adjustmentPurpose:"add",itemTypes:"",currentBucket:new kendo.data.ObservableObject({Name:"",Id:null,Details:[],PartIds:[]}),currentReason:new kendo.data.ObservableObject({Reason:"",Id:0}),usersAdjustDataSource:new kendo.data.DataSource({pageSize:5}),partsForBucketDataSource:new kendo.data.DataSource({pageSize:5}),change:function(b){$(".checkbox").each(function(d,e){var c=$(e);c.removeAttr("checked")});$(b.sender.select()).find(".checkbox").prop("checked",true)},checkboxSelectAllUsers:function(b){var c=$("div[data-id='usersBalanceGrid']").data("kendoGrid");if($(b.toElement).is(":checked")){$.each(c.items(),function(d,e){c.select(e)})}else{c.clearSelection();$(".checkbox").each(function(d,e){$(e).prop("checked",false)})}},checkboxSelectAllUserGroups:function(b){var c=$("div[data-id='userGoupsBalanceGrid']").data("kendoGrid");if($(b.toElement).is(":checked")){$.each(c.items(),function(d,e){c.select(e)})}else{c.clearSelection();$(".checkbox").each(function(d,e){$(e).prop("checked",false)})}},checkboxClick:function(b){var c=$(b.currentTarget.parentElement.parentElement);if(b.currentTarget.checked){c.addClass("k-state-selected")}else{c.removeClass("k-state-selected")}},showBucketFromDetails:function(c){var h=this,f=$("tr[data-uid='"+c.data.uid+"']"),d=$("div[data-id='addBucketsGrid']").data("kendoGrid"),g=d.items(),b=d.dataItem(f);h.showBucketDetails(b);$.each(g,function(){var e=d.dataItem($(this));if(e.uid===b.uid){$(this).addClass("k-state-selected")}else{$(this).removeClass("k-state-selected")}})},showBucketFromRow:function(c){var f=c.data,d=c.sender,b=d.dataItem(d.select().last());f.showBucketDetails(b)},showBucketDetails:function(b){var c=this;c.set("currentBucket",new kendo.data.ObservableObject(b));c.set("bucketDetail",new kendo.data.DataSource({pageSize:15}));$.each(c.currentBucket.Details,function(e,d){c.bucketDetail.add(d)});CompanyPartsGridView.prototype.options.excludePartIds=$(c.currentBucket.get("PartIds")).toArray();$("div[data-argosy-view=CompanyPartsGridView]").getKendoGrid().dataSource.read();$("#detailHeaderLabel").text("Details for "+c.currentBucket.get("Name"));$("#divBucketDetails").fadeIn()},saveBucket:function(d){var g=d.data,c=g.get("newBucketName"),b=$("#_bucketAlert");b.hide();if(c===null||c===undefined||c.length<=0){b.text("You must supply a name to continue.").fadeIn();return}var f={Name:c};$(document).trigger(argosyEvents.START_LOADING);$.ajax({url:"/admin/coop/SaveBucket",dataType:"json",contentType:"application/json; charset=utf-8",method:"POST",data:JSON.stringify({bucket:f}),success:function(e){if(e.ReturnCode!==200){b.text(e.Message).show()}else{prompt.notify({question:"Success, bucket added.",type:"success"});g.buckets.read();$("#bucketName").val(""),$.fancybox.close();g.set("currentBucket",new kendo.data.ObservableObject(e.Records))}},complete:function(){$(document).trigger(argosyEvents.END_LOADING)}})},setBucket:function(){var b=$("select[data-id='ddlBucket']").data("kendoDropDownList");b.value("");b.trigger("change")},setReasonsDdl:function(){var b=$("select[data-id='ddlAdjustmentReason']").data("kendoDropDownList");b.value("");b.trigger("change")},showAddBucket:function(){this.setBucket();$("#divUsersBalance,#divUserGroupsBalance,#divCoopAdjustment").hide();$("#divAddBuckets").fadeIn()},showAdjustment:function(){this.setBucket();$("#divUsersBalance,#divUserGroupsBalance,#divAddBuckets").hide();$("#divCoopAdjustment").fadeIn()},showCoop:function(){this.setBucket();$("#divUsersBalance,#divUserGroupsBalance").fadeIn();$("#divCoopAdjustment,#divAddBuckets").hide()},saveAdjustment:function(f){var l=f.data,c=$("#_coopAlert"),k=$("div[data-id='selectedUsersGrid']").getKendoGrid(),i=$("div[data-id='selectedUserGroupsGrid']").getKendoGrid(),d,g;if(l.currentBucket!=null){d=l.currentBucket.get("Id")}else{d=null}if(l.currentReason!=null){g=l.currentReason.get("Id")}else{g=0}c.hide();if(d==null){c.text("You must select a bucket to continue.").fadeIn();return}if(g===0){c.text("You must select an adjustment reason to continue.").fadeIn();return}if(k.dataSource.total()<=0&&i.dataSource.total()<=0){c.text("You must add a user or user group to continue").fadeIn();return}if(l.get("adjustmentAmount")==null||l.get("adjustmentAmount")<=0){c.text("You must enter an amount greater than zero").fadeIn();$("#adjustmentAmount").focus();return}var j=[],h=[];$(k.dataSource.data()).each(function(){if(this.hasOwnProperty("UserId")){j.push(this.UserId)}});$(i.dataSource.data()).each(function(){if(this.hasOwnProperty("UserGroupId")){h.push(this.UserGroupId)}});var b={AdjustmentReasonId:g,BucketId:d,Comments:l.get("adjustmentComments"),Purpose:l.get("adjustmentPurpose"),AdjustmentAmount:l.get("adjustmentAmount"),AdjusterUserId:0,UserIds:j,UserGroupIds:h};$(document).trigger(argosyEvents.START_LOADING);$.ajax({url:"/admin/coop/SaveAdjustment",dataType:"json",contentType:"application/json; charset=utf-8",method:"POST",data:JSON.stringify({adjustment:b}),success:function(e){if(e.ReturnCode!==200){prompt.clientResponseError(e)}else{prompt.notify({question:"Success, adjustment(s) added.",type:"success"});l.setReasonsDdl();l.setBucket();l.usersLedger.read();l.userGroupsLedger.read();l.set("adjustmentComments","");l.set("adjustmentAmount",null);l.set("adjustmentPurpose","add");l.set("excludeUserIds",[]);l.set("excludeUserGroupIds",[]);l.set("addUsersKeyword",null);l.set("addUserGroupsKeyword",null);$("div[data-id='selectedUsersGrid']").data("kendoGrid").dataSource.data([]);$("div[data-id='selectedUserGroupsGrid']").data("kendoGrid").dataSource.data([]);$("div[data-id='addUsersGrid']").data("kendoGrid").dataSource.read();$("div[data-id='addUserGroupsGrid']").data("kendoGrid").dataSource.read();$("div[data-id='usersBalanceGrid']").data("kendoGrid").dataSource.read();$("div[data-id='userGroupsBalanceGrid']").data("kendoGrid").dataSource.read()}},complete:function(m){$(document).trigger(argosyEvents.END_LOADING)}})},removeDetail:function(b){var d=this,c=b.data;$.ajax({url:"/admin/coop/DeleteDetail",dataType:"json",contentType:"application/json; charset=utf-8",method:"POST",data:JSON.stringify({detailId:c.Id}),success:function(g){if(g.ReturnCode!==200){prompt.notify({question:g.Message,type:"error"})}else{prompt.notify({question:"Success, detail deleted.",type:"success"});var e=-1,f;$.each(d.currentBucket.Details,function(k,j){if(j.Id===c.Id){var h=ManageCoopDollars.prototype.options.viewModel.bucketDetail;f=h.getByUid(j.uid);e=k}});if(e>=0){d.currentBucket.Details.splice(e,1)}if(f!=null){d.bucketDetail.remove(f)}}}})},searchUserBalance:function(){var b=this;b.usersLedger.read()},searchUserGroupBalance:function(){var b=this;b.userGroupsLedger.read()},searchBuckets:function(b){var c=this;c.buckets.read()},removePart:function(b){this.removeDetail(b);this.partsForBucketDataSource.remove(b.data)},removeUser:function(b){this.usersAdjustDataSource.remove(b.data)},addBucket:function(b){$.fancybox({href:"#divAddNewBucket"})},addItemTypesToDetail:function(b){$.fancybox({href:"#divAddItemTypesToBucket"})},addPartToDetail:function(b){$.fancybox({href:"#divAddParts"})},savePartToDetail:function(c){var b=[],f=c.data;var d=$("div[data-argosy-view=CompanyPartsGridView]").getKendoGrid();$(d.select()).each(function(g){var h=d.dataItem(this);var e={BucketId:f.currentBucket.get("Id"),PartName:h.PartName,PartId:h.PartId,Sku:h.Sku};b.push(e)});if(b.length>0){$.ajax({url:"/admin/coop/SaveBucketDetails",dataType:"json",contentType:"application/json; charset=utf-8",method:"POST",data:JSON.stringify({details:b}),success:function(g){if(g.ReturnCode!==200){prompt.notify({question:g.Message,type:"error"})}else{prompt.notify({question:"Success, detail added.",type:"success"});$(g.Records).each(function(j,h){f.currentBucket.Details.push(h);f.currentBucket.PartIds.push(h.PartId);f.bucketDetail.add(h)});CompanyPartsGridView.prototype.options.excludePartIds=$(f.currentBucket.PartIds).toArray();var e=$("div[data-argosy-view=CompanyPartsGridView]").data("kendoGrid");e.dataSource.read()}$.fancybox.close()},complete:function(){$(document).trigger(argosyEvents.END_LOADING)}})}},saveItemTypesToDetail:function(f){var g=f.data,b=$("#_addItemTypesAlert"),c;if(g.currentBucket!=null){c=g.currentBucket.get("Id")}else{c=null}var d=[{BucketId:c,ItemTypes:g.get("itemTypes")}];b.hide();if(d[0].ItemTypes.length<=0){b.text("Item Type value is required.").fadeIn();return false}$.ajax({url:"/admin/coop/SaveBucketDetails",dataType:"json",contentType:"application/json; charset=utf-8",method:"POST",data:JSON.stringify({details:d}),success:function(e){if(e.ReturnCode!==200){b.text(e.Message).fadeIn()}else{prompt.notify({question:"Success, detail added.",type:"success"});g.set("itemTypes","");g.currentBucket.set("Details",[]);$(e.Records).each(function(j,h){g.currentBucket.Details.push(h);g.bucketDetail.add(h)});$.fancybox.close()}},complete:function(){$(document).trigger(argosyEvents.END_LOADING)}})},buckets:new kendo.data.DataSource({schema:{data:function(b){return b.Records},total:function(b){return b.TotalRecords},model:{id:"Id"},parse:function(b){return b}},transport:{read:{cache:false,url:"/admin/Coop/GetAvailableBuckets",contentType:"application/json; charset=utf-8",dataType:"json"},parameterMap:function(c,d){switch(d){case"read":var e=ManageCoopDollars.prototype.options.viewModel,b;if(e.currentBucket!=null){b=e.currentBucket.get("Id")}else{b=null}c=kendoOptionsToObject(c);c.BucketId=b;c.UserId=e.get("userId");c.CompanyId=e.get("companyId");c.Keyword=e.get("bucketsKeyword");break}return c},error:function(b){}},pageSize:25,serverFiltering:false,serverPaging:false}),assignedBuckets:new kendo.data.DataSource({schema:{data:function(b){return b.Records},total:function(b){return b.TotalRecords},model:{id:"Id"},parse:function(b){return b}},transport:{read:{cache:false,url:"/admin/Coop/GetAssignedBuckets",contentType:"application/json; charset=utf-8",dataType:"json"},update:{url:"/admin/Coop/RenameBucket",type:"POST",contentType:"application/json; charset=utf-8",dataType:"json"},parameterMap:function(b,c){switch(c){case"read":var d=ManageCoopDollars.prototype.options.viewModel;b=kendoOptionsToObject(b);b.UserId=d.get("userId");b.CompanyId=d.get("companyId");b.Keyword=d.get("bucketsKeyword");break;case"update":b=kendo.stringify(b);break}return b},error:function(b){}},pageSize:25,serverPaging:false,serverSorting:false}),bucketDetail:new kendo.data.DataSource({pageSize:15}),reasons:new kendo.data.DataSource({schema:{data:function(b){return b.Records},total:function(b){return b.TotalRecords}},transport:{read:{cache:false,url:"/admin/Coop/GetAdjustmentReasons",contentType:"application/json; charset=utf-8",dataType:"json"},error:function(b){}},serverFiltering:true,serverPaging:true,serverSorting:true,pageSize:25}),usersLedger:new kendo.data.DataSource({group:{field:"UserName",aggregates:[{field:"UserName",aggregate:"count"}]},aggregate:[{field:"UserName",aggregate:"count"}],schema:{data:function(b){return b.Records},total:function(b){return b.TotalRecords}},transport:{read:{cache:false,url:"/admin/Coop/GetCoopDollarBalances",contentType:"application/json; charset=utf-8",dataType:"json"},parameterMap:function(c){var d=a.options.viewModel,b;if(d.currentBucket!=null){b=d.currentBucket.get("Id")}else{b=null}c=kendoOptionsToObject(c);c.BucketId=b;c.UserId=d.get("userId");c.CompanyId=d.get("companyId");c.SiteId=d.get("siteId");c.Keyword=d.get("userKeyword");c.IsUserGroup=false;return c},error:function(b){}},pageSize:25,serverPaging:true,serverSorting:true,serverFiltering:true}),userGroupsLedger:new kendo.data.DataSource({group:{field:"UserGroupName",aggregates:[{field:"UserGroupName",aggregate:"count"}]},aggregate:[{field:"UserGroupName",aggregate:"count"}],schema:{data:function(b){return b.Records},total:function(b){return b.TotalRecords}},transport:{read:{cache:false,url:"/admin/Coop/GetCoopDollarBalances",contentType:"application/json; charset=utf-8",dataType:"json"},parameterMap:function(c){var d=ManageCoopDollars.prototype.options.viewModel,b;if(d.currentBucket!=null){b=d.currentBucket.get("Id")}else{b=null}c=kendoOptionsToObject(c);c.BucketId=b;c.UserGroupId=d.get("userGroupId");c.CompanyId=d.get("companyId");c.SiteId=d.get("siteId");c.Keyword=d.get("userGroupKeyword");c.IsUserGroup=true;return c},error:function(b){}},pageSize:25,serverPaging:true,serverSorting:true,serverFiltering:true}),addUsers:function(b){$.fancybox({href:"#AddUserToAdjustment"})},addSelectedUsers:function(c){$(document).trigger(argosyEvents.START_LOADING);var b=$("div[data-id='addUsersGrid']").data("kendoGrid"),d=$("div[data-id='selectedUsersGrid']").data("kendoGrid");if(b.select().length>0){$.each(b.select(),function(e,f){f=b.dataItem(f);d.dataSource.add(f);c.data.excludeUserIds.push(f.UserId)});b.dataSource.read();$.fancybox.close()}$(document).trigger(argosyEvents.END_LOADING)},searchAddUsers:function(b){b.data.addUsersDataSource.read()},searchAddUserGroups:function(b){b.data.addUserGroupsDataSource.read()},addUsersDataSource:new kendo.data.DataSource({transport:{read:{url:"/DataView/GetUsers",dataType:"json"},parameterMap:function(b){b.Keyword=a.options.viewModel.get("addUsersKeyword");b.Active=true;b.ExcludeUserIds=$(a.options.viewModel.get("excludeUserIds")).toArray();return b}},schema:{data:function(b){return b.Records},total:function(b){return b.TotalRecords}},serverFiltering:true,serverSorting:true,serverPaging:true,pageSize:10,requestStart:function(){$(document).trigger(argosyEvents.START_LOADING)},requestEnd:function(){$(document).trigger(argosyEvents.END_LOADING)}}),addUserGroups:function(b){$.fancybox({href:"#AddUserGroupToAdjustment"})},addSelectedUserGroups:function(c){$(document).trigger(argosyEvents.START_LOADING);var b=$("div[data-id='addUserGroupsGrid']").data("kendoGrid"),d=$("div[data-id='selectedUserGroupsGrid']").data("kendoGrid");if(b.select().length>0){$.each(b.select(),function(e,f){f=b.dataItem(f);d.dataSource.add(f);c.data.excludeUserGroupIds.push(f.UserGroupId)});b.dataSource.read();$.fancybox.close()}$(document).trigger(argosyEvents.END_LOADING)},addUserGroupsDataSource:new kendo.data.DataSource({transport:{read:{url:"/DataView/GetUserGroups",dataType:"json"},parameterMap:function(b){b.Keyword=a.options.viewModel.get("addUserGroupsKeyword");b.Active=true;b.excludeUserGroupIds=$(a.options.viewModel.get("excludeUserGroupIds")).toArray();return b}},schema:{data:function(b){return b.Records},total:function(b){return b.TotalRecords}},serverFiltering:true,serverSorting:true,serverPaging:true,pageSize:10,requestStart:function(){$(document).trigger(argosyEvents.START_LOADING)},requestEnd:function(){$(document).trigger(argosyEvents.END_LOADING)}}),usersBalanceDataBound:function(b){var c=b.sender.element.find(".k-grouping-row");$.each(c,function(d,e){b.sender.collapseGroup(e)})},selectedUsersDataSource:new kendo.data.DataSource({pageSize:5}),selectedUserGroupsDataSource:new kendo.data.DataSource({pageSize:5}),selectedUsersDataBound:function(b){var c=$("div[data-id='selectedUserGroupsGrid']").data("kendoGrid");if(b.sender.dataSource.total()<1&&(c==null||c.dataSource.total()<1)){$("#addUsersMessage").show();$("button[data-bind$='saveAdjustment']").attr("disabled",true)}else{$("#addUsersMessage").hide();$("button[data-bind$='saveAdjustment']").attr("disabled",false)}},selectedUserGroupsDataBound:function(b){var c=$("div[data-id='selectedUsersGrid']").data("kendoGrid");if(b.sender.dataSource.total()<1&&(c==null||c.dataSource.total()<1)){$("#addUsersMessage").show();$("button[data-bind$='saveAdjustment']").attr("disabled",true)}else{$("#addUsersMessage").hide();$("button[data-bind$='saveAdjustment']").attr("disabled",false)}},removeSelectedUser:function(c){$(document).trigger(argosyEvents.START_LOADING);var b=$("div[data-id='addUsersGrid']").data("kendoGrid"),f=$("div[data-id='selectedUsersGrid']").data("kendoGrid"),d=this.excludeUserIds.indexOf(c.data.UserId);if(d>=0){this.excludeUserIds.splice(d,1)}b.dataSource.read();f.dataSource.remove(c.data);$(document).trigger(argosyEvents.END_LOADING)},removeSelectedUserGroup:function(c){$(document).trigger(argosyEvents.START_LOADING);var b=$("div[data-id='addUserGroupsGrid']").data("kendoGrid"),f=$("div[data-id='selectedUserGroupsGrid']").data("kendoGrid"),d=this.excludeUserGroupIds.indexOf(c.data.UserGroupId);if(d>=0){this.excludeUserGroupIds.splice(d,1)}b.dataSource.read();f.dataSource.remove(c.data);$(document).trigger(argosyEvents.END_LOADING)}});kendo.bind($(a.options.bindContainer),a.options.viewModel);kendo.bind($("._toolbar"),a.options.viewModel);kendo.bind($(a.options.bindContainer).find(".k-header"),a.options.viewModel);kendo.bind($("#_bucketsDetail"),a.options.viewModel);$("*[data-argosy-control]:not([data-argosy-uuid]:not([data-role]))").each(function(b){a.controlLoader.processControlElement(this,function(c){})});$("#userCompleteInput").attr("placeholder","by name or username");$(a.options.baseTemplate).show()};var prompt=null;$(document).ready(function(a){prompt=new Message({})});function Message(b){var c=this;$.extend(true,c.options,c.baseOptions,b);var a=new ControlLoader();a.loadTemplate("Message",function(d){c.TEMPLATE=$(d);$(c).trigger(c.EVENT_TEMPLATE_LOADED)})}Message.prototype.options={};Message.prototype.defaultMessage={question:"No question defined?",description:"",button:"Continue",buttonClass:"btn-default",buttonNo:"Cancel",buttonNoIcon:"fa-stop-circle-o",buttonNoClass:"btn-default",buttonNoHidden:true,buttonMaybe:"Maybe",buttonMaybeIcon:"fa-stop-circle-o",buttonMaybeClass:"btn-default",buttonMaybeHidden:true,type:"warning",yes:function(a){$.fancybox.close()},no:null,maybe:null};Message.prototype.baseOptions={templateSelector:"#_AlertNotificationTemplate",};Message.prototype.EVENT_TEMPLATE_LOADED="TEMPLATE_ALERT_NOTIFICATIONS_LOADED";Message.prototype.TEMPLATE=null;Message.prototype.initKendoNotifications=function(){var a=this;if($(window).getKendoNotification()==null){$(window).kendoNotification({autoHideAfter:15000,bottom:20,right:20})}return $(window).getKendoNotification()};Message.prototype.notify=function(a){var b=this;a=b.makeMessageObject(a);b.setNotification(a)};Message.prototype.success=function(a){var b=this;a=b.makeMessageObject(a,"success");b.setNotification(a)};Message.prototype.error=function(a){var b=this;a=b.makeMessageObject(a,"error");b.setNotification(a)};Message.prototype.log=function(a){var b=this;a=b.makeMessageObject(a);window.console&&console.log(a.question)};Message.prototype.makeMessageObject=function(b,d){var c=this;var a={};if(d==null){d="warning"}if(typeof b=="string"||b instanceof String){a={question:b,type:d}}else{a=b}return a};Message.prototype.setNotification=function(b){var d=this;var c=d.initKendoNotifications({autoHideAfter:2000});var a={};$.extend(true,a,d.defaultMessage,b);if(b.question!=null&&b.question.toLowerCase()==="null"){b.question="An error occurred.  Please contact support."}switch(a.type){case"warning":c.warning(b.question);break;case"error":c.error(b.question);break;case"info":c.info(b.question);break;case"success":c.success(b.question);break}};Message.prototype.alert=function(b){var d=this;var c=kendo.template(d.TEMPLATE.html());var a={};$.extend(true,a,d.defaultMessage,b);if(a.description=="Ref: null"){a.description=""}a.icon=(a.type=="success"?"check":a.type);$.fancybox({content:c(a),afterShow:function(){var g=this.wrap;var f=g.find(".notification a.btn.yes");var h=g.find(".notification a.btn.maybe");var e=g.find(".notification a.btn.no");f.unbind("click");f.click(function(i){if(a.yes!=null){a.yes(i)}});h.unbind("click");h.click(function(i){if(a.maybe!=null){a.maybe(i)}});e.unbind("click");e.click(function(i){if(a.no!=null){a.no(i)}})},afterClose:function(f){if(a.no!=null&&a.yes==null){setTimeout(function(){a.no(f)},100)}else{if(a.yes!=null&&a.no==null){setTimeout(function(){a.yes(f)},100)}}},keys:{close:[27,13,32]}})};Message.prototype.clientResponseError=function(a){prompt.alert({question:a.Message,description:a.Guid==null?"":a.Guid,button:"Acknowledge",type:"warning"})};function MessageCenterGridView(a){var b=this;$.extend(true,b.options,b.baseOptions,a);$(document).bind(argosyEvents.SEARCH_PAGE_GRID,function(d,c){b.refineSearch(c)});b.refineSearch()}MessageCenterGridView.prototype.options={};MessageCenterGridView.prototype.baseOptions={gridViewSelector:"div[data-argosy-view=MessageCenterGridView]"};MessageCenterGridView.prototype.searchCriteria={};MessageCenterGridView.prototype.refineSearch=function(a){var b=this;b.searchCriteria=a;b.setupGrid()};MessageCenterGridView.prototype.setupGrid=function(){var c=this;var a=$(c.options.gridViewSelector);if(a.getKendoGrid()==null){var b={scrollable:false,editable:false,autoBind:true,dataSource:c.getDataSource({}),groupable:false,sortable:true,exportToExcel:false,pageable:{refresh:true,pageSizes:[50,100,500],buttonCount:5},columns:[{title:"~{Date}~",field:"DateCreated",template:'${kendo.toString(kendo.parseDate(DateCreated),"MM/dd/yyyy")}',width:"10%"},{title:"~{Priority}~",field:"Importance",template:"<div class='text-center'>                               #if (Importance == ' ' || Importance == 'L') {#                                   <i class='fa la fa-flag co-good'></i>                               #} else if(Importance == 'M') {#                                   <i class='fa la fa-flag co-caution'></i>                               #} else if(Importance == 'H') {#                                   <i class='fa la fa-flag co-warning'></i>                               #} else if(Importance == 'P') {#                                   <i class='fa la fa-exclamation-triangle'></i>                               #} else {#                                   <i class='fa la fa-flag'></i>                               #}#                           </div>",width:"5%"},{title:"~{Subject}~",field:"Subject",template:"<a onclick='showMessage(this); return false;' href=''                              data-title='${Subject}'                              data-description='${Description}'                              data-sender='${FirstName} ${LastName}'                              data-message-id='${CreatedBy}'                              data-date='${kendo.toString(kendo.parseDate(DateCreated),\"MM/dd/yyyy\")}'>${Subject}</a>",width:"50%%"},{title:"~{From}~",template:"${FirstName} ${LastName}",width:"30%%"}],search:[{name:"MessageKeywords",type:"text",placeholder:"~{SearchBySubjectContentSender}~",toolbar:true}]};if(c.options.adminGridView===true){b.selectable="multiple, row";b.columns.push({title:" ",template:"<div class='text-center'><i class='fa la fa-trash-o'></i></div>",width:"5%"});b.checkboxes=true;b.dataBound=function(d){var g=$(d.sender.element);var f=g.getKendoGrid();g.find("tbody tr[role=row]").each(function(){var e=f.dataItem(this);$(this).find(".fa.la.fa-trash-o").parent().unbind("click").click(function(){c.DeleteMessageModal([e])});$(this).find(".fa.la.fa-envelope").parent().unbind("click").click(function(){showMessage(e)})});g.find(".k-button.k-button-icontext.k-grid-deleteMessage").unbind("click").click(function(){c.DeleteMessageModal(c.getSelectedItems())})};b.toolbar=[{name:"deleteMessage",text:"<i class='fa fa-trash-o'></i><span class='resp-hidden'> ~{Remove}~</span>"}]}else{b.selectable=false;b.checkboxes=false;b.dataBound=function(){$("div[data-argosy-view=MessageCenterGridView] th:eq(4) ,div[data-argosy-view=MessageGridView]  tr td:nth-child(5)").addClass("hidden-sm hidden-xs")}}a.kendoArgosyGrid(b)}else{a.getKendoGrid().dataSource.read()}};MessageCenterGridView.prototype.DeleteMessageModal=function(d){var c=this;var a=false;var b={question:"~{WantToRemoveSelection}~",description:"~{CanNotRestoreDeletedMessages}~.",button:"Delete",type:"warning",yes:function(){if(!a){c.DeleteMessage(d);a=true}}};prompt.alert(b)};MessageCenterGridView.prototype.DeleteMessage=function(a){var c=this;var b={messages:a};$.ajax({url:"/Admin/Messages/Delete/",type:"POST",data:JSON.stringify(b),dataType:"json",traditional:true,contentType:"application/json; charset=utf-8",success:function(d){if(d.ReturnCode===ReturnCode.Success){$(d.Records).each(function(){prompt.notify({question:"Message "+this.Key+" was "+(!this.Value?"":"not")+" successfully deleted.",type:(!this.Value?"success":"error")})})}else{prompt.clientResponseError(d)}$(c.options.gridViewSelector).getKendoGrid().dataSource.read()}});$.fancybox.close()};MessageCenterGridView.prototype.getSelectedItems=function(){var c=this;var b=[];var a=$(c.options.gridViewSelector).getKendoGrid();$(a.select()).each(function(){b.push(a.dataItem(this))});return b};MessageCenterGridView.prototype.getDataSource=function(a){var b=this;$.extend(true,b.dataSourceOpts,_defaultDataSourceConfig,a);b.dataSourceOpts.transport={read:function(c){var d={};$.extend(true,d,kendoOptionsToObject(c),b.searchCriteria,b.options);$.ajax({url:"/DataView/GetMessages",dataType:"json",data:d,success:function(e){if(e.ReturnCode===ReturnCode.Failed){handleDataSourceException(e)}else{c.success(e)}}})}};return new kendo.data.DataSource(b.dataSourceOpts)};MessageCenterGridView.prototype.dataSourceOpts={};MessageCenterGridView.prototype.getStatus=function(){};function MessageUsersGridView(a){var b=this;$.extend(true,b.options,b.baseOptions,a);$(document).bind(argosyEvents.SEARCH_PAGE_GRID,function(d,c){b.refineSearch(c)});b.refineSearch({})}MessageUsersGridView.prototype.options={};MessageUsersGridView.prototype.baseOptions={gridViewSelector:"div[data-argosy-view=MessageUsersGridView]",};MessageUsersGridView.prototype.searchCriteria={Username:null};MessageUsersGridView.prototype.refineSearch=function(a){var b=this;b.searchCriteria=a;b.setupGrid()};MessageUsersGridView.prototype.setupGrid=function(){var c=this;if($(c.options.gridViewSelector).getKendoGrid()==null){var b={scrollable:false,editable:false,autoBind:true,dataSource:c.getDataSource({}),groupable:false,exportToExcel:false,sortable:true,selectable:"multiple, row",pageable:{refresh:true,pageSizes:false,buttonCount:2},columns:[{title:"Username",field:"Username",width:"30%"},{title:"Name",field:"LastName",template:"${FirstName} ${LastName}"},{title:"<div class='text-center'>Active</div>",field:"Active",template:"<div class='text-center'>#if (Active == true) {#<span>YES</span>#} else {#<span>NO</span>#}#</div>",width:"10%"}],checkboxes:true,search:[{name:"Keyword",type:"text",placeholder:"Search by First/Last Name or Username",toolbar:true},{name:"Active",type:"select",toolbar:true,data:[{value:"Y",text:"Active",selected:true},{value:"N",text:"Inactive"},{value:"",text:"All"}]}],};$(c.options.gridViewSelector).kendoArgosyGrid(b)}else{var a=$(c.options.gridViewSelector).getKendoGrid();a.dataSource.read();a.refresh()}};MessageUsersGridView.prototype.getDataSource=function(a){var b=this;$.extend(true,b.dataSourceOpts,_defaultDataSourceConfig,a);b.dataSourceOpts.pageSize=10;b.dataSourceOpts.transport={read:function(c){var d={};$.extend(true,d,kendoOptionsToObject(c),b.searchCriteria);$.ajax({url:"/DataView/GetUsers",dataType:"json",data:d,success:function(e){if(e.ReturnCode==ReturnCode.Failed){handleDataSourceException(e)}else{c.success(e)}}})}};return new kendo.data.DataSource(b.dataSourceOpts)};MessageUsersGridView.prototype.dataSourceOpts={};function ModalAssetDetail(b){var c=this;$.extend(true,c.options,c.baseOptions,b);var a=new ControlLoader();a.loadTemplate("ModalAssetDetail",function(d){c.TEMPLATE=$(d);$(c).trigger(c.EVENT_TEMPLATE_LOADED)})}ModalAssetDetail.prototype.options={asset:{}};ModalAssetDetail.prototype.baseOptions={templateSelector:"#_ModalAssetDetail",folderImageUpload:"#assetThumbnail"};ModalAssetDetail.prototype.EVENT_TEMPLATE_LOADED="TEMPLATE_MODAL_ASSET_DETAIL_LOADED";ModalAssetDetail.prototype.TEMPLATE=null;ModalAssetDetail.prototype.show=function(a,g){var f=this;var e=kendo.template(f.TEMPLATE.html());if(g==null){g=0}a.UserRoleId=g;f.Asset=a;ModalAssetDetail.prototype.options.Asset=a;var d=$.grep(f.Asset.Permissions,function(h){return h.RoleId===g}),c=d[0],b=c.IsAdmin;$.fancybox({content:e(a),afterShow:function(){var h=this.wrap;f.setupNameEdit(h);f.setupTagsEdit(h);f.setupDescEdit(h);addArgosyActions(h)}})};ModalAssetDetail.prototype.setupNameEdit=function(c){var g=this;var b=c.find("#nameViewEditor");var h=c.find("#nameViewWrapper");var a=h.find("a");var e=b.find("a");var d=b.find("input");var f=h.find("div.col_five_sixth");b.hide();h.show();a.unbind("click");e.unbind("click");a.bind("click",function(i){h.hide();b.show()});e.bind("click",function(i){var k=g.Asset.Name;var j=d.val();if(k!=j){$.ajax({url:"/Tools/DigitalAssets/SaveAssetName",data:{assetId:g.Asset.Id,name:j},dataType:"json",success:function(n){if(n.ReturnCode!="200"){prompt.notify({question:"There was an error saving your name! Ref: "+n.Guid,type:"error"})}else{prompt.notify({question:"Your name was updated successfully!",type:"success"});var m=$("div[data-argosy-view='MvcAssetListView']").data("kendoListView"),l=$("div[data-argosy-view='MvcAssetGridView']").data("kendoGrid");m.dataSource.read();l.dataSource.read();f.html(j);h.show();b.hide()}}})}else{h.show();b.hide()}})};ModalAssetDetail.prototype.setupDescEdit=function(c){var g=this;var b=c.find("#descViewEditor");var h=c.find("#descViewWrapper");var a=h.find("a");var e=b.find("a");var d=b.find("textarea");var f=h.find("div.col_five_sixth");b.hide();h.show();a.unbind("click");e.unbind("click");a.bind("click",function(i){h.hide();b.show()});e.bind("click",function(i){var k=g.Asset.Description;var j=d.val();if(k!=j){$.ajax({url:"/Tools/DigitalAssets/SaveAssetDescription",data:{assetId:g.Asset.Id,description:j},dataType:"json",success:function(l){if(l.ReturnCode!="200"){prompt.notify({question:"There was an error saving your description! Ref: "+l.Guid,type:"error"})}else{prompt.notify({question:"Your description was updated successfully!",type:"success"});jQuery("div[data-argosy-view='MvcAssetListView']").data("kendoListView").dataSource.read();f.html(j);h.show();b.hide()}}})}else{h.show();b.hide()}})};ModalAssetDetail.prototype.setupTagsEdit=function(c){var h=this;var f=c.find("#tagsWrapper").find("input");var g=c.find("#tagsWrapper").find(".fa-save");var d=c.find("#inclusionTagsWrapper").find("input");var e=c.find("#inclusionTagsWrapper").find(".fa-save");var a=c.find("#exlusionTagsWrapper").find("input");var b=c.find("#exlusionTagsWrapper").find(".fa-save");h.setupAssetTagMultiSelect(f,"/Tools/DigitalAssets/GetAssetTags/?tagPrefix=");h.setupAssetTagMultiSelect(d,"/Tools/DigitalAssets/GetInclusionTags/?tagPrefix=");h.setupAssetTagMultiSelect(a,"/Tools/DigitalAssets/GetExclusionTags/?tagPrefix=");h.setupSaveAssetTags(g,f,"/Tools/DigitalAssets/SaveAssetTags");h.setupSaveAssetTags(e,d,"/Tools/DigitalAssets/SaveInclusionTags","inclusion");h.setupSaveAssetTags(b,a,"/Tools/DigitalAssets/SaveExclusionTags","exclusion")};ModalAssetDetail.prototype.setupSaveAssetTags=function(a,b,e,d){var c=this;a=$(a);b=$(b).getKendoMultiSelect();a.click(function(f){var g=b.value();$.ajax({url:e,data:{assetId:c.Asset.Id,assetTags:g},dataType:"json",success:function(h){if(h.ReturnCode!="200"){prompt.notify({question:"There was an error saving your tags! Ref: "+h.Guid,type:"error"})}else{prompt.notify({question:"Your tags were updated successfully!",type:"success"});$(document).trigger(argosyEvents.UPDATE_ASSET_TAGS,{assetId:c.Asset.Id,json:h.Records,type:d})}}})})};ModalAssetDetail.prototype.setupAssetTagMultiSelect=function(element,url){var that=this;element=$(element);var cleanValues=[];var attribute=element.attr("data-argosy-tags");if(attribute!=null&&attribute.length>0){var values=eval(attribute);if(values!=null){$(values).each(function(i){cleanValues.push(htmlDecode(this))})}}element.kendoMultiSelect({placeholder:"Start entering tags and hit save...",autoBind:false,delay:250,dataSource:{type:"odata",serverFiltering:true,schema:{data:function(response){return response.Records},total:function(response){return response.TotalRecords}},transport:{read:function(options){var filter=options.data.filter;var startsWith=(filter==null||filter.filters==null||filter.filters.length==0?"":filter.filters[0].value);$.ajax({url:url+startsWith,dataType:"json",success:function(result){if(startsWith!==""){result.Records.push(startsWith)}if(result.Records[0]===""){result.Records.splice(0,1)}options.success(result)},error:function(result){options.error(result)}})}}},dataBound:function(e){$.fancybox.update()},value:cleanValues})};ModalAssetDetail.prototype.SaveAssetThumbnail=function(){var b=this;if($(b.baseOptions.folderImageUpload).get(0).files[0]!=undefined){var a=new FormData();a.append("assetId",b.options.Asset.Id);a.append("file",$(b.baseOptions.folderImageUpload).get(0).files[0],$(b.baseOptions.folderImageUpload).get(0).files[0].name);$.ajax({url:"/Tools/DigitalAssets/UpdateAssetThumbnail",contentType:false,processData:false,method:"POST",data:a,success:function(c){if(c.ReturnCode==200){prompt.notify({question:"Asset thumbnail updated succesfully.",type:"success"});$(document).trigger(argosyEvents.REFRESH_ASSET_DIRECTORY);setTimeout(function(){$(document).trigger(argosyEvents.SHOW_ASSET_DETAILS_MODAL,ModalAssetDetail.prototype.options.Asset.Id)},5000)}else{prompt.notify({question:"There was an error saving your asset! Ref: "+c.Guid,type:"error"})}}})}};function ModalAssetUsage(b){var c=this;$.extend(true,c.options,c.baseOptions,b);var a=new ControlLoader();a.loadTemplate("ModalUsage",function(d){if($(c.options.fancyboxHref).length===0){$(document.body).append(d)}$(c).trigger(c.EVENT_TEMPLATE_LOADED)})}ModalAssetUsage.prototype.options={};ModalAssetUsage.prototype.baseOptions={fancyboxHref:"div[data-argosy-modal=ModalUsage]",chartHref:"div[data-argosy-view=ModalUsageChart]"};ModalAssetUsage.prototype.EVENT_TEMPLATE_LOADED="TEMPLATE_MODAL_ASSET_USAGE_LOADED";ModalAssetUsage.prototype.show=function(b){var f=this,a=Date.today().toString("yyyy/MM/01"),e=Date.today().addMonths(-6).toString("yyyy/MM/01"),c=$(f.options.chartHref).getKendoStockChart();f.options.ID=b;if(c==null){$(f.options.chartHref).kendoStockChart({theme:"Uniform",dataSource:{transport:{read:function(g){$(document).trigger(argosyEvents.START_LOADING);var h={assetId:f.options.ID};$.ajax({url:"/DataView/GetAssetHistory",dataType:"json",data:h,success:function(i){if(i.ReturnCode==ReturnCode.Failed){handleDataSourceException(i)}else{g.success(i)}$(document).trigger(argosyEvents.END_LOADING);$.fancybox({href:f.options.fancyboxHref,type:"inline",scrolling:"no",afterClose:function(){$(f.options.chartHref).data("kendoStockChart").destroy();$(f.options.chartHref).empty()}})},error:function(i){g.error(i)}})}}},dateField:"Date",series:[{type:"column",field:"OrderVolume"}],legend:{position:"top",visible:true},categoryAxis:{field:"Date",labels:{rotation:-45},majorGridLines:{visible:false},baseUnit:"months"},navigator:{series:{type:"area",field:"OrderVolume"},select:{from:e,to:a},categoryAxis:{labels:{rotation:"auto"},baseUnit:"months"}},valueAxis:{labels:{format:"{0}"}}})}else{$(f.options.chartHref).getKendoStockChart().dataSource.read();var d=c._navigator;if(d){d._dragEnd()}}};ModalAssetUsage.prototype.getAssetUsageHistory=function(a){};function ModalCoopBucketDetail(b){var c=this;$.extend(true,c.options,c.baseOptions,b);var a=new ControlLoader();a.loadTemplate("ModalCoopBucketDetail",function(d){$(document.body).append(d);$(document.body).append($("#_ModalBucketDetailContainerTemplate").html());$(c).trigger(c.EVENT_TEMPLATE_LOADED)})}ModalCoopBucketDetail.prototype.options={};ModalCoopBucketDetail.prototype.baseOptions={templateSelector:"#_ModalBucketDetail",fancyboxDiv:"#_ModalBucketDetailContainer",};ModalCoopBucketDetail.prototype.EVENT_TEMPLATE_LOADED="TEMPLATE_MODAL_BUCKET_DETAIL_LOADED";ModalCoopBucketDetail.prototype.TEMPLATE=null;ModalCoopBucketDetail.prototype.show=function(a){var b=this;$.ajax({url:"/admin/coop/GetBucket?bucketId="+a,dataType:"json",contentType:"application/json; charset=utf-8",method:"GET",success:function(f){var c=kendo.Template.compile($(b.options.templateSelector).html())(f);$(b.options.fancyboxDiv).html(c);var e=[],d=[];$(f.Details).each(function(){var h=this;if(h.ItemType!==null){d.push(h)}else{e.push(h)}});var g=kendo.observable({parts:new kendo.data.DataSource({data:e,pageSize:10}),itemTypes:new kendo.data.DataSource({data:d,pageSize:10})});$.fancybox({href:b.options.fancyboxDiv,afterShow:function(){var h=this.wrap;kendo.bind(h,g)}})},error:function(c){}})};function ModalPartConfiguration(b){var c=this;$.extend(true,c.options,c.baseOptions,b);var a=new ControlLoader();a.loadTemplate("ModalPartConfiguration",function(d){$(document.body).append(d);$(document).trigger(c.EVENT_TEMPLATE_LOADED)})}ModalPartConfiguration.prototype.options={};ModalPartConfiguration.prototype.baseOptions={modalHref:"div[data-argosy-modal=ModalPartConfiguration]",partConfigurationWrapper:"#_ModalPartConfigurationTemplate",partId:null};ModalPartConfiguration.prototype.EVENT_TEMPLATE_LOADED="TEMPLATE_PART_CONFIGURATION_BUILDER_LOADED";ModalPartConfiguration.prototype.EVENT_LISTENERS_LOADED="PART_CONFIGURATION_BUILDER_LISTENERS_LOADED";ModalPartConfiguration.prototype.show=function(a){var b=this;b.options.partId=a.PartId;b.initialize(a)};ModalPartConfiguration.prototype.initialize=function(b){var d=this,c=b.PartId;b.FormatedPrice=kendo.toString(b.Price,"C");var a=kendo.observable({PartConfiguration:null,CurrentConfiguration:null,PartAttributes:null,ParentPart:b,ActivePart:b,CurrentCartQuantity:0,PartCache:new Array(),AddToCartDisabled:true,showCallToAction:false,getTemplateType:function(){if(this.PartConfiguration!=null&&this.PartConfiguration.Type!=null){if(this.ParentPart.IsConfigurableGridView&&this.PartConfiguration.Type==="Single"){return"single"}else{if(this.ParentPart.IsConfigurableGridView&&this.PartConfiguration.Type==="Matrix"){return"matrix"}else{return"multi"}}}else{if(this.ParentPart.IsAttributeConfigured){return"attribute"}}},isCustomizePart:function(){return this.ActivePart.Options.IsMailingListRequired||this.ActivePart.CanCustomize||this.ActivePart.CanUpload},needToAddCss:function(){switch(this.getTemplateType()){case"multi":case"single":return true;case"matrix":return false;default:return false}},getMinOrderQty:function(){if((this.ParentPart.Options!=null&&this.ParentPart.Options.IsEnforceMasterConfig)&&userSettings.EnforceMinMaxOrderQty){return this.ParentPart.MinOrderQty}else{return this.ActivePart.MinOrderQty}},isMinQtyVisible:function(){return userSettings.EnforceMinMaxOrderQty&&this.getMinOrderQty()>0},isAddToCartEnabled:function(){a.updateQuantity({},{value:0,partId:0},true);var e=false;if(userSettings.EnforceMinMaxOrderQty){e=this.CurrentCartQuantity<this.getMinOrderQty()}if(!e){e=this.CurrentCartQuantity==0}if(a.isCustomizePart()){e=false}if(!e){a.set("showCallToAction",false)}jsConsole.log(this.ActivePart.MinOrderQty);a.set("AddToCartDisabled",e)},isDefaultAddToCart:function(){return(this.PartConfiguration!=null&&!this.PartConfiguration.HasInputType)||this.ParentPart.IsAttributeConfigured},onAddToCartMouseOver:function(f){var g=this;if(g.AddToCartDisabled){a.set("showCallToAction",true)}else{a.set("showCallToAction",false)}},onAddToCartMouseOut:function(f){a.set("showCallToAction",false)},attributesSelectBound:function(){},addToCart:function(g){var j=new Array(),h=$(d.options.modalHref).find("*[data-cart-qty=true]"),f=$(d.options.modalHref).find("select.attributeOptions,input.attributeOptions");a.isAddToCartEnabled();if(!a.AddToCartDisabled){$(h).each(function(l,m){m=$(m);var n=m.val();if($.isKendo(m)){var e=$.getKendoControl(m);n=e.value()}if((n===null||n==="")&&a.isCustomizePart()){n=1}j.push({partId:m.attr("data-part-id"),qty:n,rank:m.attr("data-part-rank"),part:a.getPart(m.attr("data-part-id")),parentPartId:a.ParentPart.IsAttributeConfigured?0:a.ParentPart.PartId,attributePartId:a.AttributePartId})});if(j.length===0){j.push({partId:g.data.PartId,qty:1,rank:0,part:g.data,attributePartId:a.AttributePartId})}j=$.grep(j,function(e){return e.qty!=null&&!isNaN(e.qty)&&e.qty!==""&&parseInt(e.qty)>0});if(f.length>0){var k=[];var i=true;$(f).each(function(o,e){e=$(e);var p=e.attr("required")==="required";if(e.is("select")){e=e.getKendoDropDownList();var q=(e.selectedIndex===0?null:e.element[0].selectedOptions[0]),m=q!=null?parseAttributeIdFromValueKey(q.value):null,l=q!=null?parseAttributeCostFromValueKey(q.value):null,n=q!=null?q.text:null;if(q!=null){k.push({AttributeId:m,Value:l,Name:n})}else{if(p){i=false}}}else{if(e.val().trim()!=""){k.push({AttributeId:e.attr("data-type-id"),Value:e.attr("data-cost"),Name:e.val()})}else{if(p){i=false}}}});if(f.length>0){$(j).each(function(e,l){l.selectedAttributes=k})}if(!i){prompt.error("Missing required part configuration options.");return false}}sendPartsToCartOrCustomization(j,a.ParentPart.PartName,function(l){$(document).trigger(argosyEvents.PROMPT_NOTIFY,{message:a.ParentPart.PartName+" added to your cart.",type:"success"})});$.fancybox.close()}},selectButtonClicked:function(f){var g=f.data;this.parent().parent().parent().changeSelectedPartConfigTypeValue(g)},dropDownSelected:function(f){var h=parseInt($(f.target).find(":selected").attr("data-part-config-type-value-id")),g=this.getPartConfigTypeValue(f.data.ConfigTypeValues,h);this.changeSelectedPartConfigTypeValue(g)},listItemSelected:function(f){var g=f.data;this.parent().parent().parent().changeSelectedPartConfigTypeValue(g)},isOptionVisible:function(e){return !this.isOptionDisabled(e)},isOptionDisabled:function(f){var j=f.parent().parent(),k=j.parent(),i=0,l=this.CurrentConfiguration;$(k).each(function(n,o){if(o.PartConfigTypePartId===j.PartConfigTypePartId){i=n}});var m=new Array();while(i>0){i--;var g=k[i];var h=$.grep(l.ConfigTypeValues,function(n){return n.PartConfigTypePartId===g.PartConfigTypePartId})[0];m.push(h)}var e=new Array();$(f.ConfigParts).each(function(n,p){var o=true;$(m).each(function(q,r){var s=$.grep(p.ConfigTypeValues,function(t){return t.PartConfigTypePartId===r.PartConfigTypePartId&&t.PartConfigTypeValueId===r.PartConfigTypeValueId});if(o&&s.length===0){o=false}});if(o){e.push(this)}});return e.length===0},isOptionSelected:function(e){var g=this.CurrentConfiguration;var f=false;$(g.ConfigTypeValues).each(function(h,j){if(!f){f=j.PartConfigTypeValueId===e.PartConfigTypeValueId}});return f},isDropDownSelected:function(e){return this.isOptionSelected(e)?"selected":""},isSmallWindow:function(f){return this.getTemplateType()!=="multi"},isLargeWindow:function(f){return this.getTemplateType()==="multi"},getPartConfigTypeValue:function(g,f){var e=null;$(g).each(function(h,j){if(j.PartConfigTypeValueId==f){e=j}});return e},getMatchingConfigParts:function(f){var e=new Array();$(this.PartConfiguration.ConfigParts).each(function(g,j){var h=true;$(f).each(function(i,k){var l=$.grep(j.ConfigTypeValues,function(m){return m.PartConfigTypePartId===k.PartConfigTypePartId&&m.PartConfigTypeValueId===k.PartConfigTypeValueId});if(h&&l.length===0){h=false}});if(h){e.push(j)}});return e},changeSelectedPartConfigTypeValue:function(f){var g=this.getSelectedPartConfigValues(f,true);var e=this.getMatchingConfigParts(g);if(e.length>0){a.set("CurrentConfiguration",e[0]);a.updateCurrentPart();kendo.bind($(d.options.modalHref),a)}},getActivePartForValue:function(f){var g=this.getSelectedPartConfigValues(f,true),e=this.getMatchingConfigParts(g);if(e.length>0){return e[0]}return null},getSelectedPartConfigValues:function(k,e){var i=k.parent().parent(),j=i.parent(),h=0,l=this.CurrentConfiguration;$(j).each(function(n,o){if(o.PartConfigTypePartId===i.PartConfigTypePartId){h=n}});var m=new Array();while(h>0){h--;var f=j[h];var g=$.grep(l.ConfigTypeValues,function(n){return n.PartConfigTypePartId===f.PartConfigTypePartId})[0];m.push(g)}if(e){m.push({PartConfigTypePartId:i.PartConfigTypePartId,PartConfigTypeValueId:k.PartConfigTypeValueId})}return m},getPart:function(g){var f=this.PartCache[g],e=this;if(f==null){$.ajax({url:"/Store/Part/GetPartById/"+g,type:"GET",dataType:"json",contentType:"application/json; charset=utf-8",success:function(h){e.PartCache[g]=h;f=h},async:false})}return f},setPart:function(g,e){var f=this.getPart(g);e.part=new kendo.data.ObservableObject(f)},updateCurrentPart:function(){var e=this.getPart(a.CurrentConfiguration.PartId);e.FormatedPrice=kendo.toString(e.Price,"C");a.set("ActivePart",new kendo.data.ObservableObject(e));var f=a.getTemplateType();if(f!="attribute"&&f!=="matrix"&&f!=="single"&&!a.PartConfiguration.HasInputType){a.updateQuantity({},{partId:e.PartId,value:((e.IsLimitPartOrderQuantity&&e.Discounts&&e.Discounts.length>0&&!e.IsEdeliveryOnly)?0:e.DefaultQuantity)})}if(f!="attribute"){this.updatePartMinimumQuantity()}},updatePartMinimumQuantity:function(){if(a.ParentPart.Options!=null&&!a.ParentPart.Options.IsEnforceMasterConfig){$(a.PartConfiguration.ConfigTypeParts).each(function(e,f){f.MinimumQuantity=a.ActivePart.MinOrderQty});a.set("PartConfiguration",a.PartConfiguration)}},updateQuantity:function(h,f,g){var j=f.value,i=$(d.options.modalHref).find("*[data-cart-qty=true]");g=g==undefined?false:g;$(i).each(function(e,k){k=$(k);var l=parseInt(k.attr("data-part-id"));var m=k.val();if(f.partId!==l&&!isNaN(m)&&m!=null&&m!==""){j+=parseInt(m)}});a.set("CurrentCartQuantity",j);if(!g){a.isAddToCartEnabled()}},getMinimumQuantityText:function(){if(this.isMinQtyVisible()){var e=this.getTemplateType();switch(e){case"multi":return"Minimum Quantity of "+this.getMinOrderQty();default:return"Total Minimum Quantity of "+this.getMinOrderQty()}}else{return""}},getSingleViewPartNameHtml:function(g){var f=g.parent().parent();if(f.DisplayType==="ImageList"){var e="<img class='img-responsive mwh150' alt='"+g.Value+"' src='"+g.DisplayImage+"' />";return e}else{if(f.DisplayType==="ButtonList"){return"<b>"+g.Value+"</b>"}else{return"<b>"+g.Value+"</b>"}}},onTextBoxChange:function(g){var f=parseFloat($(g.target).attr("data-cost")),i=$(g.target).val(),h=$(g.target).closest(".col-md-12").find(".attributeCost");if(i!=null&&i.trim().length>0&&f!=null&&f!=NaN&&f>0){h.text("+"+kendo.toString(f,"c"))}else{h.text("")}},onAttributeChange:function(i){var k=(i.sender.selectedIndex===0?null:i.sender.element[0].selectedOptions[0]),g=k!=null?parseAttributeIdFromValueKey(k.value):null,f=k!=null?parseAttributeCostFromValueKey(k.value):null,h=k!=null?k.text:null,j=i.sender.wrapper.closest(".col-md-12").find(".attributeCost");if(f!=null&&f!=0){j.text("+"+kendo.toString(f,"c"))}else{j.text("")}$.fancybox.update()}});$(document).bind(argosyEvents.EVENT_PART_INPUT_QTY_CHANGED,function(g,f){a.updateQuantity(g,f)});if(b.IsAttributeConfigured){d.getPartAttributeConfigurations(b,a)}else{d.getPartConfigurations(b,a)}};ModalPartConfiguration.prototype.setupPartAttributeConfigurations=function(b,a){var c=this;a.set("PartConfiguration",null);a.set("CurrentConfiguration",b);a.set("CurrentCartQuantity",1);a.updateCurrentPart();if(a.getTemplateType()=="matrix"){a.ParentPart.FormatedPrice=kendo.toString(a.ParentPart.MinPrice,"C")+" - "+kendo.toString(a.ParentPart.MaxPrice,"C")}$(c.options.modalHref).empty();$(c.options.modalHref).append(kendo.Template.compile($(c.options.partConfigurationWrapper).html())({template:a.getTemplateType(),selectedPartId:a.ActivePart.PartId,hasInputType:false,MinimumQuantity:b.MinOrderQty,PartAttributes:a.PartAttributes,ParentPart:a.ParentPart}));a.isAddToCartEnabled();kendo.bind($(c.options.modalHref),a);$.fancybox({href:c.options.modalHref,type:"inline"})};ModalPartConfiguration.prototype.getPartAttributeConfigurations=function(b,a){var c=this;a.set("AttributePartId",b.PartId);$.ajax({url:"/Store/Part/GetPartAttributeConfiguration/"+b.PartId,type:"GET",dataType:"json",contentType:"application/json; charset=utf-8",success:function(d){if(d==null||d.length==0){c.getPartConfigurations(b,a)}else{a.set("PartAttributes",d);$.each(d,function(f,e){a.set("Attributes_"+e.Id,e.Attributes)});if(b.IsConfigurable){c.getPartConfigurations(b,a)}else{c.setupPartAttributeConfigurations(b,a)}}}})};ModalPartConfiguration.prototype.getPartConfigurations=function(b,a){var c=this;$.ajax({url:"/Store/Part/GetPartConfiguration/"+b.PartId,type:"GET",dataType:"json",contentType:"application/json; charset=utf-8",success:function(d){if(d.ConfigTypeParts.length>0){$(d.ConfigTypeParts).each(function(e,f){f.MinimumQuantity=b.MinOrderQty});a.set("PartConfiguration",d);a.set("CurrentConfiguration",d.CurrentPart);a.updateCurrentPart();if(a.getTemplateType()=="matrix"){a.ParentPart.FormatedPrice=kendo.toString(a.ParentPart.MinPrice,"C")+" - "+kendo.toString(a.ParentPart.MaxPrice,"C")}$(c.options.modalHref).empty();$(c.options.modalHref).append(kendo.Template.compile($(c.options.partConfigurationWrapper).html())({template:a.getTemplateType(),selectedPartId:a.ActivePart.PartId,hasInputType:d.HasInputType,MinimumQuantity:b.MinOrderQty,PartAttributes:a.PartAttributes,ParentPart:a.ParentPart}));a.isAddToCartEnabled();kendo.bind($(c.options.modalHref),a);$.fancybox({href:c.options.modalHref,type:"inline"})}else{c.setupPartAttributeConfigurations(b,a)}}})};ModalPartConfiguration.prototype.parseMatrixConfigurations=function(a){var c=this;var b={configurations:a};return b};function ModalParts(a){var b=this;$.extend(true,b.options,b.baseOptions,a);b.search();$(document).bind(argosyEvents.SEARCH_PAGE_GRID,function(d,c){b.refineSearch(c)})}ModalParts.prototype.options={};ModalParts.prototype.baseOptions={gridViewSelector:"div[data-argosy-view=ModalParts]",};ModalParts.prototype.searchCriteria={Sku:null};ModalParts.prototype.refineSearch=function(a){var c=this;c.searchCriteria=a;var b=$(c.options.gridViewSelector).getKendoGrid();b.dataSource.read();b.refresh()};ModalParts.prototype.search=function(){var c=this;if($(c.options.gridViewSelector).getKendoGrid()==null){var b={scrollable:false,editable:false,autoBind:false,dataSource:c.getDataSource({}),groupable:false,sortable:true,selectable:"multiple, row",pageable:{refresh:true,pageSize:10,pageSizes:[10,50,100,500],buttonCount:5},columns:[{title:"SKU",field:"Sku"},{title:"Product",template:"<div><a href='/Admin/Parts/Edit/${Sku}'> #if (PartName != null && PartName.trim().length > 0) {#   #= PartName # #}else{# #= Sku # #}#     </a></div>",width:"20%"},{title:"Description",field:"Description",width:"20%"}],checkboxes:true,search:[{name:"Keyword",type:"text",placeholder:"Search by Product, SKU or Description",toolbar:true}],};$(c.options.gridViewSelector).kendoArgosyGrid(b)}else{var a=$(c.options.gridViewSelector).getKendoGrid();a.dataSource.read();a.refresh()}};ModalParts.prototype.getDataSource=function(a){var b=this;$.extend(true,b.dataSourceOpts,_defaultDataSourceConfig,a);b.dataSourceOpts.pageSize=10,b.dataSourceOpts.transport={read:function(c){var d={};$.extend(true,d,kendoOptionsToObject(c),b.searchCriteria);$.ajax({url:"/DataView/GetParts",dataType:"json",data:d,success:function(e){if(e.ReturnCode==ReturnCode.Failed){handleDataSourceException(e)}else{c.success(e)}}})}};return new kendo.data.DataSource(b.dataSourceOpts)};ModalParts.prototype.dataSourceOpts={};function ModalPersistentMessageDetail(b){var c=this;var a=new ControlLoader();$.extend(true,c.options,b);$.ajax({url:"/Account/Messages/ShowPersistentMessageCheck",type:"GET",dataType:"json",cache:false,complete:function(d){if(d.responseText==="True"){a.loadTemplate("ModalPersistentMessageDetail",function(e){$.fancybox({modal:true,content:kendo.template($(e).html())(c.options),beforeShow:function(){$(document).trigger(argosyEvents.START_LOADING)},afterShow:function(){$(document).trigger(argosyEvents.END_LOADING);$(this.wrap).find("div.btn.btn-primary").click(function(){$.ajax({url:"/Account/Messages/SetPersistentMessageViewed",type:"POST",dataType:"json",success:function(f){if(f.ReturnCode===ReturnCode.Success){$.fancybox.close()}else{prompt.clientResponseError(f)}}})})}})})}}})}ModalPersistentMessageDetail.prototype.options={};function ModalProductDetail(b){var c=this;$.extend(true,c.options,c.baseOptions,b);var a=new ControlLoader();a.loadTemplate("ModalProductDetail",function(d){if($("#_ModalProductInventory").length==0){$(document.body).append(d)}$(c).trigger(c.EVENT_TEMPLATE_LOADED)})}ModalProductDetail.prototype.options={product:{}};ModalProductDetail.prototype.baseOptions={templateSelector:"#_ModalProductDetail",templateEnlargeImageViewTemplate:"#_ModalProductEnlargeImageViewTemplate",modalDiv:"#_ModalProductEnlargeImage",gridViewHref:"#_ModalProductKitView",fancyboxHref:"#_ModalProductContainer",configurationRowTemplate:"#_ModalProductDetailConfigurationGridTemplate",kitRowTemplate:"#_ModalProductDetailKitGridTemplate",productInventoryTemplate:"#_ModalProductInventory",productDetailTemplate:"#_ModalProductDetail",partCrossSellTemplate:"#_PartCrossSaleWrapperTemplate",};ModalProductDetail.prototype.EVENT_TEMPLATE_LOADED="TEMPLATE_MODAL_PRODUCT_DETAIL_LOADED";ModalProductDetail.prototype.setupComponentGridView=function(c,a,b){var e=this,d=b?e.options.kitRowTemplate:e.options.configurationRowTemplate;if(b||a){$(e.options.gridViewHref).kendoGrid({dataSource:{data:c},rowTemplate:kendo.template($(d).html()),columns:[{title:""},{title:"~{Product}~"},{title:"~{QuantityAvailable}~",headerAttributes:{"class":"textr"}},{title:"~{QuantityOnHand}~",headerAttributes:{"class":"textr"}},{title:"~{Qty}~",headerAttributes:{"class":"textr"}}],sortable:true,scrollable:false,dataBound:function(f){var g=f.sender;addArgosyActions(e.options.gridViewHref);if(a){g.hideColumn(4)}else{g.hideColumn(2);g.hideColumn(3)}},autoBind:true})}};ModalProductDetail.prototype.show=function(e,a,d,g){var i=this;if(a==null){a=false}if(d==null){d=false}if(g==null){g=true}$(document).bind(argosyEvents.PART_ADDED_TO_CART,function(l,k){if(k==e.PartName){$.fancybox.close()}});e.hideCartInputs=a;e.showAddToCart=g;var c;if(d){c=$(i.options.productInventoryTemplate).html()}else{c=$(i.options.productDetailTemplate).html()}var h=kendo.template(c),b=kendo.Template.compile($(i.options.templateEnlargeImageViewTemplate).html())(e),f=kendo.observable({part:e,quantity:e.DefaultQuantity,priceBreakDataBound:function(m){var k=$(m.sender.element),l=k.data("kendoDropDownList");k.data("kendoDropDownList").list.width("auto")},isShowAddToCart:function(k){return this.part.showAddToCart},showProductDetails:function(k){i.show(k.data)},showAddToCartModal:function(k){$(document).trigger(argosyEvents.SHOW_PART_QUANTITY_MODAL,k.data.PartId)},showCrossSellItems:function(k){return this.part.CrossSellParts!=null&&this.part.CrossSellParts.length>0},crossSaleItems:new kendo.data.DataSource({transport:{read:{url:"/Store/Part/GetPartsById",dataType:"json",contentType:"application/json",complete:function(){$.fancybox.update()}},parameterMap:function(k){k.ids=e.CrossSellParts;return k}}})});var j=function(){var k=$.fancybox.wrap.find("select.price-break-dropdown,input.qty_input:not([data-role])");$(k).each(function(l){if($.isKendo(this)){$.getKendoControl($(this)).value(e.DefaultQuantity)}else{$(this).val(e.DefaultQuantity)}})};$(i.options.modalDiv).html(b);if(e.IsConfigurable){$.ajax({url:"/Store/Part/GetPartsInConfiguration?parentPartId="+e.PartId,dataType:"json",method:"GET",success:function(k){$(i.options.fancyboxHref).html(h(e));i.setupComponentGridView(k,d,false);$.fancybox({href:i.options.fancyboxHref,afterShow:function(){var l=this.wrap;kendo.bind(l,f);addArgosyActions(l);j();$(document).trigger(argosyEvents.END_LOADING,{name:"MvcProductView"});$(document).trigger(argosyEvents.END_LOADING,{name:"ShoppingCartView"});$(".fancybox").fancybox()}})}})}else{if(e.IsKit){$.ajax({url:"/Store/Kit/GetKitParts?sku="+e.Sku,dataType:"json",method:"GET",success:function(k){$(i.options.fancyboxHref).html(h(e));i.setupComponentGridView(k,d,true);$.fancybox({href:i.options.fancyboxHref,afterShow:function(){var l=this.wrap;kendo.bind(l,f);addArgosyActions(l);j();$(document).trigger(argosyEvents.END_LOADING,{name:"MvcProductView"});$(document).trigger(argosyEvents.END_LOADING,{name:"ShoppingCartView"});$(".fancybox").fancybox()}})}})}else{$.fancybox({content:h(e),afterShow:function(){var k=this.wrap;kendo.bind(k,f);addArgosyActions(k);j();$(document).trigger(argosyEvents.END_LOADING,{name:"MvcProductView"});$(".fancybox").fancybox()}})}}};function ModalProductUsage(b){var c=this;$.extend(true,c.options,c.baseOptions,b);var a=new ControlLoader();a.loadTemplate("ModalUsage",function(d){if($(c.options.fancyboxHref).length===0){$(document.body).append(d)}$(c).trigger(c.EVENT_TEMPLATE_LOADED)})}ModalProductUsage.prototype.options={};ModalProductUsage.prototype.baseOptions={fancyboxHref:"div[data-argosy-modal=ModalUsage]",chartHref:"div[data-argosy-view=ModalUsageChart]"};ModalProductUsage.prototype.EVENT_TEMPLATE_LOADED="TEMPLATE_MODAL_PRODUCT_USAGE_LOADED";ModalProductUsage.prototype.show=function(j){var m=this,n=Date.today(),b=n.toString("yyyy/MM/01"),l=n.addMonths(-12).toString("yyyy/MM/01"),f=$(m.options.chartHref).getKendoStockChart();m.options.partId=j;if(f==null){$(m.options.chartHref).kendoStockChart({theme:"Uniform",dataSource:{transport:{read:function(o){$(document).trigger(argosyEvents.START_LOADING);var p={PartId:m.options.partId};$.ajax({url:"/DataView/GetProductHistory",dataType:"json",data:p,success:function(q){if(q.ReturnCode==ReturnCode.Failed){handleDataSourceException(q)}else{o.success(q)}$(document).trigger(argosyEvents.END_LOADING);$.fancybox({href:m.options.fancyboxHref,type:"inline",scrolling:"no",afterClose:function(){$(m.options.chartHref).data("kendoStockChart").destroy();$(m.options.chartHref).empty()}});$(m.options.chartHref).getKendoStockChart()._navigator._dragEnd()},error:function(q){o.error(q)}})}}},dateField:"Date",series:[{type:"column",field:"OrderVolume",name:"~{QtyOrdered}~"},{type:"column",field:"ShipmentVolume",name:"~{QtyShipped}~"}],categoryAxis:{field:"Date",labels:{rotation:-45},majorGridLines:{visible:false}},legend:{position:"top",visible:true},navigator:{series:[{type:"area",field:"OrderVolume"},{type:"area",field:"ShipmentVolume"}],select:{from:l,to:b},categoryAxis:{labels:{rotation:"auto"},baseUnit:"months"}},valueAxis:{labels:{format:"n0"}}})}else{f.dataSource.read();var a=f.dataSource.data();if(a.length>0){var g=a[a.length-1],i=f._navigator,k=i.options.select,h=g._date_Date.getMonth();g._date_Date.setMonth(h-12);var c=g._date_Date.getDate(),d=g._date_Date.getMonth()+1,e=g._date_Date.getFullYear();k.to=g.Date;k.from=e+"/"+d+"/"+c;f.refresh();if(i){i._dragEnd()}}}};ModalProductUsage.prototype.getPartUsageHistory=function(a){};function ModalProductView(a){var b=this;$.extend(true,b.options,b.baseOptions,a)}ModalProductView.prototype.baseOptions={skip:0,take:50,pagerHref:"div[data-argosy-view=ModalProductViewPager]",};ModalProductView.prototype.options={currentSearch:{}};ModalProductView.prototype.gridViewHref="div[data-argosy-view=ModalProductView]";ModalProductView.prototype.ModalContainer="#ModalProductDetailsContainer";ModalProductView.prototype.gridView={};ModalProductView.prototype.dataSourceOpts={pageSize:100};ModalProductView.prototype.recordCount=null;ModalProductView.prototype.dataSource=null;ModalProductView.prototype.pager=null;ModalProductView.prototype.setupListView=function(){var a=this;a.dataSource=a.getDataSource();a.listView=$(a.gridViewHref).kendoListView({dataSource:a.dataSource,template:$("#_ProductListViewPanelTemplate").html(),autoBind:false,selectable:false,pageable:true}).getKendoListView();a.setupPagerView();a.read();$.fancybox($(a.ModalContainer),{autoSize:false,width:"700",})};ModalProductView.prototype.setupPagerView=function(){var a=this;a.pager=$(a.baseOptions.pagerHref).kendoPager({dataSource:a.dataSource,messages:{empty:""},autoBind:false}).getKendoPager()};ModalProductView.prototype.read=function(a){var b=this;if(a!=null){b.dataSource.page(a)}else{b.dataSource.read(1)}b.listView.refresh();b.pager.refresh()};ModalProductView.prototype.getDataSource=function(a){var b=this;b.dataSourceOpts.transport={read:function(c){var d={ExcludedKitIds:b.baseOptions.ExcludedKitIds,Types:b.baseOptions.searchTerm.split(","),ExcludeKit:b.baseOptions.ExcludeKit,ExcludeAttributeParts:b.baseOptions.ExcludeAttributeParts,ExcludeConfiguredParts:b.baseOptions.ExcludeConfiguredParts};$.extend(true,b.options.currentSearch,kendoOptionsToObject(c),d);$.ajax({url:"/api/LuceneSearch/Parts",dataType:"json",method:"POST",data:b.options.currentSearch,success:function(f){if(f.Records!=null&&f.Records.length>0){$.each(f.Records,function(h,g){g.id=g.PartId;g.ButtonAction="AddToKit";g.AddToKitAction="KitBuilder.prototype.AddComponentToKit('"+g.PartId+"')";g.IsRequired=false;g.Disabled=false});addParts(f.Records)}if(f.ReturnResponse!=null){var e=$.parseJSON(f.ReturnResponse.PostJsonData)}c.success(f);$(document).trigger(argosyEvents.END_LOADING,{name:b.constructor.name})},error:function(e){$(document).trigger(argosyEvents.END_LOADING,{name:b.constructor.name});c.error(e)}})}};b.dataSourceOpts.pageSize=25;b.dataSourceOpts.serverPaging=true;b.dataSourceOpts.schema={data:function(c){return c.Records},total:function(c){return c.TotalRecords}};return new kendo.data.DataSource(b.dataSourceOpts)};function ModalProductViewingRights(b){$.extend(true,this.options,this.baseOptions,b);var c=this,a=new ControlLoader();a.loadTemplate("ModalViewingRights",function(d){$(document.body).append(d);$(c).trigger(c.EVENT_TEMPLATE_LOADED)})}ModalProductViewingRights.prototype.options={};ModalProductViewingRights.prototype.baseOptions={html:"#_ViewingRights",modal:"#_ViewingRightsModal",title:"#_ViewingRightsTitle",userGroups:"#_UserGroups",userGroupsList:"#_UserGroupsList",inclusionTags:"#_InclusionTags",inclusionTagsList:"#_InclusionTagsList",exclusionTags:"#_ExclusionTags",exclusionTagsList:"#_ExclusionTagsList"};ModalProductViewingRights.prototype.EVENT_TEMPLATE_LOADED="TEMPLATE_MODAL_PRODUCT_VIEWING_RIGHTS_LOADED";ModalProductViewingRights.prototype.init=function(a){var b=this;$(document).trigger(argosyEvents.START_LOADING);$.ajax({url:"/Admin/Parts/GetUserGroupNames",data:{partId:a.partId,companyId:a.companyId},dataType:"json",contentType:"application/json; charset=utf-8",success:function(g){var i=$(b.options.userGroupsList),h=$(b.options.userGroups),f=$(b.options.inclusionTagsList),e=$(b.options.inclusionTags),d=$(b.options.exclusionTagsList),c=$(b.options.exclusionTags);i.empty();f.empty();d.empty();$(b.options.title).html(a.partName);if(g.length>0){h.show();i.text(g.join(", "))}else{h.hide()}if(a.inclusionTags!==null&&a.inclusionTags!==""){e.show();f.text(a.inclusionTags)}else{e.hide()}if(a.exclusionTags!==null&&a.exclusionTags!==""){c.show();d.text(a.exclusionTags)}else{c.hide()}$.fancybox({content:$(b.options.html).html()});$(document).trigger(argosyEvents.END_LOADING)}})};function ModalShareAsset(b){var c=this;$.extend(true,c.options,c.baseOptions,b);var a=new ControlLoader();a.loadTemplate("ModalShareAsset",function(d){if($(c.options.fancyboxHref).length===0){$(document.body).append(d)}$(c).trigger(c.EVENT_TEMPLATE_LOADED)})}ModalShareAsset.prototype.options={};ModalShareAsset.prototype.baseOptions={fancyboxHref:"div[data-argosy-modal=ModalShareAsset]",shareAssetTemplateHref:"#_ModalShareAssetTemplate",emailContainer:"#_modalShareEmailContainer",assetId:null};ModalShareAsset.prototype.EVENT_TEMPLATE_LOADED="TEMPLATE_MODAL_SHARE_ASSET_LOADED";ModalShareAsset.prototype.setupEmailMultiSelect=function(){var c=this;var b=$.fancybox.wrap.find("select");var a=function(d){var e=/^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;return e.test(d)};b.kendoMultiSelect({placeholder:"Enter email(s) here...",autoBind:false,dataSource:{type:"odata",serverFiltering:true,schema:{data:function(d){return d.Records},total:function(d){return d.TotalRecords}},transport:{read:function(e){var d=e.data.filter;var f={Records:[],TotalRecords:0};var g=(d==null||d.filters==null||d.filters.length==0?"":d.filters[0].value);if(a(g)){f.Records.push(g);f.TotalRecords=f.Records.Length;e.success(f)}else{e.success(f)}}}},dataBound:function(d){$.fancybox.update()}})};ModalShareAsset.prototype.getBindHandlers=function(){var a=this;var b=kendo.observable({showMsgToUser:false,onSendFile:function(c){var f=this,g=[],d=false,h=$.fancybox.wrap.find("select").getKendoMultiSelect();g=h.value();d=g.length>0;f.set("recipients",g);f.set("showMsgToUser",!d);if(d){a.sendEmail(g)}},onAddRecipient:function(c){var d=this;d.get("recipients").push({email:"",hasError:false});d.set("showMsgToUser",false)},onRemoveRecipient:function(c){var f=c.data;var g=this.get("recipients");var d=g.indexOf(f);g.splice(d,1)},getErrorMsgText:function(c){var d=this,g=d.get("recipients"),f="Please correct or remove highlighted emails.";if(g.length>0){return f}return"Click + sign to add a recipient."},getErrorClass:function(c){return this.get("showMsgToUser")?"field-validation-error":"hide"},doesInputHaveError:function(c){return c.hasError?"input-has-error":""},recipients:[]});return b};ModalShareAsset.prototype.sendEmail=function(a){var b=this;$.ajax({url:"/Tools/DigitalAssets/ShareAsset",dataType:"json",data:{emails:a,assetId:b.options.assetId},type:"POST",complete:function(c){prompt.alert({question:"Your file has been shared.",description:"",type:"success",yes:function(d){$.fancybox.close()}})}})};ModalShareAsset.prototype.show=function(a){var c=this;c.options.assetId=a.Id;$(c.options.fancyboxHref).html();var b=kendo.Template.compile($(c.options.shareAssetTemplateHref).html())(a);$.fancybox({content:b,scrolling:"no",afterShow:function(d){c.setupEmailMultiSelect();kendo.bind($.fancybox.wrap,c.getBindHandlers())}})};function MvcAssetView(b){var c=this;$.extend(true,c.options,c.baseOptions,b);var a=new ControlLoader();a.loadControl("ModalAssetDetail",{},function(d){c.assetDetailControl=d});a.loadControl("ModalAssetUsage",{},function(d){c.assetUsageControl=d});a.loadControl("ModalShareAsset",{},function(d){c.assetShareControl=d});c.setupEventListeners();a.loadTemplate("MvcAssetView",function(d){$(document.body).append(d);$("*[data-argosy-uuid='"+c.options.uuid+"']").append($(c.options.assetViewTemplateHref).html());c.dataSource=c.getDataSource();c.setupLoadingAttributes();c.setupListView();c.setupGridView();c.setupPagerView();c.setupMenuOptions();c.setupDefaultOptions();c.setupViewButtons();c.updateTitle();c.read();c.loaded=true;addArgosyActions($(c.options.actionHref));$(document).trigger(c.EVENT_TEMPLATE_LOADED)})}MvcAssetView.prototype.options={};MvcAssetView.prototype.baseOptions={listViewHref:"div[data-argosy-view=MvcAssetListView]",gridViewHref:"div[data-argosy-view=MvcAssetGridView]",treeViewHref:"ul[data-argosy-control='DamDirectoryView']",masonryViewHref:"div[data-argosy-view=MvcAssetMasonryView]",availableFormatsHref:"div[data-argosy-view=availableFormatsGrid]",pagerHref:"div[data-argosy-view=MvcAssetViewPager]",sortBySelector:"select[data-argosy-view=MvcAssetViewSort]",filterBySelector:"select[data-argosy-view=MvcAssetViewFilter]",sortByTextSelector:"*[data-argosy-view=MvcAssetViewSortText]",filterByTextSelector:"*[data-argosy-view=MvcAssetViewFilterText]",showGridViewSelector:"a[data-argosy-view=MvcAssetGridViewSelector]",showListViewSelector:"a[data-argosy-view=MvcAssetListViewSelector]",showMasonryViewSelector:"a[data-argosy-view=MvcAssetMasonryViewSelector]",titleHref:"*[data-argosy-view=MvcAssetViewTitle]",actionHref:"*[data-argosy-view=MvcAssetViewActions]",descriptionHref:"*[data-argosy-view=MvcAssetViewDescription]",showDetailsHref:"*[data-argosy-view=MvcAssetViewShowDetails]",assetViewTemplateHref:"#_AssetViewTemplate",keywordSearchSelector:"input.search",historyTitleElment:"[rel='historyTitleElement']",createAssetFolderTemplate:"#_MvcAssetViewAddFolder",createAssetHref:"*[data-argosy-view='mvcAssetViewAddFolder']",assetViewCartStep1Template:"#_MvcAssetViewCartStep1Template",assetViewCartStep2Template:"#_MvcAssetViewCartStep2Template",assetViewDetailsTemplate:"#_MvcAssetViewDetailsTemplate",folderImageUpload:"#folderThumbnail",filterByCategory:false,assetToggle:"#chDAM",category:"",initialSortOrder:"relevance",initialAssetGroupId:null,includeDeleted:false,currentView:"list",showPricing:true,showEstShip:true,showTitle:true,showActions:true,showSort:true,showFilter:true,showDescription:true,includeFolders:false,showCompanyLinks:true,enableDragDrop:false,userRoleId:0,enableEdit:false,currentKeywordSearch:"",currentSearch:{AssetGroupId:0,Keyword:decodeURIComponent(getQuerystring("searchFor","")),Name:"",TypeId:"",MinDpi:0,MaxDpi:0,IsDeleted:false,SortOption:"AssetAsc",FilterOption:"All",DirectoryName:"Root"}};MvcAssetView.prototype.EVENT_TEMPLATE_LOADED="TEMPLATE_ASSET_VIEW_LOADED";MvcAssetView.prototype.EVENT_LISTENERS_LOADED="ASSET_VIEW_LISTENERS_LOADED";MvcAssetView.prototype.EVENT_DATABOUND="ASSET_VIEW_DATABOUND";MvcAssetView.prototype.assetDetailControl=null;MvcAssetView.prototype.assetUsageControl=null;MvcAssetView.prototype.assetShareControl=null;MvcAssetView.prototype.loaded=false;MvcAssetView.prototype.enableFeature=function(){var a=this;var b=$(window).width();if(b<=760){return false}else{return true}};MvcAssetView.prototype.addFolder=function(){var d=this,a=$(d.options.createAssetFolderTemplate).html(),b=kendo.template(a),c=b({Name:d.options.currentSearch.DirectoryName});$.fancybox({content:c});$(".btn-createFolder").unbind("click").click(function(){var e=$(d.options.createAssetHref).find("#folderName").val();d.doesFolderExist(e)})};MvcAssetView.prototype.updateTitle=function(){var a=this;if(a.options.categoryDesc!=null&&a.options.categoryDesc.length>0){$(a.options.descriptionHref).html(decodeURIComponent(a.options.categoryDesc));$(a.options.descriptionHref).show()}else{$(a.options.descriptionHref).hide()}$(a.options.titleHref).html(decodeURIComponent(a.options.category));if(!a.options.showDescription){$(a.options.descriptionHref).hide()}if(!a.options.showTitle){$(a.options.titleHref).hide()}};MvcAssetView.prototype.setupDefaultOptions=function(){var a=this;if(a.options.initialSortOrder!=null){a.options.currentSearch.SortOption=a.options.initialSortOrder}a.options.currentSearch.AssetGroupId=a.options.initialAssetGroupId};MvcAssetView.prototype.setupLoadingAttributes=function(){var b=this;var a=$("*[data-argosy-uuid='"+b.options.uuid+"']");appendLoadingAttribute(a,b.constructor.name);a.attr("data-argosy-loading-message","~{MsgLoadingYourAssets}~");appendLoadingAttribute($("*[data-argosy-control='MvcAssetCategories']"),b.constructor.name)};MvcAssetView.prototype.updateGroupPermission=function(a){var b=this;if(a==null){b.enableUpload(false);b.enableDelete(false);b.enableEdit(false)}else{b.enableUpload(a.CanUpload);b.enableEdit(a.CanEdit);b.enableDelete(a.CanDelete)}};MvcAssetView.prototype.enableEdit=function(a){var b=this;if(a==null){a=false}b.options.enableEdit=a};MvcAssetView.prototype._uploadOption=null;MvcAssetView.prototype.enableUpload=function(b){var c=this;if(b==null){b=false}var a=$("select[data-argosy-action=asset-action-change]").getKendoDropDownList();var d=null;$(a.dataSource.data()).each(function(e){if(this.value.toLowerCase()=="upload"){d=e}});if(b){if(d==null){a.dataSource.add(c._uploadOption)}}else{c._uploadOption=a.dataSource.data()[d];if(c._uploadOption!=null){a.dataSource.remove(c._uploadOption)}}};MvcAssetView.prototype._deleteOption=null;MvcAssetView.prototype.enableDelete=function(c){var d=this;if(c==null){c=false}var a=$("select[data-argosy-action=asset-action-change]").getKendoDropDownList();var b=null;$(a.dataSource.data()).each(function(e){if(this.value.toLowerCase()=="delete"){b=e}});if(c){if(b==null){a.dataSource.add(d._deleteOption)}}else{d._deleteOption=a.dataSource.data()[b];if(d._deleteOption!=null){a.dataSource.remove(d._deleteOption)}}};MvcAssetView.prototype.setupEventListeners=function(){var g=this;var f=function(h){return h.indexOf("width")>=0};var c=function(h){return h.indexOf("height")>=0};var e=function(h){return h.indexOf("pixel")>=0};var d=function(h){return h.indexOf("inches")>=0};var a=function(h){return h.indexOf("dpi")>=0};var b=function(h){return h.indexOf("format")>=0};$(document).bind(argosyEvents.FULL_TEXT_SEARCH,function(i,j){var h=g;h.options.currentSearch=j.currentAssetSearch;if(h.loaded){if(j.read){h.read()}}else{$(document).bind(h.EVENT_TEMPLATE_LOADED,function(k){if(j.read){h.read()}})}});$(document).bind(argosyEvents.ASSET_DIRECTORY_CHANGED,function(i,h){g.options.categoryDesc=h.Description;g.updateTitle();var k=g.options.currentSearch.AssetGroupId;var l=g.options.currentSearch.DirectoryName;var j=g.options.currentSearch.IsDeleted;g.options.currentSearch.AssetGroupId=h.Id;g.options.currentSearch.DirectoryName=h.Name;if(h.Name=="Deleted Items"){g.options.currentSearch.IsDeleted=null}else{g.options.currentSearch.IsDeleted=false}$.ajax({url:"/tools/digitalassets/GetAssetGroupPermission",dataType:"json",method:"POST",data:{assetGroupId:h.Id,assetRoleId:g.options.userRoleId},success:function(s){if(s.ReturnCode!="200"||!s.Records.CanView){g.options.currentSearch.AssetGroupId=k;g.options.currentSearch.DirectoryName=l;g.options.currentSearch.IsDeleted=j;if(s.ReturnCode!="200"){prompt.clientResponseError(s)}else{prompt.alert({question:"~{NoPermissionViewFolder}~",description:"~{SelectDifferentDirectoryTryAgain}~",type:"error",yes:function(w){$.fancybox.close()}})}}else{g.updateGroupPermission(s.Records);var v=$("ul[data-argosy-control='DamDirectoryView']").data("kendoTreeView"),n=function(w){var x;$.each(w,function(z,y){if(x==null&&y.ID===parseInt(h.Id)){x=y}if(x==null&&y.hasChildren){x=n(y.children.data())}});return x},o=n(v.dataItems()),p;if(o!=null){p=v.findByUid(o.uid);if(v.select().length===0){v.select(p)}else{if(v.select().length>0){var t=v.select()[0],u=v.dataItem(t);if(u.ID!==h.Id){v.select(p)}}}}else{var q=new kendo.data.Node({id:h.Id,ID:h.Id,Text:h.Name,SpriteCssClass:h.IconClass,hasChildren:h.HasChildren,HasChildren:h.HasChildren}),r=v.dataItems()[0].children;r.add(q);var m=r.data()[q.index-1];r.remove(m);r.sort({field:"Text",dir:"asc"});r.add(m);p=v.findByUid(q.uid);v.select(p)}g.read(1)}},error:function(m){options.error(m)}})});$(document).bind(argosyEvents.REFRESH_ASSET_DIRECTORY,function(h){g.read(1)});$(document).bind(argosyEvents.SHOW_ASSET_DETAILS_MODAL,function(j,i){var h=g.getAsset(parseInt(i));if(g.assetDetailControl!=null){g.assetDetailControl.show(h,g.options.userRoleId)}});$(document).bind(argosyEvents.SHOW_ASSET_USAGE_MODAL,function(i,h){if(g.assetUsageControl!=null){g.assetUsageControl.show(parseInt(h.assetId));$(g.options.historyTitleElment).html("~{AssetUsage}~")}});$(document).bind(argosyEvents.ADD_ASSET_TO_CART,function(j,i){var h=g.getAsset(parseInt(i));if(h!=null){var k=$(g.options.assetViewCartStep1Template).html();var m=kendo.template(k);var l=m(h);$.fancybox({content:l})}});$(document).bind(argosyEvents.UPDATE_ASSET_TAGS,function(i,h){g.updateAssetTagJson(parseInt(h.assetId),h.json,h.type)});$(document).bind(argosyEvents.ADD_ASSET_TO_CART_FINAL,function(k,i){var l=$.fancybox.wrap;var h=l.find("[data-argosy-view=dimensions]");var o=0;var n=0;var j=0;var m=0;$(h).each(function(q){var r=$(this);var p=r.attr("data-argosy-type");if(e(p)&&f(p)){o=r.getKendoNumericTextBox().value()}else{if(e(p)&&c(p)){n=r.getKendoNumericTextBox().value()}else{if(a(p)){j=parseInt(r.val())}else{if(b(p)){m=parseInt(r.val())}}}}});if(o>0&&n>0&&j>0){g.addAssetToCart(i,m,o,n,j)}});$(document).bind(argosyEvents.ADD_ASSET_TO_CART2,function(i,j){var h=g.getAsset(parseInt(j.assetId));h.format=g.getFormat(h,parseInt(j.formatId));if(h!=null&&j.formatId>0){var k=$(g.options.assetViewCartStep2Template).html();var m=kendo.template(k);var l=m(h);$.fancybox({content:l,afterShow:function(){var n=this.wrap;kendo.bind(n);n.find("input").keyup(function(p){var s=parseFloat($(p.target).val());var v=$(p.target).attr("data-argosy-type");var o=n.find("[data-argosy-view=dimensions]");var u=null;var t=null;if(d(v)&&c(v)){t=h.format.Dpi*s;u=t*(h.format.MaxWidth/h.format.MaxHeight)}else{if(d(v)&&f(v)){u=(h.format.Dpi*s);t=u*(h.format.MaxHeight/h.format.MaxWidth)}else{if(e(v)&&c(v)){t=s;u=t*(h.format.MaxWidth/h.format.MaxHeight)}else{if(e(v)&&f(v)){u=s;t=u*(h.format.MaxHeight/h.format.MaxWidth)}}}}if(h.format.MaxHeight<t||h.format.MaxWidth<u){p.preventDefault(true)}var r=u/h.format.Dpi;var q=t/h.format.Dpi;jsConsole.log("inchesWidth:  "+r);jsConsole.log("inchesHeight: "+q);jsConsole.log("pixelWidth:   "+u);jsConsole.log("pixelHeight:  "+t);$(o).each(function(x){var y=$(this);var w=y.attr("data-argosy-type");if(w!=v){if(e(w)&&c(w)){y.getKendoNumericTextBox().value(t)}else{if(e(w)&&f(w)){y.getKendoNumericTextBox().value(u)}else{if(d(w)&&f(w)){y.getKendoNumericTextBox().value(r)}else{if(d(w)&&c(w)){y.getKendoNumericTextBox().value(q)}}}}}})})}})}else{g.addAssetToCart(j.assetId,0,h.Width,h.Height,h.Dpi)}});$(document).bind(argosyEvents.DO_ASSET_ACTION,function(j,i){if(g.assetUsageControl!=null){var h=i.action.toLowerCase();switch(h){case"upload":if(g.options.currentSearch.AssetGroupId>0){$(document).trigger(argosyEvents.SHOW_ASSET_UPLOAD_MODAL,g.options.currentSearch.AssetGroupId)}else{prompt.alert({question:"~{CanNotUploadAssetToRootFolder}~",description:"~{SelectDirectoryTryAgain}~",type:"error",yes:function(k){$.fancybox.close()}})}break;case"addfolder":g.addFolder();break;case"delete":g.promptFileFolderAction("You are about to delete ","You have not selected any files or folders to delete.",function(k,l){return k==0&&l==0},function(k,l,m,n){$.ajax({url:"/tools/digitalassets/DeleteAssetItems",dataType:"json",method:"POST",data:{items:JSON.stringify(n)},success:function(o){if(o.ReturnCode!="200"){prompt.clientResponseError(o)}else{g.read(1);prompt.alert({question:"~{ItemsDeletedSuccessfully}~",description:"~{TakesMinutesForChangessToAppear}~",type:"success",yes:function(p){$.fancybox.close()}})}},error:function(o){options.error(o)}})});break}}});$(document).bind(argosyEvents.SELECT_ALL_ASSETS,function(i,h){if(g.listView!=null){if(h.isChecked){g.listView.select(g.listView.element.find("*[role='option']"))}else{g.listView.clearSelection()}}if(g.gridView!=null){if(h.isChecked){g.gridView.select(g.gridView.element.children().find("tbody > tr"))}else{g.gridView.clearSelection()}}});$(document).bind(argosyEvents.SHOW_SHARE_ASSET_MODAL,function(j,i){var h;$(g.dataSource.data()).each(function(){var k=this;if(k.Id===i){h=k}});if(h&&g.assetShareControl){g.assetShareControl.show(h)}});$(document).bind(argosyEvents.MOVE_ASSETS_TO_FOLDER,function(i,h){g.promptFileFolderAction("You are about to move ","You can only move folders to the root directory.",function(j,k){return j>0&&h.Id==0},function(j,k,l,m){$.ajax({url:"/tools/digitalassets/MoveAssetItems",dataType:"json",method:"POST",data:{assetGroupId:h.Id,items:JSON.stringify(m)},success:function(n){if(n.ReturnCode!="200"){prompt.clientResponseError(n)}else{if(l===0){$(document).trigger(argosyEvents.ASSET_DIRECTORY_CHANGED,h)}prompt.notify({question:"~{ItemsMovedSuccessfully}~",description:"~{TakesMinutesForChangessToAppear}~",type:"success"});var o=$("ul[data-argosy-control='DamDirectoryView']").data("kendoTreeView");$.each(o.items(),function(p,q){var r=$(q).text().trim();if(r===h.Name){o.select(q)}});$.fancybox.close()}},error:function(n){options.error(n)}})})});$(document).trigger(g.EVENT_LISTENERS_LOADED)};MvcAssetView.prototype.addAssetToCart=function(a,b,f,d,c){var e=this;$.ajax({url:"/tools/digitalassets/AddAssetToCart",dataType:"json",method:"POST",data:{assetId:a,downloadFormatId:b,height:parseInt(d),width:parseInt(f),dpi:c},success:function(g){prompt.alert({question:"~{AssetsAddedToCart}~",description:'Click "View Order" for more information.',type:"success",buttonNo:"~{SelectMoreAssets}~",button:"~{Checkout}~",buttonNoIcon:"fa-plus",buttonNoHidden:false,no:function(h){$.fancybox.close()},yes:function(h){window.location="/Tools/DigitalAssets/Cart"}})},error:function(g){prompt.alert({question:"~{ErrorAddingAssetToCart}",description:"Ref: "+g,type:"error",yes:function(h){$.fancybox.close()}})}})};MvcAssetView.prototype.promptFileFolderAction=function(a,c,d,b){var i=this;var h=i.getDataItems();var g=a;var e=0;var f=0;$(h).each(function(j){if(this.AssetItemType=="Folder"){f++}else{e++}});if(d(e,f)){prompt.alert({question:c,description:"",type:"warning",yes:function(j){$.fancybox.close()}})}else{if(f>0){g+=f+pluralize(" folder",f)+(e>0?" and ":"")}if(e>0){g+=e+pluralize(" file",e)}g+=".";prompt.alert({question:g,description:"~{TakesMinutesForChangessToAppear}~",buttonNoHidden:false,buttonNo:"No",button:"Yes",type:"warning",yes:function(j){if(typeof(j.preventDefault)==="function"){b(j,e,f,h)}},no:function(j){if(typeof(j.preventDefault)==="function"){$.fancybox.close()}}})}};MvcAssetView.prototype.getDataItems=function(){var b=this;var a=[];switch(b.currentView){case"list":$(b.listView.select()).each(function(c){a.push(b.listView.dataItem(this))});break;case"grid":$(b.gridView.select()).each(function(c){a.push(b.gridView.dataItem(this))});break;case"masonry":break}return a};MvcAssetView.prototype.getSelectedAssets=function(){var b=this;var a=null;switch(b.currentView){case"list":a=b.listView.select();break;case"grid":a=b.gridView.select();break;case"masonry":a=[];break}return a};MvcAssetView.prototype.doesFolderExist=function(a){var c=this;var b=(c.options.currentSearch.AssetGroupId==0?null:c.options.currentSearch.AssetGroupId);$.ajax({url:"/tools/digitalassets/DoesFolderExist",dataType:"json",method:"POST",data:{parentGroupId:b,name:a},success:function(d){if(d){prompt.alert({question:"~{FolderAlreadyExists}~",description:"~{TryAnotherName}~",type:"warning",yes:function(f){$(document).trigger(argosyEvents.DO_ASSET_ACTION,{action:"addfolder"})}})}else{c.createFolder(a,b)}},error:function(d){options.error(d)}})};MvcAssetView.prototype.createFolder=function(b,c){var d=this;var a=new FormData();a.append("parentAssetGroupId",c);a.append("name",b);a.append("userRoleId",d.options.userRoleId);a.append("inheritParentPermissions",$("#useParentPermission").is(":checked"));if($(d.baseOptions.folderImageUpload).get(0).files[0]!==undefined){a.append("file",$(d.baseOptions.folderImageUpload).get(0).files[0],$(d.baseOptions.folderImageUpload).get(0).files[0].name)}$.ajax({url:"/tools/digitalassets/CreateAssetFolder",contentType:false,processData:false,method:"POST",data:a,success:function(e){if(e==null){prompt.alert({question:"~{ProblemCreatingFolder}~",description:"~{TryAgainLater}~",type:"warning",yes:function(f){$.fancybox.close()}})}else{$(document).trigger(argosyEvents.ASSET_DIRECTORY_CREATED,e);prompt.alert({question:"~{FolderCreatedSuccessfully}~",description:"~{TakesMinutesForChangessToAppear}~",type:"success",yes:function(f){$.fancybox.close()}})}},error:function(e){options.error(e)}})};MvcAssetView.prototype.getFormat=function(a,c){var e=this;var b=null;if(a.AvailableFormats!=null&&c>0){for(var d=0;d<a.AvailableFormats.length;d++){if(a.AvailableFormats[d].Id==c){b=a.AvailableFormats[d];break}}}else{b={Dpi:a.Dpi,Extension:a.Extension,Id:0,IsActive:true,IsSystem:false,Name:"Original"}}b.MaxWidth=a.Width;b.MaxHeight=a.Height;return b};MvcAssetView.prototype.getAsset=function(b){var f=this;var a=null;if(f.dataSource!=null){var e=f.dataSource.data().length;for(var c=0;c<e;c++){var d=f.dataSource.data()[c];if(d.Id===b){a=d;break}}}return a};MvcAssetView.prototype.updateAssetTagJson=function(assetId,json,type){var that=this;if(that.dataSource!=null){var length=that.dataSource.data().length;for(var i=0;i<length;i++){var item=that.dataSource.data()[i];if(item.Id===assetId){switch(type){case"inclusion":item.InclusionArray=eval(json);break;case"exclusion":item.ExclusionArray=eval(json);break;default:item.TagsJson=json;break}break}}}};MvcAssetView.prototype.setupMenuOptions=function(){var c=this;var b=$(c.options.sortBySelector);var a=$(c.options.filterBySelector);if(c.options.showFilter){a.change(function(d){var f=$(d.currentTarget[d.currentTarget.selectedIndex]).attr("data-argosy-filter");c.options.currentSearch.FilterOption=f;c.read()})}else{a.hide();$(c.options.filterByTextSelector).hide()}if(c.options.showSort){b.change(function(d){var f=$(d.currentTarget[d.currentTarget.selectedIndex]).attr("data-argosy-sort");c.options.currentSearch.SortOption=f;c.read()})}else{b.hide();$(c.options.sortByTextSelector).hide()}if(c.options.showActions){$(c.options.actionHref).show()}else{$(c.options.actionHref).hide()}};MvcAssetView.prototype.setupViewButtons=function(){var d=this;var b=$(d.options.showListViewSelector);var a=$(d.options.showGridViewSelector);var c=$(d.options.showMasonryViewSelector);b.unbind("click");a.unbind("click");c.unbind("click");b.click(function(f){d.updateView(false,true,false)});a.click(function(f){d.updateView(true,false,false)});c.click(function(f){d.updateView(false,false,true)});if(a.hasClass("selected")){d.updateView(true,false,false)}else{if(c.hasClass("selected")){d.updateView(false,false,true)}else{d.updateView(false,true,false)}}};MvcAssetView.prototype.updateView=function(d,f,h){var j=this;var a=$(j.options.gridViewHref);var b=$(j.options.listViewHref);var c=$(j.options.masonryViewHref);var g=$(j.options.showListViewSelector);var e=$(j.options.showGridViewSelector);var i=$(j.options.showMasonryViewSelector);if(d){a.show();e.addClass("selected");j.currentView="grid"}else{a.hide();e.removeClass("selected")}if(f){b.show();g.addClass("selected");j.currentView="list"}else{b.hide();g.removeClass("selected")}if(h){c.show();i.addClass("selected");j.currentView="masonry"}else{c.hide();i.removeClass("selected")}};MvcAssetView.prototype.sendDataUpdateEvent=function(){var a=this;$(document).trigger(a.EVENT_DATABOUND,{Count:a.dataSource._total})};MvcAssetView.prototype.addDraggable=function(a){var b=this;if(b.options.enableEdit&&b.options.enableDragDrop){if(b.enableFeature()){$(a).kendoDraggable({hint:function(c){var f=b.getSelectedAssets();if(f.length>1){return $("<div class='dragdropwrapper'><div><h2 class='dragdroptext'>Moving "+f.length+" items...</h1>")}else{if(f.length==0){b.listView.select(c)}}var d=c.find("img");return $("<img src='"+d.attr("src")+"'>")},dragstart:function(c){},dragend:function(c){},cursorOffset:{top:10,left:10}})}}};MvcAssetView.prototype.setupListView=function(){var a=this;a.listView=$(a.options.listViewHref).kendoListView({dataSource:a.dataSource,template:$("#_AssetListViewPanelTemplate").html(),dataBound:function(b){addArgosyActions(a.options.listViewHref);$(".fancybox").fancybox();a.addDraggable($(a.options.listViewHref).find(".draggable"))},change:function(){$("#mycheckbox").prop("checked",false)},autoBind:false,selectable:a.enableFeature()?"multiple":null}).getKendoListView()};MvcAssetView.prototype.setupGridView=function(){var a=this;a.gridView=$(a.options.gridViewHref).kendoGrid({dataSource:a.dataSource,rowTemplate:kendo.template($("#_AssetGridViewTemplate").html()),columns:[{title:"",},{title:"~{Asset}~",},{title:"~{Size}~",headerAttributes:{"class":"hidden-sm hidden-xs",},},{title:"",headerAttributes:{"class":"textr",},}],sortable:true,scrollable:false,selectable:a.enableFeature()?"multiple":null,dataBound:function(b){$("#mycheckbox").prop("checked",false);addArgosyActions(a.options.gridViewHref);$(".fancybox").fancybox();a.addDraggable($(a.options.gridViewHref).find(".draggable"));if(b.sender.dataItems().length>0){var c=-1;$.each(b.sender.dataItems(),function(f,e){if(c===-1&&e.Name==="Deleted Items"){c=f}});if(c>=0){var d=b.sender.dataSource.at(c);b.sender.dataSource.remove(d)}}},autoBind:false}).getKendoGrid()};MvcAssetView.prototype.setupPagerView=function(){var a=this;a.pager=$(a.options.pagerHref).kendoPager({dataSource:a.dataSource,autoBind:false}).getKendoPager()};MvcAssetView.prototype.read=function(a){var b=this;if(a!=null){b.dataSource.page(a)}b.dataSource.read();b.gridView.refresh();b.listView.refresh();b.pager.refresh();var c=$(b.options.treeViewHref).data("kendoTreeView");if(c!=null&&c.dataItems().length===0){c.dataSource.read()}};MvcAssetView.prototype.getDataSource=function(a){var b=this;$.extend(true,b.dataSourceOpts,_defaultDataSourceConfig,a);b.dataSourceOpts.transport={read:function(c){$(document).trigger(argosyEvents.START_LOADING,{name:b.constructor.name});$.extend(true,b.options.currentSearch,kendoOptionsToObject(c),b.searchCriteria);b.options.currentSearch.AssetItemType=3;b.options.currentSearch.IsDeleted=b.options.includeDeleted?null:false;$.ajax({url:"/api/LuceneSearch/Assets",dataType:"json",method:"POST",data:b.options.currentSearch,success:function(d){$(d.Records).each(function(e){this.UserRoleId=b.options.userRoleId});c.success(d);$(document).trigger(argosyEvents.END_LOADING,{name:b.constructor.name});b.sendDataUpdateEvent()},error:function(d){c.error(d)}})}};b.dataSourceOpts.pageSize=100;b.dataSourceOpts.schema={data:function(c){return c.Records},total:function(c){return c.TotalRecords},model:{id:"Id"}};return new kendo.data.DataSource(b.dataSourceOpts)};MvcAssetView.prototype.getRandomPrice=function(){return Math.round((Math.random()*100)*(Math.random()))};MvcAssetView.prototype.dataSourceOpts={pageSize:100};function MvcCategoryView(a){var b=this;b.setupEventListeners();$.extend(true,b.options,b.baseOptions,a);b.dataSource=b.getDataSource();b.setupListView();b.read();b.loaded=true}MvcCategoryView.prototype.options={groupId:0};MvcCategoryView.prototype.baseOptions={listViewHref:"div[data-argosy-view=MvcCategoryGridView]",categoryListViewTemplateHref:"#_CategoryListViewTemplate"};MvcCategoryView.prototype.EVENT_LISTENERS_LOADED="CATEGORY_VIEW_LISTENERS_LOADED";MvcCategoryView.prototype.loaded=false;MvcCategoryView.prototype.TotalCount=0;MvcCategoryView.prototype.listView=null;MvcCategoryView.prototype.read=function(){var a=this;a.dataSource.read()};MvcCategoryView.prototype.setupEventListeners=function(){var a=this;$(document).bind(argosyEvents.PART_CATEGORY_CHANGE,function(c,d){var b=a;b.options.groupId=d.id;if(b.loaded){b.read()}else{$(document).bind(b.EVENT_TEMPLATE_LOADED,function(f){b.read()})}})};MvcCategoryView.prototype.setupListView=function(){var c=this,a=$(c.options.listViewHref),b=$(c.options.categoryListViewTemplateHref);c.listView=a.kendoListView({dataSource:c.dataSource,template:b.html(),dataBound:function(d){addArgosyActions(c.options.listViewHref)},autoBind:false,selectable:true,}).getKendoListView()};MvcCategoryView.prototype.getDataSource=function(a){var b=this;$.extend(true,b.dataSourceOpts,_defaultDataSourceConfig,a);b.dataSourceOpts.transport={read:function(d){$(document).trigger(argosyEvents.START_LOADING,{name:b.constructor.name});$.extend(true,b.options.currentSearch,kendoOptionsToObject(d),b.searchCriteria);var c={};c.ParentGroupId=b.options.groupId;$.ajax({url:"/DataView/GetPartCategoryHierachyView",dataType:"json",data:c,success:function(e){b.TotalCount=e.TotalRecords;d.success(e);$(document).trigger(argosyEvents.END_LOADING,{name:b.constructor.name});$(document).trigger(argosyEvents.PART_CATEGORY_VIEW_CHANGE)},error:function(e){d.error(e)}})}};b.dataSourceOpts.schema={data:function(c){return c.Records},total:function(c){return c.TotalRecords}};return new kendo.data.DataSource(b.dataSourceOpts)};MvcCategoryView.prototype.dataSourceOpts={pageSize:20};function MvcCompanyFilters(a){var b=this;$(document).bind(argosyEvents.COMPANY_FILTER_HIDE,function(c){$("#filtersContainer").hide();if(!$("#linksContainer").is(":visible")){$("#mainbrowse").removeClass("col-sm-10").addClass("col-sm-12")}});$(document).bind(argosyEvents.COMPANY_FILTER_SHOW,function(c){$("#filtersContainer").show();var d=$("#linksContainer");if(d.length>0&&d.is(":visible")){$(document).trigger(argosyEvents.COMPANY_LINKS_HIDE)}$("#mainbrowse").removeClass("col-sm-12").addClass("col-sm-10")})};function MvcCompanyFiltersHorizontal(a){var b=this;$(document).bind(argosyEvents.COMPANY_FILTER_HIDE,function(c){$("#filtersContainer").hide();filterPadding()});$(document).bind(argosyEvents.COMPANY_FILTER_SHOW,function(c){$("#filtersContainer").slideDown(function(){filterPadding()})})}function filterPadding(){var a=$("nav");var b=a.height();if(a.css("display")==="none"){b=0}$("#product-container").css("paddingTop",b+15+"px")};function MvcCompanyLinks(a){var b=this;$(document).bind(argosyEvents.COMPANY_LINKS_HIDE,function(c){$("#linksContainer").hide();var d=$("a[data-argosy-view=MvcProductPageLinkViewSelector]").find("i");d.removeClass("fa-caret-square-o-right").addClass("fa-caret-square-o-left");if(!$("#filtersContainer").is(":visible")){$("#mainbrowse").removeClass("col-sm-10").addClass("col-sm-12")}});$(document).bind(argosyEvents.COMPANY_LINKS_SHOW,function(c){$("#linksContainer").show();var d=$("#filtersContainer");var f=$("a[data-argosy-view=MvcProductPageLinkViewSelector]").find("i");f.removeClass("fa-caret-square-o-left").addClass("fa-caret-square-o-right");if(d.length>0&&d.is(":visible")){$(document).trigger(argosyEvents.COMPANY_FILTER_HIDE)}$("#mainbrowse").removeClass("col-sm-12").addClass("col-sm-10")})};function MvcProductCategories(a){var b=this;$.extend(true,b.options,b.baseOptions,a);$(window).on("hashchange",function(c){var f=c.originalEvent.oldURL.replace(window.location.origin+window.location.pathname,"");var d=c.originalEvent.newURL.replace(window.location.origin+window.location.pathname,"");if(b.hasHashChanged(f,d)){b.triggerChangeEvent(d)}});b.setupMenu()}MvcProductCategories.prototype.options={};MvcProductCategories.prototype.baseOptions={menuSelector:"ul[data-argosy-view=MvcProductCategoryList]",initialLoadComplete:false};MvcProductCategories.prototype.triggerChangeEvent=function(f){var j=this;var e=j.getCategoryHash(f);var g=$("span[data-argosy-categoryName='"+e.value+"']");g.parent().parent().parent().find(".k-state-active").each(function(k){$(this).removeClass("k-state-active")});g.parent().parent().addClass("k-state-active");var c=parseInt(g.data("argosyCategoryid"));var d=e.value;var b=g.data("argosyCategorydesc");var a=g.data("argosyCategorycomments");var i=g.data("argosyCategoryshowgridview");var h={};h.id=c;h.name=d;h.desc=b;h.comments=a;h.showGridView=i;$(document).trigger(argosyEvents.PART_CATEGORY_CHANGE,h)};MvcProductCategories.prototype.hasHashChanged=function(d,b){var e=this;var c=e.getCategoryHash(d);var a=e.getCategoryHash(b);return c.value.toLowerCase()!=a.value.toLowerCase()};MvcProductCategories.prototype.getCategoryHash=function(b){var f=this;var e=b.split("/");var a={type:"Category",value:""};for(var c=0;c<e.length;c++){var d=e[c];if(d.indexOf("Category")>-1||d.indexOf("category")>-1){a.value=d.split(":")[1];break}}return a};MvcProductCategories.prototype.setupMenu=function(){var a=this;if($(a.options.menuSelector).getKendoMenu()==null){$.ajax({url:"/DataView/GetPartCategoryHierachyView",dataType:"json",data:{ParentGroupId:0},success:function(c){if(c.ReturnCode==ReturnCode.Failed){handleDataSourceException(c)}else{$(a.options.menuSelector).kendoMenu({orientation:"vertical",dataSource:a.convertToMenu(c.Records),select:function(f){var g=$(f.item).find("span[data-argosy-categoryid]");var d=g.attr("data-argosy-categoryName");window.location.hash="#Category:"+d;if(window.location.pathname.toLowerCase().indexOf("store")<0){window.location="/Store#Category:"+d}}});var b=a.getCategoryHash(window.location.hash);if(b.value!=""){a.triggerChangeEvent(window.location.hash)}else{a.triggerChangeEvent("#Category:"+a.DefaultPartCategory.GroupName)}}}})}};MvcProductCategories.prototype.convertToMenu=function(a){var c=this,b=[];$(a).each(function(f){var e="",d="";if(this.Description!==this.GroupName){e=this.Description}if(f===0&&c.DefaultPartCategory==null){c.DefaultPartCategory=this}if(this.CategoryComments){d=$.trim(this.CategoryComments)}b.push({text:"<span data-argosy-categoryShowgridview='"+this.ShowGridView+"' data-argosy-categoryComments='"+d+"' data-argosy-categoryId='"+this.GroupId+"' data-argosy-categoryName='"+$.trim(this.GroupName)+"' data-argosy-categoryDesc='"+e+"'>"+this.GroupName+"</span>",encoded:false,items:((this.ChildPartCategories==null||this.ChildPartCategories.length>0)?c.convertToMenu(this.ChildPartCategories):null),})});return b};function MvcProductView(b){var c=this;$.extend(true,c.options,c.baseOptions,b);var a=new ControlLoader();a.loadControl("ModalProductUsage",{},function(d){c.productUsageControl=d});a.loadControl("ModalProductViewingRights",{},function(d){c.productViewingRightsControl=d});a.loadControl("ModalPartConfiguration",{},function(d){c.productConfigurationControl=d});c.setupEventListeners();a.loadTemplate("MvcProductView",function(d){$(document.body).append(d);$("*[data-argosy-uuid='"+c.options.uuid+"']").append($(c.options.productViewTemplateHref).html());c.dataSource=c.getDataSource();c.setupLoadingAttributes();c.setupListView();c.setupGridView();c.setupPagerView();c.setupSortDropDown();c.setupViewButtons();c.updateTitle();if(!c.options.waitForCategoryLoad&&window.location.hash.length===0){c.read()}c.loaded=true;$(function(){setTimeout(function(){$(document).trigger(c.EVENT_TEMPLATE_LOADED)},300)})})}MvcProductView.prototype.options={currentSearch:{ExcludePartIds:[]}};MvcProductView.prototype.recordCount=null;MvcProductView.prototype.baseOptions={passedSku:getQuerystring("sku",null),listViewHref:"div[data-argosy-view=MvcProductListView]",gridViewHref:"div[data-argosy-view=MvcProductGridView]",masonryViewHref:"div[data-argosy-view=MvcProductMasonryView]",categoryViewHref:"div[data-argosy-view=MvcCategoryGridView]",hotPartsViewHref:"div[data-argosy-view=MvcHotProductsView]",pagerHref:"div[data-argosy-view=MvcProductViewPager]",headerHref:"#_productContainerHeader",sortBySelector:"select[data-argosy-view=MvcProductViewSort]",sortByTextSelector:"select[data-argosy-view=MvcProductViewSortText]",showGridViewSelector:"a[data-argosy-view=MvcProductGridViewSelector]",showListViewSelector:"a[data-argosy-view=MvcProductListViewSelector]",showPageLinksSelector:"a[data-argosy-view=MvcProductPageLinkViewSelector]",showCompanyFilterSelector:"a[data-argosy-view=MvcProductCompanyLinkViewSelector]",showMasonryViewSelector:"a[data-argosy-view=MvcProductMasonryViewSelector]",titleHref:"*[data-argosy-view=MvcProductViewTitle]",commentHref:"*[data-argosy-view=MvcProductViewComments]",showDetailsHref:"*[data-argosy-view=MvcProductViewShowDetails]",productViewTemplateHref:"#_ProductViewTemplate",availabilityTemplate:"#_ProductAvailabilityTemplate",onHandTemplate:"#_ProductOnHandTemplate",keywordSearchSelector:"input.search",historyTitleElment:"[rel='historyTitleElement']",category:"",categoryComments:"",showHeader:true,showTopCategoriesOnly:false,showCategoryThumbnails:false,showGridView:true,showPricing:true,showEstShip:true,showTitle:true,showCategoryComments:true,showSort:true,showDescription:true,showCompanyLinks:true,openCompanyLinks:false,waitForCategoryLoad:false,showHotProductsLander:false,initalLoad:true,currentKeywordSearch:"",currentSearch:{Active:"Y",PartGroupId:0,Keyword:decodeURIComponent(getQuerystring("searchFor","")),Sku:"",PartName:"",Description:"",FormNo:"",Code:"",Type:"",Plant:"",Manufacturer:"",VendorSku:"",InternalPartId:"",SortOption:"rank",ShowTopCategoriesOnly:false}};MvcProductView.prototype.EVENT_TEMPLATE_LOADED=argosyEvents.MVC_VIEW_PRODUCTS_CONTROL_LOADED;MvcProductView.prototype.EVENT_LISTENERS_LOADED="PRODUCT_VIEW_LISTENERS_LOADED";MvcProductView.prototype.productDetailControl=null;MvcProductView.prototype.productUsageControl=null;MvcProductView.prototype.productViewingRightsControl=null;MvcProductView.prototype.productConfigurationControl=null;MvcProductView.prototype.landingPageHotProductsControl=null;MvcProductView.prototype.categoryViewControl=null;MvcProductView.prototype.loaded=false;MvcProductView.prototype.loadConfigFromQueryString=function(){var b=this;if(b.options.passedSku!==null){var a=b.getPartBySku(b.options.passedSku);b.options.passedSku=null;if(b.productConfigurationControl!=null&&a!==null){b.productConfigurationControl.show(a)}}};MvcProductView.prototype.updateTitle=function(){var a=this;$(a.options.titleHref).html(decodeURIComponent(a.options.category));$(a.options.commentHref).html(decodeURIComponent(a.options.categoryComments));if(!a.options.showTitle){$(a.options.titleHref).hide()}if(!a.options.showCategoryComments){$(a.options.commentHref).hide()}else{if(!a.options.showGridView){$(a.options.showGridViewSelector).trigger("click")}else{$(a.options.showListViewSelector).trigger("click")}}};MvcProductView.prototype.setupLoadingAttributes=function(){var b=this;var a=$("*[data-argosy-uuid='"+b.options.uuid+"']");appendLoadingAttribute(a,b.constructor.name);a.attr("data-argosy-loading-message","~{MsgLoadingYourProducts}~");appendLoadingAttribute($("*[data-argosy-control='MvcProductCategories']"),b.constructor.name,true)};MvcProductView.prototype.setupEventListeners=function(){var a=this;$(document).bind(argosyEvents.PART_CATEGORY_CHANGE,function(c,d){var b=a;$("#menu").data("kendoMenu").close();b.options.category=d.name;b.options.currentSearch.PartGroupId=d.id;b.options.categoryDesc=d.desc;b.options.categoryComments=d.comments;b.options.showGridView=d.showGridView;b.options.aggs=null;if(b.loaded){b.updateTitle();b.read(1)}else{$(document).bind(b.EVENT_TEMPLATE_LOADED,function(f){b.updateTitle();b.read(1)})}$.ajax({url:"/Store/Browse/GetCategoryBreadcrumbs?id="+d.id,method:"GET",success:function(e){var f=$("ol.breadcrumb");f.find(".k-category-name").remove();$(e).each(function(g){var h=g==e.length-1;var k=$("<a />",{href:this.PageName!=null?"/Store/Browse/Page/"+this.PageName:"/Store#Category:"+this.GroupId+":"+this.GroupName,html:this.GroupName});var j=$("<li />",{"class":"k-category-name",html:h?this.GroupName:""});if(!h){j.append(k)}f.append(j)})}})});$(document).bind(argosyEvents.EVENT_FILTER_AGGREGATE_SEARCH,function(f,d){var c=a;var b=[];if(d!=null&&d.button){$.each($("#filtersContainer").find("a.btn-primary"),function(g,e){e=$(e);b.push({Key:e.attr("data-group"),Value:e.attr("data-value")})})}else{$.each($("#filtersContainer").find("input[type=checkbox]:checked"),function(g,e){e=$(e);b.push({Key:e.attr("data-group"),Value:e.val()})})}c.options.aggs=b;c.read(1)});$(document).bind(argosyEvents.EVENT_TOGGLE_COMPANY_FILTERS,function(c,b){var d=$("#filtersContainer");if(d.length>0){if(d.is(":visible")){$(document).trigger(argosyEvents.COMPANY_FILTER_HIDE)}else{$(document).trigger(argosyEvents.COMPANY_FILTER_SHOW)}}});$(document).bind(argosyEvents.FULL_TEXT_SEARCH,function(c,d){var b=a;b.options.aggs=null;b.options.currentSearch=d.currentPartSearch;b.options.currentSearch.AggregationsJson=null;if(b.loaded){if(d.read){b.read(1)}}else{$(document).bind(b.EVENT_TEMPLATE_LOADED,function(f){if(d.read){b.read(1)}})}});$(document).bind(argosyEvents.SHOW_KIT_INVENTORY_DETAILS_MODAL,function(b,d){if(productDetailControl!=null){var c=a.getPart(parseInt(d));$(document).trigger(argosyEvents.START_LOADING,{name:a.constructor.name});productDetailControl.show(c,true,true)}});$(document).bind(argosyEvents.SHOW_PART_USAGE_MODAL,function(c,b){if(a.productUsageControl!=null){a.productUsageControl.show(parseInt(b.partId));$(a.options.historyTitleElment).html(b.partName+" - Part History")}});$(document).bind(argosyEvents.SHOW_VIEWING_RIGHTS_MODAL,function(c,b){if(a.productViewingRightsControl!=null){a.productViewingRightsControl.init(b)}});$(document).bind(argosyEvents.SHOW_PART_CONFIGURATION_MODAL,function(b,d){if(a.productConfigurationControl!=null){var c=a.getPart(d);a.productConfigurationControl.show(c)}});$(document).bind(argosyEvents.SHOW_PART_QUANTITY_MODAL,function(b,d){var c=a.getPart(d);showPartQuantityModal(c)});$(document).bind(argosyEvents.PART_CATEGORY_VIEW_CHANGE,function(c,b){if(a.categoryViewControl.TotalCount<=0){if(a.options.showHotProductsLander){return}if(!a.options.showGridView){$(a.options.showGridViewSelector).trigger("click")}else{$(a.options.showListViewSelector).trigger("click")}}});$(document).bind(argosyEvents.EVENT_FAVORITES_ADDED_REMOVED,function(c,b){if(a.options.allowedPartIds!=undefined&&a.options.allowedPartIds.length>0){a.options.currentSearch.allowedPartIds=jQuery.grep(a.options.currentSearch.allowedPartIds,function(e){return e!==b});a.options.currentSearch.ExcludePartIds.push(b);if(!a.options.showGridView){var f=$(a.options.listViewHref).getKendoListView();f.dataSource.read();f.refresh()}else{var d=$(a.options.gridViewHref).getKendoGrid();d.dataSource.read();d.refresh()}}});$(document).trigger(a.EVENT_LISTENERS_LOADED)};MvcProductView.prototype.getPart=function(e){var f=this,d=null;if(f.dataSource!=null){var c=f.dataSource.data().length;for(var a=0;a<c;a++){var b=f.dataSource.data()[a];if(b.PartId===e){d=b;break}}}if(d===null){d=f.landingPageHotProductsControl.getPart(e)}return d};MvcProductView.prototype.getPartBySku=function(e){var f=this,d=null;if(f.dataSource!=null){var c=f.dataSource.data().length;for(var a=0;a<c;a++){var b=f.dataSource.data()[a];if(b.Sku===e){d=b;break}}}return d};MvcProductView.prototype.setupSortDropDown=function(){var b=this;var a=$(b.options.sortBySelector);if(b.options.showSort){a.change(function(c){var d=$(c.currentTarget[c.currentTarget.selectedIndex]).attr("data-argosy-sort");b.options.currentSearch.SortOption=d;b.read()})}else{a.hide();$(b.options.sortByTextSelector).hide()}};MvcProductView.prototype.setupViewButtons=function(){var e=this;var d=$(e.options.showListViewSelector);var c=$(e.options.showGridViewSelector);var b=$(e.options.showPageLinksSelector);var a=$(e.options.showCompanyFilterSelector);if(!e.options.showCompanyLinks){b.hide()}if(!e.options.showCompanyFilters){a.hide()}d.unbind("click");c.unbind("click");b.unbind("click");d.click(function(f){e.updateView(false,true)});c.click(function(f){e.updateView(true,false)});b.click(function(f){e.displayCompanyLinks()});if(c.hasClass("selected")){e.updateView(true,false)}else{e.updateView(false,true)}if(e.options.openCompanyLinks&&e.options.showCompanyLinks){b.click()}};MvcProductView.prototype.showFavoritePartsOnly=function(){var a=this;if(a.options.allowedPartIds!=undefined&&a.options.allowedPartIds.length>0){a.options.currentSearch.allowedPartIds=$.parseJSON(a.options.allowedPartIds)}};MvcProductView.prototype.showTopCategoriesOnly=function(){var a=this;if(a.options.showTopCategoriesOnly){a.options.currentSearch.ShowTopCategoriesOnly=a.options.showTopCategoriesOnly}};MvcProductView.prototype.displayCompanyLinks=function(){var c=this;var b=$(c.options.showPageLinksSelector);var a=b.find("i").hasClass("fa-caret-square-o-left");if(a){$(document).trigger(argosyEvents.COMPANY_LINKS_SHOW)}else{$(document).trigger(argosyEvents.COMPANY_LINKS_HIDE)}};MvcProductView.prototype.updateView=function(e,g){var i=this,a=$(i.options.gridViewHref),c=$(i.options.listViewHref),h=$(i.options.showListViewSelector),f=$(i.options.showGridViewSelector),b=$(i.options.headerHref),d=$(i.options.pagerHref);if(e){a.show();f.addClass("selected")}else{a.hide();f.removeClass("selected")}if(g){c.show();h.addClass("selected")}else{c.hide();h.removeClass("selected")}if(!i.options.showHeader){b.hide()}else{b.show()}d.show()};MvcProductView.prototype.setupListView=function(){var a=this;a.listView=$(a.options.listViewHref).kendoListView({dataSource:a.dataSource,template:$("#_ProductListViewPanelTemplate").html(),dataBound:function(b){addArgosyActions(a.options.listViewHref);$(".fancybox").fancybox();if(a.recordCount!=null&&a.recordCount==0){$(a.listView.element).append(loadEmptyGridTemplate("~{NoPartsReturned}~"))}},autoBind:false,selectable:false,}).getKendoListView()};MvcProductView.prototype.setupGridView=function(){var b=this;var a={dataSource:b.dataSource,rowTemplate:kendo.template($("#_ProductGridViewTemplate").html()),columns:[{title:""},{title:"~{Product}~"},{title:"~{Ship}~",headerAttributes:{"class":"center hidden-sm hidden-xs"}},{title:"",headerAttributes:{"class":"textr"},}],sortable:true,scrollable:false,dataBound:function(d){addArgosyActions(b.options.gridViewHref);$(".fancybox").fancybox();if(b.recordCount!=null&&b.recordCount==0){var c=b.gridView.columns.length;$(b.gridView.wrapper).find("tbody").append('<tr class="kendo-data-row"><td colspan="'+c+'" class="no-data">'+loadEmptyGridTemplate("~{NoPartsReturned}~")+"</td></tr>")}$("div[data-argosy-view=MvcProductView] th:eq(3),div[data-argosy-view=MvcProductView]  tr td:nth-child(4)").addClass("hidden-sm hidden-xs");$("div[data-argosy-view=MvcProductView] th:eq(4),div[data-argosy-view=MvcProductView]  tr td:nth-child(5)").addClass("hidden-sm hidden-xs");$("div[data-argosy-view=MvcProductView] th:eq(5),div[data-argosy-view=MvcProductView]  tr td:nth-child(6)").addClass("hidden-sm hidden-xs")},autoBind:false};if(userSettings.IsInventoryInformationVisible){a.columns.splice(2,0,{title:"~{Available}~",headerAttributes:{"class":"center hidden-sm hidden-xs"}},{title:"~{OnHand}~",headerAttributes:{"class":"center hidden-sm hidden-xs"}})}b.gridView=$(b.options.gridViewHref).kendoGrid(a).getKendoGrid()};MvcProductView.prototype.setupPagerView=function(){var a=this;a.pager=$(a.options.pagerHref).kendoPager({dataSource:a.dataSource,messages:{empty:""},autoBind:false}).getKendoPager()};MvcProductView.prototype.read=function(a){var b=this;if(a!=null){b.dataSource.page(a)}else{b.dataSource.read()}b.gridView.refresh();b.listView.refresh();b.pager.refresh()};MvcProductView.prototype.getDataSource=function(a){var b=this;$.extend(true,b.dataSourceOpts,_defaultDataSourceConfig,a);b.showFavoritePartsOnly();b.showTopCategoriesOnly();b.dataSourceOpts.transport={read:function(c){$(document).trigger(argosyEvents.START_LOADING,{name:b.constructor.name});if(b.options.aggs!=null){b.options.currentSearch.AggregationsJson=JSON.stringify(b.options.aggs)}else{b.options.currentSearch.AggregationsJson=null}$.extend(true,b.options.currentSearch,kendoOptionsToObject(c),b.searchCriteria);$.ajax({url:"/api/LuceneSearch/Parts",dataType:"json",method:"POST",data:b.options.currentSearch,success:function(e){if(e.Records!=null&&e.Records.length>0){addParts(e.Records)}if(e.ReturnResponse!=null){var d=$.parseJSON(e.ReturnResponse.PostJsonData);if(b.options.currentSearch.AggregationsJson==null){b.showAggregates(d.Aggregations)}else{b.options.aggs=null}}c.success(e);b.loadConfigFromQueryString();$(document).trigger(argosyEvents.END_LOADING,{name:b.constructor.name})},error:function(d){$(document).trigger(argosyEvents.END_LOADING,{name:b.constructor.name});c.error(d)}})}};b.dataSourceOpts.requestStart=function(c){$(b.gridView.wrapper).find("tbody").empty();$(b.listView.element).empty()};b.dataSourceOpts.requestEnd=function(c){b.recordCount=c.response.TotalRecords};b.dataSourceOpts.pageSize=100;b.dataSourceOpts.schema={data:function(c){return c.Records},total:function(c){return c.TotalRecords}};return new kendo.data.DataSource(b.dataSourceOpts)};MvcProductView.prototype.showAggregates=function(a){var c=[];for(var b in a){if(a.hasOwnProperty(b)){if(a[b].Items.length>0){c.push({Name:b.replace(/_/g," "),Values:a[b].Items,Meta:a[b].Meta})}}}if($("#filtersContainer").length>0){$("#filtersContainer").html(kendo.Template.compile($("#_CompanyFiltersTemplate").html())(c));$("#filtersContainer").find("a.btn").click(function(f){var d=$(f.currentTarget);if(d.hasClass("btn-danger")){d.removeClass("btn-danger").addClass("btn-primary")}else{d.removeClass("btn-primary").addClass("btn-danger")}$(document).trigger(argosyEvents.EVENT_FILTER_AGGREGATE_SEARCH,{button:true})})}if(c.length==0){$(document).trigger(argosyEvents.COMPANY_FILTER_HIDE);$(".fa-filter").closest("a").hide()}else{$(document).trigger(argosyEvents.COMPANY_FILTER_SHOW);$(".fa-filter").closest("a").show()}};MvcProductView.prototype.dataSourceOpts={pageSize:100};function MyListsGridView(a){var b=this;$.extend(true,b.options,b.baseOptions,a);$(document).bind(argosyEvents.SEARCH_PAGE_GRID,function(d,c){b.refineSearch(c)});b.refineSearch({})}MyListsGridView.prototype.options={};MyListsGridView.prototype.baseOptions={gridViewSelector:"div[data-argosy-view=MyListsGridView]",};MyListsGridView.prototype.searchCriteria={};MyListsGridView.prototype.dataSourceOpts={};MyListsGridView.prototype.refineSearch=function(a){var b=this;b.searchCriteria=a;b.setupGrid()};MyListsGridView.prototype.setupGrid=function(){var c=this;if($(c.options.gridViewSelector).getKendoGrid()==null){var b={scrollable:false,editable:false,autoBind:true,dataSource:c.getDataSource({}),groupable:false,sortable:true,selectable:"multiple, row",pageable:{refresh:true,pageSizes:[50,100,500],buttonCount:5},columns:[{title:"~{DateCreated}~",field:"DateCreated",template:'${kendo.toString(kendo.parseDate(DateCreated),"MM/dd/yyyy")}'},{title:"~{Name}~",field:"Name"},{title:"~{Status}~",sortable:true,field:"Status"},{title:"<div class='text-center'>~{NumberOfRecords}~</div>",field:"TotalRecords",template:"<div class='bold text-center'>${TotalRecords}</div>"}],dataBound:function(d){var g=$(d.sender.element);var f=g.find(".k-button.k-button-icontext.k-grid-excel");f.unbind("click");f.click(function(e){c.showExportStateModal()})},toolbar:[{name:"excel",text:"<i class='fa la fa-file-excel-o'></i>"}],search:[{name:"Keyword",type:"text",placeholder:"~{SearchByListNameStatus}~",toolbar:true}]};$(c.options.gridViewSelector).kendoArgosyGrid(b)}else{var a=$(c.options.gridViewSelector).getKendoGrid();a.dataSource.read();a.refresh()}};MyListsGridView.prototype.getDataSource=function(a){var b=this;$.extend(true,b.dataSourceOpts,_defaultDataSourceConfig,a);b.dataSourceOpts.transport={read:function(c){var d=b.options;$.extend(true,d,kendoOptionsToObject(c),b.searchCriteria);$.ajax({url:"/DataView/GetMailLists",dataType:"json",data:d,success:function(e){if(e.ReturnCode==ReturnCode.Failed){handleDataSourceException(e)}else{c.success(e)}}})}};return new kendo.data.DataSource(b.dataSourceOpts)};MyListsGridView.prototype.dataSourceOpts={};function OrderApprovalGridView(a){var b=this;$.extend(true,b.options,b.baseOptions,a);$(document).bind(argosyEvents.SEARCH_PAGE_GRID,function(d,c){b.refineSearch(c)});b.refineSearch({})}OrderApprovalGridView.prototype.options={};OrderApprovalGridView.prototype.baseOptions={IncludeOrderTotal:true,gridViewSelector:"div[data-argosy-view=OrderApprovalGridView]",};OrderApprovalGridView.prototype.searchCriteria={IsApprovalSearch:true};OrderApprovalGridView.prototype.refineSearch=function(a){var b=this;a.IsApprovalSearch=true;b.searchCriteria=a;b.setupGrid()};OrderApprovalGridView.prototype.setupGrid=function(){var c=this;if($(c.options.gridViewSelector).getKendoGrid()==null){var b={scrollable:false,editable:false,autoBind:true,dataSource:c.getDataSource({}),groupable:false,sortable:true,selectable:"multiple, row",pageable:{refresh:true,pageSizes:[50,100,500],buttonCount:5},columns:[{title:"~{OrderNumber}~",field:"OrderNumber",template:"<a href='/Account/OrderApprovals/Edit/${OrderNumber}'>${OrderNumber}</a>"},{title:"~{OrderDate}~",template:'${kendo.toString(kendo.parseDate(OrderDate),"MM/dd/yyyy")}'},{title:"~{User}~",template:"${FirstName} ${LastName}"},{title:"~{Approver}~",template:"${OrderApprover}",hidden:userSettings.IsApprovalWorkflow},{title:"~{ShippingInformation}~",template:"<div>${Address1}</div><div>${Address2}</div><div>${Address3}</div><div>${City}, ${StateName} ${Zip}</div>"},{title:"<span class='floatr textr'>~{Total}~</span>",field:"OrderTotal",template:"<div class='grid-price'>#:kendo.toString(OrderTotal,'c')#</div>",hidden:!userSettings.IsPriceInformationVisible}],checkboxes:true,dataBinding:function(d){},dataBound:function(f){var g=$(f.sender.element);var d=g.find(".k-button.k-button-icontext.k-grid-aprove");var h=g.find(".k-button.k-button-icontext.k-grid-reject");d.unbind("click");h.unbind("click");d.click(function(e){c.showUpdatePartStateModal(c.getSelectedRecords(),"Approve")});h.click(function(e){c.showUpdatePartStateModal(c.getSelectedRecords(),"Reject")});$("div[data-argosy-view=OrderApprovalGridView] th:eq(3) ,div[data-argosy-view=OrderApprovalGridView]  tr td:nth-child(4)").addClass("hidden-xs");$("div[data-argosy-view=OrderApprovalGridView] th:eq(4) ,div[data-argosy-view=OrderApprovalGridView]  tr td:nth-child(5)").addClass(" hidden-xs")},toolbar:[{name:"reject",text:"~{Reject}~"},{name:"aprove",text:"~{Approve}~"},],search:[{name:"Keyword",type:"text",placeholder:"~{SearchByOrderNumberUser}~",toolbar:true}],};$(c.options.gridViewSelector).kendoArgosyGrid(b)}else{var a=$(c.options.gridViewSelector).getKendoGrid();a.dataSource.read();a.refresh()}};OrderApprovalGridView.prototype.showUpdatePartStateModal=function(c,a){var d=this;var b={question:"",description:"",button:"",type:"warning",yes:function(f){d.updateOrderState(c,a)}};if(a=="Approve"){b.question="~{WantToApproveOrder}~";b.description="~{ApprovedOrdersIgnored}~";b.button="~{Approve}~"}else{b.question="~{WantToDenyOrder}~";b.description="~{DeniedOrdersIgnored}~";b.button="~{Reject}~"}prompt.alert(b)};OrderApprovalGridView.prototype.updateOrderState=function(b,a){var d=this;var c={orderNumbers:b,approvalOption:a,comments:"",overrideAll:false};$.ajax({url:"/Admin/Orders/ChangeOrderStatusByNumber",type:"POST",data:JSON.stringify(c),dataType:"json",traditional:true,contentType:"application/json; charset=utf-8",success:function(f){var e=$(d.options.gridViewSelector).getKendoGrid();if(f.ReturnCode==ReturnCode.Success){$(f.Records).each(function(){prompt.notify({question:this.Value?f.Message:"Order "+this.Key+" was approved.",type:(!this.Value?"success":"error")})})}else{prompt.clientResponseError(f)}e.dataSource.read()}});$.fancybox.close()};OrderApprovalGridView.prototype.getSelectedRecords=function(){var d=this;var c=[];var a="";var b=$(d.options.gridViewSelector).getKendoGrid();$(b.select()).each(function(f){var e=b.dataItem(this);a=e.OrderNumber;c.push(a)});return c};OrderApprovalGridView.prototype.getDataSource=function(a){var b=this;$.extend(true,b.dataSourceOpts,_defaultDataSourceConfig,a);b.dataSourceOpts.transport={read:function(c){var d=b.options;$.extend(true,d,kendoOptionsToObject(c),b.searchCriteria);$.ajax({url:"/DataView/GetOrders",dataType:"json",data:d,success:function(e){if(e.ReturnCode==ReturnCode.Failed){handleDataSourceException(e)}else{c.success(e)}},error:function(f){}})}};return new kendo.data.DataSource(b.dataSourceOpts)};OrderApprovalGridView.prototype.dataSourceOpts={};function OrderApprovalsGridView(a){var b=this;$.extend(true,b.options,b.baseOptions,a);$(document).bind(argosyEvents.SEARCH_PAGE_GRID,function(d,c){b.search({})});b.search({})}OrderApprovalsGridView.prototype.options={};OrderApprovalsGridView.prototype.baseOptions={gridViewSelector:"div[data-argosy-view=OrderApprovalsGridView]"};OrderApprovalsGridView.prototype.search=function(){var c=this;if($(c.options.gridViewSelector).getKendoGrid()==null){var b={scrollable:false,editable:false,autoBind:true,dataSource:c.getDataSource({}),groupable:false,sortable:false,selectable:false,exportToExcel:false,columns:[{title:"~{Name}~",template:"${FirstName} ${LastName}"},{title:"~{ApprovalDate}~",template:'${kendo.toString(kendo.parseDate(ApprovalDate),"MM/dd/yyyy")}'},{title:"~{Status}~",template:"#if (Approved==true) {#Approved#} else {#Denied#}#"}],detailTemplate:kendo.template($("#template").html()),detailInit:function(g){var d=new kendo.data.DataSource({data:[{title:"~{Comments}~",content:g.data.ApprovalComments}]});var f=g.detailRow;f.find(".approvals").kendoTabStrip({scrollable:false,sortable:true,pageable:true,dataTextField:"title",dataContentField:"content",dataSource:d}).data("kendoTabStrip").select(0)}};$(c.options.gridViewSelector).kendoArgosyGrid(b)}else{var a=$(c.options.gridViewSelector).getKendoGrid();a.dataSource.read();a.refresh()}};OrderApprovalsGridView.prototype.getDataSource=function(a){var b=this;$.extend(true,b.dataSourceOpts,_defaultDataSourceConfig,a);b.dataSourceOpts.transport={read:function(c){var d=b.options;$.extend(true,d,kendoOptionsToObject(c),b.searchCriteria);$.ajax({url:"/DataView/GetOrderApprovals",dataType:"json",data:d,success:function(e){if(e.ReturnCode==ReturnCode.Failed){handleDataSourceException(e)}else{c.success(e)}}})}};return new kendo.data.DataSource(b.dataSourceOpts)};OrderApprovalsGridView.prototype.dataSourceOpts={};OrderApprovalsGridView.prototype.getStatus=function(){};function OrderCustomFieldsGridView(a){var b=this;$.extend(true,b.options,b.baseOptions,a);b.setupGrid({})}OrderCustomFieldsGridView.prototype.options={};OrderCustomFieldsGridView.prototype.baseOptions={gridViewSelector:"div[data-argosy-view=OrderCustomFieldsGridView]"};OrderCustomFieldsGridView.prototype.searchCriteria={};OrderCustomFieldsGridView.prototype.setupGrid=function(){var c=this;if($(c.options.gridViewSelector).getKendoGrid()==null){var b={dataSource:c.getDataSource({}),groupable:false,sortable:false,scrollable:false,pageable:false,exportToExcel:false,columns:[{title:"Field",template:"<b>${Field}</b>",width:"20%"},{title:"Value",template:"${Value}"}]};$(c.options.gridViewSelector).kendoArgosyGrid(b)}else{var a=$(c.options.gridViewSelector).getKendoGrid();a.dataSource.read();a.refresh()}};OrderCustomFieldsGridView.prototype.getDataSource=function(a){var b=this;$.extend(true,b.dataSourceOpts,_defaultDataSourceConfig,a);b.dataSourceOpts.pageSize=10;b.dataSourceOpts.transport={read:function(c){var d=b.options;$.extend(true,d,kendoOptionsToObject(c),b.searchCriteria);$.ajax({url:"/DataView/GetOrderCustomFields",dataType:"json",data:d,success:function(e){if(e.ReturnCode==ReturnCode.Failed){handleDataSourceException(e)}else{c.success(e)}}})}};return new kendo.data.DataSource(b.dataSourceOpts)};OrderCustomFieldsGridView.prototype.dataSourceOpts={};function OrderDetailPartGridView(b){var c=this;$.extend(true,c.options,c.baseOptions,b);var a=new ControlLoader();c.setupBindEvents();a.loadTemplate("OrderDetailPartGridView",function(d){$(document.body).append(d);c.search({})})}OrderDetailPartGridView.prototype.options={};OrderDetailPartGridView.prototype.setupBindEvents=function(){var a=this;$(document).bind(argosyEvents.SEARCH_PAGE_GRID,function(c,b){if($(a.options.gridViewSelector).getKendoGrid()==null){setTimeout(function(){$(document).trigger(argosyEvents.SEARCH_PAGE_GRID,b)},500)}else{a.search({})}})};OrderDetailPartGridView.prototype.baseOptions={isEditable:false,userId:null,parts:[],gridViewSelector:"div[data-argosy-view=OrderDetailPartGridView]"};OrderDetailPartGridView.prototype.orderSummary=null;OrderDetailPartGridView.prototype.search=function(){var b=this;if($(b.options.gridViewSelector).getKendoGrid()==null){var a={scrollable:false,editable:false,autoBind:true,dataSource:b.getDataSource({}),dataBound:function(c){if($(b.options.gridViewSelector).data("kendoGrid").dataSource._group.length>0){$(b.options.gridViewSelector+" .k-grouping-row").filter(function(d){return($(this).find("p")[0].textContent.trim()=="")}).hide();$(b.options.gridViewSelector+"table tbody tr.k-grouping-row").parent().hide()}else{$(b.options.gridViewSelector+"table tbody tr.k-grouping-row").parent().show()}$(b.options.gridViewSelector).find("span.toggleRow").each(function(e,d){$(d).click(function(h){var i=$(this).parents("tr");var f=$(this).attr("action");var g=$(b.options.gridViewSelector).getKendoGrid().dataItem($(this).closest("tr"));var j;if(f==="remove"){i.addClass("disabledInput");j=0}else{i.removeClass("disabledInput");j=1}$(this).parents("tr").find("input.orderQuantity").each(function(l,k){$(k).val(j)});g.OrderQty=j;$(d).siblings("span.toggleRow").removeClass("hidden");$(d).addClass("hidden");$(document).trigger(argosyEvents.EVENT_UPDATE_ORDER_CALCULATION,{orderLine:{Id:g.LineId,CompanyUserId:b.options.userId,PartId:g.PartId,BucketId:g.BucketId,Quantity:g.OrderQty,PartKitQuantity:0,PromotionId:0,UnitPrice:g.UnitPrice,ChildItems:null,CustomizationState:null,DiscountAppliedQuantity:null,DiscountId:null,Discount:g.Discount,ParentPartId:0,PriceAggregateId:42,IsEdelivery:g.IsEdelivery,IsPriceAggregate:true,IsKit:false,IsMailingList:false,IsThirdPartyList:false,IsCustomized:false,MailingListCost:0,ThirdPartListCost:0,PrePressCharge:0,DynamicSourceKey:null,ItemKey:null,Price:0}})})}),$(b.options.gridViewSelector).find("input[type=number]").kendoNumericTextBox({min:0,spinners:false,step:1,format:"n0",change:function(f){var g=$(f.sender.element),d=$(b.options.gridViewSelector).getKendoGrid().dataItem(g.closest("tr")),i=f.sender.value(),h=b.checkPartForMinMax(d.PartId,i);if(h===true){d.OrderQty=i;$(document).trigger(argosyEvents.EVENT_UPDATE_ORDER_CALCULATION,{orderLine:{Id:d.LineId,CompanyUserId:b.options.userId,PartId:d.PartId,BucketId:d.BucketId,Quantity:d.OrderQty,PartKitQuantity:0,PromotionId:0,UnitPrice:d.UnitPrice,ChildItems:null,CustomizationState:null,DiscountAppliedQuantity:null,DiscountId:null,Discount:d.Discount,ParentPartId:0,PriceAggregateId:42,IsEdelivery:d.IsEdelivery,IsPriceAggregate:true,IsKit:false,IsMailingList:false,IsThirdPartyList:false,IsCustomized:false,MailingListCost:0,ThirdPartListCost:0,PrePressCharge:0,DynamicSourceKey:null,ItemKey:null,Price:0}})}else{f.sender.value(d.OrderQty)}}});$("div[data-argosy-view=OrderDetailPartGridView] th:eq(1),div[data-argosy-view=OrderDetailPartGridView]  tr td:nth-child(2)").addClass("hidden-xs");$("div[data-argosy-view=OrderDetailPartGridView] th:eq(4),div[data-argosy-view=OrderDetailPartGridView]  tr td:nth-child(5)").addClass("hidden-sm hidden-xs");$("div[data-argosy-view=OrderDetailPartGridView] th:eq(5),div[data-argosy-view=OrderDetailPartGridView]  tr td:nth-child(6)").addClass("hidden-sm hidden-xs");$("div[data-argosy-view=OrderDetailPartGridView] th:eq(8),div[data-argosy-view=OrderDetailPartGridView]  tr td:nth-child(9)").addClass("columnStatus");$("div[data-argosy-view=OrderDetailPartGridView] th:eq(9),div[data-argosy-view=OrderDetailPartGridView]  tr td:nth-child(10)").addClass("hidden-xs")},groupable:false,sortable:false,selectable:false,exportToExcel:false,columns:[{title:"",template:"<div class='textr'>${LineNo}</div>",width:"20px"},{field:"KitName",hidden:true,groupHeaderTemplate:"#if(value != null) { # ~{KitName}~: #= value # # } else {##}  # "},{title:"~{Product}~",field:"PartName",encoded:false,template:$("#_OrderDetailPartGridViewPartNameTemplate").html()},{title:"<span class='floatr textr'>~{Qty}~</span>",template:$("#_OrderDetailPartGridViewQuantityTemplate").html()},{title:"<span class='floatr textr'>~{Shipped}~</span>",template:$("#_OrderDetailPartGridViewShippedTemplate").html()},{title:"<span class='floatr textr'>~{Avail}~</span>",template:$("#_OrderDetailPartGridViewAvailQtyTemplate").html(),hidden:!b.options.showInventory},{title:"<span class='floatr textr'>~{Subtotal}~</span>",field:"OrderSubTotal",template:$("#_OrderDetailPartGridViewSubtotalTemplate").html(),hidden:!b.options.showPricing},{title:"~{Status}~",template:"<span class='bold'>${Status}</span>"},{template:$("#_OrderDetailPartGridViewFlagsTemplate").html()}]};$(b.options.gridViewSelector).kendoArgosyGrid(a);b.refreshGrid()}else{b.refreshGrid()}};OrderDetailPartGridView.prototype.checkPartForMinMax=function(c,d){var e=this,a=_.find(e.options.parts,function(f){return f.PartId===c}),b=true;if(a!==undefined){b=checkBeforeAddingToCart(a,d,$(".test"))}else{$.ajax({url:"/Store/Part/GetPartById/"+c,type:"GET",dataType:"json",contentType:"application/json; charset=utf-8",async:false,success:function(f){e.options.parts.push(f);b=checkBeforeAddingToCart(f,d,$(".test"))}})}return b};OrderDetailPartGridView.prototype.refreshGrid=function(){var b=this;var a=$(b.options.gridViewSelector).getKendoGrid();a.dataSource.read();a.refresh()};OrderDetailPartGridView.prototype.getDataSource=function(a){var b=this;$.extend(true,b.dataSourceOpts,_defaultDataSourceConfig,a);b.dataSourceOpts.group={field:"KitName"};b.dataSourceOpts.transport={read:function(c){var d=b.options;$.extend(true,d,kendoOptionsToObject(c),b.searchCriteria);$.ajax({url:"/DataView/GetOrderItems",dataType:"json",data:d,success:function(f){if(f.ReturnCode==ReturnCode.Failed){handleDataSourceException(f)}else{var e=$(f.Records).length;$(f.Records).each(function(g,h){h.orderNumber=b.options.orderNumber;h.isAdmin=b.options.isAdmin;h.isEditable=b.options.isEditable;h.numItems=e});c.success(f)}}})}};return new kendo.data.DataSource(b.dataSourceOpts)};OrderDetailPartGridView.prototype.toggleRow=function(c,a){var d=this;var b=$(d.options.gridViewSelector).getKendoGrid().dataItem($(c.sender.element).closest("tr"))};OrderDetailPartGridView.prototype.dataSourceOpts={};OrderDetailPartGridView.prototype.getStatus=function(){};function OrderGridView(a){var b=this;$.extend(true,b.options,b.baseOptions,a);$(document).bind(argosyEvents.SEARCH_PAGE_GRID,function(d,c){b.refineSearch(c)});b.refineSearch({})}OrderGridView.prototype.options={};OrderGridView.prototype.baseOptions={gridViewSelector:"div[data-argosy-view=OrderGridView]",adminGridView:false};OrderGridView.prototype.searchCriteria={Username:null,Keyword:null,OrderTag:null,OrderNumber:null,ProofName:null,StatusId:null,OrderDateStart:null,OrderDateEnd:null,UserGroup:null,UserId:null,PartName:null,SKU:null,PurchaseOrderNumber:null,Custom01:null,Country:null,State:null,City:null,Zip:null,Phone:null,};OrderGridView.prototype.refineSearch=function(a){var b=this;$.extend(true,b.searchCriteria,a);b.setupGrid()};OrderGridView.prototype.setupGrid=function(){var c=this,a=$(c.options.gridViewSelector).getKendoGrid();if(a==null){var b={scrollable:false,editable:false,autoBind:true,dataSource:c.getDataSource({}),groupable:false,sortable:true,dataBound:function(){$("div[data-role='countries']").data("kendoCountries").value(219);$("div[data-argosy-view=OrderGridView] th:eq(3),div[data-argosy-view=OrderGridView]  tr td:nth-child(4)").addClass("hidden-sm hidden-xs");$("div[data-argosy-view=OrderGridView] th:eq(5),div[data-argosy-view=OrderGridView]  tr td:nth-child(6)").addClass("hidden-sm hidden-xs");$("div[data-argosy-view=OrderGridView] th:eq(7),div[data-argosy-view=OrderGridView]  tr td:nth-child(8)").addClass("hidden-sm hidden-xs");$("div[data-argosy-view=OrderGridView] th:eq(8),div[data-argosy-view=OrderGridView]  tr td:nth-child(9)").addClass("hidden-sm hidden-xs")},pageable:{refresh:true,pageSizes:[50,100,200],buttonCount:3},columns:[{title:"~{OrderNumber}~",field:"OrderNumber",template:"<a href='/"+(c.options.adminGridView?"Admin":"Account")+"/Orders/Edit/${OrderNumber}'>${OrderNumber}</a>"},{title:"~{Date}~",field:"OrderDate",template:'${kendo.toString(kendo.parseDate(OrderDate),"MM/dd/yyyy")}'},{title:"~{User}~",template:kendo.Template.compile($("#_OrderUserName").html())({FirstName:"${FirstName}",LastName:"${LastName}"})},{title:"~{OrderTag}~",field:"OrderTag"},{title:"~{Status}~",field:"Status",template:"<span class='bold'>#=renderOrderStatus(Status)#</span>"},{title:"~{Carrier}~",field:"CarrierName"},{title:"<span class='floatr'>Total</span>",field:"OrderTotal",template:"<div class='grid-price'>${OrderTotal > 0 ?kendo.toString(OrderTotal,'c'):kendo.toString(0,'c')}</div>",hidden:!userSettings.IsPriceInformationVisible}],search:[{name:"OrderTag",type:"text",placeholder:"~{OrderTag}~",toolbar:false},{name:"OrderNumber",type:"text",placeholder:"~{OrderNumber}~",toolbar:false},{name:"Keyword",type:"text",placeholder:"~{SearchByOrderNumberUserTagsStatus}~",toolbar:true},{name:"ProofName",type:"text",placeholder:"~{ProofName}~",toolbar:false},{name:"StatusId",type:"select",toolbar:true,data:MaskedOrderStatuses},{name:"OrderDateStart",type:"date",placeholder:"~{From}~",toolbar:false},{name:"OrderDateEnd",type:"date",placeholder:"~{To}~",toolbar:false},{name:"UserGroup",type:"argosy","data-argosy-control":"GlobalUserGroupDropDown"},{name:"UserId",type:"argosy","data-argosy-control":"GlobalUserDropDown"},{name:"PartName",type:"text",placeholder:"~{Product}~",toolbar:false},{name:"SKU",type:"text",placeholder:"~{SKU}~",toolbar:false},{name:"PurchaseOrderNumber",type:"text",placeholder:"~{PONumber}~",toolbar:false},{name:"Custom01",type:"text",placeholder:"~{Custom}~",toolbar:false},{type:"div",name:"Country","data-role":"countries"},{type:"div",name:"State","data-role":"states"},{name:"City",type:"text",placeholder:"~{City}~",toolbar:false},{name:"Zip",type:"text",placeholder:"~{ZipCode}~",toolbar:false},{name:"Phone",type:"text",placeholder:"~{Phone}~",toolbar:false},{name:"ShipTo",type:"text",placeholder:"Ship To",toolbar:false}]};$(c.options.gridViewSelector).kendoArgosyGrid(b)}else{a.dataSource.read()}};OrderGridView.prototype.getCountries=function(a){var b=this;$.extend(true,b.dataSourceOpts,_defaultDataSourceConfig,a);b.dataSourceOpts.transport={read:function(c){var d={};$.extend(true,d,kendoOptionsToObject(c),b.searchCriteria);$.ajax({url:"/DataView/GetCountries",dataType:"json",data:(d),success:function(e){if(e.ReturnCode===ReturnCode.Failed){handleDataSourceException(e)}else{e.Records.forEach(function(g){if(g.CountryCode==="US"){var f=e.Records.indexOf(g);e.Records.splice(f,1);e.Records.splice(0,1,g)}});c.success(e)}}})}};b.dataSourceOpts.pageSize=1000;return b.dataSourceOpts};OrderGridView.prototype.getDataSource=function(a){var b=this;$(document).trigger(argosyEvents.START_LOADING);$.extend(true,b.dataSourceOpts,_defaultDataSourceConfig,a);b.dataSourceOpts.transport={read:function(c){var d={ShowUserOrdersOnly:!b.options.adminGridView,IsIndex:true};$.extend(true,d,kendoOptionsToObject(c),b.searchCriteria);$.ajax({url:"/DataView/GetOrders",dataType:"json",data:d,success:function(e){$(document).trigger(argosyEvents.END_LOADING);if(e.ReturnCode===ReturnCode.Failed){handleDataSourceException(e)}else{c.success(e)}}})}};return new kendo.data.DataSource(b.dataSourceOpts)};OrderGridView.prototype.getStatus=function(){};OrderGridView.prototype.dataSourceOpts={};function OrderShippingInfoGridView(a){var b=this;$.extend(true,b.options,b.baseOptions,a);b.setupGrid({})}OrderShippingInfoGridView.prototype.options={};OrderShippingInfoGridView.prototype.baseOptions={gridViewSelector:"div[data-argosy-view=OrderShippingInfoGridView]",};OrderShippingInfoGridView.prototype.searchCriteria={};OrderShippingInfoGridView.prototype.setupGrid=function(){var c=this;if($(c.options.gridViewSelector).getKendoGrid()==null){var b={dataSource:c.getDataSource({}),groupable:false,sortable:true,scrollable:false,pageable:{refresh:false,pageSizes:false,buttonCount:1},columns:[{title:"Date",template:'${kendo.toString(kendo.parseDate(ShipDate),"MM/dd/yy")}',width:"25%"},{title:"Packlist #",field:"ShipmentId",width:"35%"},{title:"<div>Tracking # /<br/>Carrier</div>",template:"<div>#if (Url == '') {#${TrackingNumber}#} else {#<a href='${Url}'>${TrackingNumber}</a>#}#</div><div>${CarrierName}</div>",width:"40%"}],title:"Shipping Information",};$(c.options.gridViewSelector).kendoCollapseGrid(b)}else{var a=$(c.options.gridViewSelector).getKendoGrid();a.dataSource.read();a.refresh()}};OrderShippingInfoGridView.prototype.getDataSource=function(a){var b=this;$.extend(true,b.dataSourceOpts,_defaultDataSourceConfig,a);b.dataSourceOpts.pageSize=5;b.dataSourceOpts.transport={read:function(c){var d=b.options;$.extend(true,d,kendoOptionsToObject(c),b.searchCriteria);$.ajax({url:"/DataView/GetShipmentDetails",dataType:"json",data:d,success:function(e){if(e.ReturnCode==ReturnCode.Failed){handleDataSourceException(e)}else{c.success(e)}}})}};return new kendo.data.DataSource(b.dataSourceOpts)};OrderShippingInfoGridView.prototype.dataSourceOpts={};function PartCategoryGridView(a){var b=this;$.extend(true,b.options,b.baseOptions,a);$(document).bind(argosyEvents.SEARCH_PAGE_GRID,function(d,c){b.refineSearch(c)});b.refineSearch({})}PartCategoryGridView.prototype.options={};PartCategoryGridView.prototype.baseOptions={gridViewSelector:"div[data-argosy-view=PartCategoryGridView]",};PartCategoryGridView.prototype.searchCriteria={Sku:null};PartCategoryGridView.prototype.refineSearch=function(a){var b=this;b.searchCriteria=a;b.setupGrid()};PartCategoryGridView.prototype.setupGrid=function(){var c=this;if($(c.options.gridViewSelector).getKendoGrid()==null){var b={scrollable:false,editable:false,autoBind:true,dataSource:c.getDataSource({}),groupable:false,sortable:true,selectable:"multiple, row",pageable:{refresh:c.options.adminGridView?true:false,pageSizes:c.options.adminGridView?[50,100,500]:false,buttonCount:c.options.adminGridView?5:1},columns:[{title:"~{CategoryName}~",field:"GroupName",template:"<div><a href='/Admin/PartCategories/Update/${GroupId}'> ${GroupName}  </a></div>",},{title:"~{Description}~",field:"GroupDescrip"},{title:"~{Active}~",headerAttributes:{"class":"text-center",style:"text-align:center;"},template:"#if (IsActive==true) {#<span>YES</span>#} else {#<span>NO</span>#}#",attributes:{"class":"text-center bold"}}],checkboxes:true,dataBinding:function(d){},dataBound:function(g){var h=$(g.sender.element);var d=h.find(".k-button.k-button-icontext.k-grid-activate");var f=h.find(".k-button.k-button-icontext.k-grid-deactivate");d.unbind("click");f.unbind("click");d.click(function(e){c.showUpdatePartStateModal(c.getSelectedRecords(),true)});f.click(function(e){c.showUpdatePartStateModal(c.getSelectedRecords(),false)})},toolbar:[{name:"deactivate",text:"<i class='fa fa-close'></i><span class='resp-hidden'> ~{Deactivate}~</span>"},{name:"activate",text:"<i class='fa fa-check'></i><span class='resp-hidden'> ~{Activate}~</span>"}],search:[{name:"GroupName",type:"text",placeholder:"~{PartCategory}~",toolbar:false},{name:"Keyword",type:"text",placeholder:"~{SearchCategoryNameDescription}~",toolbar:true},{name:"GroupDescrip",type:"text",placeholder:"~{Description}~",toolbar:false},{name:"IsActive",type:"select",toolbar:true,data:ActiveStates}],};$(c.options.gridViewSelector).kendoArgosyGrid(b)}else{var a=$(c.options.gridViewSelector).getKendoGrid();a.dataSource.read();a.refresh()}};PartCategoryGridView.prototype.showUpdatePartStateModal=function(c,a){var d=this;var b={question:"",description:"",button:"",type:"warning",yes:function(f){if(typeof(f.preventDefault)==="function"){d.updatePartState(c,a)}}};if(a){b.question="~{WantToActivateSelection}~";b.description="~{ActivePartCategoriesIgnored}~";b.button="~{Activate}~"}else{b.question="~{WantToDeactivateSelection}~";b.description="~{InactivePartCategoriesIgnored}~";b.button="~{Deactivate}~"}prompt.alert(b)};PartCategoryGridView.prototype.updatePartState=function(c,a){var d=this;var b={partCategories:c,active:a};$.ajax({url:"/Admin/PartCategories/UpdatePartCategoryActive",type:"POST",data:JSON.stringify(b),dataType:"json",traditional:true,contentType:"application/json; charset=utf-8",success:function(f){var e=$(d.options.gridViewSelector).getKendoGrid();if(f.ReturnCode==ReturnCode.Success){$(f.Records).each(function(){prompt.notify({question:this.Key+" was  successfully "+(this.Value?"activated.":"deactivated"),type:"success"})})}else{prompt.clientResponseError(f)}e.dataSource.read()}});$.fancybox.close()};PartCategoryGridView.prototype.getSelectedRecords=function(){var c=this;var b=[];var a=$(c.options.gridViewSelector).getKendoGrid();$(a.select()).each(function(d){var e=a.dataItem(this).GroupId;b.push(e)});return b};PartCategoryGridView.prototype.getDataSource=function(a){var b=this;$.extend(true,b.dataSourceOpts,_defaultDataSourceConfig,a);if(!b.options.adminGridView){b.dataSourceOpts.pageSize=5}b.dataSourceOpts.transport={read:function(c){var d={};$.extend(true,d,kendoOptionsToObject(c),b.searchCriteria);if(b.searchCriteria.IsActive!==null){d.IsActive=b.searchCriteria.IsActive=="Y"}$.ajax({url:"/DataView/GetPartCategories",dataType:"json",data:d,success:function(e){if(e.ReturnCode==ReturnCode.Failed){handleDataSourceException(e)}else{c.success(e)}}})}};return new kendo.data.DataSource(b.dataSourceOpts)};PartCategoryGridView.prototype.dataSourceOpts={};function PartCategoryHierarchyListTreeView(a){var b=this;$.extend(true,b.options,b.baseOptions,a);b.setupMenu()}PartCategoryHierarchyListTreeView.prototype.options={};PartCategoryHierarchyListTreeView.prototype.baseOptions={menuSelector:"div[data-argosy-view=PartCategoryHierarchyListTreeView]",};PartCategoryHierarchyListTreeView.prototype.setupMenu=function(){var b=this;if($(b.options.menuSelector).getKendoTreeView()==null){var a={autoBind:true,dragAndDrop:true,dataTextField:"GroupName",dataSource:b.MenuItems(),drop:function(h){var j=$(b.options.menuSelector).getKendoTreeView();var k=j.dataItem(h.sourceNode);var l=k.GroupId;var d=j.dataItem(h.destinationNode);if(d){var f=d.GroupId;var g=h.dropPosition;var m=$(b.options.menuSelector).data("kendoTreeView").parent(j.findByText(d.text));var i=m.length;if(i==0&&g!=="over"){f=0}b.updatePartCategoryHierarchy(l,f)}}};$(b.options.menuSelector).kendoTreeView(a)}else{var c=$(b.options.menuSelector).getKendoTreeView();c.dataSource.read();c.refresh()}};PartCategoryHierarchyListTreeView.prototype.updatePartCategoryHierarchy=function(c,a){alert(c+" "+a);var d=this;var b={partCategories:c,parentGroupId:a};$.ajax({url:"/Admin/PartCategories/UpdatePartCategoryParentGroupId",type:"POST",data:JSON.stringify(b),dataType:"json",traditional:true,async:true,contentType:"application/json; charset=utf-8",success:function(e){var f=$(d.options.menuSelector).getKendoTreeView();if(e.ReturnCode==ReturnCode.Success){$(e.Records).each(function(){prompt.notify({question:this.Key+" was "+(!this.Value?"":"not")+" successfully  changed.",type:(!this.Value?"success":"error")})})}else{prompt.clientResponseError(e)}}})};PartCategoryHierarchyListTreeView.prototype.MenuItems2=function(){var b;$.ajax({type:"POST",url:"/DataView/GetPartCategoryHierarchy",contentType:"application/json; charset=utf-8",data:JSON.stringify(),dataType:"json",async:false,success:function(c){if(c.ReturnCode==ReturnCode.Failed){handleDataSourceException(c)}else{b=(c.Records)}},error:function(c){alert("Error.")}});var a=this.convertToMenu(b);return a};PartCategoryHierarchyListTreeView.prototype.MenuItems=function(){var a=new kendo.data.HierarchicalDataSource({transport:{read:{url:"/DataView/GetPartCategoryHierarchyLazyLoad",dataType:"json"}},schema:{model:{id:"GroupId",hasChildren:"HasChildren",}}});return a};PartCategoryHierarchyListTreeView.prototype.convertToMenu=function(a){var c=this;var b=[];$(a).each(function(d){b.push({text:this.GroupName,encoded:false,GroupId:this.GroupId,items:((this.ChildPartCategories==null||this.ChildPartCategories.length>0)?c.convertToMenu(this.ChildPartCategories):null),})});return b};function PartCategoryModalGridView(a){var b=this;$.extend(true,b.options,b.baseOptions,a);$(document).bind(argosyEvents.SEARCH_PAGE_GRID,function(d,c){b.refineSearch(c)});b.refineSearch({})}PartCategoryModalGridView.prototype.options={};PartCategoryModalGridView.prototype.baseOptions={gridViewSelector:"div[data-argosy-view=PartCategoryModalGridView]",};PartCategoryModalGridView.prototype.searchCriteria={Sku:null,};PartCategoryModalGridView.prototype.refineSearch=function(a){var b=this;b.searchCriteria=a;b.setupGrid()};PartCategoryModalGridView.prototype.setupGrid=function(){var c=this;if($(c.options.gridViewSelector).getKendoGrid()==null){var b={scrollable:false,editable:false,autoBind:true,dataSource:c.getDataSource({}),groupable:false,exportToExcel:false,sortable:true,selectable:"multiple, row",pageable:{refresh:c.options.adminGridView?true:false,pageSizes:c.options.adminGridView?[50,100,500]:false,buttonCount:c.options.adminGridView?5:1},columns:[{title:"~{CategoryName}~",field:"GroupName"},{title:"~{Description}~",field:"GroupDescrip"}],checkboxes:true,search:[{name:"Keyword",type:"text",placeholder:"~{SearchCategoryNameDescription}~",toolbar:true}],};$(c.options.gridViewSelector).kendoArgosyGrid(b)}else{var a=$(c.options.gridViewSelector).getKendoGrid();a.dataSource.read();a.refresh()}};PartCategoryModalGridView.prototype.getDataSource=function(a){var b=this;$.extend(true,b.dataSourceOpts,_defaultDataSourceConfig,a);b.dataSourceOpts.pageSize=5;b.dataSourceOpts.transport={read:function(c){var d=b.options;$.extend(true,d,kendoOptionsToObject(c),b.searchCriteria);$.ajax({url:"/DataView/GetUserAvailablePartCategories",dataType:"json",data:d,success:function(e){if(e.ReturnCode==ReturnCode.Failed){handleDataSourceException(e)}else{c.success(e)}}})}};return new kendo.data.DataSource(b.dataSourceOpts)};PartCategoryModalGridView.prototype.dataSourceOpts={};function PartCategoryPartsGridView(a){var b=this;$.extend(true,b.options,b.baseOptions,a);$(document).bind(argosyEvents.SEARCH_PAGE_GRID,function(d,c){b.refineSearch(c)});b.refineSearch({})}PartCategoryPartsGridView.prototype.options={};PartCategoryPartsGridView.prototype.baseOptions={gridViewSelector:"div[data-argosy-view=PartCategoryPartsGridView]",};PartCategoryPartsGridView.prototype.searchCriteria={};PartCategoryPartsGridView.prototype.refineSearch=function(a){var b=this;b.searchCriteria=a;b.setupGrid()};PartCategoryPartsGridView.prototype.setupGrid=function(){var c=this;if($(c.options.gridViewSelector).getKendoGrid()==null){var b={dataSource:c.getDataSource({}),groupable:false,editable:false,autobind:true,sortable:true,scrollable:false,pageable:{refresh:true,pageSizes:false,buttonCount:1},columns:[{template:"<i class='fa la fa-times'></i>",width:"10%"},{title:"~{Name}~",field:"PartName",template:"<div> #if (PartName != null && PartName.trim().length > 0) {#   #= PartName # #}else{# #= Sku # #}# </div>",},{title:"~{Description}~",field:"PartDescription"}],title:"~{Products}~",toolbar:[{name:"addedit",text:" ~{Add}~","class":"fa fa-plus"}],dataBinding:function(d){},dataBound:function(f){var h=$(f.sender.element);var d=h.find(".k-button.k-button-icontext.k-grid-addedit");var g=h.getKendoGrid();d.unbind("click");d.click(function(e){showAddPartsModal()});h.find("tbody tr[role=row]").each(function(){var e=g.dataItem(this);var i=$(this).find(".fa.la.fa-times").parent();i.unbind("click");i.click(function(){c.showDeletePartModal(e)})})}};$(c.options.gridViewSelector).kendoArgosyGrid(b)}else{var a=$(c.options.gridViewSelector).getKendoGrid();a.dataSource.read();a.refresh()}};PartCategoryPartsGridView.prototype.showDeletePartModal=function(a){var c=this;var b={question:"",description:"",button:"",type:"warning",yes:function(d){c.deletePartFromPartCategory(a)}};b.question="~{WantToRemoveSelection}~";b.description="~{CanNotRecoverParts}~";b.button="~{Remove}~";prompt.alert(b)};PartCategoryPartsGridView.prototype.deletePartFromPartCategory=function(b){var c=this;var a={partGroup:b};$.ajax({url:"/Admin/Parts/DeletePartCategoryFromPart",type:"POST",data:JSON.stringify(a),dataType:"json",traditional:true,contentType:"application/json; charset=utf-8",success:function(e){if(e.ReturnCode==ReturnCode.Success){$(e.Records).each(function(){prompt.notify({question:this.Key+" was "+(!this.Value?"":"not")+" successfully deleted.",type:(!this.Value?"success":"error")})})}else{prompt.clientResponseError(e)}var d=$(c.options.gridViewSelector).getKendoGrid();d.dataSource.read();d.refresh(true)}});$.fancybox.close()};PartCategoryPartsGridView.prototype.getDataSource=function(a){var b=this;$.extend(true,b.dataSourceOpts,_defaultDataSourceConfig,a);b.dataSourceOpts.pageSize=5;b.dataSourceOpts.transport={read:function(c){var d=b.options;$.extend(true,d,kendoOptionsToObject(c),b.searchCriteria);$.ajax({url:"/DataView/GetPartGroups",dataType:"json",data:d,success:function(e){if(e.ReturnCode==ReturnCode.Failed){handleDataSourceException(e)}else{c.success(e)}}})}};return new kendo.data.DataSource(b.dataSourceOpts)};PartCategoryPartsGridView.prototype.dataSourceOpts={};function PartGridView(a){var b=this;$.extend(true,b.options,b.baseOptions,a);$(document).bind(argosyEvents.SEARCH_PAGE_GRID,function(d,c){b.refineSearch(c)});b.refineSearch({})}PartGridView.prototype.options={};PartGridView.prototype.baseOptions={gridViewSelector:"div[data-argosy-view=PartGridView]"};PartGridView.prototype.searchCriteria={Active:null,Keyword:null,Description:null,PartName:null,Code:null,FormNo:null,Type:null,IsRetail:null};PartGridView.prototype.refineSearch=function(a){var b=this;$.extend(true,b.searchCriteria,a);b.search()};PartGridView.prototype.search=function(){var c=this,a=$(c.options.gridViewSelector).getKendoGrid();if(a==null){var b={dataSource:c.getDataSource({}),scrollable:false,editable:false,autoBind:true,groupable:false,sortable:true,selectable:"multiple, row",pageable:{refresh:true,pageSizes:[50,100,500],buttonCount:5},columns:[{title:"~{SKU}~",field:"Sku",template:"<div><a href='/Admin/Parts/Edit/${PartId}'>#= Sku #</a></div>",width:"20%"},{title:"~{Product}~",field:"PartName",template:"<div> #if (PartName != null && PartName.trim().length > 0) {#   #= PartName # #}else{# #= Sku # #}#     </div>",width:"20%"},{title:"~{Description}~",template:"#=Description#"},{title:"~{ItemType}~",field:"Type",width:"10%"},{title:"~{Active}~",field:"Active",headerAttributes:{"class":"text-center"},template:"#if (Active==true) {#<span>YES</span>#} else {#<span>NO</span>#}#",attributes:{"class":"text-center bold"}}],checkboxes:true,dataBound:function(d){var f=$(d.sender.element);f.find(".k-button.k-button-icontext.k-grid-activate").unbind("click").click(function(){c.showUpdatePartStateModal(c.getSelectedRecords(),true)});f.find(".k-button.k-button-icontext.k-grid-deactivate").unbind("click").click(function(){c.showUpdatePartStateModal(c.getSelectedRecords(),false)});$("div[data-argosy-view=PartGridView] th:eq(3) ,div[data-argosy-view=PartGridView]  tr td:nth-child(4)").addClass("hidden-xs");$("div[data-argosy-view=PartGridView] th:eq(4),div[data-argosy-view=PartGridView]  tr td:nth-child(5)").addClass("hidden-sm hidden-xs")},toolbar:[{name:"deactivate",text:"<i class='fa fa-close'></i><span class='resp-hidden'> ~{Deactivate}~</span>"},{name:"activate",text:"<i class='fa fa-check'></i><span class='resp-hidden'> ~{Activate}~</span>"}],search:[{name:"Keyword",type:"text",placeholder:"~{SearchProductSkuDescription}~",toolbar:true},{name:"Description",type:"text",placeholder:"~{Description}~",toolbar:false},{name:"PartName",type:"text",placeholder:"~{Product}~",toolbar:false},{name:"Active",type:"select",toolbar:true,autoSubmit:true,data:ActiveStates},{name:"Code",type:"text",placeholder:"~{CommCode}~",toolbar:false},{name:"FormNo",type:"text",placeholder:"~{FormNumber}~",toolbar:false},{name:"Type",type:"text",placeholder:"~{ItemType}~",toolbar:false},{name:"IsRetail",type:"checkbox",placeholder:"~{IncludeRetailParts}~",toolbar:false}]};$(c.options.gridViewSelector).kendoArgosyGrid(b);setupPartTypeAheadSearch($(".part-type-ahead"))}else{a.dataSource.read()}};PartGridView.prototype.showUpdatePartStateModal=function(c,a){var d=this,b={question:"",description:"",button:"",type:"warning",yes:function(f){if(typeof(f.preventDefault)==="function"){d.updatePartState(c,a)}}};if(a){b.question="~{WantToActivateSelection}~";b.description="~{ActivePartsIgnored}~";b.button="~{Activate}~"}else{b.question="~{WantToDeactivateSelection}~";b.description="~{InactivePartsIgnored}~";b.button="~{Deactivate}~"}prompt.alert(b)};PartGridView.prototype.updatePartState=function(c,a){var d=this,b={parts:c,activate:a};$(document).trigger(argosyEvents.START_LOADING);$.ajax({url:"/Admin/Parts/UpdatePartStatus",type:"POST",data:JSON.stringify(b),dataType:"json",traditional:true,contentType:"application/json; charset=utf-8",success:function(e){$(document).trigger(argosyEvents.END_LOADING);if(e.ReturnCode===ReturnCode.Success){prompt.notify({question:"Part(s) successfully updated.",type:"success"})}else{prompt.clientResponseError(e)}$(d.options.gridViewSelector).getKendoGrid().dataSource.read()}});$.fancybox.close()};PartGridView.prototype.getSelectedRecords=function(){var c=this,b=[],a=$(c.options.gridViewSelector).getKendoGrid();$(a.select()).each(function(){b.push(a.dataItem(this))});return b};PartGridView.prototype.getDataSource=function(a){var b=this;$(document).trigger(argosyEvents.START_LOADING);$.extend(true,b.dataSourceOpts,_defaultDataSourceConfig,a);b.dataSourceOpts.transport={read:function(c){var d=b.options;$.extend(true,d,kendoOptionsToObject(c),b.searchCriteria);$.ajax({url:"/DataView/GetParts",dataType:"json",data:d,success:function(e){$(document).trigger(argosyEvents.END_LOADING);if(e.ReturnCode===ReturnCode.Failed){handleDataSourceException(e)}else{c.success(e)}}})},serverSorting:true};return new kendo.data.DataSource(b.dataSourceOpts)};PartGridView.prototype.dataSourceOpts={};function PartGroupCategoriesGrid(a){var b=this;$.extend(true,b.options,b.baseOptions,a);b.setupGrid({})}PartGroupCategoriesGrid.prototype.options={};PartGroupCategoriesGrid.prototype.baseOptions={gridViewSelector:"div[data-argosy-view=PartGroupCategoriesGrid]",};PartGroupCategoriesGrid.prototype.searchCriteria={};PartGroupCategoriesGrid.prototype.setupGrid=function(){var c=this;if($(c.options.gridViewSelector).getKendoGrid()==null){var b={dataSource:c.getDataSource({}),groupable:false,editable:false,autobind:true,sortable:true,scrollable:false,exportToExcel:false,pageable:{refresh:true,pageSizes:false,buttonCount:1},columns:[{template:"<i class='fa la fa-times'></i>",width:"10%"},{title:"~{CategoryName}~",field:"GroupName"},{title:"~{Description}~",field:"GroupDescrip"}],title:"~{PartCategories}~",toolbar:[{name:"addedit",text:" ~{Add}~","class":"fa fa-plus"}],addedit:function(d){showAddPartCategoryModal()},dataBinding:function(d){},dataBound:function(d){var g=$(d.sender.element);var f=g.getKendoGrid();g.find("tbody tr[role=row]").each(function(){var e=f.dataItem(this);var h=$(this).find(".fa.la.fa-times").parent();h.unbind("click");h.click(function(){c.showDeletePartCategoryModal(e)})})}};$(c.options.gridViewSelector).kendoCollapseGrid(b)}else{var a=$(c.options.gridViewSelector).getKendoGrid();a.dataSource.read();a.refresh()}};PartGroupCategoriesGrid.prototype.showDeletePartCategoryModal=function(a){var c=this;var b={question:"",description:"",button:"",type:"warning",yes:function(d){if(typeof(d.preventDefault)==="function"){c.deletePartCategoriesFromPart(a)}}};b.question="~{WantToRemove}~?";b.description="";b.button="~{Remove}~";prompt.alert(b)};PartGroupCategoriesGrid.prototype.deletePartCategoriesFromPart=function(b){var c=this;var a={partGroup:b};$.ajax({url:"/Admin/Parts/DeletePartCategoryFromPart",type:"POST",data:JSON.stringify(a),dataType:"json",traditional:true,contentType:"application/json; charset=utf-8",success:function(f){var d=$(c.options.gridViewSelector).find(".k-collapse-grid").getKendoGrid();if(f.ReturnCode==ReturnCode.Success){$(f.Records).each(function(){prompt.notify({question:this.Key+" was "+(!this.Value?"":"not")+" successfully deleted.",type:(!this.Value?"success":"error")})});d.dataSource.read()}else{prompt.clientResponseError(f)}d.dataSource.read();d.refresh(true);var e=$("div[data-argosy-view=CompanyCategoriesGridView]").getKendoGrid();e.dataSource.read();e.refresh(true)}});$.fancybox.close()};PartGroupCategoriesGrid.prototype.getDataSource=function(a){var b=this;$.extend(true,b.dataSourceOpts,_defaultDataSourceConfig,a);b.dataSourceOpts.pageSize=5;b.dataSourceOpts.transport={read:function(c){var d=b.options;$.extend(true,d,kendoOptionsToObject(c),b.searchCriteria);$.ajax({url:"/DataView/GetPartGroups",dataType:"json",data:d,success:function(e){if(e.ReturnCode==ReturnCode.Failed){handleDataSourceException(e)}else{c.success(e)}}})}};return new kendo.data.DataSource(b.dataSourceOpts)};PartGroupCategoriesGrid.prototype.dataSourceOpts={};function PartInclusionTagsGrid(a){var b=this;$.extend(true,b.options,b.baseOptions,a);b.options.inclusionTags=JSON.parse(b.options.inclusionTags);b.options.setInclusionTagsDataSource();b.options.partDataSource.add({PartId:b.options.partId,CompanyId:b.options.companyId,InclusionArray:b.options.inclusionTags});b.setupInclusionTagsCollapseGrid();b.setupInclusionTagsGrid()}PartInclusionTagsGrid.prototype.options={companyId:0,partId:0,inclusionTags:[],inclusionTagsDataSource:new kendo.data.DataSource(),partDataSource:new kendo.data.DataSource({transport:{update:{url:"/Admin/Parts/UpdateInclusionTags",type:"post",dataType:"json",contentType:"application/json; charset=utf-8"},parameterMap:function(a){return kendo.stringify(a)}},schema:{model:{id:"PartId"}},requestEnd:function(a){if(a.response!=null){PartInclusionTagsGrid.prototype.options.mapPartResponse(a.response)}}}),mapPartResponse:function(a){this.inclusionTags=a.Records.InclusionArray;$("#InclusionTags").val(a.Records.InclusionTags);this.setInclusionTagsDataSource();this.typeAheadDataSource.read()},setInclusionTagsDataSource:function(){var b=this,a=[];$.each(b.inclusionTagsDataSource.data(),function(c,d){a.push(d)});$.each(a,function(c,d){b.inclusionTagsDataSource.remove(d)});$.each(b.inclusionTags,function(c,d){b.inclusionTagsDataSource.add({name:d})})},typeAheadDataSource:new kendo.data.DataSource({sort:[{field:"name",dir:"asc"}],transport:{read:{url:"/DataView/GetTypeAheads",dataType:"json",contentType:"application/json; charset=utf-8",data:function(a){a.companyId=PartInclusionTagsGrid.prototype.options.companyId;a.tags=PartInclusionTagsGrid.prototype.options.inclusionTags.join(",");a.type=1;return a}}},pageSize:5,schema:{model:{id:"id",fields:{id:{type:"number"},name:{type:"string"}}},parse:function(a){$.each(a.Records,function(b,c){a.Records[b]={id:b,name:c}});return a},data:function(a){return a.Records},total:function(a){return a.TotalRecords}}})};PartInclusionTagsGrid.prototype.baseOptions={inclusionTagsCollapseGrid:"#inclusionTagsCollapseGrid",inclusionTagsGrid:"#inclusionTagsGrid"};PartInclusionTagsGrid.prototype.setupInclusionTagsCollapseGrid=function(){var a=this;$(a.options.inclusionTagsCollapseGrid).kendoCollapseGrid({scrollable:false,editable:false,dataSource:a.options.inclusionTagsDataSource,groupable:false,sortable:true,exportToExcel:false,toolbar:[{name:"showInclusionTags",text:" ~{Add}~","class":"fa fa-plus"}],labelProperty:"name",title:"~{InclusionTags}~",type:"list",remove:function(b){a.showRemovePrompt(b.data)},showInclusionTags:function(){$.fancybox({href:"#inclusionTagsGrid"})}})};PartInclusionTagsGrid.prototype.setupInclusionTagsGrid=function(){var c=this,a=$(c.options.inclusionTagsGrid).data("kendoGrid");if(a==null){var b={dataSource:c.options.typeAheadDataSource,groupable:false,editable:false,sortable:true,autoBind:true,scrollable:false,exportToExcel:false,selectable:"multiple, row",pageable:{refresh:true,pageSizes:false,buttonCount:1},columns:[{title:"Inclusion Tag",field:"name"}],title:"~{InclusionTags}~",toolbar:[{name:"addInclusionTags",text:"Add Selected Tags","class":"fa fa-plus"}],dataBound:function(f){var d=$(f.sender.element).find(".k-grid-addInclusionTags"),g=[];d.click(function(){if(f.sender.select().length>0){$.each(f.sender.select(),function(e,h){g.push(f.sender.dataItem(h).name)});PartInclusionTagsGrid.prototype.showAddPrompt(g)}})}};$(c.options.inclusionTagsGrid).kendoCustomGrid(b)}else{a.dataSource.read()}};PartInclusionTagsGrid.prototype.showAddPrompt=function(a){var c=this,b={buttonNoHidden:false,no:function(){$.fancybox.close()},type:"warning",yes:function(d){if(typeof(d.preventDefault)==="function"){c.addInclusionTags(a)}},question:"~{WantToAddTag}~ '"+a.join(", ")+"'?",description:"~{TagWillBeAdded}~",button:"~{Add}~"};prompt.alert(b)};PartInclusionTagsGrid.prototype.showRemovePrompt=function(a){var c=this,b={buttonNoHidden:false,no:function(){$.fancybox.close()},type:"warning",yes:function(d){if(typeof(d.preventDefault)==="function"){c.removeInclusionTag(a)}},question:"~{WantToRemove}~ '"+a.name+"'?",description:"~{CanNotRecoverDeletedTags}~",button:"~{Remove}~"};prompt.alert(b)};PartInclusionTagsGrid.prototype.removeInclusionTag=function(b){var a=this.options.partDataSource.data()[0].InclusionArray,c=a.indexOf(b.name);a.splice(c,1);this.options.partDataSource.sync();$.fancybox.close()};PartInclusionTagsGrid.prototype.addInclusionTags=function(b){var a=this.options.partDataSource.data()[0].InclusionArray;$.each(b,function(c,d){a.push(d)});this.options.partDataSource.sync();$.fancybox.close()};function PartKeywordGrid(a){var b=this;$.extend(true,b.options,b.baseOptions,a);b.setupGrid({})}PartKeywordGrid.prototype.options={};PartKeywordGrid.prototype.baseOptions={gridViewSelector:"div[data-argosy-view=PartKeywordGrid]",partId:null};PartKeywordGrid.prototype.setupGrid=function(){var c=this;if($(c.options.gridViewSelector).getKendoListView()==null){var b={scrollable:false,editable:false,autoBind:true,dataSource:c.getDataSource({}),groupable:false,sortable:true,exportToExcel:false,toolbar:[{name:"addKeyword",input:"text",placeholder:"~{EnterKeyword}~",text:" ~{Add}~","class":"fa fa-plus"}],labelProperty:"keyword",title:"~{ManageKeywords}~",type:"list",remove:function(d){c.showAddDeleteKeywordModal(d.data.keyword,c.options.partId,false)},addKeyword:function(d){var f=$(".k-command-input-element").val();if(f==null||f==""){prompt.notify({question:"~{InputKeywordToAdd}~",type:"error"});$(".k-command-input-element").focus();return}c.showAddDeleteKeywordModal(f,c.options.partId,true)}};$(c.options.gridViewSelector).kendoCollapseGrid(b)}else{var a=$(c.options.gridViewSelector).getKendoListView();a.dataSource.read();a.refresh()}};PartKeywordGrid.prototype.showAddDeleteKeywordModal=function(c,e,a){var f=this;var b=false;var d={question:"",description:"",button:"",type:"warning",yes:function(g){if(!b){f.addDeleteKeyword(c,e,a);b=true}},no:function(g){$.fancybox.close()}};if(!a){d.question="~{WantToRemove}~ '"+c+"'?";d.description="~{CanNotRecoverDeletedKeywords}~";d.button="~{Remove}~";d.buttonNoHidden=false}else{d.question="~{WantToAddKeyword}~ '"+c+"'?";d.description="~{KeywordWillBeAdded}~";d.button="~{Add}~";d.buttonNoHidden=false}prompt.alert(d)};PartKeywordGrid.prototype.addDeleteKeyword=function(b,d,a){var e=this;var c={keyword:b,partId:d,addKeyword:a};$.ajax({url:"/Admin/Parts/DeletePartKeyword",type:"POST",data:JSON.stringify(c),dataType:"json",traditional:true,contentType:"application/json; charset=utf-8",success:function(j){if(j.ReturnCode==ReturnCode.Success){$(j.Records).each(function(){prompt.notify({question:this.Key+" was "+(!this.Value?"":"not")+" successfully "+(a?"Added":"Deleted")+".",type:(!this.Value?"success":"error")})});var h="",f=$("div[data-argosy-control='PartKeywordGrid']").data("kendoCollapseGrid"),i=f.getKendoListView(),g;if(a){i.dataSource.add({keyword:j.Records[0].Key})}else{$(i.dataItems()).each(function(l,k){if(k.keyword===j.Records[0].Key){g=k}});i.dataSource.remove(g)}$.each(i.dataItems(),function(l,k){h+=","+k.keyword});$("#Keywords").val(h)}else{prompt.clientResponseError(j)}$(".k-command-input-element").val("")}});$.fancybox.close()};PartKeywordGrid.prototype.getDataSource=function(a){var b=this;$.extend(true,b.dataSourceOpts,_defaultDataSourceConfig,a);b.dataSourceOpts.transport={read:function(c){var d={partId:b.options.partId};$.extend(true,d,kendoOptionsToObject(c),b.searchCriteria);$.ajax({url:"/DataView/GetPartKeyword",dataType:"json",data:d,success:function(e){if(e.ReturnCode==ReturnCode.Success){c.success(e)}else{prompt.clientResponseError(e)}}})}};b.dataSourceOpts.schema={data:function(d){var c=[];$(d.Records[0].Keywords).each(function(e){c.push({keyword:this})});return c},total:function(c){return c.TotalRecords}};b.dataSourceOpts.pageSize=5;return new kendo.data.DataSource(b.dataSourceOpts)};PartKeywordGrid.prototype.dataSourceOpts={};function PartUserGroupLimitsGrid(a){var b=this;$.extend(true,b.options,b.baseOptions,a);b.setupGrid()}PartUserGroupLimitsGrid.prototype.options={};PartUserGroupLimitsGrid.prototype.baseOptions={gridViewSelector:"div[data-argosy-view=PartUserGroupLimitsGrid]"};PartUserGroupLimitsGrid.prototype.setupGrid=function(){var c=this;if($(c.options.gridViewSelector).getKendoGrid()==null){var b={scrollable:false,editable:false,autoBind:true,dataSource:c.getDataSource({}),groupable:false,sortable:true,exportToExcel:false,pageable:{refresh:true,pageSizes:false,buttonCount:1},columns:[{template:"<i class='fa la fa-times'></i>",width:"10%"},{title:"~{Name}~",field:"GroupName"},{title:"<span class='floatr textr'>~{LimitQty}~</span>",template:"<div class='floatr textr'>#:kendo.toString(LimitQuantity,'n0')#</div>"},{title:"~{AllowApproval}~",template:"#if (GotoApprovalIfOverLimit===true) {#<span>YES</span>#} else {#<span>NO</span>#}#",width:"20%"},{title:"~{TimeFrame}~",field:"TimeFrame",width:"20%"},{title:"~{Enabled}~",template:"#if (Active==true) {#<span>YES</span>#} else {#<span>NO</span>#}#",width:"20%"}],dataBound:function(d){var g=$(d.sender.element);var f=g.getKendoGrid();g.find("tbody tr[role=row]").each(function(){var e=f.dataItem(this);var h=$(this).find(".fa.la.fa-times").parent();h.unbind("click");h.click(function(){c.showDeletePartUserGroupLimitModal(e)})})},toolbar:[{name:"addUserGroupPart",text:" ~{AddEdit}~","class":"fa fa-plus"}],addUserGroupPart:function(d){showAddUserGroupLimitModal()},title:"~{UserGroupProductLimits}~",};$(c.options.gridViewSelector).kendoCollapseGrid(b)}else{var a=$(c.options.gridViewSelector).getKendoGrid();a.dataSource.read();a.refresh()}};PartUserGroupLimitsGrid.prototype.showDeletePartUserGroupLimitModal=function(a){var c=this;var b={question:"",description:"",button:"",type:"warning",yes:function(d){c.deletePartUserGroupLimit(a)}};b.question="~{WantToRemoveSelection}~";b.description="~{CanNotRecoverUserGroupLimit }~";b.button="~{Remove}~";prompt.alert(b)};PartUserGroupLimitsGrid.prototype.deletePartUserGroupLimit=function(b){var c=this;var a={partLimit:b};$.ajax({url:"/Admin/Parts/DeletePartUserGroupLimit",type:"POST",data:JSON.stringify(a),dataType:"json",traditional:true,contentType:"application/json; charset=utf-8",success:function(e){if(e.ReturnCode==ReturnCode.Success){$(e.Records).each(function(){prompt.notify({question:"Part Limit for User Group("+this.Key+") was "+(!this.Value?"":"not")+" successfully deleted.",type:(!this.Value?"success":"error")})})}else{prompt.clientResponseError(e)}var d=$(c.options.gridViewSelector).find(".k-collapse-grid").getKendoGrid();d.dataSource.read();d.refresh(true)}});$.fancybox.close()};PartUserGroupLimitsGrid.prototype.getDataSource=function(a){var b=this;$.extend(true,b.dataSourceOpts,_defaultDataSourceConfig,a);b.dataSourceOpts.transport={read:function(c){var d=b.options;$.extend(true,d,kendoOptionsToObject(c),b.searchCriteria);$.ajax({url:"/DataView/GetUserGroupsPartLimits",dataType:"json",data:d,success:function(e){if(e.ReturnCode==ReturnCode.Failed){handleDataSourceException(e)}else{c.success(e)}}})}};b.dataSourceOpts.pageSize=5;return new kendo.data.DataSource(b.dataSourceOpts)};PartUserGroupLimitsGrid.prototype.dataSourceOpts={};function PartUserLimitsGrid(a){var b=this;$.extend(true,b.options,b.baseOptions,a);b.setupGrid({})}PartUserLimitsGrid.prototype.options={};PartUserLimitsGrid.prototype.baseOptions={gridViewSelector:"div[data-argosy-view=PartUserLimitsGrid]"};PartUserLimitsGrid.prototype.setupGrid=function(){var c=this;if($(c.options.gridViewSelector).getKendoGrid()==null){var b={scrollable:false,editable:false,autoBind:true,dataSource:c.getDataSource({}),groupable:false,sortable:true,exportToExcel:false,pageable:{refresh:true,pageSizes:false,buttonCount:1},columns:[{template:"<i class='fa la fa-times'></i>",width:"10%"},{title:"~{Name}~",field:"FullName"},{title:"~{LimitQty}~",field:"LimitQuantity",template:"<div>#:kendo.toString(LimitQuantity,'n0')#</div>"},{title:"~{AllowApproval}~",template:"#if (GotoApprovalIfOverLimit===true) {#<span>YES</span>#} else {#<span>NO</span>#}#",width:"20%"},{title:"~{TimeFrame}~",field:"TimeFrame",width:"20%"},{title:"~{Enabled}~",template:"#if (Active==true) {#<span>YES</span>#} else {#<span>NO</span>#}#",width:"20%"}],toolbar:[{name:"addPart",text:" ~{AddEdit}~","class":"fa fa-plus"}],addPart:function(d){showAddUserLimitModal()},title:"~{UserProductLimits}~",dataBound:function(d){var g=$(d.sender.element);var f=g.getKendoGrid();g.find("tbody tr[role=row]").each(function(){var e=f.dataItem(this);var h=$(this).find(".fa.la.fa-times").parent();h.unbind("click");h.click(function(){c.showDeletePartUserLimitModal(e)})})}};$(c.options.gridViewSelector).kendoCollapseGrid(b)}else{var a=$(c.options.gridViewSelector).getKendoGrid();a.dataSource.read();a.refresh()}};PartUserLimitsGrid.prototype.showDeletePartUserLimitModal=function(a){var c=this;var b={question:"",description:"",button:"",type:"warning",yes:function(d){c.deletePartUserLimit(a)}};b.question="~{WantToRemoveSelection}~";b.description="~{CanNotRecoverUserLimit}~";b.button="Remove";prompt.alert(b)};PartUserLimitsGrid.prototype.deletePartUserLimit=function(b){var c=this;var a={partLimit:b};$.ajax({url:"/Admin/Parts/DeletePartUserLimit",type:"POST",data:JSON.stringify(a),dataType:"json",traditional:true,contentType:"application/json; charset=utf-8",success:function(e){if(e.ReturnCode==ReturnCode.Success){$(e.Records).each(function(){prompt.notify({question:"Part Limit for User("+this.Key+") was "+(!this.Value?"":"not")+" successfully deleted.",type:(!this.Value?"success":"error")})})}else{prompt.clientResponseError(e)}var d=$(c.options.gridViewSelector).find(".k-collapse-grid").getKendoGrid();d.dataSource.read();d.refresh(true)}});$.fancybox.close()};PartUserLimitsGrid.prototype.getDataSource=function(a){var b=this;$.extend(true,b.dataSourceOpts,_defaultDataSourceConfig,a);b.dataSourceOpts.transport={read:function(c){var d=b.options;$.extend(true,d,kendoOptionsToObject(c),b.searchCriteria);$.ajax({url:"/DataView/GetUsersPartLimits",dataType:"json",data:d,success:function(e){if(e.ReturnCode==ReturnCode.Failed){handleDataSourceException(e)}else{c.success(e)}}})}};b.dataSourceOpts.pageSize=5;return new kendo.data.DataSource(b.dataSourceOpts)};PartUserLimitsGrid.prototype.dataSourceOpts={};function PersonalizedProofCollectionDetails(b){var c=this;var a=new ControlLoader();$.extend(true,c.options,c.baseOptions,b);a.loadTemplate("PersonalizedProofCollectionDetails",function(d){$(document.body).append(d)});if(!c.options.templateLoaded){$("*[data-argosy-uuid="+c.options.uuid+"]").append($(c.options.templates.baseTemplate).html());c.options.templateLoaded=true}$(document).bind(argosyEvents.SELECT_ALL_PERSONALIZED_PROOF_COLLECTION_ITEMS,function(f,d){c.selectAll(d)}).bind(argosyEvents.REORDER_SELECTED_PERSONALIZED_PROOF_COLLECTION_ITEMS,function(){c.reorderSelectedOrderPartGroupItems()}).bind(argosyEvents.SHOW_PERSONALIZED_PROOF_COLLECTION_DETAILS,function(d,f){c.show(f)})}PersonalizedProofCollectionDetails.prototype.options={viewModel:null};PersonalizedProofCollectionDetails.prototype.baseOptions={templateLoaded:false,templates:{baseTemplate:"#_PersonalizedProofCollectionDetailsModal",innerTemplate:"#_PersonalizedProofCollectionDetails"}};PersonalizedProofCollectionDetails.prototype.show=function(a){var b=this;getPart(parseInt(a),function(g){var f=location.pathname.split("/"),c=f[2],e=$(b.options.templates.baseTemplate).html();if(c==="Library"){e=e.replace('data-selectable="single"','data-selectable="false"')}var d=kendo.Template.compile(e)(g);$.fancybox({content:d,beforeShow:function(){$(document).trigger(argosyEvents.START_LOADING,{name:b.constructor.name});b.options.viewModel=kendo.observable({keyword:"",dataSource:new kendo.data.DataSource({error:function(h){console.log("Error in datasource see below:");console.log(h)},schema:{data:function(h){return h.Records},total:function(h){if(h.Records===null){return 0}return h.Records.length}},transport:{read:{url:"/DataView/GetPersonalizedProofCollectionDetails",dataType:"json",type:"GET",data:function(){return{Keyword:b.options.viewModel.keyword,PartNumber:g.PartId}}}},requestEnd:function(h){setTimeout(function(){addArgosyActions($("*[data-argosy-uuid="+b.options.uuid+"]"))},250);$(document).trigger(argosyEvents.END_LOADING)}}),searchPersonalizedProofCollectionDetails:function(){$(document).trigger(argosyEvents.START_LOADING,{name:b.constructor.name});this.dataSource.read();$(document).trigger(argosyEvents.END_LOADING)},selectAll:function(i){var h=$(i.currentTarget).is(":checked");if(h){$("input:checkbox").each(function(){this.checked=true})}else{$("input:checkbox").each(function(){this.checked=false})}},reorderSelectedPersonalizedProofCollectionItems:function(){var k=this,l="/Account/Library/ReorderSelectedPersonalizedProofCollectionItems",j=false,i=[],h=k.get("dataSource");$("#personalizedProofCollectionItems input:checked").each(function(){for(var m=0;m<h._data.length;m++){if(this.id===h._data[m].uid){i.push(h._data[m].LastLine)}}});$(document).trigger(argosyEvents.START_LOADING,{name:k.constructor.name});block(null,"~{MsgReorderingProof}~");$.ajax({url:l,dataType:"json",data:JSON.stringify({lineIds:i}),type:"POST",contentType:"application/json; charset=utf-8",success:function(m){var p=m.IsError===false,n="~{Success}~",q="success";if(!p){n=m.Message;q="error"}else{window.location=m.Data}var o={message:n,type:q};j=p;$(document).trigger(argosyEvents.PROMPT_NOTIFY,o)},error:function(){var m={message:"Unable to re-order at this time.",type:"error"};$(document).trigger(argosyEvents.PROMPT_NOTIFY,m)},complete:function(){if(j){block(null,"~{MsgTransferToCart}~ ")}else{unblock()}$(document).trigger(argosyEvents.END_LOADING)}})},dataBound:function(i){var h=$("button[data-id='selectedButton']");switch(c){case"Library":h.text("~{ReorderSelected}~");break;case"Proofing":$("label[data-id='selectAllItemsLabel']").hide();$("#personalizedProofs").find("input[type='checkbox']").hide();h.text("Use Selected Proof").unbind("click").click(function(){if(i.sender.select().length>0){var k=i.sender.select(),j=i.sender.dataItem(k);$(document).trigger(argosyEvents.EVENT_UPDATE_VARIABLES_BY_LINE_ID,{orderLineId:j.LastLine})}});break}$.fancybox.update()}});kendo.bind(this.wrap,b.options.viewModel)}})})};function PersonalizedProofCollections(b){var c=this;var a=new ControlLoader();$.extend(true,c.options,c.baseOptions,b);a.loadTemplate("PersonalizedProofCollections",function(d){$(document.body).append(d);c.options.templateLoaded=true;c.init()})}PersonalizedProofCollections.prototype.init=function(){var a=this;$(document).trigger(argosyEvents.START_LOADING);var b=kendo.observable({keyword:"",dataSource:new kendo.data.DataSource({error:function(c){console.log("Error in datasource see below:");console.log(c)},schema:{data:function(c){return c.Records},total:function(c){if(c.Records===null){return 0}return c.Records.length}},transport:{read:{url:"/DataView/GetPersonalizedProofCollections",dataType:"json",type:"GET",data:function(){return{Keyword:b.keyword}}}},requestEnd:function(){setTimeout(function(){addArgosyActions(a.getElement())},250);$(document).trigger(argosyEvents.END_LOADING)}}),searchPersonalizedProofCollections:function(){this.dataSource.read()}});a.getElement().append($(a.options.templates.baseTemplate).html());kendo.bind(a.getElement(),b)};PersonalizedProofCollections.prototype.getElement=function(){var a=this;return $("*[data-argosy-uuid="+a.options.uuid+"]")};PersonalizedProofCollections.prototype.options={};PersonalizedProofCollections.prototype.baseOptions={templateLoaded:false,templates:{baseTemplate:"#_PersonalizedProofCollectionsTemplate",innerTemplate:"#_PersonalizedProofCollections"}};function PricingManager(){}PricingManager.prototype.getPartPricing=function(b,c,a){$.ajax({url:"/DataView/GetPartPricing",dataType:"json",method:"POST",data:{partId:b,quantity:c},success:function(d){if(a!=null){a(d)}},error:function(d){if(a!=null){a(null)}}})};PricingManager.prototype.getPartPricingWithPart=function(c,d,a){var b={};b.part=c;b.quantity=d;$.ajax({url:"/DataView/GetPartPricingWithPart",dataType:"json",method:"POST",async:true,processData:false,contentType:"application/json; charset=utf-8",data:JSON.stringify(b),success:function(e){if(a!=null){a(e)}},error:function(e){if(a!=null){a(null)}}})};PricingManager.prototype.GetDynamicKitPricing=function(b,a){var c={};c.part=b.Part;c.quantity=b.Quantity;var d=[];$(b.ChildCartLines).each(function(){var e=this;d.push({Key:e.PartId,Value:e.Quantity})});c.kitParts=d;$.ajax({url:"/DataView/GetDynamicKitPricing",dataType:"json",method:"POST",async:true,processData:false,contentType:"application/json; charset=utf-8",data:JSON.stringify(c),success:function(e){if(a!=null){a(e)}},error:function(e){if(a!=null){a(null)}}})};PricingManager.prototype.getKitPricing=function(c,e,a){var d=[];var b={kitId:c.Kit.PartId,quantity:e};$(c.KitParts).each(function(f){if(!this.Disabled){d.push({partId:this.ChildPartId,quantity:this.Quantity})}});b.kitParts=JSON.stringify(d);$.ajax({url:"/DataView/GetKitPricing",dataType:"json",method:"POST",data:b,success:function(f){if(a!=null){a(f)}},error:function(f){if(a!=null){a(null)}}})};function ProductGridView(b){var c=this;$(c).one(c.EVENT_TEMPLATE_LOADED,function(d){$.extend(true,c.options,c.baseOptions,b);c.dataSource=c.getDataSource();$(c.options.listHref).kendoListView({dataSource:c.dataSource,template:c.TEMPLATE.find("#GridItem").html(),dataBound:function(f){addArgosyActions(c.options.listHref)}});$(c.options.pagerHref).kendoPager({dataSource:c.dataSource,});$(c.options.titleHref).html(c.options.category)});var a=new ControlLoader();a.loadTemplate("ProductGridView",function(d){c.TEMPLATE=$(d);$(c).trigger(c.EVENT_TEMPLATE_LOADED)})}ProductGridView.prototype.EVENT_TEMPLATE_LOADED="PRODUCT_GRID_VIEW_LOADED";ProductGridView.prototype.options={};ProductGridView.prototype.TEMPLATE="";ProductGridView.prototype.baseOptions={listHref:"tr[data-argosy-view=ProductGridView]",pagerHref:"div[data-argosy-view=ProductGridViewPager]",titleHref:"h2[data-argosy-view=ProductGridViewTitle]",category:"unknown",showPricing:true,showEstShop:true};ProductGridView.prototype.getDataSource=function(){var a=this;return new kendo.data.DataSource({type:"odata",serverFiltering:true,serverPaging:true,serverSorting:true,pageSize:20,transport:{read:{url:"/Services/ViewServices.svc/ViewBrowseProducts"},},})};ProductGridView.prototype.getRandomPrice=function(){return Math.round((Math.random()*100)*(Math.random()))};$(document).ready(function(){$(".fancybox").fancybox()});function ProductListView(b){var c=this;$(c).one(c.EVENT_TEMPLATE_LOADED,function(d){$.extend(true,c.options,c.baseOptions,b);c.dataSource=c.getDataSource();$(c.options.listHref).kendoListView({dataSource:c.dataSource,template:c.TEMPLATE.find("#listItem").html(),dataBound:function(f){addArgosyActions(c.options.listHref)}});$(c.options.pagerHref).kendoPager({dataSource:c.dataSource,});$(c.options.titleHref).html(c.options.category)});var a=new ControlLoader();a.loadTemplate("ProductListView",function(d){c.TEMPLATE=$(d);$(c).trigger(c.EVENT_TEMPLATE_LOADED)})}ProductListView.prototype.EVENT_TEMPLATE_LOADED="PRODUCT_LIST_VIEW_LOADED";ProductListView.prototype.options={};ProductListView.prototype.TEMPLATE="";ProductListView.prototype.baseOptions={listHref:"div[data-argosy-view=ProductListView]",pagerHref:"div[data-argosy-view=ProductListViewPager]",titleHref:"h2[data-argosy-view=ProductListViewTitle]",category:"unknown",showPricing:true,showEstShop:true};ProductListView.prototype.getDataSource=function(){var a=this;return new kendo.data.DataSource({type:"odata",serverFiltering:true,serverPaging:true,serverSorting:true,pageSize:20,transport:{read:{url:"/Services/ViewService.svc/ViewBrowseProducts"},},schema:{data:function(b){return b.value},total:function(b){return b["odata.count"]},}})};ProductListView.prototype.getRandomPrice=function(){return Math.round((Math.random()*100)*(Math.random()))};$(document).ready(function(){$(".fancybox").fancybox()});function ProductMasonryView(b){var c=this;$(c).one(c.EVENT_TEMPLATE_LOADED,function(d){$.extend(true,c.options,c.baseOptions,b);c.dataSource=c.getDataSource();$(c.options.listHref).kendoListView({dataSource:c.dataSource,template:c.TEMPLATE.find("#masonryItem").html(),dataBound:function(f){addArgosyActions(c.options.listHref)}});$(c.options.pagerHref).kendoPager({dataSource:c.dataSource,});$(c.options.titleHref).html(c.options.category)});var a=new ControlLoader();a.loadTemplate("ProductMasonryView",function(d){c.TEMPLATE=$(d);$(c).trigger(c.EVENT_TEMPLATE_LOADED)})}ProductMasonryView.prototype.EVENT_TEMPLATE_LOADED="PRODUCT_MASONRY_VIEW_LOADED";ProductMasonryView.prototype.options={};ProductMasonryView.prototype.TEMPLATE="";ProductMasonryView.prototype.baseOptions={listHref:"div[data-argosy-view=ProductMasonryView]",pagerHref:"div[data-argosy-view=ProductMasonryViewPager]",titleHref:"h2[data-argosy-view=ProductMasonryViewTitle]",category:"unknown",showPricing:true,showEstShop:true};ProductMasonryView.prototype.getDataSource=function(){var a=this;return new kendo.data.DataSource({type:"odata",serverFiltering:true,serverPaging:true,serverSorting:true,pageSize:20,transport:{read:{url:"/Services/ViewService.svc/ViewBrowseProducts"},},schema:{data:function(b){return b.value},total:function(b){return b["odata.count"]},}})};ProductMasonryView.prototype.getRandomPrice=function(){return Math.round((Math.random()*100)*(Math.random()))};$(document).ready(function(){$(".fancybox").fancybox()});function ProductViewDataSource(a){var b=this;b.options=$.extend(true,b.options,b._defaultOptions,a);return new kendo.data.DataSource(b.options)}ProductViewDataSource.prototype._defaultOptions={transport:{read:function(a){$.ajax({url:"/DataView/GetProductView",dataType:"jsonp",success:function(b){a.success(b)},error:function(b){a.error(b)}})}},pageSize:20,page:1,serverPaging:true,serverSorting:true,serverFiltering:true,sort:[{field:"PartName",encoded:false,dir:"asc"}],filter:[],schema:{data:"Records",total:"TotalRecords",errors:"Errors",model:{fields:{PartId:{type:"number"},CompanyId:{type:"number"},SiteId:{type:"number"},PartName:{type:"string"},Description:{type:"string"},ThumbnailFile:{type:"string"},Sku:{type:"string"},FormFolder:{type:"string"},CommodityCode:{type:"string"},Manufacturer:{type:"string"},OrderUnit:{type:"string"},QuantityAvailable:{type:"number"},QuantityOnHand:{type:"number"},Pieces:{type:"number"},IsRegularKit:{type:"number"},IsDynamicKit:{type:"number"},IsBundleKit:{type:"number"},IsKit:{type:"number"},IsFeatured:{type:"string"},CanCustomize:{type:"string"},CanUpload:{type:"boolean"},CanCreateList:{type:"boolean"},CanDirectMail:{type:"boolean"},ClientCode:{type:"string"},BuyerGroup:{type:"string"},PartCategory:{type:"string"},LeadTime:{type:"string"},ItemType:{type:"string"},Plant:{type:"string"},IsNew:{type:"number"}}}}};function ProjectRevisionCommentsGridView(a){var b=this;$.extend(true,b.options,b.baseOptions,a);$(document).bind(argosyEvents.SEARCH_PAGE_GRID,function(d,c){b.refineSearch(c)});$(document).bind(argosyEvents.PROJECT_REVISION_CHANGE,function(d,c){b.options.revisionId=c;if(b.options.revisionId!=null&&b.options.revisionId!=""){b.refineSearch(c)}});b.refineSearch({})}ProjectRevisionCommentsGridView.prototype.options={};ProjectRevisionCommentsGridView.prototype.baseOptions={gridViewSelector:"table[data-argosy-view=ProjectRevisionCommentsGridView]"};ProjectRevisionCommentsGridView.prototype.refineSearch=function(a){var b=this;b.searchCriteria=a;b.setupGrid()};ProjectRevisionCommentsGridView.prototype.setupGrid=function(){var c=this;if($(c.options.gridViewSelector).getKendoGrid()==null){var b={exportToExcel:false,autoBind:true,dataSource:c.getDataSource({}),rowTemplate:kendo.template($("#rowTemplate").html()),altRowTemplate:kendo.template($("#altRowTemplate").html())};$(c.options.gridViewSelector).kendoGrid(b)}else{var a=$(c.options.gridViewSelector).getKendoGrid();a.dataSource.read();a.refresh()}};ProjectRevisionCommentsGridView.prototype.getDataSource=function(a){var b=this;$.extend(true,b.dataSourceOpts,_defaultDataSourceConfig,a);b.dataSourceOpts.transport={read:function(c){var d={RevisionId:b.options.revisionId};$.extend(true,d,kendoOptionsToObject(c),b.searchCriteria);$.ajax({url:"/DataView/GetProjectRevisionComments",dataType:"json",data:d,success:function(e){if(e.ReturnCode==ReturnCode.Failed){handleDataSourceException(e)}else{c.success(e)}}})}};b.dataSourceOpts.pageSize=10;return new kendo.data.DataSource(b.dataSourceOpts)};ProjectRevisionCommentsGridView.prototype.dataSourceOpts={};ProjectRevisionCommentsGridView.prototype.getStatus=function(){};function ProjectsGridView(a){var b=this;$.extend(true,b.options,b.baseOptions,a);$(document).bind(argosyEvents.SEARCH_PAGE_GRID,function(d,c){b.refineSearch(c)});b.refineSearch({})}ProjectsGridView.prototype.options={};ProjectsGridView.prototype.baseOptions={gridViewSelector:"div[data-argosy-view=ProjectsGridView]",};ProjectsGridView.prototype.searchCriteria={Sku:null};ProjectsGridView.prototype.refineSearch=function(a){var b=this;b.searchCriteria=a;b.search()};ProjectsGridView.prototype.search=function(){var c=this;if($(c.options.gridViewSelector).getKendoGrid()==null){var b={dataSource:c.getDataSource({}),scrollable:false,editable:false,autoBind:true,groupable:false,sortable:true,dataBound:function(f){var g=f.sender;if(g.dataSource.total()==0){var d=g.columns.length;$(f.sender.wrapper).find("tbody").append('<tr class="kendo-data-row"><td colspan="'+d+'" class="no-data">'+loadEmptyGridTemplate("There were no projects returned.")+"</td></tr>")}},pageable:{refresh:true,pageSizes:[50,100,500],buttonCount:5},columns:[{title:"Project Name",field:"ProjectName",template:"<div><a href='/Tools/Projects/Details/${ProjectId}'>   ${ProjectName}  </a></div>",},{title:"Created By",template:"${FirstName} ${LastName}"},{title:"Status",field:"StatusDesc"},{title:"Rev",field:"RevisionsCount"},{title:"Artwork Approval",headerAttributes:{"class":"text-center"},template:"#if (IsArtworkApproved==true) {#YES#} else {#NO#}#",attributes:{"class":"text-center bold"}},{title:"Pricing Approval",headerAttributes:{"class":"text-center"},template:"#if (IsPricingApproved==true) {#YES#} else {#NO#}#",attributes:{"class":"text-center bold"}}],checkboxes:false,search:[{name:"ProjectName",type:"text",placeholder:"Project Name",toolbar:true},{name:"StatusId",type:"select",placeholder:"-- Status --",toolbar:true,autoSubmit:true,data:ProjectStatuses},{name:"StartDate",type:"date",placeholder:"From",toolbar:false},{name:"EndDate",type:"date",placeholder:"To",toolbar:false}],};$(c.options.gridViewSelector).kendoArgosyGrid(b)}else{var a=$(c.options.gridViewSelector).getKendoGrid();a.dataSource.read();a.refresh()}};ProjectsGridView.prototype.getDataSource=function(a){var b=this;$.extend(true,b.dataSourceOpts,_defaultDataSourceConfig,a);b.dataSourceOpts.transport={read:function(c){var d=b.options;$.extend(true,d,kendoOptionsToObject(c),b.searchCriteria);$.ajax({url:"/DataView/GetProjects",dataType:"json",data:d,success:function(e){if(e.ReturnCode==ReturnCode.Failed){handleDataSourceException(e)}else{c.success(e)}}})}};return new kendo.data.DataSource(b.dataSourceOpts)};ProjectsGridView.prototype.dataSourceOpts={};function Proofing(b){var c=this;$.extend(true,c.options,c.baseOptions,b);var a=new ControlLoader();c.setupEventListeners();a.loadTemplate("Proofing",function(d){$(document.body).append(d);c.initialize(c.getDataSource());$(document).trigger(c.EVENT_TEMPLATE_LOADED)})}Proofing.prototype.options={};Proofing.prototype.baseOptions={dataSource:null,isPreview:false,proofingView:"div[data-argosy-control=proofing]",proofingModalWrapper:"div[data-argosy-view=ProofingModalWrapper]",proofingCurrentPagePreviewImage:"img[data-argosy-view=ProofingCurrentPagePreviewImage]",proofingRightNavigationPanel:"div[data-argosy-view=ProofingRightNavigationPanel]",proofingMainWrapperPanel:"div[data-argosy-view=ProofingMainWrapperPanel]",proofingNavigationCurrentPage:"span[data-argosy-view=ProofingNavigationCurrentPage]",proofingNavigationWrapper:"div[data-argosy-view=ProofingNavigationWrapper]",proofingModalImageUploadWrapper:"#proofingVariableImageUploadModal",proofingImageBankListView:"#proofingImageBankListView",proofingCustomizationView:"#divPersonalize",proofingSaveProfileView:"#divSaveProfileModal",proofingTemplate:"#_ProofingTemplate",proofingQrCodeGenerationModal:"#divGenerateQrCode",proofingPreviewTemplate:"#_ProofingPreviewTemplate",proofingContinueAndDownloadOptionsPlaceHolder:"#_ProofingContinueAndDownloadOptionsPlaceHolder",proofingContinueAndDownloadOptions:"#_ProofingContinueAndDownloadOptions",proofingDownloadOptionsForPreview:"#_ProofingDownloadOptionsForPreview",proofingPageNavigationTemplate:"#_ProofingPageNavigationTemplate",proofingDownloadOptionsTemplate:"#_ProofingDownloadOptionsTemplate",proofingApproveProofTemplate:"#_ProofingApproveProofTemplate",proofingPersonalizeTemplate:"#_ProofingPersonalizeTemplate",proofingDesignTemplatesTemplate:"#_ProofingDesignTemplatesTemplate",proofingCustomizationOptionsTemplate:"#_ProofingCustomizationOptionsTemplate",proofingImageBankListViewModalTemplate:"#_ProofingImageBankListViewModalTemplate",proofingVariableImageUploadModal:"#_ProofingVariableImageUploadModal",proofingRightNavigationPanelTemplate:"#_ProofingRightNavigationPanelTemplate",proofingGenerateQRCodeTemplate:"#_ProofingGenerateQRCodeTemplate",proofingSaveProfileTemplate:"#_ProofingSaveProfileModal",approvalProofInitial:"#approvalProofInitial",approvalProofName:"#approvalProofName",approvalProofModalHref:"#divApproveProof",approvalProofAcceptButton:"#approvalProofAcceptButton",dynamicDataSourceForm:"#_ProofingDynamicDataSourceForm"};Proofing.prototype.taskHub=null;Proofing.prototype.dynamicDataSourceKey=null;Proofing.prototype.EVENT_TEMPLATE_LOADED="TEMPLATE_PROOFING_LOADED";Proofing.prototype.EVENT_LISTENERS_LOADED="PROOFING_LISTENERS_LOADED";Proofing.prototype.initialize=function(data){var that=this;that.data=data;var html=$(that.options.proofingTemplate).html();var kendoTemplate=kendo.template(html);var result=kendoTemplate(that.data);that.taskHub=new TaskHub(that.update,that.complete,that.error);that.dynamicDataSourceKey=null;that.getElement().append(result);that.renderDesignTemplate();that.renderPersonalizeTemplate();that.renderPickProfileTemplate();that.renderApproveProofTemplate();that.renderGenerateQRCodeTemplate();that.renderSaveProfileTemplate();that.configureMultiplePartsNavigation();if(that.data.LockProofName!=null&&that.data.LockProofName===true){$("#approvalProofName").prop("readonly",true).css("cursor","not-allowed")}$(".btn-buildproof").click(function(e){that.buildProof()});$(".btn-dynamic-datasource").click(function(e){that.showDynamicDataSourceForm()});$(".btn-dynamic-refresh").click(function(e){that.refreshDynamicDataSourceForm()});$(".btn-spellcheck").click(function(e){that.spellCheck()});$(".btn-saveprofile").click(function(e){$.fancybox({href:that.options.proofingSaveProfileView})});$(".btn-createProfile").click(function(e){that.createProfile()});$(".btn-cancelCreateProfile").click(function(e){$.fancybox({href:that.options.proofingCustomizationView})});var viewModel=kendo.observable({showGenerateQrCode:function(e){$.fancybox({href:that.options.proofingQrCodeGenerationModal,autoSize:true,modal:true,afterLoad:function(afterLoadEvent){kendo.bind($(that.options.proofingQrCodeGenerationModal),kendo.observable({onDropDownListDataBound:function(e){var defaultValue=e.sender.element.attr("data-value");e.sender.select(function(item){return item.name===defaultValue})},onCancelQRCode:function(onCancelQRCodeEvent){var originalInput=$(e.sender.element[0]);$("#qr_code_save").getKendoButton().enable(false);if(originalInput.attr("data-show-fancybox-after-edit")=="true"){$.fancybox({href:"#"+originalInput.attr("data-fancybox-after-edit-href")})}},onRemoveQRCode:function(onRemoveQRCodeEvent){var originalInput=$(e.sender.element[0]);$("#"+originalInput.attr("data-hidden-field-id")).val("");originalInput.text("Add QR Code");$("#qr_code_remove").getKendoButton().enable(false);$("#qr_code_save").getKendoButton().enable(false);$(that.options.proofingQrCodeGenerationModal).find("img").attr("src","/noimagefound.png?w=300&h=300");if(originalInput.attr("data-show-fancybox-after-edit")=="true"){$.fancybox({href:"#"+originalInput.attr("data-fancybox-after-edit-href")})}},onSaveQRCode:function(onSaveQRCodeEvent){var originalInput=$(e.sender.element[0]);$("#"+originalInput.attr("data-hidden-field-id")).val($(that.options.proofingQrCodeGenerationModal).find("#qr_final_url").val());originalInput.text("Edit QR Code");$("#qr_code_save").getKendoButton().enable(false);if(originalInput.attr("data-show-fancybox-after-edit")=="true"){$.fancybox({href:"#"+originalInput.attr("data-fancybox-after-edit-href")})}},onGenerateQRCode:function(onGenerateQRCodeEvent){if(that.isValidVariables(that.options.proofingQrCodeGenerationModal,"qr_","data-argosy-qrcode")){var variableObject=that.getVariables(false,that.options.proofingQrCodeGenerationModal,"qr_","data-argosy-qrcode");$(document).trigger(argosyEvents.START_LOADING,{name:"QrCode"});$.ajax({url:"/Store/Proofing/GenerateQrCode/",dataType:"json",method:"POST",data:{variables:JSON.stringify(variableObject)},success:function(result){$(document).trigger(argosyEvents.END_LOADING,{name:"QrCode"});if(result.ReturnCode==ReturnCode.Success){$(that.options.proofingQrCodeGenerationModal).find("img").attr("src",result.Records.Url+"?w=300&h=300");$(that.options.proofingQrCodeGenerationModal).find("#qr_final_url").val(result.Records.Url);$("#qr_code_remove").getKendoButton().enable(true);$("#qr_code_save").getKendoButton().enable(true)}else{prompt.alert({question:result.Message,description:"Ref: "+result.Guid,type:"warning",yes:function(e){$.fancybox({href:that.options.proofingQrCodeGenerationModal,autoSize:true,scrolling:"no"})}})}}})}else{prompt.alert({question:"~{MsgMissingQrFields}~",description:"~{MsgUpdateFormContinue}~",type:"warning",yes:function(e){$.fancybox({href:that.options.proofingQrCodeGenerationModal,autoSize:true,scrolling:"no"})}})}},qrTypes:[{name:"Contact"},{name:"Email"},{name:"Phone"},{name:"Website"}],qrColors:[{name:"Black",value:"Black"},{name:"Deep Sky Blue",value:"DeepSkyBlue"},{name:"Red"},{name:"Green",value:"Green"},{name:"Red",value:"Red"},{name:"White",value:"White"}],qrBackgroundColors:[{name:"White",value:"White"},{name:"Black",value:"Black"},{name:"Deep Sky Blue",value:"DeepSkyBlue"},{name:"Green",value:"Green"},{name:"Red",value:"Red"},{name:"Transparent",value:"Transparent"}],qrStates:[{name:"AA"},{name:"AE"},{name:"AK"},{name:"AL"},{name:"AP"},{name:"AR"},{name:"AS"},{name:"AZ"},{name:"CA"},{name:"CO"},{name:"CT"},{name:"DC"},{name:"DE"},{name:"FL"},{name:"FM"},{name:"GA"},{name:"GU"},{name:"HI"},{name:"IA"},{name:"ID"},{name:"IL"},{name:"IN"},{name:"KS"},{name:"KY"},{name:"LA"},{name:"MA"},{name:"MD"},{name:"ME"},{name:"MH"},{name:"MI"},{name:"MN"},{name:"MO"},{name:"MP"},{name:"MS"},{name:"MT"},{name:"NA"},{name:"NC"},{name:"ND"},{name:"NE"},{name:"NH"},{name:"NJ"},{name:"NM"},{name:"NV"},{name:"NY"},{name:"OH"},{name:"OK"},{name:"OR"},{name:"PA"},{name:"PR"},{name:"PW"},{name:"RI"},{name:"SC"},{name:"SD"},{name:"TN"},{name:"TX"},{name:"UT"},{name:"VA"},{name:"VI"},{name:"VT"},{name:"WA"},{name:"WI"},{name:"WV"},{name:"WY"}],}))}})},onProofingPrePopChange:function(e){var selectedItem=e.sender.dataItem(e.sender.select());var variables=selectedItem.Variables;var clearValue=false;if(variables==null){variables=e.sender.dataItem(1).Variables;clearValue=true}if(variables!=null&&variables.length>0){$(variables).each(function(i){var input=$("#var_"+this.Key);input.val(clearValue?"":this.Value)})}},onProgressChange:function(e){e.sender.progressStatus.text(e.value+" of "+e.sender.options.max)},onDropDownListDataBound:function(e){var defaultValue=e.sender.element.attr("data-value");e.sender.select(function(item){return item.Value===defaultValue})},onComboBoxDataBound:function(e){},onProofingImageBankListOpen:function(e){if($(that.options.proofingImageBankListView)){$(that.options.proofingImageBankListView).remove()}var currentData=JSON.stringify($.grep(e.sender.dataSource.data(),function(item){return item.Rule!=null&&item.Option!=null}));var html=$(that.options.proofingImageBankListViewModalTemplate).html();var kendoTemplate=kendo.template(html);var result=kendoTemplate(currentData);$(that.options.proofingModalWrapper).append(result);kendo.bind($(that.options.proofingImageBankListView));var ddl=$(e.sender.element).getKendoDropDownList();var listView=$(that.options.proofingImageBankListView).find("div[data-role=listview]").getKendoListView();listView.bind("change",function(ev){var val=listView.dataItem(listView.select());if(val!=null){ddl.value(val.Rule)}});$.fancybox({href:that.options.proofingImageBankListView,afterClose:function(e){setTimeout(function(e){$.fancybox({href:that.options.proofingCustomizationView})})},afterLoad:function(e){kendo.bind($(that.options.proofingImageBankListView))}});e.preventDefault()}});$(that.data.Variables).each(function(e){viewModel["var_"+this.Id+"_DataSourceJson"]=eval(this.DataSourceJson);viewModel["var_"+this.Id+"_VariableOptionsJson"]=eval(this.VariableOptionsJson);if(this.TooltipText!=null){var tooltip=$("#tooltip_"+this.Id);tooltip.kendoTooltip({content:this.TooltipText,position:"top"})}});kendo.bind($(that.options.proofingCustomizationView),viewModel);setTimeout(function(e){if($(that.options.proofingCustomizationView).find("*[data-role='maskedtextbox']").getKendoMaskedTextBox()==null){$(that.options.proofingCustomizationView).find("*[data-role='maskedtextbox']").kendoMaskedTextBox()}$("[data-role=datepicker]").keypress(function(e){return false});$("[data-role=datepicker]").focus(function(e){$(e.target).getKendoDatePicker().open()});$("[data-role=dropdownlist][data-control-type=imagebank],[data-role=dropdownlist][data-control-type=imagebanklistview]").each(function(i,element){element=$(element);var value=element.attr("data-value"),ddl=element.getKendoDropDownList(),data=ddl.dataSource.data();ddl.select(function(dataItem){return dataItem.Rule==value})});$("[data-role=imageeditor][data-control-type=imagebankorupload]").each(function(e){var element=$(this);var variableName=element.attr("data-variable-name");var variable=$.grep(that.data.Variables,function(item){return item.Name==variableName})[0];var dataSource=eval(variable.DataSourceJson);if(dataSource==null||dataSource.length==0){dataSource=eval(variable.VariableOptionsJson)}var kendoElement=element.getKendoImageEditor();kendoElement.setImageBankImages(dataSource)});$("[data-role=progressbar]").each(function(i){var input=$("#"+$(this).attr("data-variable-control"));var kendoControl=$(this).getKendoProgressBar();input.keyup(function(e){kendoControl.value(input.val().length)})});if(that.data.DynamicDataSource!=null){that.showDynamicDataSourceForm()}else{if((that.data.GlobalProfiles!=null&&that.data.GlobalProfiles.length>0)||(that.data.Profiles!=null&&that.data.Profiles.length>0)){if(!that.data.IsEdit){that.selectProfile(0,function(e){that.buildProof(false)},false)}else{that.buildProof(false)}}else{that.buildProof(false)}}},500);addArgosyActions($(that.options.proofingModalWrapper));$(document).on(argosyEvents.KENDO_EDITOR_IMAGE_UPLOADED,function(event,data,target){if(target==undefined){target=data.target}if(data.Extension==undefined&&data.response.Extension==".pdf"){data=data.response}that.CheckValidUpload(data,target)})};Proofing.prototype.getGlobalFormsId=function(){var b=this;var a=0;$(b.data.DynamicDataSourceProfiles).each(function(c,d){a=d.GlobalFormsId});return a};Proofing.prototype.refreshDynamicDataSourceForm=function(){var a=this;if(a.dynamicDataSourceParameters!=null&&a.dynamicDataSourceViewModel!=null){a.dynamicDataSourceViewModel.getTemporaryProfileId(a.dynamicDataSourceParameters,true)}};Proofing.prototype.showDynamicDataSourceForm=function(){var that=this;var content=kendo.Template.compile($(that.options.dynamicDataSourceForm).html())(that.data.DynamicDataSource);var viewModel=kendo.observable({disableDynamicDataSourceContinue:true,onContinueDynamicDataSource:function(e){var params=this.getDynamicDataSourceParams();this.getTemporaryProfileId(params)},isDynamicDataSourceReady:function(e){var inputs=$("#divDynamicDataSourceForm").find("input:not([type=hidden])");var allFilledOut=true;$(inputs).each(function(i,input){if($(input).val().trim().length===0){allFilledOut=false}});this.set("disableDynamicDataSourceContinue",!allFilledOut)},getTemporaryProfileId:function(parameters,forceRefresh,updateInputs){var model=this;var identifier="";forceRefresh=forceRefresh==null?false:forceRefresh;updateInputs=updateInputs==null?true:updateInputs;that.dynamicDataSourceParameters=parameters;block(null,"~{MsgLoading}~");$(parameters).each(function(e,param){if(param.isIdentifier){identifier+=param.value+","}});that.dynamicDataSourceKey=identifier;$.ajax({url:"/Store/Proofing/GetTemporaryGlobalProfile/",dataType:"json",data:{globalFormId:that.getGlobalFormsId(),identifier:identifier},success:function(result){result.globalProfileId=result.globalProfileId===0?null:result.globalProfileId;if(result.globalProfileId==null||result.globalProfileId===0||result.isExpired||forceRefresh){var requestUrl=model.generateRequestUrl(parameters);that.dynamicDataSourceResponse={requestUrl:requestUrl,identifier:identifier,result:result};model.getDynamicDataSourceData(requestUrl,identifier,result.globalProfileId)}else{$(document).trigger(argosyEvents.SELECT_GLOBAL_PROFILE,{globalProfileId:result.globalProfileId,callback:function(e){$.fancybox({href:that.options.proofingCustomizationView})},updateInputs:updateInputs})}}})},onCancelDynamicDataSource:function(e){$.fancybox({href:that.options.proofingCustomizationView})},generateRequestUrl:function(parameters){var dataSource=that.data.DynamicDataSource;var url=dataSource.UrlStructure;$(parameters).each(function(i,param){var regExp=new RegExp("{"+param.name+"}");url=url.replace(regExp,param.value)});return url},getDynamicDataSourceData:function(requestUrl,identifier,globalProfileId){var model=this;$.ajax({url:"/DataView/GetRemoteJsonObject/",dataType:"json",data:{path:requestUrl},success:function(result){if(result.ReturnCode==ReturnCode.Success){if(model.isValid(result.Records)){that.createTemporaryGlobalProfile(result.Records,identifier,globalProfileId)}}else{prompt.alert({question:result.Message,description:"Ref: "+result.Guid,type:"warning",yes:function(e){$.fancybox.close()}})}unblock()}})},isValid:function(data){var dataSource=that.data.DynamicDataSource;var valid=true;if(dataSource.SuccessResponse!=null&&dataSource.SuccessJsonPath!=null){valid=this.getValue(data,dataSource.SuccessJsonPath)==dataSource.SuccessResponse;if(!valid){var message=this.getValue(data,dataSource.ErrorJsonPath);if(message==null||message===""){message="~{MsgFailedDynamicDataFetch}~"}prompt.alert({question:message,type:"warning",yes:function(e){that.showDynamicDataSourceForm()}})}}return valid},getValue:function(data,path){var arrayValue=jsonPath(data,path);var parsedValue=null;if(arrayValue.length===1){parsedValue=arrayValue[0]}return parsedValue.toString()},getDynamicDataSourceParams:function(){var items=$("*[data-argosy-dynamic]");var params=new Array();$(items).each(function(e,item){var param=$(item);params.push({name:param.attr("data-argosy-dynamic"),value:param.val().trim(),isIdentifier:eval(param.attr("data-argosy-identifier"))})});return params}});viewModel.bind("change",function(e){this.isDynamicDataSourceReady(e)});$(that.data.DynamicDataSource.Parameters).each(function(i,variable){viewModel["dynamic_"+this.Name]=variable.DefaultValue});that.dynamicDataSourceViewModel=viewModel;if(that.firstRun&&that.data!=null&&that.data.CustomizationState!=null&&that.data.CustomizationState.DynamicDataSourceJson!=null&&that.data.CustomizationState.DynamicDataSourceJson.trim().length>0){var params=JSON.parse(that.data.CustomizationState.DynamicDataSourceJson);if(params!=null&&params.length>0){that.dynamicDataSourceViewModel.getTemporaryProfileId(params,false,false);that.firstRun=false}}else{$.fancybox({content:content,modal:true,afterShow:function(e){var wrapper=$(".fancybox-inner");kendo.bind(wrapper,that.dynamicDataSourceViewModel)}})}};Proofing.prototype.firstRun=true;Proofing.prototype.changeProofingView=function(a){var b=this;b.destroy();b.proofingResult=null;b.initialize(a)};Proofing.prototype.destroy=function(){var a=this;kendo.destroy(a.getElement());a.getElement().empty()};Proofing.prototype.configureMultiplePartsNavigation=function(){var e=this;if(e.data.Parts.length>1){var a=e.getElement();var c=a.find(".goto-previous-part").closest("a");var b=a.find(".goto-next-part").closest("a");var d={question:"~{MsgApproveToContinue}~",description:"",type:"warning",yes:function(f){var g=e.options.proofingCustomizationView;if(e.proofingResult!=null){g=e.options.approvalProofModalHref}$.fancybox({href:g})}};c.click(function(f){var h=e.getCurrentPartState();if(h!=null&&h.IsApproved){var g=0;if(e.data.CurrentPartNumber===1){g=e.data.Parts.length}else{g=e.data.CurrentPartNumber-1}e.updateProofingDisplay(g)}else{prompt.alert(d)}});b.click(function(f){var h=e.getCurrentPartState();if(h!=null&&h.IsApproved){var g=0;if(e.data.CurrentPartNumber===e.data.Parts.length){g=1}else{g=e.data.CurrentPartNumber+1}e.updateProofingDisplay(g)}else{prompt.alert(d)}})}};Proofing.prototype.updateDefaultProofName=function(c){var b=this,a=b.getProofName(c);$(b.options.approvalProofModalHref).find("#approvalProofName").val(a)};Proofing.prototype.selectProfile=function(d,a,e){if(e==null){e=true}var c=$("select[data-argosy-action=select-proofing-profile]").getKendoDropDownList();var b=0;c.select(function(f){return f.value!=="-1"&&b===d});triggerProfileChangeEvent(c.value(),a,e)};Proofing.prototype.getCurrentPartState=function(){var b=this;var a=null;$(b.data.Parts).each(function(c){if(b.data.Part.Sku===this.Sku){a=this}});return a};Proofing.prototype.updateProofingDisplay=function(a){var c=this;var b=c.data.Parts[(a-1)];block(null,"~{MsgLoadingNextProduct}~");$.ajax({url:"/Store/Proofing/GetProofingViewModel/"+b.Sku+"/",dataType:"json",success:function(d){if(d.ReturnCode===ReturnCode.Success){d.Records.Parts=c.data.Parts;d.Records.CurrentPartNumber=a;c.changeProofingView(d.Records)}else{prompt.alert({question:d.Message,description:"Ref: "+d.Guid,type:"warning",yes:function(f){$.fancybox.close()}})}unblock()}})};Proofing.prototype.getElement=function(){var a=this;return $("*[data-argosy-uuid="+a.options.uuid+"]")};Proofing.prototype.renderDesignTemplate=function(){var e=this;var a=$(e.options.proofingDesignTemplatesTemplate).html();var b=kendo.template(a);var c=b(e.data);$(e.options.proofingModalWrapper).append(c);var d=$(e.options.proofingModalWrapper).find("*[data-argosy-action=select-design-template]");$(d).each(function(f){var g=$(this);var h=g.attr("data-argosy-value");if(f===0){g.closest("div").addClass("k-state-selected")}else{g.closest("div").removeClass("k-state-selected")}g.closest("a").click(function(i){if(e.data!=null){$(e.data.Variables).each(function(j){if(this.IsDesignTemplate){$("#var_"+this.Name).val(h)}});$(d).each(function(j){$(this).closest("div").removeClass("k-state-selected")});g.closest("div").addClass("k-state-selected");e.buildProof(true)}})})};Proofing.prototype.renderPersonalizeTemplate=function(){var d=this;var a=$(d.options.proofingPersonalizeTemplate).html();var b=kendo.template(a);var c=b(d.data);$(d.options.proofingModalWrapper).append(c)};Proofing.prototype.updateImageList=function(d,g,e,f){var c=$("#var_"+g);if(!c.is("input[type=hidden]")){var b=c.getKendoImageEditor();b.setImageBankImages(d,f);var a=getFileExtension(e);if(a==".pdf"||a==".eps"){b.initializeImageList(e,null);b.generatePreviewImage(e,function(h){if(getFileExtension(e)==".pdf"){h=h[0].href}b.updateSelectedFile(e,h)})}else{b.initializeImageList(e,null)}}};Proofing.prototype.createTemporaryGlobalProfile=function(b,f,e){var g=this;var a=g.data.DynamicDataSourceProfiles;var d=new Array();var c=0;e=e==null?0:e;$(a).each(function(j,n){var h=jsonPath(b,n.JsonPath);var l=null;var k=null;if(h.length===1){l=h[0]}if(l!=null&&$.isArray(l)){k=h[0];l=k[0]}var m={Value:l,GlobalFormStructId:n.GlobalFormsStructId};c=n.GlobalFormsId;if(k!=null){m.DataSource=JSON.stringify(k)}d.push(m)});g.taskHub.generateDynamicDataGlobalProfile(g.data.DynamicDataSource.Name,c,f,g.data.Part.ProofingProjectId,d,e)};Proofing.prototype.update=function(a){var b=this};Proofing.prototype.complete=function(task){var that=this;if(task.ErrorGuid!=null&&task.ErrorGuid!==""){prompt.alert({question:"~{MsgErrorProofingProfile}~",description:"Ref: "+task.ErrorGuid,type:"warning",yes:function(e){$.fancybox({href:"#divPersonalize"})}})}else{var variables=eval(task.Data.variables);$(document).trigger(argosyEvents.EVENT_TEMPORARY_GLOBAL_PROFILE_CREATED,[variables])}};Proofing.prototype.error=function(a){var b=this};Proofing.prototype.getControlType=function(b){var a=b.attr("data-control-type");if(a!=null){a=a.toLowerCase()}return a};Proofing.prototype.updateVariableValues=function(variables,isRegularProfile,updateInputs){var that=this;if(isRegularProfile==null){isRegularProfile=true}updateInputs=(updateInputs==null)?true:false;$(variables).each(function(e){var input=$("*[data-variable-id="+this.VARIABLE_ID+"]");var controlType=that.getControlType(input);if(!updateInputs){this.VALUE=that.getValue(input)}else{if(controlType=="imagelist"){if(input[0].attributes["data-original"]!==undefined){this.VALUE=input[0].attributes["data-original"].value}}}});$(variables).each(function(i){var input=null;var controlType=null;if(isRegularProfile){input=$("#var_"+this.Name);controlType=that.getControlType(input);if(controlType!=="imagelist"){setInputValue(input,this.Value)}else{if(controlType==="imagelist"){}}}else{input=$("*[data-variable-id="+this.VARIABLE_ID+"]");if(this.TYPE!=null&&this.TYPE.toLowerCase()==="dropdownlist"&&input.is("select")&&this.DATASOURCE_JSON!=null&&this.DATASOURCE_JSON.length>0){var ddl=input.getKendoDropDownList();ddl.setOptions({dataTextField:"Text",dataValueField:"Value"});ddl.setDataSource(new kendo.data.DataSource({data:eval(this.DATASOURCE_JSON)}))}controlType=that.getControlType(input);var data=null;if(controlType==="imagelist"){data=eval(this.DATASOURCE_JSON);that.updateImageList(data,input.attr("data-variable-name"),this.VALUE,this.VARIABLE_ID)}if(data==null){setInputValue(input,this.VALUE)}}});setTimeout(function(e){$.fancybox.update()},500)};Proofing.prototype.reloadProfileOptions=function(d){var e=this;var c=$("select[data-argosy-action=select-proofing-profile]").getKendoDropDownList();e.data.Profiles=d;var a=[];if(e.data.Profiles.length>0){a.push({text:"~{TxtDdlUserProfiles}~"});$(e.data.Profiles).each(function(){a.push({text:this.Name,value:this.Id})})}if(e.data.GlobalProfiles.length>0){a.push({text:"~{TxtDdlGlobalProfiles}~"});$(e.data.GlobalProfiles).each(function(){a.push({text:this.NAME,value:this.GLOBAL_FORMS_PROFILE_ID})})}var b=new kendo.data.DataSource({data:a});c.setDataSource(b);c=$("#existingProfileName").getKendoDropDownList();e.data.Profiles=d;a=[];$(d).each(function(){a.push({text:this.Name,value:this.Id})});b=new kendo.data.DataSource({data:a});c.setDataSource(b);e.enableProfiles(!(e.data.Profiles.length===0&&e.data.GlobalProfiles.length===0))};Proofing.prototype.enableProfiles=function(b){var c=this;b=b==null?true:b;if(b){$(".proofingProfiles").show()}else{$(".proofingProfiles").hide()}var a=$(".proofingProfiles").getKendoDropDownList();if(a!=null){a.ul.width(400)}};Proofing.prototype.createProfile=function(){var c=this;var d=c.getVariables(false);var b=$("#profileName").val();var a=$("#existingProfileName").val();if(b.length>0){$.ajax({url:"/Store/Proofing/CreateProfile?partId="+c.data.Part.PartId,dataType:"json",method:"POST",data:{Name:b,Variables:JSON.stringify(d)},success:function(e){if(e.ReturnCode===ReturnCode.Success){$.fancybox({href:c.options.proofingCustomizationView});c.reloadProfileOptions(e.Records)}else{prompt.alert({question:e.Message,description:"Ref: "+e.Guid,type:"warning",yes:function(f){$.fancybox({href:c.options.proofingSaveProfileView})}})}}});$("#profileName").removeClass("input-validation-error")}else{if(a>0){$.ajax({url:"/Store/Proofing/UpdateProfile?profileId="+a+"&partId="+c.data.Part.PartId,dataType:"json",method:"POST",data:{Name:b,Variables:JSON.stringify(d)},success:function(e){if(e.ReturnCode===ReturnCode.Success){$.fancybox({href:c.options.proofingCustomizationView});c.reloadProfileOptions(e.Records)}else{prompt.alert({question:e.Message,description:"Ref: "+e.Guid,type:"warning",yes:function(f){$.fancybox({href:c.options.proofingSaveProfileView})}})}}});$("#profileName").removeClass("input-validation-error")}else{$("#profileName").addClass("input-validation-error");$("#profileName").focus()}}};Proofing.prototype.renderPickProfileTemplate=function(){var a=this;a.enableProfiles(!(a.data.Profiles.length===0&&a.data.GlobalProfiles.length===0));$(document).bind(argosyEvents.EVENT_GENERATE_HIGH_RES_PROOF,function(){a.buildProof(true,true)});$(document).bind(argosyEvents.EVENT_TEMPORARY_GLOBAL_PROFILE_CREATED,function(c,b){a.updateVariableValues(b,false);$.fancybox({href:"#divPersonalize"})});$(document).bind(argosyEvents.SELECT_GLOBAL_PROFILE,function(c,b){if(!isNaN(b.globalProfileId)){if(b.showLoading==null||b.showLoading){block(null,"~{MsgLoadingProfile}~")}$.ajax({url:"/Store/Proofing/GetGlobalProfileVariables?globalFormsProfileId="+b.globalProfileId+"&projectId="+a.data.Part.ProofingProjectId,dataType:"json",method:"GET",success:function(d){if(d.ReturnCode==ReturnCode.Success){a.updateVariableValues(d.Records,false,b.updateInputs);if(b.callback!=null){b.callback()}}else{prompt.alert({question:d.Message,description:"Ref: "+d.Guid,type:"warning",yes:function(f){$.fancybox({href:a.options.proofingCustomizationView})}})}},complete:function(d){if(b.showLoading==null||b.showLoading){unblock()}}})}});$(document).bind(argosyEvents.SELECT_STANDARD_PROFILE,function(c,b){if(!isNaN(b.standardProfileId)){if(b.showLoading==null||b.showLoading){block(null,"~{MsgLoadingProfile}~")}$.ajax({url:"/Store/Proofing/GetProfileVariables?profileId="+b.standardProfileId+"&partId="+a.data.Part.PartId,dataType:"json",method:"GET",success:function(d){if(d.ReturnCode==ReturnCode.Success&&d.Records.length>0){a.updateVariableValues(d.Records[0].Variables);if(b.callback!=null){b.callback()}}else{prompt.alert({question:d.Message,description:"Ref: "+d.Guid,type:"warning",yes:function(f){$.fancybox({href:a.options.proofingCustomizationView})}})}},complete:function(d){if(b.showLoading==null||b.showLoading){unblock()}}})}})};Proofing.prototype.renderApproveProofTemplate=function(){var d=this;var a=$(d.options.proofingApproveProofTemplate).html();var b=kendo.template(a);var c=b(d.data);$(d.options.proofingModalWrapper).append(c);var e=$(d.options.proofingModalWrapper).find(d.options.approvalProofModalHref);e.find(d.options.approvalProofAcceptButton).click(function(f){var g=$(d.options.approvalProofInitial).val();var h=$(d.options.approvalProofName).val();if(g.length>0){var i=d.getVariables(false);d.saveCustomizationState(i,d.data.Part.PartId,d.proofingResult.TransactionId,g,h)}else{prompt.alert({question:"~{MsgInitialToContinue}~",description:"",type:"warning",yes:function(j){$.fancybox({href:d.options.approvalProofModalHref})}})}})};Proofing.prototype.saveCustomizationState=function(i,e,h,a,d){var g=this;var f=g.getCurrentPartState();if(f==null||f.CustomizationStateId<=0){block(null,"~{MsgAddingToCart}~");$.ajax({url:"/Store/Proofing/SaveCustomizationState",dataType:"json",data:{variables:JSON.stringify(i),partId:e,transactionId:h,initials:a,orderLineTag:d,dynamicDataSourceKey:g.dynamicDataSourceKey,dynamicDataSourceParams:JSON.stringify(g.dynamicDataSourceParameters)},method:"POST",success:function(j){if(j.ReturnCode==ReturnCode.Success&&j.Records>0){g.CustomizationStateId=j.Records;g.saveCustomizationToCart(e,g.CustomizationStateId)}else{unblock();prompt.alert({question:j.Message,description:"Ref: "+j.Guid,type:"warning",yes:function(k){$.fancybox({href:g.options.approvalProofModalHref})}})}}})}else{var c="~{MsgUpdatingCart}~",b=g.data.RedirectUrl!==null&&g.data.RedirectUrl.length>0;if(b===true){c="~{MsgUpdatingOrder}~"}block(null,c);$.ajax({url:"/Store/Proofing/UpdateCustomizationState",dataType:"json",data:{customizationStateId:f.CustomizationStateId,variables:JSON.stringify(i),transactionId:h,initials:a,orderLineTag:d,dynamicDataSourceKey:g.dynamicDataSourceKey},method:"POST",success:function(j){if(j.ReturnCode===ReturnCode.Success&&j.Records>0){g.CustomizationStateId=j.Records;if(b===false){g.saveCustomizationToCart(e,g.CustomizationStateId)}else{window.location=g.data.RedirectUrl}}else{unblock();prompt.alert({question:j.Message,description:"Ref: "+j.Guid,type:"warning",yes:function(k){$.fancybox({href:g.options.approvalProofModalHref})}})}}})}};Proofing.prototype.updatePartState=function(e,b,c,a){var f=this;var d=null;if(f.data.Parts!=null){$(f.data.Parts).each(function(g){if(this.Sku===e){if(b!=null){this.CustomizationStateId=b}if(c!=null){this.IsApproved=c}if(a!=null){this.CartId=a}d=this}})}return d};Proofing.prototype.saveCustomizationToCart=function(c,b){var e=this;var d=e.updatePartState(e.data.Part.Sku,b,true);var a=function(j){if(j!=null&&j.Records!=null){var i=j.Records;e.updatePartState(e.data.Part.Sku,b,true,i.CartId)}var f="/Store/Cart";if(j!=null&&j.ReturnResponse!=null&&j.ReturnResponse.ReturnUrl!=null&&j.ReturnResponse.ReturnUrl.length>0){f=j.ReturnResponse.ReturnUrl}try{if(customizationStateIds!=null){customizationStateIds=$.grep(customizationStateIds,function(k){return k!=b})}}catch(g){}if(e.data.Parts.length>1){var h=0;$(e.data.Parts).each(function(k){if(!this.IsApproved&&h==0){h=k}});if(h==0){window.location=f}else{unblock();$.fancybox.close();e.updateProofingDisplay(h+1)}}else{window.location=f}};$.ajax({url:"/Store/Proofing/SaveCustomizationToCart",dataType:"json",data:{partId:c,customizationStateId:b,dynamicDataSourceKey:e.dynamicDataSourceKey,cartId:d.CartId>0?d.CartId:null,orderLineId:getQuerystring("orderLineId",null)},method:"POST",success:function(f){if(f.ReturnCode===ReturnCode.Success){a(f)}else{unblock();prompt.alert({question:f.Message,description:"Ref: "+f.Guid,type:"warning",yes:function(g){$.fancybox({href:e.options.approvalProofModalHref})}})}}})};Proofing.prototype.renderGenerateQRCodeTemplate=function(){var d=this;var a=$(d.options.proofingGenerateQRCodeTemplate).html();var b=kendo.template(a);var c=b(d.data);$(d.options.proofingModalWrapper).append(c)};Proofing.prototype.renderSaveProfileTemplate=function(){var d=this;var a=$(d.options.proofingSaveProfileTemplate).html();var b=kendo.template(a);var c=b(d.data);$(d.options.proofingModalWrapper).append(c);$("#existingProfileName").kendoDropDownList()};Proofing.prototype.setupEventListeners=function(){var a=this;$(document).trigger(a.EVENT_LISTENERS_LOADED);$(document).bind(argosyEvents.EVENT_UPDATE_VARIABLES_BY_LINE_ID,function(c,b){$(document).trigger(argosyEvents.START_LOADING);$.ajax({url:"/Proofing/GetOrderLineCustomizationStateVariables",dataType:"json",method:"POST",data:{orderLineId:b.orderLineId},success:function(d){$.fancybox({href:a.options.proofingCustomizationView});a.updateVariableValues(d.Records);a.buildProof()}})})};Proofing.prototype.getDataSource=function(a){var b=this;return window[b.options.dataSource]};Proofing.prototype.buildProof=function(b,a){var c=this;if(b==null){b=true}if(a==null){a=false}if(c.isValidVariables()){$.fancybox.close();var e=c.getVariables(false);$(document).trigger(argosyEvents.START_LOADING);var d=a?"/Store/Proofing/GenerateHighResProof/"+c.data.Part.Sku+"/":"/Store/Proofing/GenerateProof/"+c.data.Part.Sku+"/";$.ajax({url:d,dataType:"json",method:"POST",data:{variables:JSON.stringify(e),height:$(window).height()-250,width:$(window).width()},success:function(f){$(document).trigger(argosyEvents.END_LOADING);if(f.ReturnCode===ReturnCode.Success){if(!a){c.proofingResult=f.Records;c.updateProofingPageNavigation();c.updateSelectedProofingPage();c.updateDefaultProofName(e)}else{window.open(f.Records.HighResUrl)}}else{prompt.alert({question:f.Message,description:"Ref: "+f.Guid,type:"warning",yes:function(g){$.fancybox({href:c.options.proofingCustomizationView})}})}}})}else{if(b){prompt.alert({question:"~{MsgMissingFieldsForProofing}~",description:"~{MsgUpdateFormContinue}~",type:"warning",yes:function(f){$.fancybox({href:c.options.proofingCustomizationView})}})}else{$.fancybox({href:c.options.proofingCustomizationView})}}};Proofing.prototype.getValue=function(c){c=$(c);var g=null;if($.isKendo(c)){var d=$.getKendoControl(c);var b=d.element.attr("data-text-value");if(b==null||b===""){g=d.value();if(c.attr("data-format")!=null&&g!=null&&g!==""){g=kendo.toString(g,c.attr("data-format"))}}else{var f=d.selectedIndex;var e=d.value();if(f!=null&&f>-1){var a=d.dataItem(f);if(a!=null){g=d.dataItem(f)[b]}}else{if($.type(e)==="string"||$.type(e)==="number"){g=e}}}if(g==null){g=""}if($.type(g)==="date"){g=kendo.toString(g,"d")}}else{g=c.val()}return g};Proofing.prototype.getProofName=function(b){if(b==null){return null}var a="";_.forEach(b,function(c){if(c.IsProofName){a+=decodeURIComponent(c.Value)+" "}});a=a.slice(0,-1);if(a.length===0){_.forEach(b,function(c){if(a.length===0&&c.ControlType.toLowerCase()==="textbox"){a=decodeURIComponent(c.Value)}})}return a.substring(0,100)};Proofing.prototype.getVariables=function(c,b,d,a){var e=this;if(d==null){d="var_"}if(b==null){b=e.options.proofingCustomizationView}if(a==null){a="data-argosy-proofing"}var g=$(b).find("*["+a+"]");var f=[];$(g).each(function(h,m){m=$(m);var l=m.attr(a).replace(d,""),j=m.data("isProofName"),k={Name:l,Value:"",IsProofName:j};k.Value=e.getValue(this);if(c){k.Required=(m.attr("required")!=null);k.Element=m}if(m.data("isUpload")!=null){k.IsUpload=m.data("isUpload")}else{k.IsUpload=false}if(m.data("variableId")!=null){k.VariableId=m.data("variableId")}if(m.data("controlType")!=null){k.ControlType=m.data("controlType")}if(m.data("name")!=null){k.Name=m.data("name");k.DisplayName=k.Name}if(k.Value!=null){k.Value=encodeURIComponent(k.Value)}if(k.Name!=null&&k.Name.trim().length>0){f.push(k)}});return f};Proofing.prototype.isValidVariables=function(b,c,a){var d=this;var e=true;var f=d.getVariables(true,b,c,a);$(f).each(function(g){if(this.Required&&this.Value.trim().length==0){e=false;if($.isKendo(this.Element)){$.getKendoControl(this.Element).wrapper.addClass("input-validation-error")}else{this.Element.addClass("input-validation-error")}}else{if($.isKendo(this.Element)){$.getKendoControl(this.Element).wrapper.removeClass("input-validation-error")}else{this.Element.removeClass("input-validation-error")}}});return e};Proofing.prototype.updateProofingPageNavigation=function(){var i=this;var c=$(i.options.proofingRightNavigationPanel);var e=i.generateNavigationPanel();c.empty();c.append(e);var d=c.find(i.options.proofingNavigationWrapper);d.find("img[data-page-number]").each(function(k){var l=$(this);$(l).click(function(m){var n=parseInt(l.attr("data-page-number"));i.updateSelectedProofingPage(n)})});var h=d.find("i.fa-chevron-left").parent();var f=d.find("i.fa-chevron-right").parent();h.click(function(l){var k=parseInt(d.find(i.options.proofingNavigationCurrentPage).html());i.updateSelectedProofingPage((k-1))});f.click(function(l){var k=parseInt(d.find(i.options.proofingNavigationCurrentPage).html());i.updateSelectedProofingPage((k+1))});var b=$(i.options.proofingContinueAndDownloadOptionsPlaceHolder);b.empty();if(!i.options.isPreview){b.append(i.generateContinuePanel())}else{b.append(i.generateDownLoadPanelForPreview())}var j=$(i.options.proofingMainWrapperPanel);var a=j.children();var g=i.proofingResult.Pages.length;$(a).each(function(l){var k=$(this);if(l==1){if(k.hasClass("col-md-8")&&g<=1){k.removeClass("col-md-8").addClass("col-md-10")}else{if(k.hasClass("col-md-10")&&g>1){k.removeClass("col-md-10").addClass("col-md-8")}}}else{if(l>1){if(k.hasClass("col-md-2")&&g<=1){k.addClass("hide")}else{if(k.hasClass("hide")&&g>1){k.removeClass("hide").addClass("show")}}}}})};Proofing.prototype.generateDownLoadPanelForPreview=function(){var d=this;var a=$(d.options.proofingDownloadOptionsForPreview).html();var b=kendo.template(a);var c=b(d.proofingResult);return c};Proofing.prototype.generateContinuePanel=function(){var d=this;var a=$(d.options.proofingContinueAndDownloadOptions).html();var b=kendo.template(a);var c=b(d.proofingResult);return c};Proofing.prototype.generateNavigationPanel=function(){var d=this;var a=$(d.options.proofingRightNavigationPanelTemplate).html();var b=kendo.template(a);d.proofingResult.PersonalizedProofs=d.data.PersonalizedProofs;var c=b(d.proofingResult);return c};Proofing.prototype.updateSelectedProofingPage=function(b){var c=this;if(b==null||b>c.proofingResult.Pages.length){b=1}if(b===0){b=c.proofingResult.Pages.length}$(c.options.proofingNavigationCurrentPage).html(b);var a=c.proofingResult.Pages[(b-1)];$(c.options.proofingCurrentPagePreviewImage).parent().show();$(c.options.proofingCurrentPagePreviewImage).attr("src",a.PreviewImageUrl)};Proofing.prototype.CheckValidUpload=function(a,c){var g=this;if(a!=null){if(a.Extension!=null){var e=[".jpg",".jpeg",".png",".jpg",".tiff",".tif",".gif",".pdf",".eps"],b=a.Extension,f=a.PreviewFileUrl;if($.inArray(b,e)>-1){var d=g.getVariables(true,$("#"+c)[0].parentNode)[0];if(d.Required&&(d.Value.trim().length==0&&a.FileName.length==0)){valid=false;if($.isKendo(c.Element)){$.getKendoControl(d.Element).wrapper.addClass("input-validation-error")}else{d.Element.addClass("input-validation-error")}}else{if($.isKendo(d.Element)){$.getKendoControl(d.Element).wrapper.removeClass("input-validation-error")}else{d.Element.removeClass("input-validation-error")}}}}}};function ProofingLite(b){var c=this;$.extend(true,c.options,c.baseOptions,b);var a=new ControlLoader();c.setupEventListeners();a.loadTemplate("ProofingLite",function(d){$(document.body).append(d);c.initialize(c.getDataSource());$(document).trigger(c.EVENT_TEMPLATE_LOADED)})}ProofingLite.prototype.options={};ProofingLite.prototype.baseOptions={dataSource:null,layoutSelector:"#_ProofingLiteLayout",};ProofingLite.prototype.EVENT_TEMPLATE_LOADED="TEMPLATE_PROOFING_LITE_LOADED";ProofingLite.prototype.EVENT_LISTENERS_LOADED="PROOFING_LITE_LISTENERS_LOADED";ProofingLite.prototype.initialize=function(a){var c=this;c.data=a;var b=c.generateTemplateContent(c.options.layoutSelector,c.data);c.getElement().append(b)};ProofingLite.prototype.setupEventListeners=function(){var a=this};ProofingLite.prototype.getDataSource=function(){var a=this;return window[a.options.dataSource]};ProofingLite.prototype.getElement=function(){var a=this;return $("*[data-argosy-uuid="+a.options.uuid+"]")};ProofingLite.prototype.generateTemplateContent=function(c,a){var e=this;var b=$(c).html();var d=kendo.template(b);return d(a)};function ProofingUpload(a){var b=this;$.extend(true,b.options,b.baseOptions,a);b.controlLoader=new ControlLoader();b.controlLoader.loadTemplate("ProofingUpload",function(c){$(document.body).append(c);b.init()})}ProofingUpload.prototype.options={};ProofingUpload.prototype.baseOptions={dataSource:null,proofingUploadTemplateHref:"#_ProofingUploadTemplate",proofingUploadHiddenInputHref:"#proofingUploadImage",proofingUploadImageControlHref:"#proofingUploadImageControl"};ProofingUpload.prototype.init=function(){var b=this;b.data=b.getDataSource();b.data.Name=b.options.displayName;b.data.UpdateButton=(b.options.updateButton==null?"~{UpdateCart}~":b.options.updateButton);b.data.SkipButton=(b.options.skipButton==null?"~{SkipToCart}~":b.options.skipButton);var a=kendo.template($(b.options.proofingUploadTemplateHref).html());b.getElement().append(a(b.data));kendo.bind(b.getElement());$(document).bind(argosyEvents.ADD_UPLOAD_TO_CART,function(c){b.addUploadToCart()}).bind(argosyEvents.KENDO_EDITOR_IMAGE_UPLOADED,function(d,c){b.imageSwap(d,c)}).bind(argosyEvents.KENDO_EDITOR_IMAGE_REMOVED,function(d,c){b.imageSwap(d,c)});$.waitFor(b.options.proofingUploadImageControlHref,function(c){var d=b;d.controlLoader.loadControls(c)},250)};ProofingUpload.prototype.getDataSource=function(a){var b=this;return window[b.options.dataSource]};ProofingUpload.prototype.getElement=function(){var a=this;return $("*[data-argosy-uuid="+a.options.uuid+"]")};ProofingUpload.prototype.addUploadToCart=function(){var c=this;var d=c.getElement().find(c.options.proofingUploadImageControlHref).getKendoImageEditor(),e=null,b=null;if(d.response!=null){e=d.response.UploadFileUrl;b=d.response.PreviewFileUrl}if(c.data.Part.IsUploadRequired&&(e==null||e.length==0)){prompt.alert({question:"This product requires an upload to be added to your cart.",description:"",type:"warning",yes:function(f){$.fancybox.close()}})}else{var a=null;if(c.data.CustomizationState!=null){a=c.data.CustomizationState.CustomizationStateId}c.addToCart(e,b,a,c.data.CartId,c.data.OrderLineId)}};ProofingUpload.prototype.imageSwap=function(d,a){var b=$("#divArtworkReq"),c=$("#divPreview"),i=c.find("img");i.attr("src","");if(d.type==="EVENT_KENDO_EDITOR_IMAGE_UPLOADED"){if(a!=null){if(a.response!=null){a=a.response}if(a.Extension!=null){var g=[".jpg",".jpeg",".png",".jpg",".tiff",".tif",".gif",".pdf",".eps"],f=a.Extension,h=a.PreviewFileUrl;if($.inArray(f,g)>-1){if(userSettings.IsAssetUploadRestricted){b.hide()}i.attr("src",h)}else{if(userSettings.IsAssetUploadRestricted){b.show()}}}}}};ProofingUpload.prototype.addToCart=function(g,f,b,a,d,c){var e=this;block(null,"~{MsgAddingToCart}~");$.ajax({url:"/Store/Proofing/AddUploadToCart",dataType:"json",data:{partId:e.data.Part.PartId,customizationStateId:b,uploadPath:g,orderLineId:d,thumbnailPath:f,cartId:a,isUploadRequired:c},method:"POST",success:function(i){if(i.ReturnCode==ReturnCode.Success){var h="/Store/Cart";if(i.ReturnResponse!=null&&i.ReturnResponse.ReturnUrl!=null&&i.ReturnResponse.ReturnUrl.length>0){h=i.ReturnResponse.ReturnUrl}window.location=h}else{unblock();prompt.alert({question:i.Message,description:"Ref: "+i.Guid,type:"warning",yes:function(j){$.fancybox.close()}})}}})};function ProofingVariables(){var b=this;$.extend(true,b.options,b.baseOptions,opts);var a=new ControlLoader();a.loadTemplate("BundleBuilder",function(c){$(document.body).append(c);a.loadTemplate("ProofingVariables",function(d){$(document.body).append(d);$(document).trigger(b.EVENT_TEMPLATE_LOADED)})})}ProofingVariables.prototype.options={};ProofingVariables.prototype.baseOptions={partId:null,partObject:null,part:null,};ProofingVariables.prototype.EVENT_TEMPLATE_LOADED="BUNDLE_BUILDER_TEMPLATES_LOADED";function ReportDetailGridView(b){var c=this;$.extend(true,c.options,c.baseOptions,b);var a=new ControlLoader();a.loadTemplate("Reporting",function(d){c.TEMPLATE=$(d);$(document.body).append(d);$(c).trigger(c.EVENT_TEMPLATE_LOADED)});$(document).bind(argosyEvents.EVENT_REQUEST_EXCEL_DATASOURCE,function(f,d){c.search(10000,false,"~{GeneratingExcelReport}~")});c.search()}ReportDetailGridView.prototype.EVENT_TEMPLATE_LOADED="TEMPLATE_REPORTING_LOADED";ReportDetailGridView.prototype.TEMPLATE=null;ReportDetailGridView.prototype.options={};ReportDetailGridView.prototype.baseOptions={gridViewSelector:"div[data-argosy-view=ReportDetailGridView]",templateSelectColumns:"#_ModalSelectReportColumns",templateReportFilters:"#_ModalSelectReportFilters",templateReportDateFilters:"#_ModalReportSelectDateFilters",templateReportUsers:"#_ModalSelectReportUsers",templateReportSummary:"#_ModalSummarizeReport",templateReportSave:"#_ModalSaveReport",fancyboxReportColumnsHref:"div[id=_ModalReportColumns]",fancyboxReportFiltersHref:"div[id=_ModalReportFilters]",fancyboxReportDateFiltersHref:"div[id=_ModalReportDateFilters]",fancyboxReportUsersHref:"div[id=_ModalReportUsers]",fancyboxReportSummary:"div[id=_ModalReportGroupByColumns]",fancyboxReportSaveHref:"div[id=_ModalReportSave]"};ReportDetailGridView.prototype.properties={Report:null,TotalCount:0,SelectedColumns:[],OrigSelectedColumns:[],AvailableColumns:[],ReportColumnList:[],RptDataSrc:[],ReportGroupColumnList:[],SelectedUserIds:[],SelectedFilters:[],SelectedDates:[],SelDateFilterValue:"",XmlLoad:true,FiltersColumnList:[],CurrPageSize:100,PrevPageSize:100,HasGrouping:false,GroupByColumns:[],SelRepColumnIds:[],SelFilterIds:[],SelectedUserIdList:[],GridGroupByColsDataSrc:[],DateFormatValue:"",DateFormatNode:"",ReportConfigId:"",ReportName:"",ReportOperation:"",ReportDateRangeText:"",CurrentPage:1,CurrPage:1,Sort:{},NeedtoClearGridContent:false};ReportDetailGridView.prototype.gridEvent={IsPagerEvent:false,PageSizeEvent:false,NeedsToRefresh:false,ReportInit:false};ReportDetailGridView.prototype.searchCriteria={};ReportDetailGridView.prototype.search=function(c,g,b){var f=this;var e=new Object();if(c==null){c=f.properties.CurrPageSize}if(g==null){g=true}if(b==null){b="~{LoadingReport}~"}e.CompanyId=f.options.companyId;e.SiteId=f.options.siteId;e.SelColIds=f.properties.SelRepColumnIds;e.SelFilterIds=f.properties.SelFilterIds.length>0?f.properties.SelFilterIds:f.properties.FiltersColumnList;e.SelUserIds=f.properties.SelectedUserIds;e.DateFilterValue=f.properties.SelDateFilterValue==""&&!f.properties.XmlLoad?"11":f.properties.SelDateFilterValue;e.DateStart=(f.properties.SelectedDates&&f.properties.SelectedDates.length>0)!=null?f.properties.SelectedDates[0]:null;e.EndDate=(f.properties.SelectedDates&&f.properties.SelectedDates.length>1)!=null?f.properties.SelectedDates[1]:null;e.DateFormatValue=f.properties.DateFormatNode;e.GroupByColumns=f.properties.GroupByColumns;e.ReportConfigId=f.options.reportConfigId;e.ReportId=f.options.reportId;e.XmlLoad=f.properties.XmlLoad;e.Take=c;e.Skip=0;e.PageSize=c;var a=$(f.options.gridViewSelector).getKendoGrid();if(a!=null){if(a.dataSource.sort()!=undefined){e.Sort=a.dataSource.sort();ReportDetailGridView.prototype.properties.Sort=a.dataSource.sort()}}if(f.properties.CurrentPage==0){f.properties.CurrentPage=1}e.Page=f.properties.CurrentPage;var d={search:e};block(null,b,false);$.ajax({url:"/Admin/Reports/GetDetailReport",type:"POST",contentType:"application/json; charset=utf-8",data:JSON.stringify(d),cache:false,processData:false,success:function(j){if(j.ReturnCode==ReturnCode.Failed){handleDataSourceException(j)}else{if(g){ReportDetailGridView.prototype.setUpGrid(j)}else{var i=$.parseJSON(j.Records.Report);var h=$.parseJSON(i.DataSource);$(document).trigger(argosyEvents.EVENT_SEND_EXCEL_DATASOURCE,{records:h})}}unblock()},error:function(h){unblock()}})};ReportDetailGridView.prototype.setUpGrid=function(g){var h=this;h.properties.Report=$.parseJSON(g.Records.Report);h.properties.TotalCount=g.Records.TotalCount;var e=$.parseJSON(h.properties.Report.DataSource);var d=$.parseJSON(h.properties.Report.Columns);var f=$.ReportQuery;h.properties.SelectedColumns=$.parseJSON(h.properties.Report.SelectedColumns);h.properties.OrigSelectedColumns=$.parseJSON(h.properties.Report.OriginalSelectedColumns);h.properties.AvailableColumns=$.parseJSON(h.properties.Report.AvailableColumns);h.properties.ReportColumnList=$.parseJSON(h.properties.Report.ReportAllColumns);h.properties.RptDataSrc=$.parseJSON(h.properties.Report.DataSource);h.properties.ReportGroupColumnList=h.properties.Report.GroupByColumnIds;h.properties.SelectedUserIds=h.properties.Report.SelectedUserIds;h.properties.SelectedFilters=h.properties.Report.FilterColumnsList;h.properties.SelectedDates=h.properties.Report.SelectedDates==null||h.properties.Report.SelectedDates==""?[]:h.properties.Report.SelectedDates;h.properties.SelDateFilterValue=h.properties.Report.DateFilterValue;h.properties.DateFormatValue=h.properties.Report.DateFormatValue;h.properties.ReportConfigId=h.properties.Report.ReportConfigId;h.properties.ReportId=h.properties.Report.ReportId;h.properties.ReportName=h.properties.Report.ReportName;h.properties.ReportDateRangeText=h.properties.Report.ReportDateRangeMsgText;h.properties.FiltersColumnList=[];h.populateFilters();$(h.options.fancyboxReportSummary).html($(h.options.templateReportSummary).html());h.populateGroupByColumns();if((h.properties.FiltersColumnList!=null||h.properties.FiltersColumnList!=undefined)&&h.properties.FiltersColumnList.length<=0){$("#btnAddFilter").show();$("#btnEditFilter").hide()}else{$("#btnAddFilter").hide();$("#btnEditFilter").show()}var a=new kendo.data.DataSource({data:e,serverPaging:true,serverSorting:true,serverFiltering:true,pageSize:h.properties.CurrPageSize,page:h.properties.CurrentPage,schema:{total:function(){return h.properties.Report.Count}}});var c={scrollable:false,editable:false,autoBind:true,dataSource:a,groupable:false,sortable:false,selectable:false,exportToExcel:true,resizable:false,useEventToGetExcelData:true,pageable:{refresh:true,pageSizes:[50,100,500],buttonCount:5},toolbar:[{name:"selectdaterange",text:"SELECT DATE RANGE",template:"<a class='k-button k-button-icontext' id='btnSelectDateRange' onclick='ReportDetailGridView.prototype.showDateFiltersModal();return false;' href='##'><i class='fa la'></i>~{SelectDateRange}~</a>"},{name:"selectusers",text:"SELECT USERS",template:"<a class='k-button k-button-icontext' id='btnSelectUsers' onclick='ReportDetailGridView.prototype.showSelectUsersModal();return false;' href='##'><i class='fa la'></i>~{SelectUsers}~</a>"},{name:"editfilter",text:"EDIT FILTER",template:"<a class='k-button k-button-icontext' id='btnEditFilter' style='display:none;' onclick='ReportDetailGridView.prototype.showFiltersModal();return false;' href='##'><i class='fa la'></i>~{EditFilter}~</a>"},{name:"addfilter",text:"ADD FILTER",template:"<a class='k-button k-button-icontext' id='btnAddFilter' onclick='ReportDetailGridView.prototype.showFiltersModal();return false;' href='##'><i class='fa la'></i>~{AddFilter}~</a>"},{name:"summarize",text:"SUMMARIZE",template:"<a class='k-button k-button-icontext' id='btnSummarize'  onclick='ReportDetailGridView.prototype.showReportSummaryFilters();return false;' href='##'><i class='fa la'></i>~{Summarize}~</a>"},{name:"selectColumns",text:"SELECT COLUMNS",template:"<a class='k-button k-button-icontext' id='btnSelectColumns' onclick='ReportDetailGridView.prototype.showSelectColumnsModal();return false;' href='##' ><i class='fa la'></i>~{SelectColumns}~</a>"},{name:"ReportName",text:"ReportName",template:"<span class='big-price'>"+h.properties.ReportName+"</span><br/><span class='small_txt' id='rptDateRangeText'>"+h.properties.ReportDateRangeText+"</span>"}],columns:d,dataBound:function(i){ReportDetailGridView.prototype.properties.CurrentPage=i.sender.pager.page();if(ReportDetailGridView.prototype.gridEvent.ReportInit&&ReportDetailGridView.prototype.properties.CurrPage!=ReportDetailGridView.prototype.properties.CurrentPage&&ReportDetailGridView.prototype.properties.CurrentPage!=0){ReportDetailGridView.prototype.properties.CurrPage=ReportDetailGridView.prototype.properties.CurrentPage;ReportDetailGridView.prototype.gridEvent.IsPagerEvent=true;ReportDetailGridView.prototype.gridEvent.NeedsToRefresh=true;ReportDetailGridView.prototype.refreshReport();return}else{if((ReportDetailGridView.prototype.properties.Sort!=undefined||ReportDetailGridView.prototype.properties.Sort!=null)&&(ReportDetailGridView.prototype.properties.Sort[0]!=null&&ReportDetailGridView.prototype.properties.Sort[0]!=undefined)&&(ReportDetailGridView.prototype.properties.CurrPageSize==i.sender.dataSource._pageSize&&!ReportDetailGridView.prototype.gridEvent.PageSizeEvent)){if(i.sender.dataSource._sort!=undefined&&((ReportDetailGridView.prototype.properties.Sort[0].dir!=i.sender.dataSource._sort[0].dir)||ReportDetailGridView.prototype.properties.Sort[0].field!=i.sender.dataSource._sort[0].field)){ReportDetailGridView.prototype.refreshReport();return}}else{if(ReportDetailGridView.prototype.gridEvent.ReportInit&&ReportDetailGridView.prototype.properties.CurrPageSize!=i.sender.dataSource._pageSize&&!ReportDetailGridView.prototype.gridEvent.PageSizeEvent){ReportDetailGridView.prototype.gridEvent.PageSizeEvent=true;if(i.sender.dataSource._pageSize!=ReportDetailGridView.prototype.properties.CurrPageSize){ReportDetailGridView.prototype.properties.PrevPageSize=ReportDetailGridView.prototype.properties.CurrPageSize;ReportDetailGridView.prototype.properties.CurrPageSize=i.sender.dataSource._pageSize}ReportDetailGridView.prototype.refreshReport();return}else{if(ReportDetailGridView.prototype.properties.PrevPageSize!=ReportDetailGridView.prototype.properties.CurrPageSize&&ReportDetailGridView.prototype.gridEvent.PageSizeEvent){ReportDetailGridView.prototype.gridEvent.PageSizeEvent=false;return}}}}}};$(h.options.gridViewSelector).kendoArgosyGrid(c);if(!h.properties.Report.HasUserFilter){$("#btnSelectUsers").hide()}else{$("#btnSelectUsers").show()}if(!h.properties.Report.HasDateFilter){$("#btnSelectDateRange").hide()}else{$("#btnSelectDateRange").show()}a.read();$("#rptDateRangeText").html(h.properties.ReportDateRangeText);if(!ReportDetailGridView.prototype.gridEvent.ReportInit){var b=new Object();b.dir="asc";b.field=d[0].field;ReportDetailGridView.prototype.properties.Sort[0]=b}ReportDetailGridView.prototype.gridEvent.ReportInit=true};ReportDetailGridView.prototype.dataSourceOpts={};ReportDetailGridView.prototype.showSaveReportModal=function(){var a=this;$(a.options.fancyboxReportSaveHref).html($(a.options.templateReportSave).html());ReportDetailGridView.prototype.properties.ReportOperation="New";$("#btnSaveReport").bind("click",ReportDetailGridView.prototype.saveReport);$.fancybox({href:a.options.fancyboxReportSaveHref,type:"inline",scrolling:"no"})};ReportDetailGridView.prototype.saveReport=function(){var h=this;var g=new Object();ReportDetailGridView.prototype.properties.SelRepColumnIds=[];$.each(ReportDetailGridView.prototype.properties.SelectedColumns,function(){ReportDetailGridView.prototype.properties.SelRepColumnIds.push(this.COLUMN_ID.toString())});if(ReportDetailGridView.prototype.properties.ReportOperation=="New"){g.ReportName=$("#txtViewName").val();ReportDetailGridView.prototype.properties.ReportConfigId=0}if($("#dtStartDate").getKendoDatePicker()!=undefined&&$("#dtEndDate").getKendoDatePicker()!=undefined){var c=$("#dtStartDate").getKendoDatePicker().value();var b=$("#dtEndDate").getKendoDatePicker().value();ReportDetailGridView.prototype.properties.StartDate=kendo.toString(c,"d");ReportDetailGridView.prototype.properties.EndDate=kendo.toString(b,"d")}var a=$("#lblDateRangeTxt").html();if(a==undefined||a==null){a=ReportDetailGridView.prototype.properties.ReportDateRangeText}if((ReportDetailGridView.prototype.properties.StartDate==null||ReportDetailGridView.prototype.properties.StartDate==undefined)&&a!=undefined){var f=a.substring(a.lastIndexOf("From")+5,a.lastIndexOf("To")-1);ReportDetailGridView.prototype.properties.StartDate=f}if((ReportDetailGridView.prototype.properties.EndDate==null||ReportDetailGridView.prototype.properties.EndDate==undefined||!isNaN(ReportDetailGridView.prototype.properties.EndDate))&&a!=undefined){var d=a.substring(a.lastIndexOf("To")+2);ReportDetailGridView.prototype.properties.EndDate=d}if(ReportDetailGridView.prototype.properties.StartDate==""){ReportDetailGridView.prototype.properties.StartDate=kendo.toString(new Date($.now()),"d")}if(ReportDetailGridView.prototype.properties.EndDate==""){ReportDetailGridView.prototype.properties.EndDate=kendo.toString(new Date($.now()),"d")}if(ReportDetailGridView.prototype.properties.SelFilterIds.length==0&&$("#grdSelFilters").getKendoGrid()!=null){ReportDetailGridView.prototype.applyFilters()}g.SelColIds=ReportDetailGridView.prototype.properties.SelRepColumnIds.length>0?ReportDetailGridView.prototype.properties.SelRepColumnIds:null;g.SelFilterIds=ReportDetailGridView.prototype.properties.SelFilterIds.length>0?ReportDetailGridView.prototype.properties.SelFilterIds:ReportDetailGridView.prototype.properties.FiltersColumnList;g.SelUserIds=ReportDetailGridView.prototype.properties.SelectedUserIds.length>0?ReportDetailGridView.prototype.properties.SelectedUserIds:null;g.DateFilterValue=ReportDetailGridView.prototype.properties.SelDateFilterValue==""&&!ReportDetailGridView.prototype.properties.XmlLoad?"11":ReportDetailGridView.prototype.properties.SelDateFilterValue;g.DateStart=ReportDetailGridView.prototype.properties.StartDate;g.EndDate=ReportDetailGridView.prototype.properties.EndDate;g.DateFormatValue=ReportDetailGridView.prototype.properties.DateFormatNode;g.GroupByColumns=ReportDetailGridView.prototype.properties.GroupByColumns;g.ReportConfigId=ReportDetailGridView.prototype.properties.ReportConfigId;g.ReportId=ReportDetailGridView.prototype.properties.ReportId;var e={search:g};$.ajax({url:"/Admin/Reports/SaveReportView",type:"POST",contentType:"application/json; charset=utf-8",data:JSON.stringify(e),cache:false,processData:false,success:function(i){if(i.ReturnCode==ReturnCode.Failed){handleDataSourceException(i)}else{window.location.href="/Admin/Reports/Details/"+i.Records.REPORT_CONFIG_ID}},error:function(i){}});return false};ReportDetailGridView.prototype.populateSelectColumns=function(){var e=this;var a="";var d="";var b=$("#lnkLstColumns");var c=$("#lnkLstSelCols");if(e.properties.HasGrouping){if(e.properties.SelectedColumns.length>0){$.each(e.properties.AvailableColumns,function(){var f=this;if((f.IS_SUM||f.IS_COUNT)&&$.grep(e.properties.SelectedColumns,function(g){return g.COLUMN_ID==f.COLUMN_ID})==0){a+=" <li class='list-item' COLUMN_ID='"+f.COLUMN_ID+"'>"+f.COLUMN_DISPLAY_NAME+"</li>"}})}else{$.each(e.properties.AvailableColumns,function(){var f=this;if(f.IS_VISIBLE&&!f.IS_DEFAULT){a+=" <li class='list-item' COLUMN_ID='"+f.COLUMN_ID+"'>"+f.COLUMN_DISPLAY_NAME+"</li>"}})}}else{if(e.properties.SelectedColumns.length>0){$.each(e.properties.AvailableColumns,function(){var f=this;if(f.IS_VISIBLE&&$.grep(e.properties.SelectedColumns,function(g){return g.COLUMN_ID==f.COLUMN_ID})==0){a+=" <li class='list-item' COLUMN_ID='"+f.COLUMN_ID+"'>"+f.COLUMN_DISPLAY_NAME+"</li>"}})}else{$.each(e.properties.AvailableColumns,function(){var f=this;if(f.IS_VISIBLE&&!f.IS_DEFAULT){a+=" <li class='list-item' COLUMN_ID='"+f.COLUMN_ID+"'>"+f.COLUMN_DISPLAY_NAME+"</li>"}})}}if(e.properties.SelectedColumns.length<0){$.each(e.properties.ReportColumnList,function(){var f=this;if(f.IS_VISIBLE&&f.IS_DEFAULT){var g=e.properties.HasGrouping?f.GROUP_COLUMN_DISPLAY_NAME:f.COLUMN_DISPLAY_NAME;d+=" <li class='list-item' COLUMN_ID='"+f.COLUMN_ID+"'>"+g+"</li>"}})}else{$.each(e.properties.SelectedColumns,function(){var f=this;var g=e.properties.HasGrouping?f.GROUP_COLUMN_DISPLAY_NAME:f.COLUMN_DISPLAY_NAME;d+=" <li class='list-item' COLUMN_ID='"+f.COLUMN_ID+"'>"+g+"</li>"})}b.html("");c.html("");if(b.getKendoSortable()==undefined||b.getKendoSortable()==null){b.kendoSortable({placeholder:function(f){return $("<li class='list-item' id='placeholder'>Drop Here!</li>")},connectWith:c,cursor:"move"})}if(c.getKendoSortable()==undefined||c.getKendoSortable()==null){c.kendoSortable({placeholder:function(f){return $("<li class='list-item' id='placeholder'>Drop Here!</li>")},connectWith:b,cursor:"move",end:function(f){if(f.action=="receive"){if(f.sender.items().length+1>30){var g="We only allow maximum of 30 columns per report. Please remove number of selected columns and try again.";prompt.notify({question:g,type:"error"});f.preventDefault()}}}})}b.html(a);c.html(d)};ReportDetailGridView.prototype.showSelectColumnsModal=function(){var a=this;$(a.options.fancyboxReportColumnsHref).html($(a.options.templateSelectColumns).html());$("#btnSaveSelectColumns").unbind("click").bind("click",function(){ReportDetailGridView.prototype.properties.NeedtoClearGridContent=true;ReportDetailGridView.prototype.SetGroupByColumns();ReportDetailGridView.prototype.refreshReport()});$(document).keypress(function(b){var c=(b.keyCode?b.keyCode:b.which);if(c===13){$("#filterBtn").trigger("click")}});$("#clearBtn").unbind("click").bind("click",function(){$("#lnkLstColumns .list-item:hidden").show()});$("#filterBtn").unbind("click").bind("click",function(){var b=$("#filterText").val().toLowerCase();$("#lnkLstColumns .list-item").each(function(c){var d=$(this),f=d.text().toLowerCase().replace(/\s/g,"");if(b.length>0&&f.indexOf(b)<0){d.hide()}else{d.show()}})});a.populateSelectColumns();$.fancybox({href:a.options.fancyboxReportColumnsHref,type:"inline",scrolling:"no"})};ReportDetailGridView.prototype.populateFilters=function(){var b=this;var a=b.properties.SelectedFilters;if(a!=null&&a.length>0){$.each(a,function(){b.properties.FiltersColumnList.push({ID:this.Id,COLUMN_ID:this.ColumnId,COLUMN_DISPLAY_NAME:this.FilterColumnName,VALUE:this.FilterByValue,OPERAND:this.FilterByOperand})})}if(b.properties.FiltersColumnList!=null&&b.properties.FiltersColumnList!=undefined&&b.properties.FiltersColumnList.length<=0){$("#btnAddFilter").show();$("#btnEditFilter").hide()}};ReportDetailGridView.prototype.populateFilterDropDownList=function(){var c=this;var b=c.properties.ReportColumnList;var a=[];$.each(b,function(){if(this.IS_FILTER){a.push(this)}});$("#ddlColumns").kendoDropDownList({optionLabel:"Select",dataTextField:"COLUMN_DISPLAY_NAME",dataValueField:"COLUMN_ID",dataSource:a})};ReportDetailGridView.prototype.loadFilterGrid=function(){var i=this;var b=$("#ddlColumns").getKendoDropDownList();var c=ReportDetailGridView.prototype.properties.FiltersColumnList;var h=ReportDetailGridView.prototype.properties.ReportColumnList;var d=false;if(b!=null&&b!=undefined&&b.value()!==""){if(c.length>0){$.each(c,function(){if(this.COLUMN_ID==b.value()){d=true}})}if(!d){c.push({COLUMN_ID:b.value(),COLUMN_DISPLAY_NAME:b.text(),OPERAND:"",VALUE:""})}}if(c.length>0){$("#divEmptyFilterMessage").hide();$("#btnApplyFilters").show()}else{$("#btnApplyFilters").hide();if($("#grdSelFilters").getKendoGrid()!=null){var f=$("#grdSelFilters").getKendoGrid();f.columns=[];f.thead.remove();f.dataSource.data([]);f.destroy();f=null}$("#divEmptyFilterMessage").show();return}if($("#grdSelFilters").getKendoGrid()==null||$("#grdSelFilters").getKendoGrid()==undefined){var g={dataSource:{data:c,schema:{id:"COLUMN_ID",model:{fields:{COLUMN_DISPLAY_NAME:{type:"string"}}}}},columns:[{field:"COLUMN_DISPLAY_NAME",title:"Name"},{template:"<input id='ddl_${COLUMN_ID}' uid= 'uid_${COLUMN_ID}' value='${OPERAND}' />",title:"Expression"},{template:"<input id='txt_${COLUMN_ID}' type='text' value='${VALUE}' />",title:"Value"},{template:"<a href='\\#' value='${COLUMN_DISPLAY_NAME}' onclick='ReportDetailGridView.prototype.deleteFilter(${COLUMN_ID}, this )' class='btn btn-success'><i class='fa fa-remove'></i> Remove</a>",title:""}],scrollable:false,sortable:false,dataBound:function(j){$(j.sender._data).each(function(){if(c.length>0){var m=[];var o=-1;for(var n=0;n<h.length;n++){var k=h[n];if(k.COLUMN_ID==this.COLUMN_ID){o=n}if(o>-1){break}}if(o>-1&&h[o].COLUMN_TYPE=="TEXT"){m=[{text:"Not Equals",value:"<>"},{text:"Equals",value:"="},{text:"Contains",value:"like"},{text:"Starts With",value:"startswith"},{text:"Ends With",value:"endswith"}]}else{m=[{text:"Not Equals",value:"<>"},{text:"Equals",value:"="},{text:"Greater Than",value:">"},{text:"Less Than",value:"<"},]}$("#ddl_"+this.COLUMN_ID).kendoDropDownList({optionLabel:"Select",dataTextField:"text",dataValueField:"value",dataSource:m});if(this.OPERAND!==""){var p=this.OPERAND;var l=$("#ddl_"+this.COLUMN_ID).getKendoDropDownList();l.text(this.OPERAND);l.select(function(q){return q.value==p})}}})}};$("#grdSelFilters").kendoGrid(g);$("#ddlColumns").val("")}else{var e=$("#grdSelFilters").getKendoGrid();e.dataSource.data(c);e.refresh()}var a=$("#ddlColumns").getKendoDropDownList();a.value("")};ReportDetailGridView.prototype.loadPresetDate=function(){var a=this;ReportDetailGridView.prototype.properties.SelDateFilterValue=$("#ddlPresetDate").data("kendoDropDownList").value();ReportDetailGridView.prototype.refreshReport()};ReportDetailGridView.prototype.loadDateRange=function(){var f=this;var b=$("#dtStartDate").data("kendoDatePicker").value();var a=$("#dtEndDate").data("kendoDatePicker").value();var d="";if(b==""||b==null||b==undefined){d="Please Select Start Date";prompt.notify({question:d,type:"error"});return}else{if(a==""||a==null||a==undefined){d="Please Select End Date";prompt.notify({question:d,type:"error"});return}else{if(b>a){d="Start Date cannot be greater than End Date";prompt.notify({question:d,type:"error"});return}}}var e=kendo.toString(b,"d");var c=kendo.toString(a,"d");ReportDetailGridView.prototype.properties.SelDateFilterValue="14";if(ReportDetailGridView.prototype.properties.SelectedDates!=null&&ReportDetailGridView.prototype.properties.SelectedDates!=undefined&&ReportDetailGridView.prototype.properties.SelectedDates.length>0){ReportDetailGridView.prototype.properties.SelectedDates[0]=e.trim();ReportDetailGridView.prototype.properties.SelectedDates[1]=c.trim()}else{ReportDetailGridView.prototype.properties.SelectedDates=[];ReportDetailGridView.prototype.properties.SelectedDates.push(e.trim());ReportDetailGridView.prototype.properties.SelectedDates.push(c.trim())}ReportDetailGridView.prototype.refreshReport()};ReportDetailGridView.prototype.populateReportDates=function(){var f=this;var d=f.properties.SelDateFilterValue;var e=f.properties.SelectedDates;var c=[{value:"1",text:"Today"},{value:"2",text:"Yesterday"},{value:"3",text:"This Week (Sun-Today)"},{value:"4",text:"This Week (Mon-Today)"},{value:"5",text:"Last 7 days"},{value:"6",text:"Last Week (Sun-Sat)"},{value:"7",text:"Last Week (Mon-Sun)"},{value:"8",text:"Last Business Week (Mon-Fri)"},{value:"9",text:"Last 14 Days"},{value:"10",text:"This Month"},{value:"11",text:"Last 30 Days"},{value:"12",text:"Last Month"},{value:"19",text:"Last 45 Days"},{value:"15",text:"Last 90 Days"},{value:"16",text:"Last 180 Days"},{value:"17",text:"Year To Date"},{value:"18",text:"Last Year"},{value:"13",text:"All Time"}];if($("#ddlPresetDate").getKendoDropDownList()==null||$("#ddlPresetDate").getKendoDropDownList()==undefined){$("#ddlPresetDate").kendoDropDownList({dataTextField:"text",dataValueField:"value",dataSource:c})}if(d!==""){if($("#ddlPresetDate").getKendoDropDownList()!=null&&$("#ddlPresetDate").getKendoDropDownList()!=undefined){$("#ddlPresetDate").getKendoDropDownList().value(d)}}if($("#dtStartDate").getKendoDatePicker()==null&&$("#dtStartDate").getKendoDatePicker()==undefined){$("#dtStartDate").kendoDatePicker({format:"MM/dd/yyyy"})}if($("#dtEndDate").getKendoDatePicker()==null&&$("#dtEndDate").getKendoDatePicker()==undefined){$("#dtEndDate").kendoDatePicker({format:"MM/dd/yyyy"})}var b=$("#dtStartDate").getKendoDatePicker();var a=$("#dtEndDate").getKendoDatePicker();if(e!=null){if(e[0]!=null&&e[0].length>0){if(e[0]!=null&&e[0]!==""){b.value(e[0])}}if(e[1]&&e[1].length>0){if(e[1]!=null&&e[1]!==""){a.value(e[1])}}}};ReportDetailGridView.prototype.showFiltersModal=function(){var a=this;$(a.options.fancyboxReportFiltersHref).html($(a.options.templateReportFilters).html());a.populateFilterDropDownList();$("#btnAddFilterCol").bind("click",a.loadFilterGrid);$("#btnApplyFilters").bind("click",a.refreshReport);a.loadFilterGrid();$.fancybox({href:a.options.fancyboxReportFiltersHref,type:"inline",scrolling:"no"})};ReportDetailGridView.prototype.showDateFiltersModal=function(){var a=this;$(a.options.fancyboxReportDateFiltersHref).html($(a.options.templateReportDateFilters).html());$("#btnSearchPresetdate").bind("click",a.loadPresetDate);$("#btnSearchDateRange").bind("click",a.loadDateRange);a.populateReportDates();$.fancybox({href:a.options.fancyboxReportDateFiltersHref,type:"inline",scrolling:"no"})};ReportDetailGridView.prototype.loadCompanyUserGroups=function(){var b=this;if($("#ddlUserGroup").getKendoDropDownList()==null||$("#ddlUserGroup").getKendoDropDownList==undefined){var a={companyId:b.options.companyId};$.ajax({url:"/Admin/UserGroups/GetCompanyUserGroups",type:"POST",contentType:"application/json",data:JSON.stringify(a),processData:false,success:function(d){if(d.ReturnCode==ReturnCode.Failed){handleDataSourceException(d)}else{var c=d.Records;$("#ddlUserGroup").kendoDropDownList({optionLabel:"~{Select User Group}~",dataTextField:"GroupName",dataValueField:"UserGroupId",dataSource:{data:c}});ReportDetailGridView.prototype.loadCompanyUsers()}},error:function(c){}})}};ReportDetailGridView.prototype.loadCompanyUsers=function(){var c=this;var b=new kendo.data.DataSource({serverPaging:true,serverFiltering:true,pageSize:5,schema:{data:"Records",total:"TotalRecords"},transport:{read:{url:"/Admin/Users/GetCompanyUsers",type:"POST",contentType:"application/json"},parameterMap:function(e){var f=new Object();f.IncludeUserIds=ReportDetailGridView.prototype.properties.SelectedUserIds;f.Active="Y";f.Take=5;if(e.filter!=null){f.FullName=e.filter.filters[0].value}e.search=f;return JSON.stringify(e)}}});var d;if($("#ddlCompUsers").getKendoMultiSelect()==null||$("#ddlCompUsers").getKendoMultiSelect==undefined){d=$("#ddlCompUsers").kendoMultiSelect({placeholder:"Search User By First, Last or Username...",dataTextField:"FullName",dataValueField:"UserId",headerTemplate:'<div class="dropdown-header k-widget k-header"><span>Full Name</span><span>Username</span></div>',itemTemplate:'<span class="k-state-default"><h3>#: data.FullName #</h3><p>#: data.Username #</p></span>',tagTemplate:'<span class="selected-value"></span><span>#:data.FullName#(#: data.Username #)</span>',dataSource:b,filter:"startswith",minLength:3,value:ReportDetailGridView.prototype.properties.SelectedUserIds,change:function(){ReportDetailGridView.prototype.properties.SelectedUserIds=[];var e=this._old;$.each(e,function(f){if(this!=null&&this!=""&&this>0){ReportDetailGridView.prototype.properties.SelectedUserIds.push(e[f])}f++})}});var a=$("#ddlCompUsers").data("kendoMultiSelect");a.wrapper.attr("id","customers-wrapper")}else{d=$("#ddlCompUsers").data("kendoMultiSelect");d.dataSource.read();d.refresh()}};ReportDetailGridView.prototype.showSelectUsersModal=function(){var a=this;$(a.options.fancyboxReportUsersHref).html($(a.options.templateReportUsers).html());$("#btnSelectFilterUsers").bind("click",a.refreshReport);a.loadCompanyUsers();$.fancybox({href:a.options.fancyboxReportUsersHref,type:"inline",scrolling:"no",afterClose:function(){$("#btnSelectFilterUsers").click()}})};ReportDetailGridView.prototype.getUserFilters=function(){var c=this;var a=[];if($("#ddlCompUsers").getKendoMultiSelect()!=null){var b=$("#ddlCompUsers").getKendoMultiSelect().dataSource.data();if(b.length>0){$.each(b,function(){if(b.UserId!=null&&b.UserId>0){a.push(b.UserId)}})}ReportDetailGridView.prototype.properties.SelectedUserIds=a.filter(function(d){return d!==""})}};ReportDetailGridView.prototype.populateGroupByColumns=function(){var f=this;var d=f.properties.ReportColumnList;var b=0;var e=false;f.properties.GroupByColumns=[];f.properties.GridGroupByColsDataSrc=[];var a="";var c=$("#lstLnkGroupByColumns");$('input[name="datePeriod"]').attr("disabled","disabled");$.each(d,function(){if(this.IS_VISIBLE&&this.IS_GROUP){var g=this.COLUMN_ID;f.properties.GridGroupByColsDataSrc.push({COLUMN_ID:this.COLUMN_ID,COLUMN_DISPLAY_NAME:this.COLUMN_DISPLAY_NAME});e=true;a+="<li class='list-item-not-sortable-disabled list-disabled' COLUMN_ID='"+this.COLUMN_ID+"' COLUMN_NAME='"+this.COLUMN_DISPLAY_NAME+"'><input type='checkbox' onclick='ReportDetailGridView.prototype.groupByColumnChanged(this,"+this.COLUMN_TYPE.toUpperCase().indexOf("DATE")+");' id='chkGroupBy_"+this.COLUMN_ID+"'/><label for='chkGroupBy_"+this.COLUMN_ID+"'>"+this.COLUMN_DISPLAY_NAME+"</label></li>";if(this.COLUMN_TYPE.toUpperCase().indexOf("DATE")!=-1){$("#chkGroupBy_"+this.COLUMN_ID).attr("IsDate",true)}if(!$("#btnSummarize").is(":visible")){$("#btnSummarize").show()}if(f.properties.ReportGroupColumnList!=null){$.each(f.properties.ReportGroupColumnList,function(){var h=this;if(g==h){$("#chkGroupBy_"+g).prop("checked",true);f.properties.HasGrouping=true;f.properties.GroupByColumns.push(g)}b++})}}});c.html("");if(c.getKendoSortable()==undefined||c.getKendoSortable()==null){c.kendoSortable({disabled:".list-disabled"})}c.html(a);if(e){$("#btnSummarize").show()}else{$("#btnSummarize").hide()}if(f.properties.DateFormatValue!=null&&f.properties.DateFormatValue!=""){$("input[name=datePeriod][value="+f.properties.DateFormatValue+"]").prop("checked",true);f.properties.DateFormatNode=f.properties.DateFormatValue}};ReportDetailGridView.prototype.showReportSummaryFilters=function(){var a=this;$("#btnGroupByContinue").bind("click",a.ReportGroupByContinue);$.fancybox({href:a.options.fancyboxReportSummary,type:"inline",scrolling:"no"})};ReportDetailGridView.prototype.SetGroupByColumns=function(){ReportDetailGridView.prototype.properties.HasGrouping=false;ReportDetailGridView.prototype.properties.GroupByColumns=[];var b=$("#lstLnkGroupByColumns").getKendoSortable();var a=[];$.each(b.items(),function(f){var d=$(b.items()[f]).attr("COLUMN_ID");var e=$(b.items()[f]).attr("COLUMN_NAME");var c=$("#chkGroupBy_"+d);if($(c).is(":checked")){if($.grep(a,function(g){return g.COLUMN_ID==d})==0){a.push({COLUMN_ID:d,COLUMN_DISPLAY_NAME:e,GROUP_COLUMN_DISPLAY_NAME:e});ReportDetailGridView.prototype.properties.GroupByColumns.push(d);ReportDetailGridView.prototype.properties.HasGrouping=true}}});a=[]};ReportDetailGridView.prototype.ReportGroupByContinue=function(){var g=this;$(ReportDetailGridView.prototype.options.fancyboxReportColumnsHref).html($(ReportDetailGridView.prototype.options.templateSelectColumns).html());$("#btnSaveSelectColumns").bind("click",function(){ReportDetailGridView.prototype.properties.NeedtoClearGridContent=true;ReportDetailGridView.prototype.refreshReport()});ReportDetailGridView.prototype.properties.HasGrouping=false;ReportDetailGridView.prototype.properties.GroupByColumns=[];var f=$("#lstLnkGroupByColumns").getKendoSortable();var a="";var e="";var b=$("#lnkLstColumns");var c=$("#lnkLstSelCols");var d=[];$.each(f.items(),function(l){var j=$(f.items()[l]).attr("COLUMN_ID");var k=$(f.items()[l]).attr("COLUMN_NAME");var h=$("#chkGroupBy_"+j);if($(h).is(":checked")){if($.grep(d,function(i){return i.COLUMN_ID==j})==0){d.push({COLUMN_ID:j,COLUMN_DISPLAY_NAME:k,GROUP_COLUMN_DISPLAY_NAME:k});if($.grep(ReportDetailGridView.prototype.properties.SelectedColumns,function(i){return i.COLUMN_ID==j}).length==0){ReportDetailGridView.prototype.properties.SelectedColumns.push({COLUMN_ID:j,COLUMN_DISPLAY_NAME:k,GROUP_COLUMN_DISPLAY_NAME:k})}ReportDetailGridView.prototype.properties.GroupByColumns.push(j);ReportDetailGridView.prototype.properties.HasGrouping=true}}});if(ReportDetailGridView.prototype.properties.HasGrouping){ReportDetailGridView.prototype.properties.DateFormatNode=$("input[name=datePeriod]:checked").val();$.each(ReportDetailGridView.prototype.properties.ReportColumnList,function(){if((this.IS_SUM||this.IS_COUNT)){a+=" <li class='list-item' COLUMN_ID='"+this.COLUMN_ID+"'>"+this.GROUP_COLUMN_DISPLAY_NAME+"</li>"}});$.each(d,function(){e+=" <li class='list-item' COLUMN_ID='"+this.COLUMN_ID+"'>"+this.GROUP_COLUMN_DISPLAY_NAME+"</li>"})}else{ReportDetailGridView.prototype.properties.SelectedColumns=[];$.each(ReportDetailGridView.prototype.properties.OrigSelectedColumns,function(){e+=" <li class='list-item' COLUMN_ID='"+this.COLUMN_ID+"'>"+this.COLUMN_DISPLAY_NAME+"</li>";ReportDetailGridView.prototype.properties.SelectedColumns.push({COLUMN_ID:this.COLUMN_ID,COLUMN_DISPLAY_NAME:this.COLUMN_DISPLAY_NAME,GROUP_COLUMN_DISPLAY_NAME:this.COLUMN_DISPLAY_NAME})});ReportDetailGridView.prototype.properties.GroupByColumns=[];ReportDetailGridView.prototype.properties.DateFormatNode=""}b.html("");c.html("");if(b.getKendoSortable()==undefined||b.getKendoSortable()==null){b.kendoSortable({placeholder:function(h){return $("<li class='list-item' id='placeholder'>Drop Here!</li>")},connectWith:c,cursor:"move"})}if(c.getKendoSortable()==undefined||c.getKendoSortable()==null){c.kendoSortable({placeholder:function(h){return $("<li class='list-item' id='placeholder'>Drop Here!</li>")},connectWith:b,cursor:"move",end:function(h){if(h.action=="receive"){if(h.sender.items().length+1>30){var i="We only allow maximum of 30 columns per report. Please remove number of selected columns and try again.";prompt.notify({question:i,type:"error"});h.preventDefault()}}}})}b.html(a);c.html(e);$.fancybox({href:ReportDetailGridView.prototype.options.fancyboxReportColumnsHref,type:"inline",scrolling:"no"});return false};ReportDetailGridView.prototype.groupByColumnChanged=function(a,b){var c=this;if(b!=-1&&$(a).is(":checked")){$('input[name="datePeriod"]').attr("disabled",false)}else{$('input[name="datePeriod"]').attr("disabled","disabled")}if(!$(a).is(":checked")){$.each(ReportDetailGridView.prototype.properties.SelectedColumns,function(d){if(this.COLUMN_DISPLAY_NAME==a._text||this.GROUP_COLUMN_DISPLAY_NAME==a._text){ReportDetailGridView.prototype.properties.SelectedColumns.splice(d,1)}})}};ReportDetailGridView.prototype.setSelectedColumns=function(){var b=this;var a=$("#lnkLstSelCols").getKendoSortable();b.properties.SelRepColumnIds=[];if(a!=null){b.properties.SelectedColumns=[];$.each(a.items(),function(){b.properties.SelRepColumnIds.push($(this).attr("COLUMN_ID"));b.properties.SelectedColumns.push({COLUMN_ID:$(this).attr("COLUMN_ID"),COLUMN_DISPLAY_NAME:$(this).html(),GROUP_COLUMN_DISPLAY_NAME:$(this).html()})})}else{b.properties.SelRepColumnIds=[];$.each(b.properties.SelectedColumns,function(){b.properties.SelRepColumnIds.push($(this).attr("COLUMN_ID"))})}};ReportDetailGridView.prototype.applyFilters=function(){var g=this;g.properties.SelFilterIds=[];var c=$("#grdSelFilters").getKendoGrid();if(c!=null){var d=$("#grdSelFilters").getKendoGrid().dataSource;for(var e=0;e<d._data.length;e++){var b=new Object();b.Id=e+1;b.ColumnId=d._data[e].COLUMN_ID;b.FilterColumnName=d._data[e].COLUMN_DISPLAY_NAME;var a=$("#ddl_"+d._data[e].COLUMN_ID).getKendoDropDownList();var f=$("#txt_"+d._data[e].COLUMN_ID).val();b.FilterByOperand=a.value();b.FilterByValue=f;b.ColumnNameInQuery=d._data[e].COLUMN_DISPLAY_NAME;g.properties.SelFilterIds.push(b)}}};ReportDetailGridView.prototype.refreshReport=function(){var a=this;ReportDetailGridView.prototype.properties.XmlLoad=false;ReportDetailGridView.prototype.setSelectedColumns();ReportDetailGridView.prototype.applyFilters();if(ReportDetailGridView.prototype.properties.NeedtoClearGridContent){ReportDetailGridView.prototype.clearReportContents()}ReportDetailGridView.prototype.search();$.fancybox.close()};ReportDetailGridView.prototype.deleteFilter=function(b,c){var d=this;var a=[];a.push({COLUMN_ID:b,COLUMN_DISPLAY_NAME:c});$.each(ReportDetailGridView.prototype.properties.FiltersColumnList,function(e){if(this.COLUMN_ID==b){ReportDetailGridView.prototype.properties.FiltersColumnList.splice(e,1)}});ReportDetailGridView.prototype.loadFilterGrid();d.refreshReport()};ReportDetailGridView.prototype.clearReportContents=function(){var b=this;var a=$(ReportDetailGridView.prototype.options.gridViewSelector).getKendoGrid();if(a!=null){a.columns=[];a.thead.remove();a.dataSource.data([]);a.destroy();a=null}};function RMADetailPartGridView(a){var b=this;$.extend(true,b.options,b.baseOptions,a);$(document).bind(argosyEvents.SEARCH_PAGE_GRID,function(d,c){b.search({})});b.search({})}RMADetailPartGridView.prototype.options={};RMADetailPartGridView.prototype.baseOptions={gridViewSelector:"div[data-argosy-view=RMADetailPartGridView]"};RMADetailPartGridView.prototype.search=function(){var c=this;if($(c.options.gridViewSelector).getKendoGrid()==null){var b={scrollable:false,editable:false,autoBind:true,dataSource:c.getDataSource({}),groupable:false,sortable:true,selectable:"multiple, row",pageable:{refresh:true,pageSizes:[50,100,500],buttonCount:5},columns:[{title:"Sku",field:"Sku"},{title:"Description",field:"PartName",encoded:false},{title:"Serial",field:"RMASerial"},{title:"Custom Identifier",field:"Custom01",width:"15%"},{title:"<span class='floatr textr'>Shipped Qty</span>",field:"ShippedQty",template:"<div class='textr'>${ShippedQty}</div>"},{title:"<span class='floatr textr'>Recv. Qty</span>",field:"ReceivedQty",template:"<div class='textr'>${ReceivedQty}</div>",width:"15%"},{title:"Recv. Date",field:"ReceivedDate",template:'${kendo.toString(kendo.parseDate(ReceivedDate),"MM/dd/yyyy")}'}],};$(c.options.gridViewSelector).kendoArgosyGrid(b)}else{var a=$(c.options.gridViewSelector).getKendoGrid();a.dataSource.read();a.refresh()}};RMADetailPartGridView.prototype.getDataSource=function(a){var b=this;$.extend(true,b.dataSourceOpts,_defaultDataSourceConfig,a);b.dataSourceOpts.transport={read:function(c){var d=b.options;$.extend(true,d,kendoOptionsToObject(c),b.searchCriteria);$.ajax({url:"/DataView/GetParts",dataType:"json",data:d,success:function(e){if(e.ReturnCode==ReturnCode.Failed){handleDataSourceException(e)}else{c.success(e)}}})}};return new kendo.data.DataSource(b.dataSourceOpts)};RMADetailPartGridView.prototype.dataSourceOpts={};RMADetailPartGridView.prototype.getStatus=function(){};function RmaOrderDetailGridView(a){var b=this;$.extend(true,b.options,b.baseOptions,a);$(document).bind(argosyEvents.SEARCH_PAGE_GRID,function(d,c){b.search({})});b.search({})}RmaOrderDetailGridView.prototype.options={};RmaOrderDetailGridView.prototype.baseOptions={gridViewSelector:"div[data-argosy-view=RmaOrderDetailGridView]"};RmaOrderDetailGridView.prototype.search=function(){var c=this;if($(c.options.gridViewSelector).getKendoGrid()==null){var b={scrollable:false,editable:false,autoBind:true,dataSource:c.getDataSource({}),groupable:false,sortable:false,selectable:false,exportToExcel:false,columns:[{title:"~{SKU}~",field:"Sku"},{title:"~{Description}~",field:"Description"},{title:"~{Serial}~",field:"SerialNumber"},{title:"<span class='nowrap'>~{CustomIdentifier}~</span>",field:"CustomIdentifier"},{title:"<span class='floatr textr nowrap'>~{QtyShip}~</span>",template:"<div class='textr'>#:kendo.toString(ShippedQty,'n0')#</div>"},{title:"<span class='floatr textr nowrap'>~{QtyRec}~</span>",template:"<div class='textr'>${ReceivedQty}</div>"},{title:"~{DateRec}~",field:"ReceivedDate",template:'${kendo.toString(kendo.parseDate(ReceivedDate),"MM/dd/yyyy")}'}],dataBinding:function(d){},dataBound:function(d){var g=$(d.sender.element);var f=g.getKendoGrid();g.find("tbody tr[role=row]").each(function(){var e=$(this).find(".fa.la.fa-search").parent();var h=$(this).kendoTooltip({filter:"a",width:300,position:"top"}).data("kendoTooltip")});$("div[data-argosy-view=RmaOrderDetailGridView] th:eq(1) ,div[data-argosy-view=RmaOrderDetailGridView]  tr td:nth-child(2)").addClass("hidden-sm hidden-xs");$("div[data-argosy-view=RmaOrderDetailGridView] th:eq(2) ,div[data-argosy-view=RmaOrderDetailGridView]  tr td:nth-child(3)").addClass("hidden-sm hidden-xs");$("div[data-argosy-view=RmaOrderDetailGridView] th:eq(3) ,div[data-argosy-view=RmaOrderDetailGridView]  tr td:nth-child(4)").addClass("hidden-xs");$("div[data-argosy-view=RmaOrderDetailGridView] th:eq(4) ,div[data-argosy-view=RmaOrderDetailGridView]  tr td:nth-child(5)").addClass("hidden-xs")}};$(c.options.gridViewSelector).kendoArgosyGrid(b)}else{var a=$(c.options.gridViewSelector).getKendoGrid();a.dataSource.read();a.refresh()}};RmaOrderDetailGridView.prototype.getDataSource=function(a){var b=this;$.extend(true,b.dataSourceOpts,_defaultDataSourceConfig,a);b.dataSourceOpts.transport={read:function(c){var d=b.options;$.extend(true,d,kendoOptionsToObject(c),b.searchCriteria);$.ajax({url:"/DataView/GetRmaOrderItems",dataType:"json",data:d,success:function(e){if(e.ReturnCode==ReturnCode.Failed){handleDataSourceException(e)}else{c.success(e)}}})}};return new kendo.data.DataSource(b.dataSourceOpts)};RmaOrderDetailGridView.prototype.dataSourceOpts={};function RMAOrdersGridView(a){var b=this;$.extend(true,b.options,b.baseOptions,a);$(document).bind(argosyEvents.SEARCH_PAGE_GRID,function(d,c){b.refineSearch(c)});b.refineSearch({})}RMAOrdersGridView.prototype.options={};RMAOrdersGridView.prototype.baseOptions={gridViewSelector:"div[data-argosy-view=RMAOrdersGridView]",};RMAOrdersGridView.prototype.searchCriteria={};RMAOrdersGridView.prototype.refineSearch=function(a){var b=this;b.searchCriteria=a;b.setupGrid()};RMAOrdersGridView.prototype.setupGrid=function(){var c=this;if($(c.options.gridViewSelector).getKendoGrid()==null){var b={scrollable:false,editable:false,autoBind:true,dataSource:c.getDataSource({}),dataBound:function(d){$("div[data-argosy-view=RMAOrdersGridView] th:eq(3) ,div[data-argosy-view=RMAOrdersGridView]  tr td:nth-child(4)").addClass("hidden-sm hidden-xs");$("div[data-argosy-view=RMAOrdersGridView] th:eq(4),div[data-argosy-view=RMAOrdersGridView]  tr td:nth-child(5)").addClass("hidden-sm hidden-xs");$("div[data-argosy-view=RMAOrdersGridView] th:eq(6),div[data-argosy-view=RMAOrdersGridView]  tr td:nth-child(7)").addClass("hidden-sm hidden-xs")},groupable:false,sortable:true,pageable:{refresh:true,pageSizes:[50,100,500],buttonCount:5},columns:[{title:"~{RMANumber}~",field:"RMANumber",template:"<a href='/Admin/RMA/Edit/${RMANumber}'>${RMANumber}</a>",},{title:"~{RMADate}~",field:"ReceivedDate",template:'${kendo.toString(kendo.parseDate(ReceivedDate),"MM/dd/yyyy")}',},{title:"~{OrderNumber}~",field:"OrderNumber",},{title:"~{User}~",field:"OrderUserFullName"},{title:"~{Status}~",field:"Status",template:"<span class='bold'>${Status}</span>"},{title:"~{Carrier}~",field:"CarrierName"}],search:[{name:"Keyword",type:"text",placeholder:"~{SearchByRMANumberStatus}~",toolbar:true},{name:"StatusId",type:"select",toolbar:true,data:RMAStatuses}],};$(c.options.gridViewSelector).kendoArgosyGrid(b)}else{var a=$(c.options.gridViewSelector).getKendoGrid();a.dataSource.read();a.refresh()}};RMAOrdersGridView.prototype.getSelectedRecords=function(){var c=this;var b=[];var a=$(c.options.gridViewSelector).getKendoGrid();$(a.select()).each(function(d){b.push(a.dataItem(this))});return b};RMAOrdersGridView.prototype.getDataSource=function(a){var b=this;$.extend(true,b.dataSourceOpts,_defaultDataSourceConfig,a);b.dataSourceOpts.transport={read:function(c){var d={};$.extend(true,d,kendoOptionsToObject(c),b.searchCriteria);$.ajax({url:"/DataView/GetRMAOrders",dataType:"json",data:d,success:function(e){if(e.ReturnCode==ReturnCode.Failed){handleDataSourceException(e)}else{c.success(e)}}})}};return new kendo.data.DataSource(b.dataSourceOpts)};RMAOrdersGridView.prototype.dataSourceOpts={};function ScheduledReports(a){var b=this;$.extend(true,b.options,b.baseOptions,a);b.CompanyId=b.options.companyId;b.SiteId=b.options.siteId;$(document).bind(argosyEvents.SEARCH_PAGE_GRID,function(d,c){b.refineSearch(c)});b.refineSearch()}ScheduledReports.prototype.options={};ScheduledReports.prototype.Init=false;ScheduledReports.prototype.baseOptions={gridViewSelector:"div[data-argosy-view=ScheduledReports]"};ScheduledReports.prototype.CompanyId=null;ScheduledReports.prototype.SiteId=null;ScheduledReports.prototype.searchCriteria={};ScheduledReports.prototype.refineSearch=function(a){var b=this;b.searchCriteria=a;b.setupGrid()};ScheduledReports.prototype.properties={SelectedUserIds:[],SelectedReportIds:[],AdditionalEmails:[]};ScheduledReports.prototype.setupGrid=function(){var c=this;if(!c.Init){c.getScheduleDropDowns();c.Init=true}if($(c.options.gridViewSelector).getKendoGrid()==null){var b={scrollable:false,editable:false,autoBind:true,dataSource:c.getDataSource({}),groupable:false,sortable:true,selectable:"multiple, row",exportToExcel:false,pageable:{refresh:true,pageSizes:[50,100,500],buttonCount:5},columns:[{title:" ",template:"<div class='text-center'><a title='Remove'><i class='fa fa-trash-o'></i></a></div>"},{title:" ",template:"<div class='text-center'><a title='Edit'><i class='fa fa-edit'></a></i></div>"},{title:" ",template:"<div id='RunSchedule' class='textl'>#if(Active){#<a><b><i id='IconRunning' class='fa fa-pause' title='Stop'></i></b></a>#}else{# <a><b><i id='IconRunning' class='fa fa-play' title='Start'></i></b></a> #}#</div>"},{template:"<div id='ScheduleStatus' class='textl'>#if(Active){#<b>Running <i id='IconRunning' class='fa fa-refresh fa-spin'></i></b>#}else{# <b>~{Stopped}~ <i id='IconRunning' class='fa fa-refresh fa-stop'></i></b> #}#</div>"},{title:"~{Name}~",template:"<a class='reportSchedule'>${ReportScheduleName}</a>"},{title:"~{Frequency}~",template:"#= Frequency=='D'?'~{Daily}~':Frequency=='M'?'~{Monthly}~':'~{Weekly}~' #"},{title:"~{TimeToRun}~",template:"#= TimeToRun=='M'?'~{Morning}~':TimeToRun=='A'?'~{Afternoon}~':'~{Evening}~' #"},{title:"~{DayOfMonth}~",template:"<div > #if(DayOfMonth > 0) {#   #= DayOfMonth # #}else{# - #}#  </div>"},{title:"~{LastRunDate}~",field:"LastRunDate",template:"#= (LastRunDate!=null) ? kendo.toString(kendo.parseDate(LastRunDate), 'MM/dd/yyyy') : 'Never Ran'#",width:"150px"},{title:"~{DateCreated}~",field:"DateCreated",template:'${kendo.toString(kendo.parseDate(DateCreated),"MM/dd/yyyy")}',width:"150px"}],checkboxes:false,dataBinding:function(d){},dataBound:function(f){var h=$(f.sender.element);var d=h.find(".k-button.k-button-icontext.k-grid-createSchedule");var g=h.getKendoGrid();d.unbind("click");d.click(function(e){c.clearControls();$.fancybox({href:"#createScheduleModal",autoSize:true})});h.find("tbody tr[role=row]").each(function(){var e=g.dataItem(this);var i=$(this).find(".fa.fa-trash-o").parent();i.unbind("click");i.click(function(){c.DeleteReportScheduleModal(e)});var l=$(this).find(".fa.fa-play").parent();l.unbind("click");l.click(function(){c.StartReport(e)});var k=$(this).find(".fa.fa-pause").parent();k.unbind("click");k.click(function(){c.StopReport(e)});var j=$(this).find(".fa.fa-edit").parent();j.unbind("click");j.click(function(){c.ShowEditReportScheduleModal(e)});var m=$(this).find(".reportSchedule").parent();m.unbind("click");m.click(function(){c.ShowReportScheduleDetailModal(e)})});$("div[data-argosy-view=ScheduledReports] th:eq(5) ,div[data-argosy-view=ScheduledReports]  tr td:nth-child(6)").addClass(" hidden-xs");$("div[data-argosy-view=ScheduledReports] th:eq(6) ,div[data-argosy-view=ScheduledReports]  tr td:nth-child(7)").addClass("hidden-xs");$("div[data-argosy-view=ScheduledReports] th:eq(7),div[data-argosy-view=ScheduledReports]  tr td:nth-child(8)").addClass("hidden-sm hidden-xs");$("div[data-argosy-view=ScheduledReports] th:eq(8),div[data-argosy-view=ScheduledReports]  tr td:nth-child(9)").addClass("hidden-sm hidden-xs");$("div[data-argosy-view=ScheduledReports] th:eq(9),div[data-argosy-view=ScheduledReports]  tr td:nth-child(10)").addClass("hidden-sm hidden-xs");$("div[data-argosy-view=ScheduledReports] th:eq(10),div[data-argosy-view=ScheduledReports]  tr td:nth-child(11)").addClass("hidden-sm hidden-xs")},toolbar:[{name:"createSchedule",text:"<i class='fa fa-plus'></i><span class='resp-hidden'> ~{CreateSchedule}~</span>"}]};$(c.options.gridViewSelector).kendoArgosyGrid(b)}else{var a=$(c.options.gridViewSelector).getKendoGrid();a.dataSource.read();a.refresh()}};ScheduledReports.prototype.DeleteReportScheduleModal=function(c){var d=this;var a=false;var b={question:"",description:"",button:"",type:"warning",yes:function(f){if(!a){d.DeleteReportSchedule(c);a=true}}};b.question="Do you want to delete the selected report ?";b.description="Deleted Report cannot be restored.";b.button="Delete";prompt.alert(b)};ScheduledReports.prototype.DeleteReportSchedule=function(b){var c=this;var a={reportSchedule:b};$.ajax({url:"/Admin/Reports/DeleteScheduledReport",type:"POST",data:JSON.stringify(a),dataType:"json",traditional:true,contentType:"application/json; charset=utf-8",success:function(e){if(e.ReturnCode==ReturnCode.Success){$(e.Records).each(function(){prompt.notify({question:"Report "+this.Key+" was "+(!this.Value?"":"not")+" successfully deleted.",type:(!this.Value?"success":"error")})})}else{prompt.clientResponseError(e)}var d=$(c.options.gridViewSelector).getKendoGrid();d.dataSource.read();d.refresh(true)}});$.fancybox.close()};ScheduledReports.prototype.StartReport=function(b){var c=this;b.Active=true;var a={reportSchedule:b};$.ajax({url:"/Admin/Reports/UpdateReportSchedule",type:"POST",data:JSON.stringify(a),dataType:"json",traditional:true,contentType:"application/json; charset=utf-8",success:function(e){if(e.ReturnCode==ReturnCode.Success){prompt.notify({question:"Report schedule was successfully started.",type:"success"})}else{prompt.clientResponseError(e)}var d=$(c.options.gridViewSelector).getKendoGrid();d.dataSource.read();d.refresh(true)}})};ScheduledReports.prototype.StopReport=function(b){var c=this;b.Active=false;var a={reportSchedule:b};$.ajax({url:"/Admin/Reports/UpdateReportSchedule",type:"POST",data:JSON.stringify(a),dataType:"json",traditional:true,contentType:"application/json; charset=utf-8",success:function(e){if(e.ReturnCode==ReturnCode.Success){prompt.notify({question:"Report schedule was successfully stopped.",type:"success"})}else{prompt.clientResponseError(e)}var d=$(c.options.gridViewSelector).getKendoGrid();d.dataSource.read();d.refresh(true)}})};ScheduledReports.prototype.getSelectedItems=function(){var c=this;var b=[];var a=$(c.options.gridViewSelector).getKendoGrid();$(a.select()).each(function(d){b.push(a.dataItem(this))});return b};ScheduledReports.prototype.getDataSource=function(a){var b=this;$.extend(true,b.dataSourceOpts,_defaultDataSourceConfig,a);b.dataSourceOpts.transport={read:function(c){var d={};$.extend(true,d,kendoOptionsToObject(c),b.searchCriteria);$.ajax({url:"/DataView/GetScheduledReports",dataType:"json",data:d,success:function(e){if(e.ReturnCode==ReturnCode.Failed){handleDataSourceException(e)}else{c.success(e)}}})}};return new kendo.data.DataSource(b.dataSourceOpts)};ScheduledReports.prototype.dataSourceOpts={};ScheduledReports.prototype.getScheduleDropDowns=function(){var d=[{value:"M",text:"Morning"},{value:"A",text:"Afternoon"},{value:"E",text:"Evening"}];var b=[{value:"M",text:"Monthly"},{value:"W",text:"Weekly"},{value:"D",text:"Daily"}];var a=[{value:"1",text:"1"},{value:"2",text:"2"},{value:"3",text:"3"},{value:"4",text:"4"},{value:"5",text:"5"},{value:"6",text:"6"},{value:"7",text:"7"},{value:"8",text:"8"},{value:"9",text:"9"},{value:"10",text:"10"},{value:"11",text:"11"},{value:"12",text:"12"},{value:"13",text:"13"},{value:"14",text:"14"},{value:"15",text:"15"},{value:"16",text:"16"},{value:"17",text:"17"},{value:"18",text:"18"},{value:"19",text:"19"},{value:"20",text:"20"},{value:"21",text:"21"},{value:"22",text:"22"},{value:"23",text:"23"},{value:"24",text:"24"},{value:"25",text:"25"},{value:"26",text:"26"},{value:"27",text:"27"},{value:"28",text:"28"},{value:"29",text:"29"},{value:"30",text:"30"},{value:"31",text:"31"}];var e=[{value:"1",text:"Monday"},{value:"2",text:"Tuesday"},{value:"3",text:"Wednesday"},{value:"4",text:"Thursday"},{value:"5",text:"Friday"},{value:"6",text:"Saturday"},{value:"7",text:"Sunday"}];var c=[{value:"Yes",text:"Yes"},{value:"No",text:"No"}];$("#ddlFrequency").kendoDropDownList({optionLabel:"Select Frequency",dataTextField:"text",dataValueField:"value",dataSource:b,change:function(){if(this.value()=="M"){$("#divDayOftheMonth").removeClass("hide");$("#divDayOftheWeek").addClass("hide")}else{if(this.value()=="W"){$("#divDayOftheWeek").removeClass("hide");$("#divDayOftheMonth").addClass("hide")}else{$("#divDayOftheMonth").addClass("hide");$("#divDayOftheWeek").addClass("hide")}}}});$("#ddlTimeOfDay").kendoDropDownList({optionLabel:"Select Time of the Day",dataTextField:"text",dataValueField:"value",dataSource:d});$("#ddlDayOfMonth").kendoDropDownList({optionLabel:"Select Day of the Month",dataTextField:"text",dataValueField:"value",dataSource:a});$("#ddlWeekDays").kendoDropDownList({optionLabel:"Select Day of the Week",dataTextField:"text",dataValueField:"value",dataSource:e});$("#ddlSupressReports").kendoDropDownList({dataTextField:"text",dataValueField:"value",dataSource:c})};ScheduledReports.prototype.continueToReports=function(){var a=this;a.loadReports();$.fancybox({href:"#selectReportModal"})};ScheduledReports.prototype.loadReports=function(){var c=this;var a=new kendo.data.DataSource({serverPaging:true,serverFiltering:true,pageSize:5,schema:{data:"Records",total:"TotalRecords"},transport:{read:{url:"/Admin/Reports/GetReportsToSchedule",type:"POST",contentType:"application/json"},parameterMap:function(d){var e=new Object();if(d.filter!=null){e.Keyword=d.filter.filters[0].value}if(c.properties.SelectedReportIds.length>0){e.ReportConfigIds=c.properties.SelectedReportIds}e.Take=20;d.search=e;return JSON.stringify(d)}}});var b;if($("#grdReports").getKendoMultiSelect()==null||$("#grdReports").getKendoMultiSelect==undefined){b=$("#grdReports").kendoMultiSelect({placeholder:"Search By Report Name...",dataTextField:"ReportViewName",dataValueField:"ReportConfigId",headerTemplate:'<div class="dropdown-header k-widget k-header bkg-gray row"><div class="col-sm-4 upcase"><center><b>Report View</b></center></div><div class="col-sm-8 upcase"><center><b>Report Name</b></center></div></div>',itemTemplate:'<div class="row clear clearfix"><div class="k-state-default col-sm-4"><b>#: data.ReportName #</b></div><div class"col-sm-8">#: data.ReportViewName #</div>',tagTemplate:'<span class="selected-value"></span><span>#:data.ReportName# (#: data.ReportViewName #)</span>',autoWidth:true,dataSource:a,filter:"startswith",minLength:3,value:c.properties.SelectedReportIds,change:function(){c.properties.SelectedReportIds=[];var d=this._old;$.each(d,function(e){if(this!=null&&this!=""&&this>0){c.properties.SelectedReportIds.push(d[e])}e++})}})}else{b=$("#grdReports").data("kendoMultiSelect");b.setDataSource(a);b.value(c.properties.SelectedReportIds)}};ScheduledReports.prototype.continueToReportSchedule=function(){var a=this;$.fancybox({href:"#createScheduleModal"})};ScheduledReports.prototype.loadUsers=function(){var a=this;var b=new kendo.data.DataSource({serverPaging:true,serverFiltering:true,pageSize:5,schema:{data:"Records",total:"TotalRecords"},transport:{read:{url:"/Admin/Users/GetCompanyUsers",type:"POST",contentType:"application/json"},parameterMap:function(d){var e=new Object();e.Active="Y";e.Take=20;if(a.properties.SelectedUserIds.length>0){e.IncludeUserIds=a.properties.SelectedUserIds}if(d.filter!=null&&d.filter.filters[0]!=null){e.FullName=d.filter.filters[0].value}d.search=e;return JSON.stringify(d)}}});var c;if($("#grdUsers").getKendoMultiSelect()==null||$("#grdUsers").getKendoMultiSelect==undefined){c=$("#grdUsers").kendoMultiSelect({placeholder:"Search User By First, Last or Username...",dataTextField:"FullName",dataValueField:"UserId",headerTemplate:'<div class="dropdown-header k-widget k-header"><span>Full Name</span><span>Username</span></div>',itemTemplate:'<span class="k-state-default"><h3>#: data.FullName #</h3><p>#: data.Username #</p></span>',tagTemplate:'<span class="selected-value"></span><span>#:data.FullName#(#: data.Username #)</span>',dataSource:b,filter:"startswith",minLength:3,value:a.properties.SelectedUserIds,change:function(){a.properties.SelectedUserIds=[];var d=this._old;$.each(d,function(e){if(this!=null&&this!=""&&this>0){a.properties.SelectedUserIds.push(d[e])}e++})}})}else{c=$("#grdUsers").data("kendoMultiSelect");c.setDataSource(b);c.value(a.properties.SelectedUserIds)}};ScheduledReports.prototype.continueToUserSelection=function(){var a=this;a.loadUsers();$.fancybox({href:"#selectUserModal"})};ScheduledReports.prototype.continueToAdditionalEmail=function(){var c=this;if($("#grdAdditionalEmails").getKendoGrid()==null||$("#grdAdditionalEmails").getKendoGrid()==undefined){var b={dataSource:{data:c.properties.AdditionalEmails,schema:{id:"id",model:{fields:{Email:{type:"string"}}}}},columns:[{field:"Email",title:"Email(s)"}],scrollable:false,sortable:false,dataBound:function(f){$.fancybox({href:"#additionalEmailModal"});var g=f.sender;if(g.dataSource.total()==0){var d=g.columns.length;$(f.sender.wrapper).find("tbody").append('<tr class="kendo-data-row"><td colspan="'+d+'" class="no-data">No Email Address Found</td></tr>')}}};$("#grdAdditionalEmails").kendoGrid(b)}else{var a=$("#grdAdditionalEmails").getKendoGrid();a.dataSource.data(c.properties.AdditionalEmails);a.refresh()}};ScheduledReports.prototype.saveAdditionalEmails=function(b){var d=this;var a=d.properties.AdditionalEmails.length+1;d.properties.AdditionalEmails.push({id:a,Email:b});var c=$("#grdAdditionalEmails").getKendoGrid();c.dataSource.data(d.properties.AdditionalEmails);c.refresh()};ScheduledReports.prototype.saveReportSchedule=function(){var c=this;var b=new Object();b.ReportScheduleName=$("#txtScheduleName").val();b.ReportScheduleId=$("#txtScheduleName").attr("ReportScheduleId");b.Frequency=$("#ddlFrequency").getKendoDropDownList().value();b.TimeToRun=$("#ddlTimeOfDay").getKendoDropDownList().value();if(b.Frequency=="M"){b.DayOfMonth=$("#ddlDayOfMonth").getKendoDropDownList().value()}else{if(b.Frequency=="W"){b.DayOfMonth=$("#ddlWeekDays").getKendoDropDownList().value()}}b.FlagSendEmptyReport=$("#ddlSupressReports").getKendoDropDownList().value()=="Yes";if(c.properties.SelectedReportIds.length>0){b.ReportConfigIds=c.properties.SelectedReportIds}else{b.ReportConfigIds=[]}if(c.properties.SelectedUserIds.length>0){b.RecepientUserIds=c.properties.SelectedUserIds.join(", ")}else{b.RecepientUserIds=""}if(c.properties.AdditionalEmails.length>0){b.RecepientEmailAddresses=$.map(c.properties.AdditionalEmails,function(d){return d.Email}).join(", ")}else{b.RecepientEmailAddresses=""}var a={reportSchedule:b};$.ajax({url:"/Admin/ReportSchedules/SaveReportSchedule",type:"POST",contentType:"application/json; charset=utf-8",data:JSON.stringify(a),cache:false,processData:false,success:function(e){if(e.ReturnCode==ReturnCode.Success){prompt.notify({question:"Report schedule '"+e.Records.Key+"' saved successfully.",type:(!e.Records.Value?"success":"error")});var d=$(c.options.gridViewSelector).getKendoGrid();d.dataSource.read();d.refresh()}else{prompt.alert({question:e.Message,description:"Ref: "+e.Guid,type:"warning",yes:function(f){$.fancybox.close()}})}$.fancybox.close()}})};ScheduledReports.prototype.clearControls=function(){var a=this;$("#txtScheduleName").val("");if($("#ddlFrequency").getKendoDropDownList()!=null||$("#ddlFrequency").getKendoDropDownList()!=undefined){$("#ddlFrequency").getKendoDropDownList().value("")}if($("#ddlTimeOfDay").getKendoDropDownList()!=null||$("#ddlTimeOfDay").getKendoDropDownList()!=undefined){$("#ddlTimeOfDay").getKendoDropDownList().value("")}if($("#ddlDayOfMonth").getKendoDropDownList()!=null||$("#ddlDayOfMonth").getKendoDropDownList()!=undefined){$("#ddlDayOfMonth").getKendoDropDownList().value("")}if($("#ddlWeekDays").getKendoDropDownList()!=null||$("#ddlWeekDays").getKendoDropDownList()!=undefined){$("#ddlWeekDays").getKendoDropDownList().value("")}if($("#ddlSupressReports").getKendoDropDownList()!=null||$("#ddlSupressReports").getKendoDropDownList()!=undefined){$("#ddlSupressReports").getKendoDropDownList().value("Yes")}if($("#grdReports").getKendoMultiSelect()!=null|$("#grdReports").getKendoMultiSelect()!=undefined){$("#grdReports").getKendoMultiSelect().dataSource.data([])}if($("#grdUsers").getKendoMultiSelect()!=null|$("#grdUsers").getKendoMultiSelect()!=undefined){$("#grdUsers").getKendoMultiSelect().dataSource.data([])}if($("#grdAdditionalEmails").getKendoGrid()!=null|$("#grdAdditionalEmails").getKendoGrid()!=undefined){$("#grdAdditionalEmails").getKendoGrid().dataSource.data([])}a.properties.SelectedUserIds=[];a.properties.SelectedReportIds=[];a.properties.AdditionalEmails=[]};ScheduledReports.prototype.ShowEditReportScheduleModal=function(a){var b=this;b.clearControls();b.loadControls(a);$.fancybox({href:"#createScheduleModal"})};ScheduledReports.prototype.loadControls=function(a){var i=this,e=$("#ddlTimeOfDay").getKendoDropDownList(),c=$("#ddlFrequency").getKendoDropDownList(),j=$("#txtScheduleName"),b=$("#ddlDayOfMonth").getKendoDropDownList(),h=$("#divDayOftheWeek"),g=$("#divDayOftheMonth"),f=$("#ddlWeekDays").getKendoDropDownList(),d=$("#ddlSupressReports").getKendoDropDownList();j.val(a.ReportScheduleName).attr("ReportScheduleId",a.ReportScheduleId);if(c!=null||c!=undefined){c.value(a.Frequency)}if(e!=null||e!=undefined){e.value(a.TimeToRun)}if(a.Frequency=="M"&&(b!=null||b!=undefined)){b.value(a.DayOfMonth);h.addClass("hide");g.removeClass("hide")}if(a.Frequency=="W"&&(f!=null||f!=undefined)){f.value(a.DayOfMonth);h.removeClass("hide");g.addClass("hide")}if(d!=null||d!=undefined){d.value(a.FlagSendEmptyReport?"Yes":"No")}if(a.ReportConfigIds!=null&&a.ReportConfigIds.length>0){if(a.ReportConfigIds.length>0){$.each(a.ReportConfigIds,function(m){i.properties.SelectedReportIds.push(a.ReportConfigIds[m])})}}if(a.RecepientUserIds!=null&&a.RecepientUserIds!=""){var l=a.RecepientUserIds.split(",");if(l.length>0){$.each(l,function(m){i.properties.SelectedUserIds.push(l[m])})}}if(a.RecepientEmailAddresses!=null&&a.RecepientEmailAddresses!=""){var k=a.RecepientEmailAddresses.split(",");if(k.length>0){$.each(k,function(m){i.properties.AdditionalEmails.push({id:m+1,Email:k[m]})})}}};ScheduledReports.prototype.ShowReportScheduleDetailModal=function(c){var q=this;if($("#grdUsersInSchedule").find(".k-collapse-grid").getKendoGrid()!=null&&$("#grdUsersInSchedule").find(".k-collapse-grid").getKendoGrid()!=undefined){$("#grdUsersInSchedule").find(".k-collapse-grid").getKendoGrid().destroy();$("#grdUsersInSchedule").empty()}if($("#grdAdditionalEmailsInSchedule").find(".k-collapse-grid").getKendoGrid()!=null&&$("#grdAdditionalEmailsInSchedule").find(".k-collapse-grid").getKendoGrid()!=undefined){$("#grdAdditionalEmailsInSchedule").find(".k-collapse-grid").getKendoGrid().destroy();$("#grdAdditionalEmailsInSchedule").empty()}if($("#grdReportInSchedule").find(".k-collapse-grid").getKendoGrid()!=null&&$("#grdReportInSchedule").find(".k-collapse-grid").getKendoGrid()!=undefined){$("#grdReportInSchedule").find(".k-collapse-grid").getKendoGrid().destroy();$("#grdReportInSchedule").empty()}$("#lblScheduleName").html(c.ReportScheduleName);var g=c.Frequency=="M"?"Monthly":(c.Frequency=="D"?"Daily":"Weekly");$("#lblFrequency").html(g);var r=c.TimeToRun=="M"?"Morning":(c.TimeToRun=="A"?"Afternoon":"Evening");$("#lblTimeOfDay").html(r);if(c.Frequency=="M"){$("#lblDayOfMonth").html(c.DayOfMonth);$("#divLblDayOftheMonth").removeClass("hide")}else{$("#divLblDayOftheMonth").addClass("hide")}if(c.Frequency=="W"){$("#lblDayOfWeek").html(c.DayOfMonth);$("#divLblDayOftheWeek").removeClass("hide")}else{$("#divLblDayOftheWeek").addClass("hide")}var p=c.FlagSendEmptyReport?"Yes":"No";$("#lblSuppressReports").html(p);var k=c.LastRunDate==null?"Never Ran":kendo.toString(kendo.parseDate(c.LastRunDate),"MM/dd/yyyy h:mm:ss tt");$("#lblLastRunDate").html(k);var d=kendo.toString(kendo.parseDate(c.DateCreated),"MM/dd/yyyy h:mm:ss tt");$("#lblDateCreated").html(d);var f=[];if(c.RecepientEmailAddresses!=null&&c.RecepientEmailAddresses!=""){var a=c.RecepientEmailAddresses.split(",");$.each(a,function(u){f.push({id:u+1,Email:a[u]})})}var e=new kendo.data.DataSource({data:f,pageSize:5,schema:{id:"id",model:{fields:{Email:{type:"string"}}}}});if($("#grdAdditionalEmailsInSchedule").find(".k-collapse-grid").getKendoGrid()==null||$("#grdAdditionalEmailsInSchedule").find(".k-collapse-grid").getKendoGrid()==undefined){var l={scrollable:false,editable:false,exportToExcel:false,dataSource:e,columns:[{field:"Email",title:"Email"}],groupable:false,sortable:false,pageable:{refresh:true,pageSizes:[50,100,500],buttonCount:5},title:"Additional Emails"};$("#grdAdditionalEmailsInSchedule").kendoCollapseGrid(l)}else{var h=$("#grdAdditionalEmailsInSchedule").find(".k-collapse-grid").getKendoGrid();h.dataSource.read();h.refresh()}var o=new kendo.data.DataSource({serverPaging:true,pageSize:5,schema:{data:"Records",total:"TotalRecords"},transport:{read:{url:"/Admin/Reports/GetReportsByConfigIds",type:"POST",contentType:"application/json"},parameterMap:function(u){var v=new Object();if(c.ReportConfigIds.length>0){v.ReportConfigIds=c.ReportConfigIds}v.Take=5;u.search=v;return JSON.stringify(u)}}});if($("#grdReportInSchedule").find(".k-collapse-grid").getKendoGrid()==null||$("#grdReportInSchedule").find(".k-collapse-grid").getKendoGrid()==undefined){var m={scrollable:false,editable:false,exportToExcel:false,dataSource:o,columns:[{field:"ReportViewName",title:"Report Name"}],groupable:false,sortable:true,pageable:{refresh:true,pageSizes:[50,100,500],buttonCount:5},title:"Reports in Schedule"};$("#grdReportInSchedule").kendoCollapseGrid(m)}else{var i=$("#grdReportInSchedule").find(".k-collapse-grid").getKendoGrid();i.dataSource.read();i.refresh()}var s=[];if(c.RecepientUserIds.length>0){var b=c.RecepientUserIds.split(",");$.each(b,function(u){if(b[u].trim()!=""){s.push(b[u])}})}var t=new kendo.data.DataSource({serverPaging:true,pageSize:5,schema:{data:"Records",total:"TotalRecords"},transport:{read:{url:"/Admin/Users/GetReportScheduleUsers",type:"POST",contentType:"application/json"},parameterMap:function(u){var v=new Object();v.Active="Y";v.Take=5;if(s.length>0){v.IncludeUserIds=s}u.search=v;return JSON.stringify(u)}}});if($("#grdUsersInSchedule").find(".k-collapse-grid").getKendoGrid()==null||$("#grdUsersInSchedule").find(".k-collapse-grid").getKendoGrid()==undefined){var n={scrollable:false,editable:false,exportToExcel:false,dataSource:t,columns:[{field:"FullName",title:"Name"}],groupable:false,sortable:true,pageable:{refresh:true,pageSizes:[50,100,500],buttonCount:5},title:"Distribution List Users"};$("#grdUsersInSchedule").kendoCollapseGrid(n)}else{var j=$("#grdReportInSchedule").find(".k-collapse-grid").getKendoGrid();j.dataSource.read();j.refresh()}$.fancybox({href:"#scheduleDetailModal"})};function Search(a){var b=this;$.extend(true,b.options,b.baseOptions,a);b.addSearchFeatures();b.addSearchStyling();b.addSearchEvents()}Search.prototype.options={};Search.prototype.baseOptions={searchContainerSelector:"div[data-argosy-control=Search]"};Search.prototype.setFormSubmit=function(a){var b=this;if(a.keyCode==13){$(document).trigger(argosyEvents.SEARCH_PAGE_GRID,b.getSearchObject());if(a.preventDefault()){a.preventDefault()}else{a.returnValue=false}}a.returnValue=true};Search.prototype.addSearchFeatures=function(){var d=this;var b=$(d.options.searchContainerSelector);var a=b.find("*[data-argosy-search]");var c=false;$(a).each(function(e){var f=$(this);if(!c&&f.attr("data-argosy-type")==="advanced"){c=true}});b.before(d.buildShowSearchLink());b.prepend(d.buildSearchHeader());b.after(d.buildHideSearchLink());b.after(d.buildSearchButton());b.find("div:last").after(d.buildAdvancedSearchLink(c));b.find("div:last").after(d.buildBasicSearchLink(a))};Search.prototype.buildSearchHeader=function(){var b=this;var a=$("<h4 />",{"class":"text-center",text:"~{Search}~"});return a};Search.prototype.buildAdvancedSearchLink=function(c){var e=this;var d=c?"show":"hide";var a=$("<div />",{"class":"padb5 showAdvancedSearch finger "+d});var b=$("<a />",{html:"<i class='fa fa-chevron-circle-down'></i> ~{AdvancedSearch}~"});a.append(b);return a};Search.prototype.buildBasicSearchLink=function(){var c=this;var a=$("<div />",{"class":"padb5 hideAdvancedSearch finger hide"});var b=$("<a />",{html:"<i class='fa fa-chevron-circle-up'></i> Basic Search"});a.append(b);return a};Search.prototype.buildSearchButton=function(){var c=this;var a=$("<div />",{"class":"search-grid-btn finger"});var b=$("<a />",{"class":"btn btn-primary btn-block",text:"~{Search}~"});a.append(b);return a};Search.prototype.buildHideSearchLink=function(){var c=this;var a=$("<div />",{"class":"padu10 hideSearchCriteria finger show"});var b=$("<a />",{html:"<i class='fa fa-chevron-circle-left'></i> ~{HideSearchCriteria}~"});a.append(b);return a};Search.prototype.buildShowSearchLink=function(){var c=this;var a=$("<div />",{"class":"padu10 hide finger showSearchCriteria"});var b=$("<a />",{html:"<i class='fa fa-chevron-circle-right'></i> ~{ShowSearchCriteria}~"});a.append(b);return a};Search.prototype.addSearchStyling=function(){var c=this;var b=$(c.options.searchContainerSelector);var a=b.find("*[data-argosy-search]");b.addClass("search-grid");$(a).each(function(e){var f=$(this);f.unbind("keypress");f.keypress(function(g){c.setFormSubmit(g)});var d=f.parent();if(e==0){d.addClass("padu10")}if(f.attr("data-argosy-type")==="advanced"){d.hide()}d.addClass("padb5")})};Search.prototype.addSearchEvents=function(){var h=this;var e=$(h.options.searchContainerSelector);var d=e.parent().find(".search-grid-btn");var c=e.find("*[data-argosy-search]");var g=e.parent().find(".showSearchCriteria");var b=e.parent().find(".hideSearchCriteria");var f=e.parent().find(".showAdvancedSearch");var a=e.parent().find(".hideAdvancedSearch");d.click(function(i){$(document).trigger(argosyEvents.SEARCH_PAGE_GRID,h.getSearchObject())});f.on("click",function(){$(c).each(function(j){var k=$(this);var i=k.parent();if(k.attr("data-argosy-type")==="advanced"){i.show()}});f.hide();a.show()});a.on("click",function(){$(c).each(function(j){var k=$(this);var i=k.parent();if(k.attr("data-argosy-type")==="advanced"){i.hide()}});f.show();a.hide()});b.click(function(i){e.hide();g.show();b.hide();d.hide();e.parent().parent().find(".col-sm-10").removeClass("col-sm-10 padl20").addClass("col-sm-12")});g.click(function(i){e.show("slow");b.show();g.hide();d.show();e.parent().parent().find(".col-sm-12").removeClass("col-sm-12").addClass("col-sm-10 padl20")})};Search.prototype.getSearchObject=function(){var d=this;var b=$(d.options.searchContainerSelector);var a=b.find("*[data-argosy-search]");var c={};$(a).each(function(e){var f=$(this);var g=f.attr("data-argosy-search");c[g]=d.getInputData(f)});return c};Search.prototype.getInputData=function(b){var c=null;if(b.getKendoDatePicker()!=null){var e=b.getKendoDatePicker().value();if(e!=null){c=e.toJSON()}}else{var d="";if(b.is("input")){d=b.attr("type").toLowerCase()}switch(d){case"checkbox":case"radio":c=b.is(":checked");break;default:var a=b.val();if(b.data("getValue")!=undefined){a=b.data("getValue")()}if(a!=""&&a!=null){c=a}break}}if(c!=null&&(typeof c)=="string"&&c.toLowerCase()=="null"){c=null}return c};function ShoppingCartSavedView(b){var c=this;$.extend(true,c.options,c.baseOptions,b);var a=new ControlLoader();a.loadControl("ModalProductDetail",{},function(d){c.productDetailControl=d});a.loadControl("ModalProductUsage",{},function(d){c.productUsageControl=d});a.loadControl("ModalProductViewingRights",{},function(d){c.productViewingRightsControl=d});a.loadControl("ModalPartConfiguration",{},function(d){c.productConfigurationControl=d});c.setupEventListeners();a.loadTemplate("ShoppingCartSavedView",function(g){$(document.body).append(g);var d=$(c.options.ShoppingCartSavedViewTemplate).html();var e=kendo.template(d);var f=e({isMailingList:false,isThirdPartyList:false,mailingListCost:0,mailingListCostText:"",thirdPartyListCost:0,thirdPartyListCostText:"",isDiscount:false,discountCost:0,discountCostText:""});$("*[data-argosy-uuid='"+c.options.uuid+"']").append(f);c.setupLoadingAttributes();c.setupEvents();c.initialze();c.loaded=true;$(document).trigger(c.EVENT_TEMPLATE_LOADED)})}ShoppingCartSavedView.prototype.options={};ShoppingCartSavedView.prototype.baseOptions={shoppingCartBuilderView:"div[data-argosy-control=ShoppingCartSavedView]",ShoppingCartSavedViewTemplate:"#_ShoppingCartSavedViewTemplate",shoppingCartBindSection:"#_SavedShopingCartBindSection",shoppingCartGridHref:"#_SavedShoppingCartGrid",shoppingCartGridRowTempalte:"#_SavedShoppingCartRowViewTemplate",cartContainer:"#_savedCartContainer",emptyCartSelector:".empty-cart-parent-saved",};ShoppingCartSavedView.prototype.EVENT_TEMPLATE_LOADED="TEMPLATE_SAVED_SHOPPING_CART_VIEW_LOADED";ShoppingCartSavedView.prototype.productDetailControl=null;ShoppingCartSavedView.prototype.cartViewModel=null;ShoppingCartSavedView.prototype.setupLoadingAttributes=function(){var b=this;var a=$("*[data-argosy-uuid='"+b.options.uuid+"']");appendLoadingAttribute(a,b.constructor.name);a.attr("data-argosy-loading-message","~{MsgUpdadingSavedCart}~")};ShoppingCartSavedView.prototype.setupEvents=function(){var a=this;$(document).bind(argosyEvents.EVENT_CARTLINE_SAVED_FOR_LATER,function(b){if($(a.options.emptyCartSelector).hasClass("hidden")){a.cartViewModel.cartSource.read()}else{a.initialze()}});$(document).bind(argosyEvents.SHOW_PART_USAGE_MODAL,function(c,b){if(a.productUsageControl!=null){a.productUsageControl.show(parseInt(b.partId));$(a.options.historyTitleElment).html(b.partName+" - ~{PartHistory}~")}});$(document).bind(argosyEvents.SHOW_VIEWING_RIGHTS_MODAL,function(c,b){if(a.productViewingRightsControl!=null){a.productViewingRightsControl.init(b)}});$(document).bind(argosyEvents.SHOW_PART_CONFIGURATION_MODAL,function(b,d){if(a.productConfigurationControl!=null){var c=a.getPart(d);a.productConfigurationControl.show(c)}});$(document).bind(argosyEvents.SHOW_PART_QUANTITY_MODAL,function(b,d){var c=a.getPart(d);showPartQuantityModal(c)})};ShoppingCartSavedView.prototype.parts=[];ShoppingCartSavedView.prototype.getPart=function(e){var f=this,d=null;if(f.parts!=null){var c=f.parts.length;for(var a=0;a<c;a++){var b=f.parts[a];if(b.PartId===e){d=b;break}}}return d};ShoppingCartSavedView.prototype.initialze=function(){var b=this,a=new kendo.data.DataSource({error:function(c){console.log("Error in datasource see below:");console.log(c)},schema:{data:function(c){return c.CartLines},total:function(c){if(c.CartLines==null){return 0}return c.CartLines.length}},transport:{read:{url:"/store/cart/GetCartLines?isSaveForLater="+true,dataType:"json"}},requestEnd:function(c){if(c.hasOwnProperty("response")){var f=[],d=[];if(c.response.CartLines.length>0){$(document).trigger(argosyEvents.START_LOADING,{name:b.constructor.name});b.cartViewModel.showWarningAboutApprovalWorkflow=c.response.ShowWarningAboutApprovalWorkflow;b.cartViewModel.approvalWorkflowWarningMsg=c.response.ApprovalWarningMessage;$.each(c.response.CartLines,function(){var g=this,e=false;b.parts.push(g.Part);if(g.ParentPartId>0&&$.grep(d,function(h){return h===g.ParentPartId}).length===0){d.push(g.ParentPartId)}f.push(g.PartId);if(g.Part.IsEdeliveryOnly){g.IsEdelivery=true}if(g.Part.IsLimitPartOrderQuantity&&!g.IsMailingList){$.each(g.Part.Discounts,function(i){var h=this;if(h.Quantity===g.Quantity){e=true;return false}});if(e===false&&g.Part.Discounts.length>0){g.Quantity=g.Part.Discounts[0].Quantity}}g.ConfiguredParts=[]});if(d.length>0){b.cartViewModel.getRemoteParts(d,function(e){$(e).each(function(h,k){b.parts.push(k);f.push(k.PartId);var g=$.grep(c.response.CartLines,function(i){return i.ParentPartId===k.PartId});function l(i,m){return((i.PartId<m.PartId)?-1:((i.PartId>m.PartId)?1:0))}g.sort(l);var j=$.extend({},g[0],{Part:k,CartId:0,PartId:k.PartId,IsKit:false,Quantity:0,Price:0,UnitPrice:0,ParentPartId:0,ConfiguredParts:g,TotalConfiguredParts:0});$(g).each(function(m,i){j.Price+=i.Price;j.TotalConfiguredParts+=i.Quantity});c.response.CartLines=$.grep(c.response.CartLines,function(i){return i.ParentPartId!==k.PartId});c.response.CartLines.push(j)});b.cartViewModel.onDataProcessComplete(c.response.CartLines,f)})}else{b.cartViewModel.onDataProcessComplete(c.response.CartLines,f)}}else{b.cartViewModel.onDataProcessComplete(c.response.CartLines,f)}}}});b.cartViewModel=kendo.observable({showWarningAboutApprovalWorkflow:false,approvalWorkflowWarningMsg:"",partIds:[],cartLines:[],accountingUnits:[],cartSource:a,lines:[],isMailingList:false,mailingListCost:0,mailingListCostText:"",thirdPartyListCost:0,thirdPartyListCostText:"",subTotalText:"",isDiscount:false,discountCost:0,discountCostText:"",updateSubtotal:function(){var e=$(b.options.cartSubTotalSelector),d=0,c=this;e.html("Loading...");block(e,"",true);d=c.subTotal();e.html(d);$(e).unblock()},getTotalConfiguredParts:function(c){var d=$.grep(this.cartLines,function(f){return f.PartId===c.ParentPartId});var e=0;$(d).each(function(f){$(this.ConfiguredParts).each(function(g){e+=this.Quantity})});return e},onDataProcessComplete:function(c,d){b.showCartIf(d.length);b.cartViewModel.partIds=d;setTimeout(function(f){b.cartViewModel.setCartLines(c,true);if(userSettings.SaveAccountingUnitsToOrderLine){b.cartViewModel.getAccountingUnits()}addArgosyActions();$(document).trigger(argosyEvents.END_LOADING,{name:b.constructor.name})},250)},getRemoteParts:function(d,c){$.ajax({url:"/Store/Part/GetPartsById/",data:{ids:d},type:"GET",dataType:"json",contentType:"application/json; charset=utf-8",success:function(e){c(e)}})},getConfiguredPartName:function(c){var d=c.Part.PartName.replace(c.parent().parent().Part.PartName,"").trim();if(d.indexOf("-")===0){d=d.substring(1,d.length)}return d},getFormatedUnitPrice:function(c){return kendo.toString(c.UnitPrice,"C")},getFormatedPrice:function(c){return kendo.toString(c.Price,"C")},getFormatedDiscount:function(c){return"-"+kendo.toString(c.Discount,"C")},isDiscounted:function(c){return c.Discount>0},subTotal:function(){var d=this,c=d.get("cartLines"),e=0;$(c).each(function(){var f=this;e+=f.Price});e+=d.mailingListCost;e+=d.thirdPartyListCost;e-=d.discountCost;return kendo.toString(e,"C")},userSettings:b.getUserSettings(),setEdelivery:function(c){var d=this;c.data.IsEdelivery=true;c.data.PreviousQuantity=c.data.Quantity;c.data.Quantity=1;d.updateLine(c)},removeEdelivery:function(c){var d=this;c.data.IsEdelivery=false;if(c.data.PreviousQuantity!=null){c.data.Quantity=c.data.PreviousQuantity;c.data.PreviousQuantity=null}d.updateLine(c)},notAllConfiguredParts:function(c){return $.grep(this.cartLines,function(d){return d.ConfiguredParts!=null&&d.ConfiguredParts.length>0}).length!==this.cartLines.length},showToolTip:function(c){var g=$(c.currentTarget).getKendoTooltip(),d=c.data.Part,f=kendo.Template.compile($("#_PriceBreakGridViewtemplate").html())(d.Discounts);if(g==null){g=$(c.currentTarget).kendoTooltip({autoHide:false,content:f,position:"right",showOn:"click",show:function(h){if(d.showHighlight){var j=null;var i=$(h.sender.popup.element).find("table tbody tr");$(i).each(function(e,m){m=$(m);var l=m.attr("data-min-value");var k=m.attr("data-max-value");if(l<k&&d.highlightQuantity>=l&&d.highlightQuantity<=k){j=m}else{if(l<=d.highlightQuantity){j=m}}});j.addClass("k-state-selected")}}}).data("kendoTooltip");g.show()}},priceBreakSelectedValue:function(f){var c=f.Quantity,e=this,d=false;$.each(f.Part.Discounts,function(h){var g=this;if(g.Quantity===c){d=true;return false}});if(d===false){f.Quantity=f.Part.Discounts[0].Quantity}return f.Quantity},priceBreakDataBound:function(f){var c=$(f.sender.element),d=70;c.data("kendoDropDownList").list.width("auto");c.closest(".k-widget").width(d)},getUnitPriceFromPriceBreaks:function(c,e){var d=0;$(c).each(function(){var f=this;if(e<=f.Quantity){d=f.Discount;return false}});if(d===0){d=c[c.length-1].Discount}return d},dateCleaner:function(c){try{c=new Date(parseInt(c.replace(/\/Date\((.*?)\)\//gi,"$1")))}catch(d){}return c},priceBreakDropdownChange:function(f){var g=this,d=g.get("cartLines"),c=f.data;if(c.Part.IsLimitPartOrderQuantity&&!c.IsEdelivery&&c.Part.Discounts!=null&&c.Part.Discounts.length>0){var h=$("#priceBreakDropDown"+c.CartId).getKendoDropDownList().value();c.Quantity=parseInt(h)}g.setCartLines(d)},updateConfiguredPartQuantity:function(f,g,c){var h=this,d=h.get("cartLines"),e=null;$.each(d,function(j,i){if(i.CartId===c){e=i}else{$(i.ConfiguredParts).each(function(l,k){if(k.CartId===c){e=k}})}});if(e!=null){e.Quantity=g;if(e.Part.Discounts.length>0){e.UnitPrice=h.getUnitPriceFromPriceBreaks(e.Part.Discounts,e.Quantity)}e.Price=e.UnitPrice*e.Quantity}},updateLine:function(g){var h=this,d=h.get("cartLines"),c=g.data;c.DateCreated=h.dateCleaner(c.DateCreated);var f=$("#priceBreakDropDown"+c.CartId);if(c.Part.IsLimitPartOrderQuantity&&!c.IsEdelivery&&c.Part.Discounts!=null&&c.Part.Discounts.length>0&&f.length>0){var i=f.getKendoDropDownList().value();c.Quantity=parseInt(i)}if(c.Part.Discounts.length>0){c.UnitPrice=h.getUnitPriceFromPriceBreaks(c.Part.Discounts,c.Quantity);$('[data-cartline-id="'+c.CartId+'"]').text(kendo.toString(c.UnitPrice,"c"))}c.Price=c.UnitPrice*c.Quantity;h.setCartLines(d,true)},checkForEedlivery:function(c){if(c.IsEdelivery){return true}else{return false}},checkForPhysicalDelivery:function(c){if(c.IsEdelivery){return false}else{return true}},hiddenIfEdeliveryNotAllowed:function(c){if(c.Part.IsEdeliveryOnly){return true}else{if(c.Part.IsEdeliveryAllowed){return false}else{return true}}},hiddenIfKitWithoutPersonalizedItems:function(c){if(c.PersonalizedPartsInKit!==undefined&&c.PersonalizedPartsInKit!==null&&c.PersonalizedPartsInKit.length>0){return false}else{return true}},isConfiguredPart:function(c){return c.ConfiguredParts.length>0},isNotConfiguredPart:function(c){return c.ConfiguredParts.length===0},hideOverPartLimitMessage:function(c){var d=this,f=d.overPartLimit(c);if(f){return false}else{return true}},hideMaxOrderQty:function(c){var d=this,f=d.get("userSettings");if(f.IsMaxOrderQtyVisible){return false}return true},hideInventory:function(c){var d=this,f=d.get("userSettings");if(f.IsInventoryInformationVisible||c.ConfiguredParts.length>0){return false}return true},overPartLimit:function(d){var f=this,i=f.get("userSettings"),c=d,h=false,g=null;if(c.CurrentPartLimits!=null){g=c.CurrentPartLimits.OrderedPartLimit}if(i.ShowPartLimits){if(g!=null){if(g.LimitQty-g.TotalOrdered<=0){h=true}}}return h},noEdeliveryItems:function(d){var g=this,c=d,f=false;if(c==null){$.each(g.cartLines,function(e){if(!f){f=this.Part.IsEdeliveryAllowed||this.Part.IsEdeliveryOnly}})}else{f=c.Part.IsEdeliveryAllowed||c.Part.IsEdeliveryOnly}return !f},emptyCart:function(){var c=this,d={question:"You are about to remove all items in your cart, are you sure you want to continue?",description:"",button:"Clear Cart",type:"warning",yes:function(f){$.fancybox.close();$.ajax({url:"/store/cart/ClearCart",dataType:"json",type:"POST",contentType:"application/json; charset=utf-8",success:function(g){$(b.options.cartSubTotalSelector).html("");b.showCartIf(false);$(document).trigger(argosyEvents.ITEM_DELETED_FROM_CART)},error:function(){var e={message:"Unable to clear item(s), please contact support.",type:"error"};$(document).trigger(argosyEvents.PROMPT_NOTIFY,e)}})}};prompt.alert(d)},addSavedToCart:function(f){var e=this,c=f.data;var d=[c];if(c.ConfiguredParts!=null&&c.ConfiguredParts.length>0){d=c.ConfiguredParts}$.ajax({url:"/store/cart/MoveSavedCartlineToCart",dataType:"json",type:"POST",data:JSON.stringify({lines:d}),contentType:"application/json; charset=utf-8",complete:function(g){b.cartViewModel.cartSource.read();$(document).trigger(argosyEvents.EVENT_SAVED_CARTLINE_ADDED_TO_SHOPPING_CART)}})},deleteLine:function(h){var g=h.data.ParentPartId>0?h.data.parent().parent().parent().parent():this,c=h.data,e=g.get("cartLines");var f=e.indexOf(c);if(c.ParentPartId>0){var i=h.data.parent().parent();var d=i.ConfiguredParts.indexOf(c);f=e.indexOf(i);if(d>=0){e[f].ConfiguredParts.splice(d,1);e[f].Price-=c.Price}if(e[f].ConfiguredParts.length!==0){f=-1}}if(f>=0){e.splice(f,1)}g.setCartLines(e,true);$.ajax({url:"/store/cart/DeleteCartLine",dataType:"json",data:JSON.stringify(c),type:"POST",contentType:"application/json; charset=utf-8",success:function(j){var m=j.ReturnCode===ReturnCode.Success,k="Item deleted.",n="success";if(!m){k=j.Message;n="error"}var l={message:k,type:n};$(document).trigger(argosyEvents.ITEM_DELETED_FROM_CART);$(document).trigger(argosyEvents.PROMPT_NOTIFY,l);g.updateSubtotal()},error:function(){var j={message:"Unable to delete item, please contact support.",type:"error"};$(document).trigger(argosyEvents.PROMPT_NOTIFY,j)}})},goShopping:function(){window.location=$("#logo_header").attr("href")},personalizedKitItems:[],setCartLines:function(e,g){var d=this,f=0,h=0,c=0;d.set("cartLines",e);$(e).each(function(j,k){if(k.IsMailingList){f+=k.MailingListCost}if(k.IsThirdPartyList){h+=k.ThirdPartListCost}if(k.Discount>0){c+=k.Discount}});d.set("isMailingList",f>0);d.set("mailingListCostText",kendo.toString(f,"c"));d.set("mailingListCost",f);d.set("isThirdPartyList",h>0);d.set("isDiscount",c>0);d.set("discountCost",c);d.set("discountCostText","-"+kendo.toString(c,"c"));d.set("thirdPartyListCostText",kendo.toString(h,"c"));d.set("thirdPartyListCost",h);if(g){kendo.unbind($(b.options.shoppingCartBindSection));kendo.bind($(b.options.shoppingCartBindSection),d)}d.set("subTotalText",d.subTotal());addArgosyActions()},loadPartLimits:function(){var d=this,c=d.get("cartLines"),e=d.get("partIds");if(e.length>0){$.ajax({url:"/store/cart/GetPartLimits",dataType:"text json",data:JSON.stringify(e),type:"POST",contentType:"application/json; charset=utf-8",success:function(f){var g=false;$.each(f,function(){var h=this,i=h.PartId;$.each(c,function(){var j=this;if(j.PartId===i){g=true;j.CurrentPartLimits=new kendo.data.ObservableObject(h)}})});if(g===true){d.setCartLines(c)}}})}},getAccountingUnits:function(){var d=this,c=d.get("cartLines"),e={Take:50};$.ajax({url:"/DataView/GetAccountingUnits",dataType:"text json",data:JSON.stringify(e),type:"POST",contentType:"application/json; charset=utf-8",success:function(f){if(f.ReturnCode===ReturnCode.Success){if(f.TotalRecords>0){d.set("accountingUnits",new kendo.data.ObservableArray(f.Records));var g=false;$(c).each(function(h,j){if(j.AccountingUnitId===null){j.AccountingUnitId=f.Records[0].AccountingUnitId;g=true}});if(g===true){d.setCartLines(c)}}}}})},accountingUnitsChange:function(g){var h=this,d=h.get("cartLines"),f=g.sender,c=f.element.data("cartId"),i=f.value();$.each(d,function(j){if(this.CartId===c){this.AccountingUnitId=i;return false}});h.setCartLines(d)},accountingUnitsDataBound:function(g){var h=this,f=g.sender,d=h.get("cartLines"),c=f.element.data("cartId");var i=$.grep(d,function(e){return e.CartId===c});if(i.length>0&&i[0].AccountingUnitId!==null){f.value(i[0].AccountingUnitId)}else{if(f.select()===-1){f.select(0)}}},showProductDetails:function(c){if(b.productDetailControl!=null){b.productDetailControl.show(c.data);addArgosyActions()}},addProductToCart:function(c){var d={qty:1,partId:c.data.PartId};sendPartToCart(d,c.data.PartName)},getPart:function(f){var d=this,c=d.get("cartLines"),e=null;if(c.length>0){$.each(c,function(g){if(this.PartId===f){e=this.Part;return false}})}return e},flattenCartLines:function(c){var d=[];$(c).each(function(f){if(this.ConfiguredParts.length===0){d.push(this)}else{$(this.ConfiguredParts).each(function(g){d.push(this)})}});return d},updateCartLines:function(c,f,d){var g=this;var e=0;if(d==null){d=false}$.each(c,function(j,k){var i=k.ConfiguredParts;if(i.length>0){k.Price=d?k.Price:g.updateCartLines(i,f);var h=$.grep(f,function(m){return m.ParentPartId===k.PartId});if(h!=null&&h.length>0){k.CartStatus=h[0].CartStatus;k.CartStatusMessage=h[0].CartStatusMessage}}else{var l=$.grep(f,function(m){return m.CartId===k.CartId});if(l&&l.length>0){if(!d){k.UnitPrice=l[0].UnitPrice;k.Price=l[0].Price;k.Discount=l[0].Discount;k.DiscountId=l[0].DiscountId;k.DiscountName=l[0].DiscountName;e+=k.Price}k.CartStatus=l[0].CartStatus;k.CartStatusMessage=l[0].CartStatusMessage;k.ShowOverrideMessage=l[0].ShowOverrideMessage;k.OverrideCartMessage=l[0].OverrideCartMessage}}});return e}});$(document).bind(argosyEvents.EVENT_PART_INPUT_QTY_CHANGED,function(d,c){b.cartViewModel.updateConfiguredPartQuantity(c.partId,c.value,c.cartId)});a.read()};ShoppingCartSavedView.prototype.showCartIf=function(a){var b=this;if(a){$(b.options.shoppingCartBindSection).removeClass("hidden");$(b.options.emptyCartSelector).addClass("hidden")}else{$(b.options.shoppingCartBindSection).addClass("hidden");$(b.options.emptyCartSelector).removeClass("hidden")}};ShoppingCartSavedView.prototype.getUserSettings=function(){var a=this;return new kendo.data.ObservableObject(window[a.options.userSettings])};ShoppingCartSavedView.prototype.setupEventListeners=function(){var a=this;$(document).bind(argosyEvents.SHOW_KIT_INVENTORY_DETAILS_MODAL,function(b,d){if(a.productDetailControl!=null){var c=a.cartViewModel.getPart(parseInt(d));$(document).trigger(argosyEvents.START_LOADING,{name:a.constructor.name});a.productDetailControl.show(c,true,true)}});$(document).bind(argosyEvents.PART_ADDED_TO_CART,function(c,b){$.fancybox.close();a.cartViewModel.cartSource.read()});$(document).bind(argosyEvents.SHOW_PART_QUANTITY_MODAL,function(b,d){var c=a.cartViewModel.getPart(d);if(c===null){var f={Take:1,Skip:0,PartId:d};$.ajax({url:"/DataView/GetParts",dataType:"json",data:f,success:function(e){if(e.ReturnCode==ReturnCode.Failed){handleDataSourceException(e)}else{showPartQuantityModal(e.Records[0])}}})}else{showPartQuantityModal(c)}})};function ShoppingCartView(b){var c=this;$.extend(true,c.options,c.baseOptions,b);var a=new ControlLoader();a.loadControl("ModalProductDetail",{},function(d){c.productDetailControl=d});a.loadControl("ModalProductUsage",{},function(d){c.productUsageControl=d});a.loadControl("ModalProductViewingRights",{},function(d){c.productViewingRightsControl=d});a.loadControl("ModalPartConfiguration",{},function(d){c.productConfigurationControl=d});c.setupEventListeners();a.loadTemplate("ShoppingCartView",function(g){$(document.body).append(g);var d=$(c.options.ShoppingCartViewTemplate).html();var e=kendo.template(d);var f=e({isMailingList:false,isThirdPartyList:false,mailingListCost:0,mailingListCostText:"",thirdPartyListCost:0,thirdPartyListCostText:"",isDiscount:false,discountCost:0,discountCostText:""});$("*[data-argosy-uuid='"+c.options.uuid+"']").append(f);c.setupLoadingAttributes();c.setupEvents();c.initialze();c.loaded=true;$(document).trigger(c.EVENT_TEMPLATE_LOADED)})}ShoppingCartView.prototype.options={};ShoppingCartView.prototype.baseOptions={shoppingCartBuilderView:"div[data-argosy-control=ShoppingCartView]",ShoppingCartViewTemplate:"#_ShoppingCartViewTemplate",shoppingCartBindSection:"#_ShopingCartBindSection",shoppingCartGridHref:"#_ShoppingCartGrid",shoppingCartGridRowTempalte:"#_ShoppingCartRowViewTemplate",cartContainer:"#_cartContainer",cartSubTotalSelector:"._ShoppingCartSubTotal",emptyCartSelector:".empty-cart-parent",cxmlPostUrl:"",cxmlBuyerCookie:"",cxmlToIdentity:""};ShoppingCartView.prototype.EVENT_TEMPLATE_LOADED="TEMPLATE_SHOPPING_CART_VIEW_LOADED";ShoppingCartView.prototype.productDetailControl=null;ShoppingCartView.prototype.cartViewModel=null;ShoppingCartView.prototype.setupLoadingAttributes=function(){var b=this;var a=$("*[data-argosy-uuid='"+b.options.uuid+"']");appendLoadingAttribute(a,b.constructor.name);a.attr("data-argosy-loading-message","~{MsgUpdatingCart}~")};ShoppingCartView.prototype.setupEvents=function(){var a=this;$(document).bind(argosyEvents.EVENT_SAVED_CARTLINE_ADDED_TO_SHOPPING_CART,function(b){if($(a.options.emptyCartSelector).hasClass("hidden")){a.cartViewModel.cartSource.read()}else{a.initialze()}});$(document).bind(argosyEvents.SHOW_PART_USAGE_MODAL,function(c,b){if(a.productUsageControl!=null){a.productUsageControl.show(parseInt(b.partId));$(a.options.historyTitleElment).html(b.partName+" - ~{PartHistory}~")}});$(document).bind(argosyEvents.SHOW_VIEWING_RIGHTS_MODAL,function(c,b){if(a.productViewingRightsControl!=null){a.productViewingRightsControl.init(b)}});$(document).bind(argosyEvents.SHOW_PART_CONFIGURATION_MODAL,function(b,d){if(a.productConfigurationControl!=null){var c=a.getPart(d);a.productConfigurationControl.show(c)}});$(document).bind(argosyEvents.SHOW_PART_QUANTITY_MODAL,function(b,d){var c=a.getPart(d);showPartQuantityModal(c)})};ShoppingCartView.prototype.parts=[];ShoppingCartView.prototype.getPart=function(e){var f=this,d=null;if(f.parts!=null){var c=f.parts.length;for(var a=0;a<c;a++){var b=f.parts[a];if(b.PartId===e){d=b;break}}}return d};ShoppingCartView.prototype.initialze=function(){var b=this,a=new kendo.data.DataSource({error:function(c){console.log("Error in datasource see below:");console.log(c)},schema:{data:function(c){return c.CartLines},total:function(c){if(c.CartLines==null){return 0}return c.CartLines.length}},transport:{read:{url:"/store/cart/GetCartLines",dataType:"json"}},requestStart:function(c){$(document).trigger(argosyEvents.START_LOADING,{name:b.constructor.name})},requestEnd:function(c){$(document).trigger(argosyEvents.END_LOADING,{name:b.constructor.name});if(c.hasOwnProperty("response")){var f=[],d=[];b.cartViewModel.showWarningAboutApprovalWorkflow=c.response.ShowWarningAboutApprovalWorkflow;b.cartViewModel.approvalWorkflowWarningMsg=c.response.ApprovalWarningMessage;$.each(c.response.CartLines,function(){var g=this,e=false;b.parts.push(g.Part);if(g.ParentPartId>0&&g.ParentPartId!==g.PartId&&$.grep(d,function(h){return h===g.ParentPartId}).length===0){d.push(g.ParentPartId)}f.push(g.PartId);if(g.Part.IsEdeliveryOnly){g.IsEdelivery=true}if(g.Part.IsLimitPartOrderQuantity&&!g.IsMailingList){$.each(g.Part.Discounts,function(i){var h=this;if(h.Quantity===g.Quantity){e=true;return false}});if(e===false&&g.Part.Discounts.length>0){g.Quantity=g.Part.Discounts[0].Quantity}}g.ConfiguredParts=[]});if(d.length>0){b.cartViewModel.getRemoteParts(d,function(e){$(e).each(function(h,k){b.parts.push(k);f.push(k.PartId);var g=$.grep(c.response.CartLines,function(i){return i.ParentPartId===k.PartId});function l(i,m){return((i.PartId<m.PartId)?-1:((i.PartId>m.PartId)?1:0))}g.sort(l);var j=$.extend({},g[0],{Part:k,CartId:0,PartId:k.PartId,IsKit:false,Quantity:0,Price:0,UnitPrice:0,ParentPartId:0,ConfiguredParts:g,TotalConfiguredParts:0,Discount:0});$(g).each(function(m,i){j.Price+=i.Price;j.TotalConfiguredParts+=i.Quantity;j.Discount+=i.Discount});c.response.CartLines=$.grep(c.response.CartLines,function(i){return i.ParentPartId!==k.PartId});c.response.CartLines.push(j)});b.cartViewModel.onDataProcessComplete(c.response.CartLines,f)})}else{b.cartViewModel.onDataProcessComplete(c.response.CartLines,f)}}}});b.cartViewModel=kendo.observable({showWarningAboutApprovalWorkflow:false,approvalWorkflowWarningMsg:"",partIds:[],cartLines:[],accountingUnits:[],cartSource:a,lines:[],isMailingList:false,mailingListCost:0,mailingListCostText:"",thirdPartyListCost:0,thirdPartyListCostText:"",subTotalText:"",isDiscount:false,discountCost:0,discountCostText:"",updateSubtotal:function(){var e=$(b.options.cartSubTotalSelector),d=0,c=this;d=c.subTotal();e.html(d)},getTotalConfiguredParts:function(c){var d=$.grep(this.cartLines,function(f){return f.PartId===c.ParentPartId});var e=0;$(d).each(function(f){$(this.ConfiguredParts).each(function(g){e+=this.Quantity})});return e},editAttributes:function(f){var i=f.data.Part,c=f.data.AttributePartId,j=f.data.CartAttributes,d=f.data.CartId,h=this,g=kendo.observable({part:i,values:j,onTextBoxChange:function(l){var k=parseFloat($(l.target).attr("data-cost")),n=$(l.target).val(),m=$(l.target).closest(".col-md-12").find(".attributeCost");if(n!=null&&n.trim().length>0&&k!=null&&k!=NaN&&k>0){m.text("+"+kendo.toString(k,"c"))}else{m.text("")}$.fancybox.update()},onAttributeChange:function(n){var p=(n.sender.selectedIndex===0?null:n.sender.element[0].selectedOptions[0]),l=p!=null?parseAttributeIdFromValueKey(p.value):null,k=p!=null?parseAttributeCostFromValueKey(p.value):null,m=p!=null?p.text:null,o=n.sender.wrapper.closest(".col-md-12").find(".attributeCost");if(k!=null&&k!=0){o.text("+"+kendo.toString(k,"c"))}else{o.text("")}$.fancybox.update()},getAttributeCostText:function(l,k){},updateAttributes:function(l){var n=[],k=$(".fancybox-inner").find("select.attributeOptions,input.attributeOptions");if(k.length>0){var o=[];var m=true;$(k).each(function(s,e){e=$(e);var t=e.attr("required")==="required";if(e.is("select")){e=e.getKendoDropDownList();var u=(e.selectedIndex===0?null:e.element[0].selectedOptions[0]),q=u!=null?parseAttributeIdFromValueKey(u.value):null,p=u!=null?parseAttributeCostFromValueKey(u.value):null,r=u!=null?u.text:null;if(u!=null){o.push({AttributeId:q,Value:p,Name:r})}else{if(t){m=false}}}else{if(e.val().trim()!=""){o.push({AttributeId:e.attr("data-type-id"),Value:e.attr("data-cost"),Name:e.val(),Type:e.attr("data-type-name")})}else{if(t){m=false}}}});if(k.length>0){$(n).each(function(e,p){p.selectedAttributes=o})}if(!m){prompt.error("Missing required part configuration options.");return false}$.ajax({url:"/store/cart/UpdateCartLineAttributes",type:"POST",dataType:"json",data:JSON.stringify({attributes:o,cartId:d}),contentType:"application/json; charset=utf-8",success:function(e){h.cartSource.read();$.fancybox.close()}})}}});$.ajax({url:"/Store/Part/GetPartAttributeConfiguration/"+c,type:"GET",dataType:"json",contentType:"application/json; charset=utf-8",success:function(e){g.set("PartAttributes",e);$.each(e,function(m,l){g.set("Attributes_"+l.Id,l.Attributes)});var k=renderEditAttributesModal(g.part,e,g.values);$.fancybox({content:k,afterShow:function(){kendo.bind(this.wrap,g)}})}})},onDataProcessComplete:function(c,d){b.showCartIf(d.length);b.cartViewModel.partIds=d;b.cartViewModel.getCrossSaleItems();setTimeout(function(f){b.cartViewModel.setCartLines(c,true);if(userSettings.SaveAccountingUnitsToOrderLine){b.cartViewModel.getAccountingUnits()}addArgosyActions()},250)},getRemoteParts:function(d,c){$.ajax({url:"/Store/Part/GetPartsById/",data:{ids:d},type:"GET",dataType:"json",contentType:"application/json; charset=utf-8",success:function(e){c(e)}})},getConfiguredPartName:function(c){var d=c.Part.PartName.replace(c.parent().parent().Part.PartName,"").trim();if(d.indexOf("-")===0){d=d.substring(1,d.length)}return d},getFormatedUnitPrice:function(c){return kendo.toString(c.UnitPrice,"C")},getFormatedPrice:function(c){return kendo.toString(c.Price,"C")},getFormatedDiscount:function(c){return"-"+kendo.toString(c.Discount,"C")},isDiscounted:function(c){return c.Discount>0},subTotal:function(){var d=this,c=d.get("cartLines"),e=0;$(c).each(function(){var f=this;e+=f.Price});e+=d.mailingListCost;e+=d.thirdPartyListCost;e-=d.discountCost;return kendo.toString(e,"C")},userSettings:b.getUserSettings(),setEdelivery:function(c){var d=this;c.data.IsEdelivery=true;c.data.PreviousQuantity=c.data.Quantity;c.data.Quantity=1;d.updateLine(c)},removeEdelivery:function(c){var d=this;c.data.IsEdelivery=false;if(c.data.PreviousQuantity!=null){c.data.Quantity=c.data.PreviousQuantity;c.data.PreviousQuantity=null}d.updateLine(c)},notAllConfiguredParts:function(c){return $.grep(this.cartLines,function(d){return d.ConfiguredParts!=null&&d.ConfiguredParts.length>0}).length!==this.cartLines.length},showToolTip:function(c){var g=$(c.currentTarget).getKendoTooltip(),d=c.data.Part,f=kendo.Template.compile($("#_PriceBreakGridViewtemplate").html())(d.Discounts);if(g==null){g=$(c.currentTarget).kendoTooltip({autoHide:false,content:f,position:"right",showOn:"click",show:function(h){if(d.showHighlight){var j=null;var i=$(h.sender.popup.element).find("table tbody tr");$(i).each(function(e,m){m=$(m);var l=m.attr("data-min-value");var k=m.attr("data-max-value");if(l<k&&d.highlightQuantity>=l&&d.highlightQuantity<=k){j=m}else{if(l<=d.highlightQuantity){j=m}}});j.addClass("k-state-selected")}}}).data("kendoTooltip");g.show()}},doesLineNeedAttention:function(c){if(c.CartStatus!==99||c.ShowOverrideMessage===true){return true}return false},postCxml:function(){$.ajax({url:"/cxml/GetEncodedCxmlOrder",dataType:"json",type:"POST",contentType:"application/json; charset=utf-8",complete:function(c){var g=c.responseJSON;if(g.isError===false){var d=g.postUsingUrlEncoded?"cXML-urlencoded":"cXML-base64";$.submitAsForm(g.postUrl,g.xml,d)}else{var f={question:"Problem with checkout.",description:g.message,button:"Close",type:"warning",};prompt.alert(f);$(document).trigger(argosyEvents.END_LOADING,{name:b.constructor.name})}}})},checkout:function(f){var g=this,d=g.get("cartLines"),j=g.get("userSettings"),c=g.get("approvalWorkflowWarningMsg");$.each(d,function(k){this.DateCreated=g.dateCleaner(this.DateCreated);this.DateUpdated=g.dateCleaner(this.DateUpdated)});var h=$("*[data-argosy-uuid='"+b.options.uuid+"']");h.attr("data-argosy-loading-message","~{MsgVerifyingCart}~");$(document).trigger(argosyEvents.START_LOADING,{name:b.constructor.name});var i=g.flattenCartLines(d);$.ajax({url:"/store/cart/CartReadyForCheckout",dataType:"json",type:"POST",data:JSON.stringify(i),contentType:"application/json; charset=utf-8",complete:function(p){$(document).trigger(argosyEvents.END_LOADING,{name:b.constructor.name});h.attr("data-argosy-loading-message","~{MsgUpdatingCart}~");g.isFinalCalculation=true;var u=p.responseJSON;g.set("approvalWorkflowWarningMsg",u.ApprovalWarningMessage);g.set("showWarningAboutApprovalWorkflow",u.ShowWarningAboutApprovalWorkflow);g.set("redirectUrl",u.ReturnUrl);g.set("redirectMethod",function(){if(j.IsCXmlPunchOut){g.postCxml()}else{if(u.ReturnUrl.indexOf("placeorder")>0){window.location=u.ReturnUrl}else{$.submitAsForm(u.ReturnUrl+"?redirectUrl=/Store/Cart")}}});c=u.ApprovalWarningMessage;if(u.CartLines&&u.CartLines.length>0){g.updateCartLines(d,u.CartLines,true);g.setCartLines(d,true)}if(u.ReturnCode!==200){var t={message:"~{MsgUnableToCheckout}~",type:"error"};$(document).trigger(argosyEvents.PROMPT_NOTIFY,t)}else{var v=false,l=$("div[data-id='approvalWorkflowMessages']"),o=$("div[data-id='lineMessages']"),n=$("div[data-id='lineErrors']"),m=$("div[data-id='moreInformation']");if(u.Response!==null){if(u.Response.ApprovalWorkflowMessages.length>0){v=true;var k=$("div[data-id='approvalWorkflowMessagesList']").data("kendoListView");$.each(u.Response.ApprovalWorkflowMessages,function(e,w){if(w!=="~{MsgStopOrderReady}~"){k.dataSource.add({Message:w})}});l.show();g.set("lineErrorsHrVisible",true);g.set("lineMessagesHrVisible",true)}else{l.hide();g.set("lineErrorsHrVisible",false);g.set("lineMessagesHrVisible",false)}if(u.Response.LineMessages.length>0){v=true;var r=$("div[data-id='lineMessagesGrid']").data("kendoGrid");$.each(u.Response.LineMessages,function(e,w){r.dataSource.add(w)});o.show();g.set("lineErrorsHrVisible",true)}else{o.hide();g.set("lineErrorsHrVisible",false)}if(u.Response.LineErrors.length>0){v=true;var q=$("div[data-id='lineErrorsGrid']").data("kendoGrid");$.each(u.Response.LineErrors,function(e,w){q.dataSource.add(w)});g.set("alertMessageContinueEnabled",false);m.show();n.show()}else{m.show();g.set("alertMessageContinueEnabled",true);n.hide()}}$("#_alertMessageContinueToCheckout").on("click",function(w){$.fancybox.close();h.attr("data-argosy-loading-message","~{MsgHeadingToCheckout}~");$(document).trigger(argosyEvents.START_LOADING,{name:b.constructor.name});g.redirectMethod()});if(v){$.fancybox({href:"#cartResponseSection",afterShow:function(){$(document).trigger(argosyEvents.END_LOADING,{name:b.constructor.name})},maxWidth:720,minWidth:720,modal:true,autoHeight:true,closeBtn:false})}else{$("div[data-id='cartResponseSection']").hide();if(u.Response.Status===99){g.redirectMethod()}else{if(u.Response.Status===90){var s={question:"~{MsgFixHighlighted}~",description:u.Message,button:"Close",type:"warning",};prompt.alert(s)}}}}}})},priceBreakSelectedValue:function(f){var c=f.Quantity,e=this,d=false;$.each(f.Part.Discounts,function(h){var g=this;if(g.Quantity===c){d=true;return false}});if(d===false){f.Quantity=f.Part.Discounts[0].Quantity}return f.Quantity},priceBreakDataBound:function(f){var c=$(f.sender.element),d=70;c.data("kendoDropDownList").list.width("auto");c.closest(".k-widget").width(d)},getUnitPriceFromPriceBreaks:function(c,e){var d=0;$(c).each(function(){var f=this;if(e<=f.Quantity){d=f.Discount;return false}});if(d===0){d=c[c.length-1].Discount}return d},dateCleaner:function(c){try{c=new Date(parseInt(c.replace(/\/Date\((.*?)\)\//gi,"$1")))}catch(d){}return c},priceBreakDropdownChange:function(f){var g=this,d=g.get("cartLines"),c=f.data;if(c.Part.IsLimitPartOrderQuantity&&!c.IsEdelivery&&c.Part.Discounts!=null&&c.Part.Discounts.length>0){var h=$("#priceBreakDropDown"+c.CartId).getKendoDropDownList().value();c.Quantity=parseInt(h)}g.setCartLines(d);g.updatePrice()},updateConfiguredPartQuantity:function(f,g,c){var h=this,d=h.get("cartLines"),e=null;$.each(d,function(j,i){if(i.CartId===c){e=i}else{$(i.ConfiguredParts).each(function(l,k){if(k.CartId===c){e=k}})}});if(e!=null){e.Quantity=g;if(e.Part.Discounts.length>0){e.UnitPrice=h.getUnitPriceFromPriceBreaks(e.Part.Discounts,e.Quantity)}e.Price=e.UnitPrice*e.Quantity}h.updatePrice(d)},updateLine:function(g){var h=this,d=h.get("cartLines"),c=g.data;c.DateCreated=h.dateCleaner(c.DateCreated);var f=$("#priceBreakDropDown"+c.CartId);if(c.Part.IsLimitPartOrderQuantity&&!c.IsEdelivery&&c.Part.Discounts!=null&&c.Part.Discounts.length>0&&f.length>0){var i=f.getKendoDropDownList().value();c.Quantity=parseInt(i)}if(c.Part.Discounts.length>0){c.UnitPrice=h.getUnitPriceFromPriceBreaks(c.Part.Discounts,c.Quantity);$('[data-cartline-id="'+c.CartId+'"]').text(kendo.toString(c.UnitPrice,"c"))}c.Price=c.UnitPrice*c.Quantity;h.setCartLines(d,true);h.updatePrice()},checkForEedlivery:function(c){if(c.IsEdelivery){return true}else{return false}},checkForPhysicalDelivery:function(c){if(c.IsEdelivery){return false}else{return true}},hiddenIfEdeliveryNotAllowed:function(c){if(c.Part.IsEdeliveryOnly){return true}else{if(c.Part.IsEdeliveryAllowed){return false}else{return true}}},hiddenIfKitWithoutPersonalizedItems:function(c){if(c.PersonalizedPartsInKit!==undefined&&c.PersonalizedPartsInKit!==null&&c.PersonalizedPartsInKit.length>0){return false}else{return true}},hiddenIfNoCartAttributes:function(c){if(c.CartAttributes!==undefined&&c.CartAttributes!==null&&c.CartAttributes.length>0){return false}else{return true}},isConfiguredPart:function(c){return c.ConfiguredParts.length>0},isNotConfiguredPart:function(c){return c.ConfiguredParts.length===0},hideOverPartLimitMessage:function(c){var d=this,f=d.overPartLimit(c);if(f){return false}else{return true}},hideMaxOrderQty:function(c){var d=this,f=d.get("userSettings");if(f.IsMaxOrderQtyVisible){return false}return true},hideInventory:function(c){var d=this,f=d.get("userSettings");if(f.IsInventoryInformationVisible||c.ConfiguredParts.length>0){return false}return true},overPartLimit:function(d){var f=this,i=f.get("userSettings"),c=d,h=false,g=null;if(c.CurrentPartLimits!=null){g=c.CurrentPartLimits.OrderedPartLimit}if(i.ShowPartLimits){if(g!=null){if(g.LimitQty-g.TotalOrdered<=0){h=true}}}return h},noEdeliveryItems:function(d){var g=this,c=d,f=false;if(c==null){$.each(g.cartLines,function(e){if(!f){f=this.Part.IsEdeliveryAllowed||this.Part.IsEdeliveryOnly}})}else{f=c.Part.IsEdeliveryAllowed||c.Part.IsEdeliveryOnly}return !f},emptyCart:function(){var c=this,d={question:"~{MsgClearCart}~",description:"",button:"Clear Cart",type:"warning",yes:function(f){$.fancybox.close();$.ajax({url:"/store/cart/ClearCart",dataType:"json",type:"POST",contentType:"application/json; charset=utf-8",success:function(g){$(b.options.cartSubTotalSelector).html("");b.showCartIf(false);$(document).trigger(argosyEvents.ITEM_DELETED_FROM_CART)},error:function(){var e={message:"~{MsgErrorClearingCart}~",type:"error"};$(document).trigger(argosyEvents.PROMPT_NOTIFY,e)}})},no:function(f){$.fancybox.close()}};prompt.alert(d)},saveForLater:function(f){var e=this,c=f.data;var g=$("*[data-argosy-uuid='"+b.options.uuid+"']");g.attr("data-argosy-loading-message","~{MsgSavingCartForLater}~");$(document).trigger(argosyEvents.START_LOADING,{name:b.constructor.name});var d=[c];if(c.ConfiguredParts!=null&&c.ConfiguredParts.length>0){d=c.ConfiguredParts}$.ajax({url:"/store/cart/SaveCartlineForLater",dataType:"json",type:"POST",data:JSON.stringify({lines:d}),contentType:"application/json; charset=utf-8",complete:function(h){b.cartViewModel.cartSource.read();$(document).trigger(argosyEvents.EVENT_CARTLINE_SAVED_FOR_LATER);$(document).trigger(argosyEvents.END_LOADING,{name:b.constructor.name});g.attr("data-argosy-loading-message","~{MsgUpdatingCart}~")}})},deleteLine:function(h){var g=h.data.ParentPartId>0?h.data.parent().parent().parent().parent():this,c=h.data,e=g.get("cartLines");var f=e.indexOf(c);if(c.ParentPartId>0){var i=h.data.parent().parent();var d=i.ConfiguredParts.indexOf(c);f=e.indexOf(i);if(d>=0){e[f].ConfiguredParts.splice(d,1);e[f].Price-=c.Price}if(e[f].ConfiguredParts.length!==0){f=-1}}if(f>=0){e.splice(f,1)}g.setCartLines(e,true);$.ajax({url:"/store/cart/DeleteCartLine",dataType:"json",data:JSON.stringify(c),type:"POST",contentType:"application/json; charset=utf-8",success:function(j){var m=j.ReturnCode===ReturnCode.Success,k="~{MsgItemDeletedFromCart}~",n="success";if(!m){k=j.Message;n="error"}else{g.updateLine(h)}var l={message:k,type:n};$(document).trigger(argosyEvents.ITEM_DELETED_FROM_CART);$(document).trigger(argosyEvents.PROMPT_NOTIFY,l)},error:function(){var j={message:"~{MsgErrorDeletingCartItem}~",type:"error"};$(document).trigger(argosyEvents.PROMPT_NOTIFY,j)}})},goShopping:function(){window.location=$("#logo_header").attr("href")},personalizedKitItems:[],crossSaleItems:[],showAddToCartModal:function(c){$(document).trigger(argosyEvents.SHOW_PART_QUANTITY_MODAL,c.data.PartId)},setCartLines:function(e,g){var d=this;d.set("cartLines",e);var f=0;var h=0;var c=0;$(e).each(function(j,k){if(k.IsMailingList){f+=k.MailingListCost}if(k.IsThirdPartyList){h+=k.ThirdPartListCost}if(k.Discount>0){c+=k.Discount}});d.set("isMailingList",f>0);d.set("mailingListCostText",kendo.toString(f,"c"));d.set("mailingListCost",f);d.set("isThirdPartyList",h>0);d.set("isDiscount",c>0);d.set("discountCost",c);d.set("discountCostText","-"+kendo.toString(c,"c"));d.set("thirdPartyListCostText",kendo.toString(h,"c"));d.set("thirdPartyListCost",h);if(g){kendo.unbind($(b.options.shoppingCartBindSection));kendo.bind($(b.options.shoppingCartBindSection),d)}d.set("subTotalText",d.subTotal());addArgosyActions()},loadPartLimits:function(){var d=this,c=d.get("cartLines"),e=d.get("partIds");if(e.length>0){$.ajax({url:"/store/cart/GetPartLimits",dataType:"text json",data:JSON.stringify(e),type:"POST",contentType:"application/json; charset=utf-8",success:function(f){var g=false;$.each(f,function(){var h=this,i=h.PartId;$.each(c,function(){var j=this;if(j.PartId===i){g=true;j.CurrentPartLimits=new kendo.data.ObservableObject(h)}})});if(g===true){d.setCartLines(c)}}})}},getAccountingUnits:function(){var d=this,c=d.get("cartLines"),e={Take:50};$.ajax({url:"/DataView/GetAccountingUnits",dataType:"text json",data:JSON.stringify(e),type:"POST",contentType:"application/json; charset=utf-8",success:function(f){if(f.ReturnCode===ReturnCode.Success){if(f.TotalRecords>0){d.set("accountingUnits",new kendo.data.ObservableArray(f.Records));var g=false;$(c).each(function(h,j){if(j.AccountingUnitId===null){j.AccountingUnitId=f.Records[0].AccountingUnitId;g=true}});if(g===true){d.setCartLines(c)}}}}})},accountingUnitsChange:function(g){var h=this,d=h.get("cartLines"),f=g.sender,c=f.element.data("cartId"),i=f.value();$.each(d,function(k,j){if(j.CartId===c){j.AccountingUnitId=i;$.ajax({url:"/store/cart/UpdateCartAccountingUnit",dataType:"text json",data:JSON.stringify(j),type:"POST",contentType:"application/json; charset=utf-8",success:function(l){}});return false}});h.setCartLines(d)},accountingUnitsDataBound:function(g){var h=this,f=g.sender,d=h.get("cartLines"),c=f.element.data("cartId");var i=$.grep(d,function(e){return e.CartId===c});if(i.length>0&&i[0].AccountingUnitId!==null){f.value(i[0].AccountingUnitId)}else{if(f.select()===-1){f.select(0)}}},getCrossSaleItems:function(){var c=this,d=c.get("partIds");if(d.length>0){$.ajax({url:"/store/cart/GetCrossSaleItems",dataType:"text json",data:JSON.stringify(d),type:"POST",contentType:"application/json; charset=utf-8",success:function(f){if(f&&f.length>0){$(f).each(function(e){b.parts.push(this)});c.set("crossSaleItems",new kendo.data.ObservableArray(f));$("#_cartCrossSaleBindSection").show();addArgosyActions()}else{$(".toggle-recommend-controls").hide()}}})}},showProductDetails:function(c){if(b.productDetailControl!=null){b.productDetailControl.show(c.data);addArgosyActions()}},addProductToCart:function(c){var d={qty:1,partId:c.data.PartId};sendPartToCart(d,c.data.PartName)},getPart:function(f){var d=this,c=d.get("cartLines"),e=null;if(c.length>0){$.each(c,function(g){if(this.PartId===f){e=this.Part;return false}})}return e},flattenCartLines:function(c){var d=[];$(c).each(function(f){if(this.ConfiguredParts.length===0){d.push(this)}else{$(this.ConfiguredParts).each(function(g){d.push(this)})}});return d},updatePrice:function(e){var d=this,c=e==null?d.get("cartLines"):e,f=$(".show-loading, [data-role=partpricing]");f.html("Loading...");var g=d.flattenCartLines(c);if(c.length>0){block(null,"Recalculating your cart...",true);$.ajax({url:"/store/cart/UpdateCartlineUnitCosts?isFinalCalculation="+d.isFinalCalculation,dataType:"text json",data:JSON.stringify(g),type:"POST",contentType:"application/json; charset=utf-8",success:function(h){if(h&&h.length>0){d.updateCartLines(c,h);d.setCartLines(c,true)}unblock()}})}},updateCartLines:function(c,g,d){var h=this;var f=0;var e=0;if(d==null){d=false}$.each(c,function(l,m){var j=m.ConfiguredParts;if(j.length>0){var k=h.updateCartLines(j,g);m.Price=d?m.Price:k.price;m.Discount=d?m.Discount:k.discount;var i=$.grep(g,function(o){return o.ParentPartId===m.PartId});if(i!=null&&i.length>0){m.CartStatus=i[0].CartStatus;m.CartStatusMessage=i[0].CartStatusMessage}}else{var n=$.grep(g,function(o){return o.CartId===m.CartId});if(n&&n.length>0){if(!d){m.UnitPrice=n[0].UnitPrice;m.Price=n[0].Price;m.Discount=n[0].Discount;m.DiscountId=n[0].DiscountId;m.DiscountName=n[0].DiscountName;f+=m.Price;e+=m.Discount}m.CartAttributes=n[0].CartAttributes;m.CartStatus=n[0].CartStatus;m.CartStatusMessage=n[0].CartStatusMessage;m.ShowOverrideMessage=n[0].ShowOverrideMessage;m.OverrideCartMessage=n[0].OverrideCartMessage}}});return{price:f,discount:e}},lineMessages:function(){return this.getLineMessages()},getLineMessages:function(){return new kendo.data.DataSource({schema:{model:{fields:{Error:{type:"string"},Line:{type:"object"},CustomError:{type:"string"},Status:{type:"number"},PartName:{type:"number"}}}}})},approvalWorkflowMessages:function(){return this.getApprovalWorkflowMessages()},getApprovalWorkflowMessages:function(){return new kendo.data.DataSource()},lineErrors:function(){return this.getLineErrors()},getLineErrors:function(){return new kendo.data.DataSource({schema:{model:{fields:{Error:{type:"string"},Line:{type:"object"},CustomError:{type:"string"},Status:{type:"number"},PartName:{type:"string"}}}}})},lineResponsesGroup:function(c){$.fancybox.update()},lineResponsesDataBound:function(c){var d=$(".k-grouping-row");for(var f=0;f<d.length;f++){c.sender.collapseGroup(d[f])}$.fancybox.update()},lineResponsesDataBinding:function(c){var f=$("div[data-id='lineErrorsGrid']").data("kendoGrid"),g=$("div[data-id='lineMessagesGrid']").data("kendoGrid"),d=$("#_lineResponseRowTemplate").html(),h=kendo.template(d);if(f!=null){f.options.rowTemplate=$.proxy(h,f.dataSource)}if(g!=null){g.options.rowTemplate=$.proxy(h,g.dataSource)}$.fancybox.update()},alertMessageContinueToCheckout:function(c){$.fancybox.close();var d=$("*[data-argosy-uuid='"+b.options.uuid+"']");d.attr("data-argosy-loading-message","~{MsgHeadingToCheckout}~");$(document).trigger(argosyEvents.START_LOADING,{name:b.constructor.name});this.redirectMethod()},alertMessageContinueEnabled:true,clearCartResponse:function(c){c.data.set("approvalWorkflowMessages",[]);c.data.set("cartMessages",c.data.getApprovalWorkflowMessages());c.data.set("lineMessages",c.data.getLineMessages());c.data.set("lineErrors",c.data.getLineErrors());c.data.set("lineErrorsHrVisible",false);c.data.set("lineMessagesHrVisible",false);$.fancybox.close()},lineErrorsHrVisible:false,lineMessagesHrVisible:false,toggleShowInformation:function(c){$("div[data-id='moreInformation']").toggle();$.fancybox.update()}});kendo.bind($("#cartResponseSection"),b.cartViewModel);$(document).bind(argosyEvents.EVENT_PART_INPUT_QTY_CHANGED,function(d,c){b.cartViewModel.updateConfiguredPartQuantity(c.partId,c.value,c.cartId)});a.read()};ShoppingCartView.prototype.showCartIf=function(a){var b=this;if(a){$(b.options.shoppingCartGridHref+",.hide-me-on-empty").removeClass("hidden");$(b.options.emptyCartSelector).addClass("hidden")}else{$(b.options.shoppingCartGridHref+",.hide-me-on-empty").addClass("hidden");$(b.options.emptyCartSelector).removeClass("hidden")}};ShoppingCartView.prototype.getUserSettings=function(){var a=this;return new kendo.data.ObservableObject(window[a.options.userSettings])};ShoppingCartView.prototype.setupEventListeners=function(){var a=this;$(document).bind(argosyEvents.SHOW_KIT_INVENTORY_DETAILS_MODAL,function(b,d){if(a.productDetailControl!=null){var c=a.cartViewModel.getPart(parseInt(d));$(document).trigger(argosyEvents.START_LOADING,{name:a.constructor.name});a.productDetailControl.show(c,true,true)}});$(document).bind(argosyEvents.PART_ADDED_TO_CART,function(c,b){$.fancybox.close();a.cartViewModel.cartSource.read()});$(document).bind(argosyEvents.SHOW_PART_QUANTITY_MODAL,function(b,d){var c=a.cartViewModel.getPart(d);if(c===null){var f={Take:1,Skip:0,PartId:d};$.ajax({url:"/DataView/GetParts",dataType:"json",data:f,success:function(e){if(e.ReturnCode===ReturnCode.Failed){handleDataSourceException(e)}else{showPartQuantityModal(e.Records[0])}}})}else{showPartQuantityModal(c)}})};function StandardReportsGridView(a){var b=this;$.extend(true,b.options,b.baseOptions,a);$(document).bind(argosyEvents.SEARCH_PAGE_GRID,function(d,c){b.search({})});b.search({})}StandardReportsGridView.prototype.options={};StandardReportsGridView.prototype.baseOptions={gridViewSelector:"div[data-argosy-view=StandardReportsGridView]"};StandardReportsGridView.prototype.search=function(){var c=this;if($(c.options.gridViewSelector).getKendoGrid()==null){var b={scrollable:false,editable:false,autoBind:true,dataSource:c.getDataSource({}),groupable:false,sortable:false,selectable:false,exportToExcel:false,columns:[{field:"ReportName",hidden:true,groupHeaderTemplate:"#if(value != null) { #  #= value # # } else {#Items#}  # "},{title:" ",field:"ReportViewName",template:"<a href='/Admin/Reports/Details/${ReportConfigId}'>${ReportViewName}</a>"},{title:" ",field:"DateCreated",template:'${kendo.toString(kendo.parseDate(DateCreated),"MM/dd/yyyy")}',width:"100px",editable:false}],dataBound:function(f){var h=$(f.sender.element);var d=h.find(".k-icon.k-i-collapse");d.click();var g=h.getKendoGrid();h.find("tbody tr[role=row]").each(function(){var e=g.dataItem(this)})}};$(c.options.gridViewSelector).kendoArgosyGrid(b)}else{var a=$(c.options.gridViewSelector).getKendoGrid();a.dataSource.read();a.refresh()}};StandardReportsGridView.prototype.showDeleteModal=function(a){var c=this;var b={question:"",description:"",button:"",type:"warning",yes:function(d){c.deleteReportFromGroup(a)}};b.question="~{WantToRemoveSelection}~";b.button="~{Remove}~";prompt.alert(b)};StandardReportsGridView.prototype.deleteReportFromGroup=function(b){var c=this;var a={report:b};$.ajax({url:"/Admin/Reports/DeleteReportFromGroup",type:"POST",data:JSON.stringify(a),dataType:"json",traditional:true,contentType:"application/json; charset=utf-8",success:function(e){if(e.ReturnCode==ReturnCode.Success){$(e.Records).each(function(){prompt.notify({question:this.Key+" was "+(!this.Value?"":"not")+" successfully deleted",type:(!this.Value?"success":"error")})})}else{prompt.clientResponseError(e)}var d=$(c.options.gridViewSelector).getKendoGrid();d.dataSource.read();d.refresh(true)}});$.fancybox.close()};StandardReportsGridView.prototype.getDataSource=function(a){var b=this;$.extend(true,b.dataSourceOpts,_defaultDataSourceConfig,a);b.dataSourceOpts.group={field:"ReportName"};b.dataSourceOpts.transport={read:function(c){var d=b.options;$.extend(true,d,kendoOptionsToObject(c),b.searchCriteria);$.ajax({url:"/DataView/GetStandardReportViews",dataType:"json",data:d,success:function(e){if(e.ReturnCode==ReturnCode.Failed){handleDataSourceException(e)}else{c.success(e)}}})}};return new kendo.data.DataSource(b.dataSourceOpts)};StandardReportsGridView.prototype.dataSourceOpts={};StandardReportsGridView.prototype.getStatus=function(){};function TaskHub(d,a,b){var c=this;c.taskProcessor=$.connection.taskHub;c.taskProcessor.connection.qs={siteId:siteId,userId:userId,companyId:companyId,companyUserGroupId:companyUserGroupId,txt_customizationStateId:getQuerystring("customizationStateId",0)};c.taskProcessor.client.update=function(e){c.update(e);if(d!=null){d(e)}};c.taskProcessor.client.complete=function(e){c.complete(e);if(a!=null){a(e)}};c.taskProcessor.client.error=function(e){c.error(e);if(b!=null){b(e)}};$.connection.hub.start().done(function(){c.options.initialized=true;$(document).trigger("TaskHub-Initialized")})}TaskHub.prototype.options={initialized:false};TaskHub.prototype.templates={content:"<div class='task-wrapper text-center padl40 padr40'><h3 class='task-title nowrap text-center'>${Message}</h3><h4 class='task-state nowrap text-center padb40'>${State}</h4>#if (ErrorGuid != null && ErrorGuid != '') {#<h4 class='task-state text-danger nowrap text-center'>Error: ${ErrorGuid}</h4>#}#<div class='nowrap text-center task-progress'><i class='fa fa-cog fa-spin'></i> <span id='taskMessage'>~{Processing}~ ${Executions} of ${Count}.</span></div></div>"};TaskHub.prototype.update=function(a){var b=this;b.showProcessingModal(a)};TaskHub.prototype.complete=function(a){var b=this;b.showProcessingModal(a)};TaskHub.prototype.error=function(a){var b=this;b.showProcessingModal(a)};TaskHub.prototype.showProcessingModal=function(b){var c=this;var a=kendo.Template.compile(c.templates.content)(b);if(b.State=="Created"){$.fancybox({content:a})}else{$(".fancybox-inner").find(".task-wrapper").replaceWith(a)}$.fancybox.update()};TaskHub.prototype.transformList=function(a,b){var d=this;if(!d.options.initialized){$(document).one("TaskHub-Initialized",function(f){d.transformList(a)})}else{var c=d.getBaseTask("ListTransform",{listPath:a,mappingData:b},"Starting your list transformation...","List Transform");d.showProcessingModal(c);d.taskProcessor.server.processTask(c)}};TaskHub.prototype.generateListPreview=function(a,b){var d=this;if(!d.options.initialized){$(document).one("TaskHub-Initialized",function(f){d.generateListPreview(a,b)})}else{var c=d.getBaseTask("ListPreview",{listPath:a,numberOfRows:b},"Generating your list preview...","List Preview");d.showProcessingModal(c);d.taskProcessor.server.processTask(c)}};TaskHub.prototype.deduplicateList=function(b,a){var d=this;if(!d.options.initialized){$(document).one("TaskHub-Initialized",function(f){d.deduplicateList(b,a)})}else{var c=d.getBaseTask("ListDeduplication",{listPath:b,addressColumns:a},"Starting your list deduplication...","List Deduplication");d.showProcessingModal(c);d.taskProcessor.server.processTask(c)}};TaskHub.prototype.removeDuplicatesFromList=function(a,b){var d=this;if(!d.options.initialized){$(document).one("TaskHub-Initialized",function(f){d.removeDuplicatesFromList(a,b)})}else{var c=d.getBaseTask("ListDeduplicationRemoval",{listPath:a,rowsToRemove:b},"Removing your duplicates...","List Deduplication");d.showProcessingModal(c);d.taskProcessor.server.processTask(c)}};TaskHub.prototype.removeBadAddresses=function(b,c){var e=this;if(!e.options.initialized){$(document).one("TaskHub-Initialized",function(f){e.removeBadAddresses(b,c)})}else{var a={listPath:b,rowsToRemove:c};var d=e.getBaseTask("ListBadAddressRemoval",a,"Removing bad addresses...","List Address Removal");e.showProcessingModal(d);e.taskProcessor.server.processTask(d)}};TaskHub.prototype.generateDynamicDataGlobalProfile=function(f,b,e,g,c,d){var i=this;if(!i.options.initialized){$(document).one("TaskHub-Initialized",function(j){i.generateDynamicDataGlobalProfile(f,b,e,g,c)})}else{var a={name:f,globalFormsId:b,identifier:e,projectId:g,globalProfileData:c,globalProfileId:d};var h=i.getBaseTask("GenerateDynamicDataGlobalProfile",a,"~{GeneratingYourProfile}~","Temporary Global Profile.");i.showProcessingModal(h);i.taskProcessor.server.processTask(h)}};TaskHub.prototype.verifyAddressList=function(e,b,d,f,c){var h=this;if(!h.options.initialized){$(document).one("TaskHub-Initialized",function(i){h.verifyAddressList(listPath,addressColumns)})}else{var a={name:e,globalFormsId:b,identifier:d,projectId:f,globalProfileData:c};var g=h.getBaseTask("ListAddressVerification",a,"~{StartingYourAddressVerification}~","Address Verification");h.showProcessingModal(g);h.taskProcessor.server.processTask(g)}};TaskHub.prototype.verifyAddressList=function(b,a){var d=this;if(!d.options.initialized){$(document).one("TaskHub-Initialized",function(f){d.verifyAddressList(b,a)})}else{var c=d.getBaseTask("ListAddressVerification",{listPath:b,addressColumns:a},"~{StartingYourAddressVerification}~","Address Verification");d.showProcessingModal(c);d.taskProcessor.server.processTask(c)}};TaskHub.prototype.getBaseTask=function(d,a,b,c){return{Name:c,Type:d,State:"Created",Uid:kendo.guid(),Message:b,Executions:0,Count:0,Data:a,ErrorGuid:null}};TaskHub.prototype.generateBundles=function(d,g,b,c){var f=this;if(!f.options.initialized){$(document).one("TaskHub-Initialized",function(h){f.generateBundles(d,g,b,c)})}else{var a={sku:d,variables:g,priceListId:b,proofName:c};var e=f.getBaseTask("GenerateBundle",a,"Finding parts...","Bundle Creation");f.showProcessingModal(e);f.taskProcessor.server.processTask(e)}};function showMeTheLocalization(){var a="~{DigitalAssets}~";alert(a)};function Theme(b){var c=this;var a=new ControlLoader();$.extend(true,c.options,b);a.loadTemplate("Theme",function(d){$(document.body).append(d)});$(document).bind(argosyEvents.SHOW_THEME,function(d,f){c.showTheme(f)}).bind(argosyEvents.SHOW_STANDARD_THEMES,function(){c.showStandardThemes()})}Theme.prototype.options={themeTemplate:"#_ThemeTemplate"};Theme.prototype.showStandardThemes=function(){$.fancybox({content:$("#show_standard_themes"),minWidth:350})};Theme.prototype.showTheme=function(b){var a=this,c=$(a.options.themeTemplate);$(document).trigger(argosyEvents.START_LOADING);$.ajax({url:"/DataView/GetTheme",type:"POST",dataType:"json",data:{themeId:b},success:function(f){a.theme=f;var d=$("#divBuildTheme"),e=kendo.Template.compile(c.html())(a.theme),g=kendo.observable({theme:a.theme,createdThemes:$("#CreatedThemes"),colorPickerSelect:function(h){var i=$(h.sender.element.parent().parent().children()[1]);i.text(h.value.toUpperCase()).removeClass("hidden")},showExistingThemes:function(){$("#divBuildTheme").hide();$("#divExistingThemes").show();$("#btnBackToEditTheme").show();$("#chooseTheme").show()},updateListItem:function(j,p){var q=this,m=j.find("[name=themegroup]"),l=j.find("[name=primary]"),n=j.find("[name=secondary]"),o=j.find("[name=tertiary]"),k=j.find(".tc-name"),h=j.find("a");j.prop("id",p.Id);h.attr("data-argosy-dataid",p.Id);var i=h.find("i");i.attr("data-id",p.Id);i.click(function(){$(document).trigger(argosyEvents.SHOW_THEME,p.Id)});m.prop("value",p.Id);m.prop("id",p.Id);m.attr("onclick","changeCSS('/Style/ChangeCss?id="+p.Id+"');");l.css("background-color",p.PrimaryColor);n.css("background-color",p.SecondaryColor);o.css("background-color",p.TertiaryColor);k.text(p.Name);k.attr("for",p.Id);q.showExistingThemes()},editTheme:function(){var i=this,h=function(j){changeCSS("/Style/ChangeCss?id="+j.Id);var k=$(i.createdThemes).find("li[id='"+j.Id+"']");i.updateListItem(k,j);$("#btnBackToEditTheme").hide();i.swapCheckboxes(j)};i.setupTheme();$.ajax({url:"/Admin/Theme/Update",contentType:"application/json; charset=utf-8",datatype:"json",data:JSON.stringify(a.theme),method:"POST",success:function(j){h(j.Data);$(document).trigger(argosyEvents.END_LOADING)}})},swapCheckboxes:function(j){var h=$("input:radio[name='themegroup']:checked"),i=$("input:radio[value='"+j.Id+"']");h.prop("checked",false);i.prop("checked",true)},getSelectors:function(){var h={};$("[data-theme-group]").each(function(){$(this).find("[data-style]").each(function(){var o=$(this),p=$.grep(a.theme.ThemeStyles,function(t){return t.ThemeStyleId===o.data("themeStyleId")}),q=p[0],m=o.data("role"),n=o.data("selector");if(q!==null&&q!==undefined){if(h[n]===null){h[n]=[]}switch(m){case"imageeditor":var l=o.getKendoImageEditor();if(l!==null&&l!==undefined){var i=l.value();if(i!=="none"){q.Value="url("+i+")"}else{q.Value=i}}break;case"dropdownlist":var k=o.getKendoDropDownList();if(k!==null&&k!==undefined){var r=parseInt(k.value());$.each(q.ThemeOptions,function(t,u){if(u.ThemeOptionId===r){q.Value=u.Value;u.IsSelected=true}else{u.IsSelected=false}})}break;case"colorpicker":var j=o.getKendoColorPicker();if(j!==null&&j!==undefined){var s=j.value();q.Value=s}break}if(q.IsPrimary){a.theme.PrimaryColor=q.Value}else{if(q.IsSecondary){a.theme.SecondaryColor=q.Value}else{if(q.IsTertiary){a.theme.TertiaryColor=q.Value}}}if(h[n]===null||h[n]===undefined){h[n]=[]}h[n].push(q)}})});return h},generateStyleSheet:function(h){var i="";$.each(h,function(j,k){$.each(k,function(l,m){if(l===0){i+=m.Selector+" {\r\n"}i+="    "+m.Name+": "+m.Value+";\r\n"});i+="}\r\n\r\n"});return i},setupTheme:function(){$(document).trigger(argosyEvents.START_LOADING);var h=this.getSelectors(),i=this.generateStyleSheet(h);a.theme.Name=$("#_themeName").val();a.theme.StyleSheet=i},deleteTheme:function(){var h=this;$(document).trigger(argosyEvents.START_LOADING);$.ajax({url:"/Admin/Theme/Delete",contentType:"application/json; charset=utf-8",datatype:"json",data:JSON.stringify(a.theme),method:"POST",success:function(i){$(document).trigger(argosyEvents.END_LOADING);if(!i.IsError){prompt.alert({question:i.Message,description:"",type:"success"});$("li[id='"+a.theme.Id+"']").remove();h.showExistingThemes();var j=userSettings.ThemeId;$("input:radio[value='"+j+"']").prop("checked",true);$("#btnBackToEditTheme").hide();changeCSS("/Style/ChangeCss?id="+j)}else{prompt.alert({question:i.Message,description:"",type:"warning"})}}})},createTheme:function(){var i=this,h=function(l){changeCSS("/Style/ChangeCss?id="+l.Id);$("#createdThemesDiv").show();var j="<li class='tc-item' id=''>\n<div class='input-style'>\n<input name='themegroup' value='' class='bootstrap-toggle' type='radio' id='' onclick=''/>\n<label class='tc-name' for=''></label>\n</div>\n<div class='label-style'>\n<span class='tc-color' name='primary' style='background-color: ''></span>\n<span class='tc-color' name='secondary' style='background-color: ''></span>\n<span class='tc-color' name='tertiary' style='background-color: ''></span>\n<span class='marl10'>\n<a data-argosy-dataid='' data-argosy-action='editTheme' id='showBuildTheme'>\n<i title='Edit this Theme' class='fa fa-pencil' data-id=''></i>\n</a>\n</span>\n</div>\n</li>";i.createdThemes.append(j);var k=i.createdThemes.children().last();i.updateListItem(k,l);$("#btnBackToEditTheme").hide();i.swapCheckboxes(l)};i.setupTheme();$.ajax({url:"/Admin/Theme/Create",contentType:"application/json; charset=utf-8",datatype:"json",data:JSON.stringify(a.theme),method:"POST",success:function(j){h(j.Data);$(document).trigger(argosyEvents.END_LOADING)}})},previewTheme:function(){$(document).trigger(argosyEvents.START_LOADING);var h=this.getSelectors(),i=this.generateStyleSheet(h);this.swapCheckboxes(a.theme);$("#theme-stylesheet").attr("href","");$("#temp-stylesheet").remove();$("#theme-stylesheet").after($("<style />",{id:"temp-stylesheet",type:"text/css"}));$("#temp-stylesheet").html(i);$(document).trigger(argosyEvents.END_LOADING)}});d.html(e);kendo.bind(d,g);setCorrespondingValues();$("#divExistingThemes").hide();$(".gt-accordion h4").each(function(){var j=$(this),i=false,h=j.next("div").slideUp();j.click(function(){i=!i;h.slideToggle(i);j.toggleClass("active",i)})});$.fancybox.close();$("#chooseTheme").hide();d.show();$(document).trigger(argosyEvents.END_LOADING)}})};function TicketCommentsGridView(a){var b=this;$.extend(true,b.options,b.baseOptions,a);$(document).bind(argosyEvents.SEARCH_PAGE_GRID,function(d,c){b.refineSearch(c)});b.refineSearch({})}TicketCommentsGridView.prototype.options={};TicketCommentsGridView.prototype.baseOptions={gridViewSelector:"table[data-argosy-view=TicketCommentsGridView]",ticketIdGridView:null};TicketCommentsGridView.prototype.refineSearch=function(a){var b=this;b.searchCriteria=a;b.setupGrid()};TicketCommentsGridView.prototype.setupGrid=function(){var d=this;var a=d.options.admin;if($(d.options.gridViewSelector).getKendoGrid()==null){var c={exportToExcel:false,autoBind:true,dataSource:d.getDataSource({}),rowTemplate:kendo.template($("#rowTemplate").html()),altRowTemplate:kendo.template($("#altRowTemplate").html())};$(d.options.gridViewSelector).kendoGrid(c)}else{var b=$(d.options.gridViewSelector).getKendoGrid();b.dataSource.read();b.refresh()}};TicketCommentsGridView.prototype.getDataSource=function(a){var b=this;$.extend(true,b.dataSourceOpts,_defaultDataSourceConfig,a);b.dataSourceOpts.transport={read:function(c){var d={TicketNo:b.options.ticketIdGridView};$.extend(true,d,kendoOptionsToObject(c),b.searchCriteria);$.ajax({url:"/DataView/GetTicketComments",dataType:"json",data:d,success:function(e){if(e.ReturnCode==ReturnCode.Failed){handleDataSourceException(e)}else{c.success(e)}}})}};b.dataSourceOpts.pageSize=10;return new kendo.data.DataSource(b.dataSourceOpts)};TicketCommentsGridView.prototype.dataSourceOpts={};TicketCommentsGridView.prototype.getStatus=function(){};function ToggleSwitch(a){var b=this;$.extend(true,b.options,b.baseOptions,a);b.element=$("*[data-argosy-uuid="+b.options.uuid+"]");b.hiddenElement=b.element.parent().find("input[type=hidden]");b.setupToggleSwitchView();b.element.data.toggleSwitch=b}ToggleSwitch.prototype.options={};ToggleSwitch.prototype.baseOptions={checked:false,propertyName:"",displayName:"",onChange:function(a){$(document).trigger(argosyEvents.TOGGLE_SWITCH_CHANGE,a)}};ToggleSwitch.prototype.isChecked=function(){var a=this;return a.element.hasClass("toggle-switch-checked")};ToggleSwitch.prototype.setupToggleSwitchView=function(){var a=this;a.element.addClass("toggle-switch");a.element.addClass("toggle-switch-wrapper");if(a.options.checked){a.element.addClass("toggle-switch-checked")}a.element.append('<label class="toggle-switch toggle-switch-on" for="'+a.options.propertyName+'">'+a.options.displayName+"</label>");a.element.append('<label class="toggle-switch toggle-switch-off" for="'+a.options.propertyName+'">'+a.options.displayName+"</label>");a.element.append('<label class="toggle-switch toggle-switch-slider" for="'+a.options.propertyName+'"></label>');a.element.find(".toggle-switch-on").click(function(b){a.off()});a.element.find(".toggle-switch-off").click(function(b){a.on()});a.element.find(".toggle-switch-slider").click(function(b){if(a.element.hasClass("toggle-switch-checked")){a.off()}else{a.on()}})};ToggleSwitch.prototype.on=function(){var a=this;a.element.addClass("toggle-switch-checked");if(a.hiddenElement){a.hiddenElement.val("true")}if(a.options.onChange!=null){a.options.onChange(a)}};ToggleSwitch.prototype.off=function(){var a=this;a.element.removeClass("toggle-switch-checked");if(a.hiddenElement){a.hiddenElement.val("false")}if(a.options.onChange!=null){a.options.onChange(a)}};function UpdatePrices(b){var c=this;$.extend(true,c.options,c.baseOptions,b);var a=new ControlLoader();a.loadTemplate("UpdatePrices",function(d){$(document.body).append(d)})}UpdatePrices.prototype.options={};UpdatePrices.prototype.baseOptions={};UpdatePrices.prototype.searchCriteria={};UpdatePrices.prototype.viewModel=null;UpdatePrices.prototype.showFancyBox=function(){$.fancybox($("#_UpdatePricesContainer"),{openEffect:"none"})};UpdatePrices.prototype.PriceBreaksData=[];UpdatePrices.prototype.ShowUpdatePrices=function(){var a=this;if(a.viewModel==null){a.viewModel=kendo.observable({priceSource:new kendo.data.DataSource({transport:{read:function(b){$.ajax({url:"/Admin/Parts/GetPrices",dataType:"json",type:"POST",data:a.options,success:function(c){c.forEach(function(d){d.PriceBreaks.forEach(function(e){a.PriceBreaksData.push(e)})});b.success(c);a.showFancyBox()}})},update:function(b){$.ajax({url:"/Admin/Parts/UpdatePrice",dataType:"json",type:"POST",data:{priceList:JSON.stringify(b.data)}});b.success()}},schema:{model:{id:"CompanyPriceListId",fields:{CompanyPriceListId:{editable:false},CompanyPriceListName:{editable:false},DefaultPriceListName:{editable:false},IsDefault:{editable:false},CostPerEach:{type:"number"}}}}}),dataBound:function(d){var g=d.sender;var h=g.dataSource.view();for(var j=0;j<h.length;j++){var c=h[j].uid;var b=g.table.find("tr[data-uid='"+c+"']");var f=$(b).find(".k-grid-edit");if(h[j].StandardPriceListId!=null){f.hide()}}},edit:function(c){var b=c.container.find("td:last");b.html('<div><a title="Save" class="btn k-grid-update fa fa-check"></a><a title="Cancel" class="btn k-grid-cancel fa fa-close"></a></div>')}});kendo.bind($("#_UpdatePricesTemplate"),a.viewModel)}else{a.showFancyBox()}$("#_UpdatePricesTemplate").kendoTooltip({filter:".k-grid-edit",content:"Edit"})};UpdatePrices.prototype.getIndexById=function(a){var e=this;var b,d=e.PriceBreaksData.length;for(var c=0;c<d;c++){if(e.PriceBreaksData[c].Id==a){return c}}return null};UpdatePrices.prototype.showPriceBreaks=function(a){var b=this;if(!$("#priceBreakDiv"+a).length){$("#divPriceBreaks"+a).parents("tr").after('<tr role="row" class="k-detail-row" id="priceBreakCell'+a+'"><td>&nbsp;</td><td colspan="4" role="gridcell"><input type="hidden" name="priceListId" value="'+a+'"/><div class="priceBreakGrid" id="priceBreakDiv'+a+'"></div></td></tr>')}if($("#priceBreakDiv"+a).getKendoGrid()==null){$("#priceBreakDiv"+a).kendoGrid({dataSource:{transport:{read:function(c){c.success(UpdatePrices.prototype.PriceBreaksData)},create:function(c){if(c.data.Id==""){c.data.Id=0;$.ajax({url:"/Admin/Parts/SavePriceBreaks",type:"POST",dataType:"json",data:{priceListId:a,priceBreaks:JSON.stringify(c.data)},success:function(d){if(d.success){UpdatePrices.prototype.PriceBreaksData=[];d.priceLists.forEach(function(e){e.PriceBreaks.forEach(function(f){UpdatePrices.prototype.PriceBreaksData.push(f)})})}$("#priceBreakDiv"+a).data("kendoGrid").refresh()}})}},update:function(c){$.ajax({url:"/Admin/Parts/SavePriceBreaks",type:"POST",dataType:"json",data:{priceListId:a,priceBreaks:JSON.stringify(c.data)},success:function(d){if(d.success){UpdatePrices.prototype.PriceBreaksData=[];d.priceLists.forEach(function(e){e.PriceBreaks.forEach(function(f){UpdatePrices.prototype.PriceBreaksData.push(f)})})}$("#priceBreakDiv"+a).data("kendoGrid").refresh()}})},destroy:function(c){$.ajax({url:"/Admin/Parts/DeletePriceBreak",type:"POST",dataType:"json",data:{priceListId:a,priceBreakId:c.data.Id},success:function(d){UpdatePrices.prototype.PriceBreaksData=[];d.forEach(function(e){e.PriceBreaks.forEach(function(f){UpdatePrices.prototype.PriceBreaksData.push(f)})});$("#priceBreakDiv"+a).data("kendoGrid").refresh()}})}},error:function(c){},schema:{model:{id:"Id",fields:{Id:{editable:false},PriceListId:{editable:false,defaultValue:a},Quantity:{type:"number",validation:{min:1,required:true}},TypeString:{validation:{required:true},defaultValue:"$"},Discount:{type:"number",validation:{min:0.01,required:true}}}}},filter:{field:"PriceListId",operator:"eq",value:a},},editable:"inline",toolbar:[{name:"create",text:""}],columns:[{field:"Id",hidden:true},{field:"PriceListId",hidden:true},{field:"Quantity",title:"Volume",width:"10px",headerAttributes:{style:"text-align:right"},attributes:{style:"padding:0 5px; text-align:right;"},editor:UpdatePrices.prototype.NumericEditor},{field:"TypeString",editor:b.typeDropDownEditor,title:"Type",width:"10px",headerAttributes:{style:"text-align:right;"},attributes:{style:"padding:0 5px;"}},{field:"Discount",title:"Discount",width:"10px",headerAttributes:{style:"text-align:right"},attributes:{style:"padding:0 5px;"},editor:UpdatePrices.prototype.NumericEditor},{command:[{name:"destroy",text:"",width:"25px",iconClass:"fa fa-times",htmlAttributes:{title:"Delete"}},{name:"edit",text:"",width:"25px",iconClass:"fa fa-edit",attributes:{title:"Edit"}}],width:"10px",attributes:{style:"padding:0"}}],edit:function(d){var c=d.container.find("td:last");c.html('<div><a title="Save" class="btn k-grid-update fa fa-check"></a><a title="Cancel" class="btn k-grid-cancel fa fa-close"></a></div>')},dataBound:function(f){var g=f.sender;var h=g.dataSource.view();for(var j=0;j<h.length;j++){var d=h[j].uid;var c=g.table.find("tr[data-uid='"+d+"']")}},});b.showFancyBox()}else{$("#priceBreakCell"+a).toggle()}$("#priceBreakDiv"+a).kendoTooltip({filter:".k-grid-edit",content:"Edit"});$("#priceBreakDiv"+a).kendoTooltip({filter:".k-grid-delete",content:"Delete"})};UpdatePrices.prototype.typeDropDownEditor=function(a,b){$('<input required name="'+b.field+'"/>').appendTo(a).kendoDropDownList({autoBind:false,dataTextField:"text",dataValueField:"value",dataSource:[{value:"$",text:"$"},{value:"%",text:"%"}],}).data("kendoDropDownList").value(b.model.TypeString)};UpdatePrices.prototype.NumericEditor=function(a,c){var b="0.0001";var d="0.0001";if(c.field=="Quantity"){b="1";d="1"}$(a).append('<input required type="number" min="'+b+'" style="width:75%" step="'+d+'" class="numericText textr" name="'+c.field+'"></input>')};function UserAccountingUnits(a){var b=this;$.extend(true,b.options,b.baseOptions,a);b.setupGrid({})}UserAccountingUnits.prototype.options={};UserAccountingUnits.prototype.baseOptions={gridViewSelector:"div[data-argosy-view=UserAccountingUnits]",};UserAccountingUnits.prototype.searchCriteria={};UserAccountingUnits.prototype.setupGrid=function(){var b=this;if(b.kendoGrid==null){var a={dataSource:b.getDataSource({}),groupable:false,sortable:true,scrollable:false,exportToExcel:false,pageable:{refresh:true,pageSizes:false,buttonCount:1},columns:[{template:"<i class='fa la fa-times'></i>",width:"10%"},{title:"~{AccountingUnit}~",field:"AccountingUnit"},{title:"~{Default}~",template:"<input class='bootstrap-toggle' type='radio'  id='rb_${AccountingUnitUserId}' name='optDefault' />"}],title:"~{AccountingUnit}~",toolbar:[{name:"addUnits",text:" ~{Add}~","class":"fa fa-plus"}],addUnits:function(c){b.showAddUnitsModal()},dataBinding:function(c){},dataBound:function(c){var f=$(c.sender.element);var d=f.getKendoGrid();f.find("tbody tr[role=row]").each(function(){var h=$(this).find(".bootstrap-toggle");var e=d.dataItem(this);if(e.IsDefault){h.attr("checked","checked")}h.unbind("click");h.click(function(){b.updateUserDefaultAccountingUnit(e)});var g=$(this).find(".fa.la.fa-times").parent();g.unbind("click");g.click(function(){b.showDeleteUserFromAccountUnit(e)})})},};$(b.options.gridViewSelector).kendoCollapseGrid(a)}else{b.kendoGrid.dataSource.read();b.kendoGrid.refresh()}};UserAccountingUnits.prototype.showAddUnitsModal=function(a){$.fancybox({href:"#AddAccountingUnits"})};UserAccountingUnits.prototype.showDeleteUserFromAccountUnit=function(a){var c=this;var b={question:"",description:"",button:"",type:"warning",yes:function(d){if(typeof(d.preventDefault)==="function"){c.deleteUsersFromAU(a)}}};b.question="~{WantToRemoveSelection}~";b.button="~{Remove}~";prompt.alert(b)};UserAccountingUnits.prototype.deleteUsersFromAU=function(c){var b=this;var a={user:c};$.ajax({url:"/Admin/AccountUnit/DeleteUsersFromAccountingUnit",type:"POST",data:JSON.stringify(a),dataType:"json",traditional:true,contentType:"application/json; charset=utf-8",success:function(e){if(e.ReturnCode==ReturnCode.Success){$(e.Records).each(function(){prompt.notify({question:"User "+this.Key+" was "+(!this.Value?"":"not")+" successfully deleted.",type:(!this.Value?"success":"error")})})}else{prompt.clientResponseError(e)}var d=$(b.options.gridViewSelector).find(".k-collapse-grid").getKendoGrid();d.dataSource.read();d.refresh(true)}});$.fancybox.close()};UserAccountingUnits.prototype.updateUserDefaultAccountingUnit=function(c){var b=this;var a={user:c};$.ajax({url:"/Admin/Users/UpdateUserDefaultAccountingUnit",type:"POST",data:JSON.stringify(a),dataType:"json",traditional:true,contentType:"application/json; charset=utf-8",success:function(f){var d=$(b.options.gridViewSelector).find(".k-collapse-grid").getKendoGrid();if(f.ReturnCode==ReturnCode.Success){$("#AccountingUnitId").val(c.AccountingUnitId);prompt.notify({question:f.Message,type:(f.ReturnCode==200?"success":"error")})}else{prompt.clientResponseError(f)}d.dataSource.read();d.refresh(true);var e=$("div[data-argosy-view=PartCategoryModalGridView]").getKendoGrid();e.dataSource.read();e.refresh(true)}})};UserAccountingUnits.prototype.getDataSource=function(a){var b=this;$.extend(true,b.dataSourceOpts,_defaultDataSourceConfig,a);b.dataSourceOpts.pageSize=5;b.dataSourceOpts.transport={read:function(c){var d=b.options;$.extend(true,d,kendoOptionsToObject(c),b.searchCriteria);$.ajax({url:"/DataView/GetUserAccountUnits",dataType:"json",data:d,success:function(e){if(e.ReturnCode==ReturnCode.Failed){handleDataSourceException(e)}else{c.success(e)}}})}};return new kendo.data.DataSource(b.dataSourceOpts)};UserAccountingUnits.prototype.dataSourceOpts={};function UserBudgetsGridView(a){var b=this;$.extend(true,b.options,b.baseOptions,a);$(document).bind(argosyEvents.SEARCH_PAGE_GRID,function(d,c){b.refineSearch(c)});b.search()}UserBudgetsGridView.prototype.options={};UserBudgetsGridView.prototype.baseOptions={gridViewSelector:"div[data-argosy-view=UserBudgetsGridView]",};UserBudgetsGridView.prototype.searchCriteria={};UserBudgetsGridView.prototype.refineSearch=function(a){var c=this;c.searchCriteria=a;var b=$(c.options.gridViewSelector).getKendoGrid();b.dataSource.read();b.refresh()};UserBudgetsGridView.prototype.search=function(){var c=this;if($(c.options.gridViewSelector).getKendoGrid()==null){var b={scrollable:false,editable:false,autoBind:true,dataSource:c.getDataSource({}),groupable:false,sortable:true,dataBound:function(d){$("div[data-argosy-view=UserBudgetsGridView] th:eq(2) ,div[data-argosy-view=UserBudgetsGridView]  tr td:nth-child(3)").addClass("hidden-xs")},pageable:{refresh:true,pageSizes:[50,100,500],buttonCount:5},columns:[{title:"~{GroupName}~",field:"GroupName",template:"<a href='/Tools/UserBudgets/Edit/${UserGroupId}'>${GroupName}<a>"},{title:"~{GroupManager}~",field:"ManagerName"},{title:"~{ManagementType}~",field:"GroupManager",template:"<div>#if (ManagementType == 2) {#User#} else { if (ManagementType == 1) {#Group#} else {#None#}}#</div>"},{title:"<div class='textr'>~{GroupBudget}~</div>",field:"UserGroupBudget",template:"<div class='textr'>#:kendo.toString(UserGroupBudget,'c')#</div>"}],dataBinding:function(d){},search:[{name:"GroupName",type:"text",placeholder:"~{GroupName}~",toolbar:false},{name:"GroupDescription",type:"text",placeholder:"~{GroupDescription}~",toolbar:false},{name:"Keyword",type:"text",placeholder:"~{SearchByGroupNameDescription}~",toolbar:true},{name:"IsActive",type:"select",toolbar:true,data:[{value:"true",text:"~{Active}~",selected:true},{value:"false",text:"~{Inactive}~"},{value:"null",text:"~{All}~"}]},{name:"IsRetail",type:"select",placeholder:"-- ~{Retail}~ --",toolbar:false,data:[{value:"true",text:"~{Yes}~"},{value:"false",text:"~{No}~"},{value:"null",text:"~{All}~"}]}],};$(c.options.gridViewSelector).kendoArgosyGrid(b)}else{var a=$(c.options.gridViewSelector).getKendoGrid();a.dataSource.read();a.refresh()}};UserBudgetsGridView.prototype.getDataSource=function(a){var b=this;$.extend(true,b.dataSourceOpts,_defaultDataSourceConfig,a);b.dataSourceOpts.transport={read:function(c){var d={};$.extend(true,d,kendoOptionsToObject(c),b.searchCriteria);$.ajax({url:"/DataView/GetUserGroups",dataType:"json",data:d,success:function(e){if(e.ReturnCode==ReturnCode.Failed){handleDataSourceException(e)}else{c.success(e)}}})}};return new kendo.data.DataSource(b.dataSourceOpts)};UserBudgetsGridView.prototype.dataSourceOpts={};function UserCoopFundsGrid(b){var c=this;$.extend(true,c.options,c.baseOptions,b);var a=new ControlLoader();c.options.element=$("*[data-argosy-uuid='"+c.options.uuid+"']");a.loadControl("ModalCoopBucketDetail",{},function(d){c.bucketDetailControl=d});a.loadTemplate("UserCoopFunds",function(e){$(document.body).append(e);c.setupViewModel();var d=$(c.options.baseTemplate).html();c.options.element.append(kendo.template(d));kendo.bind($(c.options.bindContainer),c.options.viewModel)})}UserCoopFundsGrid.prototype.options={element:null,companyId:0,userId:0,userGroupId:null,viewModel:null,isAdmin:false,controllerName:"",actionName:""};UserCoopFundsGrid.prototype.baseOptions={baseTemplate:"#_userCoopFundsMainTemplate",bindContainer:"#_userCoopFundsContainer",toolbar:"#_userCoopFundsToolbar",gridViewSelector:"div[data-argosy-view=UserCoopFundsGrid]",keyword:"#_coopFundsKeyword",toolbarTemplate:"#toolbarTemplate",userBalance:""};UserCoopFundsGrid.prototype.bucketDetailControl=null;UserCoopFundsGrid.prototype.searchCriteria={userId:0,userGroupId:0,companyId:0,bucketId:null,keyword:""};UserCoopFundsGrid.prototype.setupViewModel=function(){var a=this;a.options.viewModel=kendo.observable({userId:a.options.userId,userGroupId:a.options.userGroupId,companyId:a.options.companyId,currentBucket:new kendo.data.ObservableObject({Name:"",Id:null,Details:[],PartIds:[]}),keyword:"",transactions:new kendo.data.DataSource({pageSize:50,schema:{data:function(b){return b.Records},total:function(b){return b.TotalRecords}},serverFiltering:true,serverSorting:true,serverPaging:true,transport:{read:{url:"/DataView/GetFunds",contentType:"application/json",dataType:"json"},parameterMap:function(b){b=kendoOptionsToObject(b);b.UserId=a.options.viewModel.get("userId");b.UserGroupId=a.options.viewModel.get("userGroupId");b.BucketId=a.options.viewModel.currentBucket.get("Id");b.Keyword=a.options.viewModel.get("keyword");return b}}}),buckets:new kendo.data.DataSource({pageSize:25,schema:{data:function(b){return b.Records},total:function(b){return b.TotalRecords},model:{id:"Id"}},serverFiltering:true,serverSorting:true,serverPaging:true,transport:{read:{url:"/coop/GetAvailableBuckets",contentType:"application/json",dataType:"json"},parameterMap:function(b){b=kendoOptionsToObject(b);b.CompanyId=a.options.viewModel.get("companyId");return b}}}),funds:new kendo.data.DataSource({pageSize:25,schema:{data:function(b){return b.Records},total:function(b){return b.TotalRecords},model:{id:"Id"}},serverFiltering:true,serverSorting:true,serverPaging:true,transport:{read:{url:"/DataView/GetUserBalances",contentType:"application/json",dataType:"json"},parameterMap:function(b){b=kendoOptionsToObject(b);b.UserId=a.options.viewModel.get("userId");b.UserGroupId=a.options.viewModel.get("userGroupId");return b}}}),transactionsDataBound:function(b){kendo.bind($(a.options.toolbar),b.data)},searchCoopFunds:function(b){b.data.transactions.read()},toolbarText:function(){var b;if(a.options.viewModel.currentBucket!=null){b=a.options.viewModel.currentBucket.get("Name")+" <b>"+kendo.toString(a.options.viewModel.currentBucket.get("BalanceForUser"),"c")+"</b> "}else{b=a.options.userBalance}b+=" <a class='marl10' data-bind='events: { click: viewAllDetails }'><i class='fa fa-eye'></i> View details</a>";if(userSettings.IsAdmin&&window.location.pathname.split("/")[1]==="Admin"){b+="<a class='marl10' data-bind='events: { click: addCoopFunds }'><i class='fa fa-plus'></i> ~{AddCoopFunds}~</a>"}return b},viewAllDetails:function(){$.fancybox({href:"#_userCoopBucketDetails",maxWidth:400})},addCoopFunds:function(){showAddCoOpFundsModal()},showBucketDetails:function(d){var b=$(d.currentTarget),c=b.data("id");a.bucketDetailControl.show(c)},showSearch:function(){switch(a.options.actionName){case"Edit":return false;case"CoopDollars":return true;default:return false}}})};UserCoopFundsGrid.prototype.dataSourceOpts={};function UserEditAddPartLimits(a){var b=this;b.options.userGroupId=null;$.extend(true,b.options,b.baseOptions,a);$(document).bind(argosyEvents.SEARCH_PAGE_GRID,function(d,c){b.refineSearch(c)});b.refineSearch({})}UserEditAddPartLimits.prototype.options={};UserEditAddPartLimits.prototype.baseOptions={gridViewSelector:"div[data-argosy-view=UserEditAddPartLimits]",};UserEditAddPartLimits.prototype.searchCriteria={};UserEditAddPartLimits.prototype.refineSearch=function(a){var b=this;b.searchCriteria=a;b.setupGrid()};UserEditAddPartLimits.prototype.setupGrid=function(){var c=this;if($(c.options.gridViewSelector).getKendoGrid()==null){var b={dataSource:c.getDataSource({}),groupable:false,sortable:true,exportToExcel:false,scrollable:false,selectable:"multiple, row",pageable:{refresh:true,pageSizes:false,buttonCount:1},columns:[{title:"~{SKU}~",template:"${Sku}"},{title:"<span class='floatr textr'>~{ProductLimitQuantity}~<b class='co-warning'>*</b></span>",template:'<div class=\'textr\'><input  min=\'0\' max=\'9999999\'class="numericText textr" onblur="javascript:editPartLimit(this)" id="txtLimitQty"  name="txtLimitQty" value="#if (LimitQuantity == null) {#0#} else {#${LimitQuantity}#}#"/>   </div>',width:"15%"},{title:"~{TimeFrame}~",template:'<select id="timeFrameDDL"  onChange="javascript:viewPartLimits(this)" style="width:90%"><option selected="selected" value="null">~{SelectOne}~</option><option #if (Days == 1) {# selected="selected" #}# value="1">~{Daily}~</option><option #if (Days == 7) {# selected="selected" #}#  value="7">7 ~{Days}~</option><option #if (Days == 30) {# selected="selected" #}#  value="30">30 ~{Days}~</option><option #if (Days == 60) {# selected="selected" #}#  value="60">60 ~{Days}~</option><option #if (Days == 90) {# selected="selected" #}#  value="90">90 ~{Days}~</option><option #if (Days == 120) {# selected="selected" #}#  value="120">120 ~{Days}~</option><option #if (Days == 160) {# selected="selected" #}#  value="160">160 ~{Days}~</option><option #if (Days == 180) {# selected="selected" #}#  value="180">180 ~{Days}~</option></select>'}],checkboxes:false,search:[{name:"Keyword",type:"text",placeholder:"~{SearchSKUProduct}~",toolbar:true}],dataBinding:function(d){},dataBound:function(d){var g=$(d.sender.element);var f=g.getKendoGrid();g.find("tbody tr[role=row]").each(function(){var e=f.dataItem(this);var h=$(this).find(".numericText");$(h).kendoNumericTextBox({min:$(this).attr("min"),max:$(this).attr("max"),format:"#",decimal:0,spinners:false})})}};$(c.options.gridViewSelector).kendoArgosyGrid(b)}else{var a=$(c.options.gridViewSelector).getKendoGrid();a.dataSource.read();a.refresh()}};UserEditAddPartLimits.prototype.showDeletePartLimitModal=function(a){var c=this;var b={question:"",description:"",button:"",type:"warning",yes:function(d){c.DeletePartLimitFromUser(a)}};b.question="~{WantToRemoveSelection}~";b.description="~{CanNotRecoverProductLimit}~ ";b.button="~{Remove}~";prompt.alert(b)};UserEditAddPartLimits.prototype.DeletePartLimitFromUser=function(b){var c=this;var a={partLimit:b};$.ajax({url:"/Admin/Users/DeleteUserPartLimit",type:"POST",data:JSON.stringify(a),dataType:"json",traditional:true,contentType:"application/json; charset=utf-8",success:function(e){var d=$(c.options.gridViewSelector).getKendoGrid();if(e.ReturnCode==ReturnCode.Success){$(e.Records).each(function(){prompt.notify({question:this.Key+" was "+(!this.Value?"":"not")+" successfully deleted.",type:(!this.Value?"success":"error")})})}else{prompt.clientResponseError(e)}d.dataSource.read();d.refresh(true)}});$.fancybox.close()};UserEditAddPartLimits.prototype.getDataSource=function(a){var b=this;$.extend(true,b.dataSourceOpts,_defaultDataSourceConfig,a);b.dataSourceOpts.pageSize=5;b.dataSourceOpts.transport={read:function(c){var d=b.options;$.extend(true,d,kendoOptionsToObject(c),b.searchCriteria);$.ajax({url:"/Admin/Users/GetUserPartLimits",dataType:"json",data:d,success:function(e){if(e.ReturnCode==ReturnCode.Failed){handleDataSourceException(e)}else{c.success(e)}}})}};return new kendo.data.DataSource(b.dataSourceOpts)};UserEditAddPartLimits.prototype.dataSourceOpts={};function UserExclusionTagsGrid(a){var b=this;$.extend(true,b.options,b.baseOptions,a);b.options.exclusionTags=JSON.parse(b.options.exclusionTags);b.options.setExclusionTagsDataSource();b.options.userDataSource.add({UserId:b.options.userId,CompanyId:b.options.companyId,ExclusionArray:b.options.exclusionTags});b.setupExclusionTagsCollapseGrid();b.setupExclusionTagsGrid()}UserExclusionTagsGrid.prototype.options={companyId:0,userId:0,exclusionTags:[],exclusionTagsDataSource:new kendo.data.DataSource(),userDataSource:new kendo.data.DataSource({transport:{update:{url:"/Admin/Users/UpdateExclusionTags",type:"post",dataType:"json",contentType:"application/json; charset=utf-8"},parameterMap:function(a){return kendo.stringify(a)}},schema:{model:{id:"UserId"}},requestEnd:function(a){if(a.response!=null){UserExclusionTagsGrid.prototype.options.mapUserResponse(a.response)}}}),mapUserResponse:function(a){if(a.Records.ExclusionArray==null){this.exclusionTags=[]}else{this.exclusionTags=a.Records.ExclusionArray}$("#ExclusionTags").val(a.Records.ExclusionTags);this.setExclusionTagsDataSource();this.typeAheadDataSource.read()},setExclusionTagsDataSource:function(){var b=this,a=[];$.each(b.exclusionTagsDataSource.data(),function(d,c){a.push(c)});$.each(a,function(d,c){b.exclusionTagsDataSource.remove(c)});$.each(b.exclusionTags,function(d,c){b.exclusionTagsDataSource.add({name:c})})},typeAheadDataSource:new kendo.data.DataSource({sort:[{field:"name",dir:"asc"}],transport:{read:{url:"/DataView/GetTypeAheads",dataType:"json",contentType:"application/json; charset=utf-8",data:function(a){a.companyId=UserExclusionTagsGrid.prototype.options.companyId;a.tags=UserExclusionTagsGrid.prototype.options.exclusionTags.join(",");a.type=2;return a}}},pageSize:5,schema:{model:{id:"id",fields:{id:{type:"number"},name:{type:"string"}}},parse:function(a){$.each(a.Records,function(b,c){a.Records[b]={id:b,name:c}});return a},data:function(a){return a.Records},total:function(a){return a.TotalRecords}}})};UserExclusionTagsGrid.prototype.baseOptions={exclusionTagsCollapseGrid:"#exclusionTagsCollapseGrid",exclusionTagsGrid:"#exclusionTagsGrid"};UserExclusionTagsGrid.prototype.setupExclusionTagsCollapseGrid=function(){var a=this;$(a.options.exclusionTagsCollapseGrid).kendoCollapseGrid({scrollable:false,editable:false,dataSource:a.options.exclusionTagsDataSource,groupable:false,sortable:true,exportToExcel:false,toolbar:[{name:"showExclusionTags",text:" ~{Add}~","class":"fa fa-plus"}],labelProperty:"name",title:"~{ExclusionTags}~",type:"list",remove:function(b){a.showRemovePrompt(b.data)},showExclusionTags:function(){$.fancybox({href:"#exclusionTagsGrid"})}})};UserExclusionTagsGrid.prototype.setupExclusionTagsGrid=function(){var c=this,a=$(c.options.exclusionTagsGrid).data("kendoGrid");if(a==null){var b={dataSource:c.options.typeAheadDataSource,groupable:false,editable:false,sortable:true,autoBind:true,scrollable:false,exportToExcel:false,selectable:"multiple, row",pageable:{refresh:true,pageSizes:false,buttonCount:1},columns:[{title:"Exclusion Tag",field:"name"}],title:"~{ExclusionTags}~",toolbar:[{name:"addExclusionTags",text:"Add Selected Tags","class":"fa fa-plus"}],dataBound:function(f){var d=$(f.sender.element).find(".k-grid-addExclusionTags"),g=[];d.click(function(){if(f.sender.select().length>0){$.each(f.sender.select(),function(e,h){g.push(f.sender.dataItem(h).name)});UserExclusionTagsGrid.prototype.showAddPrompt(g)}})}};$(c.options.exclusionTagsGrid).kendoCustomGrid(b)}else{a.dataSource.read()}};UserExclusionTagsGrid.prototype.showAddPrompt=function(a){var c=this,b={buttonNoHidden:false,no:function(){$.fancybox.close()},type:"warning",yes:function(d){if(typeof(d.preventDefault)==="function"){c.addExclusionTags(a)}},question:"~{WantToAddTag}~ '"+a.join(", ")+"'?",description:"~{TagWillBeAdded}~",button:"~{Add}~"};prompt.alert(b)};UserExclusionTagsGrid.prototype.showRemovePrompt=function(a){var c=this,b={buttonNoHidden:false,no:function(){$.fancybox.close()},type:"warning",yes:function(d){if(typeof(d.preventDefault)==="function"){c.removeExclusionTag(a)}},question:"~{WantToRemove}~ '"+a.name+"'?",description:"~{CanNotRecoverDeletedTags}~",button:"~{Remove}~"};prompt.alert(b)};UserExclusionTagsGrid.prototype.removeExclusionTag=function(b){var a=this.options.userDataSource.data()[0].ExclusionArray,c=a.indexOf(b.name);a.splice(c,1);this.options.userDataSource.sync();$.fancybox.close()};UserExclusionTagsGrid.prototype.addExclusionTags=function(b){var a=this.options.userDataSource.data()[0].ExclusionArray;$.each(b,function(c,d){a.push(d)});this.options.userDataSource.data()[0].ExclusionTags=a.join(",");this.options.userDataSource.sync();$.fancybox.close()};function UserGridView(a){var b=this;$.extend(true,b.options,b.baseOptions,a);$(document).bind(argosyEvents.SEARCH_PAGE_GRID,function(d,c){b.refineSearch(c)});b.refineSearch({})}UserGridView.prototype.options={};UserGridView.prototype.baseOptions={gridViewSelector:"div[data-argosy-view=UserGridView]"};UserGridView.prototype.searchCriteria={Active:null,Keyword:null,Username:null,FirstName:null,LastName:null,Email:null,Title:null,PhoneNumber:null,DivisionName:null,IsStore:null,Custom01:null,Custom02:null,Custom03:null,RecordSizeCategory:0};UserGridView.prototype.refineSearch=function(a){var b=this;$.extend(true,b.searchCriteria,a);b.setupGrid()};UserGridView.prototype.setupGrid=function(){var c=this,a=$(c.options.gridViewSelector).getKendoGrid();if(a==null){var b={scrollable:false,editable:false,autoBind:true,dataSource:c.getDataSource({}),groupable:false,sortable:true,selectable:"multiple, row",pageable:{refresh:true,pageSizes:[50,100,500],buttonCount:2},columns:[{title:"~{UserName}~",field:"Username",template:"<a href='/Admin/Users/Edit/${UserId}'>${Username}<a>"},{title:"~{Name}~",field:"LastName",template:"${FirstName} ${LastName}"},{title:"~{Email}~",field:"Email"},{title:"<div class='text-center'>~{Admin}~</div>",field:"AdminAccess",template:"<div class='text-center'>#if (AdminAccess == true) {#<span>YES</span>#} else {#<span>NO</span>#}#</div>",width:"10%"},{title:"<div class='text-center'>~{Restock}~</div>",field:"PrintOrders",template:"<div class='text-center'>#if (PrintOrders == true) {#<span>YES</span>#} else {#<span>NO</span>#}#</div>",width:"10%"},{title:"<div class='text-center'>~{PowerBuyer}~</div>",field:"PowerBuyer",template:"<div class='text-center'>#if (PowerBuyer == true) {#<span>YES</span>#} else {#<span>NO</span>#}#</div>",width:"10%"},{title:"<div class='text-center'>~{Active}~</div>",field:"Active",template:"<div class='bold text-center'>#if (Active == true) {#<span>YES</span>#} else {#<span>NO</span>#}#</div>",width:"10%"}],checkboxes:true,dataBound:function(d){var f=$(d.sender.element);f.find(".k-button.k-button-icontext.k-grid-activate").unbind("click").click(function(){c.showUpdateUserModal(c.getSelectedRecords(),true)});f.find(".k-button.k-button-icontext.k-grid-deactivate").unbind("click").click(function(){c.showUpdateUserModal(c.getSelectedRecords(),false)});$("div[data-argosy-view=UserGridView] th:eq(3),div[data-argosy-view=UserGridView]  tr td:nth-child(4)").addClass("hidden-sm hidden-xs");$("div[data-argosy-view=UserGridView] th:eq(4),div[data-argosy-view=UserGridView]  tr td:nth-child(5)").addClass("hidden-sm hidden-xs");$("div[data-argosy-view=UserGridView] th:eq(5),div[data-argosy-view=UserGridView]  tr td:nth-child(6)").addClass("hidden-sm hidden-xs")},toolbar:[{name:"deactivate",text:"<i class='fa fa-close'></i><span class='resp-hidden'> ~{Deactivate}~</span>"},{name:"activate",text:"<i class='fa fa-check'></i><span class='resp-hidden'> ~{Activate}~</span>"}],search:[{name:"Username",type:"text",placeholder:"Username",toolbar:false},{name:"FirstName",type:"text",placeholder:"First Name",toolbar:false},{name:"LastName",type:"text",placeholder:"Last Name",toolbar:false},{name:"Keyword",type:"text",placeholder:"~{SearchByUsernameFirstLast}~",toolbar:true},{name:"Active",type:"select",toolbar:true,data:[{value:"true",text:"~{Active}~",selected:true},{value:"false",text:"~{Inactive}~"},{value:"",text:"~{All}~"}]},{name:"Email",type:"text",placeholder:"Email",toolbar:false},{name:"Title",type:"text",placeholder:"Title",toolbar:false},{name:"PhoneNumber",type:"text",placeholder:"Phone",toolbar:false},{name:"DivisionName",type:"text",placeholder:"Division",toolbar:false},{name:"IsStore",type:"checkbox",placeholder:"Include Retail Stores",toolbar:false},{name:"Custom01",type:"text",placeholder:"Custom 1",toolbar:false},{name:"Custom02",type:"text",placeholder:"Custom 2",toolbar:false},{name:"Custom03",type:"text",placeholder:"Custom 3",toolbar:false}]};$(c.options.gridViewSelector).kendoArgosyGrid(b)}else{a.dataSource.read()}};UserGridView.prototype.showUpdateUserModal=function(d,a){var c=this,b={question:"",description:"",button:"",type:"warning",yes:function(f){if(typeof(f.preventDefault)==="function"){c.updateUserState(d,a)}}};if(a){b.question="~{WantToActivateSelection}~";b.description="~{ActiveUsersIgnored}~";b.button="~{Activate}~"}else{b.question="~{WantToDeactivateSelection}~";b.description="~{InactiveUsersIgnored}~";b.button="~{Deactivate}~"}prompt.alert(b)};UserGridView.prototype.updateUserState=function(d,a){var c=this,b={users:d,activate:a};$(document).trigger(argosyEvents.START_LOADING);$.ajax({url:"/Admin/Users/UpdateUserStatus",type:"POST",data:JSON.stringify(b),dataType:"json",traditional:true,contentType:"application/json; charset=utf-8",success:function(e){$(document).trigger(argosyEvents.END_LOADING);if(e.ReturnCode===ReturnCode.Success){prompt.notify({question:"User(s) successfully updated.",type:"success"})}else{prompt.clientResponseError(e)}$(c.options.gridViewSelector).getKendoGrid().dataSource.read()}});$.fancybox.close()};UserGridView.prototype.getSelectedRecords=function(){var c=this,b=[],a=$(c.options.gridViewSelector).getKendoGrid();$(a.select()).each(function(){b.push(a.dataItem(this))});return b};UserGridView.prototype.getDataSource=function(a){var b=this;$(document).trigger(argosyEvents.START_LOADING);$.extend(true,b.dataSourceOpts,_defaultDataSourceConfig,a);b.dataSourceOpts.transport={read:function(c){var d={Active:null};$.extend(true,d,kendoOptionsToObject(c),b.searchCriteria);$.ajax({url:"/DataView/GetUsers",dataType:"json",data:d,success:function(e){$(document).trigger(argosyEvents.END_LOADING);if(e.ReturnCode===ReturnCode.Failed){handleDataSourceException(e)}else{c.success(e)}}})},serverSorting:true};return new kendo.data.DataSource(b.dataSourceOpts)};UserGridView.prototype.dataSourceOpts={};function UserGroupBudgetDetailGridView(a){var b=this;$.extend(true,b.options,b.baseOptions,a);$(document).bind(argosyEvents.SEARCH_PAGE_GRID,function(d,c){b.refineSearch(c)});b.search()}UserGroupBudgetDetailGridView.prototype.options={};UserGroupBudgetDetailGridView.prototype.baseOptions={gridViewSelector:"div[data-argosy-view=UserGroupBudgetDetailGridView]",availableBudgetSelector:"",RecordSizeCategory:40,canEditUser:false,groupBudget:0,totalBudgetUsed:0,budgetLeftToSpend:0,alertSelector:""};UserGroupBudgetDetailGridView.prototype.searchCriteria={};UserGroupBudgetDetailGridView.prototype.refineSearch=function(a){var c=this;c.searchCriteria=a;var b=$(c.options.gridViewSelector).getKendoGrid();b.dataSource.read();b.refresh()};UserGroupBudgetDetailGridView.prototype.search=function(){var c=this;if($(c.options.gridViewSelector).getKendoGrid()==null){var b={scrollable:false,editable:false,autoBind:true,dataSource:c.getDataSource({}),groupable:false,sortable:true,pageable:{refresh:true,pageSizes:[50,100,500],buttonCount:5},columns:[{title:"~{FullName}~",field:"FullName",width:"200px"},{title:"~{UserName}~",field:"Username",width:"200px"},{title:"<div class='textr'>~{SpendingLimit}~</div>",field:"SpendingLimit",template:c.options.canEditUser?"<div class='textr'><input class=\"numericText\" id='txtSpendingLimit_${UserId}' UserId=${UserId} name='txtSpendingLimit_${UserId}' value='${SpendingLimit}' /></div>":"<div class='textr'><label>${SpendingLimit}</label></div>",width:"100px"}],checkboxes:false,dataBound:function(f){var g=f.sender;if(g.dataSource.total()==0){var d=g.columns.length;$(f.sender.wrapper).find("tbody").append('<tr class="kendo-data-row"><td colspan="'+d+'" class="no-data">'+loadEmptyGridTemplate("~{NoBudgetsReturned}~")+"</td></tr>")}$(c.options.gridViewSelector).getKendoGrid().tbody.find(".numericText").each(function(){$(this).kendoNumericTextBox({min:$(this).attr("min"),max:$(this).attr("max"),change:function(h){h.preventDefault();var i=h.sender.value();if(i<=c.options.budgetLeftToSpend||c.options.budgetType=="Group"){$(document).trigger(argosyEvents.START_LOADING,{element:$(".loader"),message:"Updating budget amount"});$(c.options.alertSelector).hide();var k=h.sender.element.attr("UserId");var j={userId:k,spendingLimit:i};$.ajax({url:"/Admin/Users/UpdateUserSpendingLimit",type:"POST",data:JSON.stringify(j),dataType:"json",contentType:"application/json; charset=utf-8",success:function(l){$(document).trigger(argosyEvents.END_LOADING,{element:$(".loader")});if(!l.IsError){prompt.notify({question:l.Message,type:"success"})}else{prompt.clientResponseError(l.Message)}var e=$(c.options.gridViewSelector).getKendoGrid();e.dataSource.read();e.refresh(true)}})}else{$(c.options.alertSelector).html('<button type="button" class="close" data-dismiss="alert" aria-label="Close"><span aria-hidden="true"></span></button><b>Unable to assign that value:</b> The avaliable budget left to assign is '+c.options.budgetLeftToSpend+".").show("slow")}},format:"c",decimal:2,spinners:false})});$("div[data-argosy-view=UserGroupBudgetDetailGridView] th:eq(3) ,div[data-argosy-view=UserGroupBudgetDetailGridView]  tr td:nth-child(3)").addClass("hidden-xs")},dataBinding:function(d){},search:[{name:"FirstName",type:"text",placeholder:"~{FirstName}~",toolbar:false},{name:"LastName",type:"text",placeholder:"~{LastName}~",toolbar:false},{name:"UserName",type:"text",placeholder:"~{UserName}~",toolbar:false},{name:"Keyword",type:"text",placeholder:"~{SearchByUserFirstLastUsername}~",toolbar:true}],};$(c.options.gridViewSelector).kendoArgosyGrid(b)}else{var a=$(c.options.gridViewSelector).getKendoGrid();a.dataSource.read();a.refresh()}};UserGroupBudgetDetailGridView.prototype.getDataSource=function(a){var b=this;$.extend(true,b.dataSourceOpts,_defaultDataSourceConfig,a);b.dataSourceOpts.transport={read:function(c){var d=b.options;$.extend(true,d,kendoOptionsToObject(c),b.searchCriteria);$.ajax({url:"/DataView/GetUsers",dataType:"json",data:d,success:function(e){if(b.options.budgetType=="User"){b.options.totalBudgetUsed=0;$(e.Records).each(function(f){b.options.totalBudgetUsed+=this.SpendingLimit});b.options.budgetLeftToSpend=b.options.groupBudget-b.options.totalBudgetUsed;if(b.options.budgetLeftToSpend<0){b.options.budgetLeftToSpend=0}$(b.options.availableBudgetSelector).html(kendo.toString(b.options.budgetLeftToSpend,"C"))}else{$(b.options.availableBudgetSelector).html(kendo.toString(b.options.budgetLeftToSpend,"C"))}if(e.ReturnCode===ReturnCode.Failed){handleDataSourceException(e)}else{c.success(e)}}})}};return new kendo.data.DataSource(b.dataSourceOpts)};UserGroupBudgetDetailGridView.prototype.dataSourceOpts={};function UserGroupGridView(a){var b=this;$.extend(true,b.options,b.baseOptions,a);$(document).bind(argosyEvents.SEARCH_PAGE_GRID,function(d,c){b.refineSearch(c)});b.search()}UserGroupGridView.prototype.options={};UserGroupGridView.prototype.baseOptions={gridViewSelector:"div[data-argosy-view=UserGroupGridView]",};UserGroupGridView.prototype.searchCriteria={UserGroup:null};UserGroupGridView.prototype.refineSearch=function(a){var c=this;c.searchCriteria=a;var b=$(c.options.gridViewSelector).getKendoGrid();b.dataSource.read();b.refresh()};UserGroupGridView.prototype.search=function(){var c=this;if($(c.options.gridViewSelector).getKendoGrid()==null){var b={scrollable:false,editable:false,autoBind:true,dataSource:c.getDataSource({}),groupable:false,sortable:true,selectable:"multiple, row",pageable:{refresh:true,pageSizes:[50,100,500],buttonCount:5},columns:[{title:"~{GroupName}~",field:"GroupName",template:"<a href='/Admin/UserGroups/Edit/${UserGroupId}'>${GroupName}<a>",width:"300px"},{title:"~{Description}~",field:"GroupDescription",width:"900px"},{title:"<div class='text-center'>~{Active}~</div>",field:"IsActive",template:"<div class='bold text-center'>#if (IsActive) {#<span>YES</span>#} else {#<span>NO</span>#}#</div>"}],checkboxes:true,dataBinding:function(d){},dataBound:function(g){var h=$(g.sender.element);var d=h.find(".k-button.k-button-icontext.k-grid-activate");var f=h.find(".k-button.k-button-icontext.k-grid-deactivate");d.unbind("click");f.unbind("click");d.click(function(e){c.showUpdateUserGroupModal(c.getSelectedRecords(),true)});f.click(function(e){c.showUpdateUserGroupModal(c.getSelectedRecords(),false)})},toolbar:[{name:"deactivate",text:"<i class='fa fa-close'></i><span class='resp-hidden'> ~{Deactivate}~</span>"},{name:"activate",text:"<i class='fa fa-check'></i><span class='resp-hidden'> ~{Activate}~</span>"}],search:[{name:"GroupName",type:"text",placeholder:"~{GroupName}~",toolbar:false},{name:"GroupDescription",type:"text",placeholder:"~{GroupDescription}~",toolbar:false},{name:"Keyword",type:"text",placeholder:"~{SearchGroupNameDescription}~",toolbar:true},{name:"IsActive",type:"select",toolbar:true,data:[{value:"true",text:"~{Active}~",selected:true},{value:"false",text:"~{Inactive}~"},{value:"null",text:"~{All}~"}]},{name:"IsRetail",type:"select",placeholder:"-- ~{Retail}~ --",toolbar:false,data:[{value:"true",text:"~{Yes}~"},{value:"false",text:"~{No}~"},{value:"null",text:"~{All}~"}]}],};$(c.options.gridViewSelector).kendoArgosyGrid(b)}else{var a=$(c.options.gridViewSelector).getKendoGrid();a.dataSource.read();a.refresh()}};UserGroupGridView.prototype.showUpdateUserGroupModal=function(d,a){var c=this;var b={question:"",description:"",button:"",type:"warning",yes:function(f){c.updateUserGroupState(d,a)}};if(a){b.question="~{WantToActivateSelection}~";b.description="~{ActiveUserGroupsIgnored}~";b.button="~{Activate}~"}else{b.question="~{WantToDeactivateSelection}~";b.description="~{InactiveUserGroupsIgnored}~";b.button="~{Deactivate}~"}prompt.alert(b)};UserGroupGridView.prototype.updateUserGroupState=function(d,a){var c=this;var b={userGroups:d,activate:a};$.ajax({url:"/Admin/UserGroups/UpdateUserGroupStatus",type:"POST",data:JSON.stringify(b),dataType:"json",traditional:true,contentType:"application/json; charset=utf-8",success:function(f){if(f.ReturnCode==ReturnCode.Success){$(f.Records).each(function(){prompt.notify({question:"User group "+this.Key+" was "+(!this.Value?"":"not")+" successfully "+(a?"activated.":"deactivated."),type:(!this.Value?"success":"error")})})}else{prompt.clientResponseError(f)}var e=$(c.options.gridViewSelector).getKendoGrid();e.dataSource.read();e.refresh(true)}});$.fancybox.close()};UserGroupGridView.prototype.getSelectedRecords=function(){var c=this;var b=[];var a=$(c.options.gridViewSelector).getKendoGrid();$(a.select()).each(function(d){b.push(a.dataItem(this))});return b};UserGroupGridView.prototype.getDataSource=function(a){var b=this;$.extend(true,b.dataSourceOpts,_defaultDataSourceConfig,a);b.dataSourceOpts.transport={read:function(c){var d={};$.extend(true,d,kendoOptionsToObject(c),b.searchCriteria);$.ajax({url:"/DataView/GetUserGroups",dataType:"json",data:d,success:function(e){if(e.ReturnCode==ReturnCode.Failed){handleDataSourceException(e)}else{c.success(e)}}})}};return new kendo.data.DataSource(b.dataSourceOpts)};UserGroupGridView.prototype.dataSourceOpts={};function UserGroupPartCategoriesGrid(a){var b=this;$.extend(true,b.options,b.baseOptions,a);b.setupGrid({})}UserGroupPartCategoriesGrid.prototype.options={};UserGroupPartCategoriesGrid.prototype.baseOptions={gridViewSelector:"div[data-argosy-view=UserGroupPartCategoriesGrid]"};UserGroupPartCategoriesGrid.prototype.searchCriteria={};UserGroupPartCategoriesGrid.prototype.setupGrid=function(){var c=this,a=$(c.options.gridViewSelector).getKendoGrid();if(a==null){var b={dataSource:c.getDataSource({}),groupable:false,sortable:true,scrollable:false,pageable:{refresh:false,pageSizes:false,buttonCount:1},columns:[{template:"<i class='fa la fa-times'></i>",width:"10%"},{title:"~{GroupName}~",field:"GroupName",width:"30%"},{title:"~{GroupDescription}~",field:"GroupDescrip",width:"70%"}],title:"~{PartCategoriesGroup}~",toolbar:[{name:"addEditPartCat",text:" ~{AddEdit}~ ","class":"fa fa-plus"}],addEditPartCat:function(){showAddPartCategoryToUserGroup()},dataBound:function(d){var f=$(d.sender.element);f.find("tbody tr[role=row]").each(function(){var e=d.sender.dataItem(this);var g=$(this).find(".fa.la.fa-times").parent();g.unbind("click");g.click(function(){c.showDeletePartCategoryModal(e)})})}};$(c.options.gridViewSelector).kendoCollapseGrid(b)}else{a.dataSource.read()}};UserGroupPartCategoriesGrid.prototype.showDeletePartCategoryModal=function(a){var c=this;var b={question:"",description:"",button:"",type:"warning",yes:function(d){if(typeof(d.preventDefault)==="function"){c.deletePartCategoriesFromUserGroup(a)}}};b.question="~{msgRemoveCatFromUserGroup}~";b.button="~{Remove}~";prompt.alert(b)};UserGroupPartCategoriesGrid.prototype.deletePartCategoriesFromUserGroup=function(b){var c=this;var a={partCategory:b};$.ajax({url:"/Admin/UserGroups/DeletePartCategoryFromPart",type:"POST",data:JSON.stringify(a),dataType:"json",traditional:true,contentType:"application/json; charset=utf-8",success:function(d){if(d.ReturnCode===ReturnCode.Success){$(d.Records).each(function(){prompt.notify({question:"Part(s) successfully removed.",type:"success"})})}else{prompt.clientResponseError(d)}$(c.options.gridViewSelector).find(".k-collapse-grid").getKendoGrid().dataSource.read();$("div[data-argosy-view=AddPartCategoryToUserGroupGridView]").getKendoGrid().dataSource.read()}});$.fancybox.close()};UserGroupPartCategoriesGrid.prototype.getDataSource=function(a){var b=this;$.extend(true,b.dataSourceOpts,_defaultDataSourceConfig,a);b.dataSourceOpts.pageSize=5;b.dataSourceOpts.transport={read:function(c){var d=b.options;$.extend(true,d,kendoOptionsToObject(c),b.searchCriteria);$.ajax({url:"/DataView/GetUserGroupPartCategories",dataType:"json",data:d,success:function(e){if(e.ReturnCode===ReturnCode.Failed){handleDataSourceException(e)}else{c.success(e)}}})}};return new kendo.data.DataSource(b.dataSourceOpts)};UserGroupPartCategoriesGrid.prototype.dataSourceOpts={};function UserGroupPartsGrid(a){var b=this;$.extend(true,b.options,b.baseOptions,a);b.setupGrid({})}UserGroupPartsGrid.prototype.options={};UserGroupPartsGrid.prototype.baseOptions={gridViewSelector:"div[data-argosy-view=UserGroupPartsGrid]",};UserGroupPartsGrid.prototype.searchCriteria={};UserGroupPartsGrid.prototype.setupGrid=function(){var c=this;if($(c.options.gridViewSelector).getKendoGrid()==null){var b={dataSource:c.getDataSource({}),groupable:false,sortable:true,scrollable:false,pageable:{refresh:false,pageSizes:false,buttonCount:1},columns:[{template:"<i class='fa la fa-times'></i>",width:"10%"},{title:"Product",template:"<div>#if (PartName != null && PartName.trim().length > 0) {#   #= PartName # #}else{# #= Sku # #}#</div>",width:"15%"},{title:"SKU",field:"Sku",width:"30%"},{title:"Description",field:"Description",}],title:"Parts",toolbar:[{name:"addedit",text:" Add/Edit","class":"fa fa-plus"}],dataBinding:function(d){},dataBound:function(d){var g=$(d.sender.element);var f=g.getKendoGrid();g.find("tbody tr[role=row]").each(function(){var e=f.dataItem(this);var h=$(this).find(".fa.la.fa-times").parent();h.unbind("click");h.click(function(){c.DeletePartsFromUserGroup([e])})})}};$(c.options.gridViewSelector).kendoCollapseGrid(b)}else{var a=$(c.options.gridViewSelector).getKendoGrid();a.dataSource.read();a.refresh()}};UserGroupPartsGrid.prototype.getDataSource=function(a){var b=this;$.extend(true,b.dataSourceOpts,_defaultDataSourceConfig,a);b.dataSourceOpts.pageSize=5;b.dataSourceOpts.transport={read:function(c){var d=b.options;$.extend(true,d,kendoOptionsToObject(c),b.searchCriteria);$.ajax({url:"/DataView/GetParts",dataType:"json",data:d,success:function(e){if(e.ReturnCode==ReturnCode.Failed){handleDataSourceException(e)}else{c.success(e)}}})}};return new kendo.data.DataSource(b.dataSourceOpts)};UserGroupPartsGrid.prototype.DeletePartsFromUserGroup=function(a){};UserGroupPartsGrid.prototype.dataSourceOpts={};function UserGroupUsersGrid(a){var b=this;$.extend(true,b.options,b.baseOptions,a);b.setupGrid({})}UserGroupUsersGrid.prototype.options={};UserGroupUsersGrid.prototype.baseOptions={gridViewSelector:"div[data-argosy-view=UserGroupUsersGrid]"};UserGroupUsersGrid.prototype.searchCriteria={UserGroupId:null};UserGroupUsersGrid.prototype.setupGrid=function(){var c=this,a=$(c.options.gridViewSelector).getKendoGrid();if(a==null){var b={dataSource:c.getDataSource({}),groupable:false,sortable:true,scrollable:false,pageable:{refresh:false,pageSizes:false,buttonCount:1},columns:[{template:"<i class='fa la fa-times'></i>",width:"10%"},{title:"~{UserName}~",field:"Username",width:"40%"},{title:"~{Name}~",template:"${FirstName} ${LastName}",width:"40%"},{title:"<div class='text-center'>Admin</div>",template:"<div class=' text-center '>#if (AdminAccess == true) {#<span>YES</span>#} else {#<span>NO</span>#}#</div>",width:"10%"}],title:"~{UsersInGroup}~",toolbar:[{name:"addedit",text:" ~{AddEdit}~ ","class":"fa fa-plus"}],addedit:function(){showAddUserToUserGroupModal()},dataBound:function(d){var f=$(d.sender.element);f.find("tbody tr[role=row]").each(function(){var e=d.sender.dataItem(this);var g=$(this).find(".fa.la.fa-times").parent();g.unbind("click");g.click(function(){c.showDeleteUserModal(e)})})}};$(c.options.gridViewSelector).kendoCollapseGrid(b)}else{a.dataSource.read()}};UserGroupUsersGrid.prototype.showDeleteUserModal=function(a){var c=this;var b={question:"",description:"",button:"",type:"warning",yes:function(d){if(typeof(d.preventDefault)==="function"){c.DeleteUserFromUserGroup(a)}}};b.question="~{msgRemoveUserFromUserGroup}~";b.button="~{Remove}~";prompt.alert(b)};UserGroupUsersGrid.prototype.getDataSource=function(a){var b=this;$.extend(true,b.dataSourceOpts,_defaultDataSourceConfig,a);b.dataSourceOpts.pageSize=5;b.dataSourceOpts.transport={read:function(c){var d=b.options;$.extend(true,d,kendoOptionsToObject(c),b.searchCriteria);$.ajax({url:"/DataView/GetUserGroupUsers",dataType:"json",data:d,success:function(e){if(e.ReturnCode===ReturnCode.Failed){handleDataSourceException(e)}else{c.success(e)}}})}};return new kendo.data.DataSource(b.dataSourceOpts)};UserGroupUsersGrid.prototype.DeleteUserFromUserGroup=function(c){var b=this;var a={user:c,userGroupId:0};$.ajax({url:"/Admin/Users/DeleteUsersFromUserGroup",type:"POST",data:JSON.stringify(a),dataType:"json",traditional:true,contentType:"application/json; charset=utf-8",success:function(d){if(d.ReturnCode===ReturnCode.Success){$(d.Records).each(function(){prompt.notify({question:"User(s) successfully removed.",type:"success"})})}else{prompt.clientResponseError(d)}$(b.options.gridViewSelector).find(".k-collapse-grid").getKendoGrid().dataSource.read();$("div[data-argosy-view=AddUserToUserGroupGridView]").getKendoGrid().dataSource.read()}});$.fancybox.close()};UserGroupUsersGrid.prototype.dataSourceOpts={};function UserHierarchyListTreeView(a){var b=this;$.extend(true,b.options,b.baseOptions,a);$(document).bind(argosyEvents.SHOW_USER_HIERARCHY_MODAL,function(d,c){b.show(c.href)})}UserHierarchyListTreeView.prototype.options={};UserHierarchyListTreeView.prototype.baseOptions={menuSelector:"div[data-argosy-view=UserHierarchyListTreeView]",};UserHierarchyListTreeView.prototype.show=function(a){var b=this;b.setupMenu(a)};UserHierarchyListTreeView.prototype.setupMenu=function(a){var c=this;if($(c.options.menuSelector).getKendoTreeView()==null){var b={autoBind:true,dragAndDrop:true,dataTextField:"DisplayName",dataSource:c.MenuItemsLazyLoaded(),dataBound:function(f){$.fancybox({href:a})},drop:function(i){var k=$(c.options.menuSelector).getKendoTreeView();var l=k.dataItem(i.sourceNode);var f=k.dataItem(i.destinationNode);if(f){var g=f.CompanyUserId;var h=i.dropPosition;var m=$(c.options.menuSelector).data("kendoTreeView").parent(k.findByText(f.DisplayName));var j=m.length;if(j==0&&h!=="over"){g=0;i.setValid(false)}c.updateUserHierarchy(g,l.CompanyUserId,l.ManagerUserId)}}};$(c.options.menuSelector).kendoTreeView(b)}else{var d=$(c.options.menuSelector).getKendoTreeView();d.dataSource.read()}};UserHierarchyListTreeView.prototype.updateUserHierarchy=function(a,e,b){var d=this;var c={newManagerId:a,userId:e,oldManagerId:b};$.ajax({url:"/Admin/Users/UpdateUserManager",type:"POST",data:JSON.stringify(c),dataType:"json",traditional:true,async:true,contentType:"application/json; charset=utf-8",success:function(f){if(!f.IsError){prompt.notify({question:f.Message,type:(!this.Value?"success":"error")});d.setupMenu()}else{prompt.clientResponseError(f)}}})};UserHierarchyListTreeView.prototype.MenuItemsLazyLoaded=function(){var a=new kendo.data.HierarchicalDataSource({transport:{read:{url:"/DataView/GetUsersHierarchyLazyLoad",dataType:"json"}},schema:{model:{id:"CompanyUserId",hasChildren:"HasEmployees",}}});return a};UserHierarchyListTreeView.prototype.MenuItems=function(){var b;$.ajax({type:"POST",url:"/DataView/GetUsersHierarchy",contentType:"application/json; charset=utf-8",data:JSON.stringify(),dataType:"json",async:false,success:function(c){if(c.ReturnCode==ReturnCode.Failed){alert("Error: "+ReturnCode.Failed);handleDataSourceException(c)}else{b=(c.Records)}},error:function(c){alert("Error.")}});var a=this.convertToMenu(b);return a};UserHierarchyListTreeView.prototype.convertToMenu=function(a){var c=this;var b=[];$(a).each(function(d){b.push({text:this.EmployeeName+" - "+((this.EmployeeSpendingLimit==null||this.EmployeeSpendingLimit=="")?"Users":this.EmployeeSpendingLimit),encoded:false,ManagerCompanyUserId:this.ManagerCompanyUserId,EmployeeCompanyUserId:this.EmployeeCompanyUserId,HierarchyId:this.HierarchyId,EmployeeName:this.EmployeeName,items:((this.Employees==null||this.Employees.length>0)?c.convertToMenu(this.Employees):null),})});return b};function UserInclusionTagsGrid(a){var b=this;$.extend(true,b.options,b.baseOptions,a);b.options.inclusionTags=JSON.parse(b.options.inclusionTags);b.options.setInclusionTagsDataSource();b.options.userDataSource.add({UserId:b.options.userId,CompanyId:b.options.companyId,InclusionArray:b.options.inclusionTags});b.setupInclusionTagsCollapseGrid();b.setupInclusionTagsGrid()}UserInclusionTagsGrid.prototype.options={companyId:0,userId:0,inclusionTags:[],inclusionTagsDataSource:new kendo.data.DataSource(),userDataSource:new kendo.data.DataSource({transport:{update:{url:"/Admin/Users/UpdateInclusionTags",type:"post",dataType:"json",contentType:"application/json; charset=utf-8"},parameterMap:function(a){return kendo.stringify(a)}},schema:{model:{id:"UserId"}},requestEnd:function(a){if(a.response!=null){UserInclusionTagsGrid.prototype.options.mapUserResponse(a.response)}}}),mapUserResponse:function(a){if(a.Records.InclusionArray==null){this.inclusionTags=[]}else{this.inclusionTags=a.Records.InclusionArray}$("#InclusionTags").val(a.Records.InclusionTags);this.setInclusionTagsDataSource();this.typeAheadDataSource.read()},setInclusionTagsDataSource:function(){var b=this,a=[];$.each(b.inclusionTagsDataSource.data(),function(c,d){a.push(d)});$.each(a,function(c,d){b.inclusionTagsDataSource.remove(d)});$.each(b.inclusionTags,function(c,d){b.inclusionTagsDataSource.add({name:d})})},typeAheadDataSource:new kendo.data.DataSource({sort:[{field:"name",dir:"asc"}],transport:{read:{url:"/DataView/GetTypeAheads",dataType:"json",contentType:"application/json; charset=utf-8",data:function(a){a.companyId=UserInclusionTagsGrid.prototype.options.companyId;a.tags=UserInclusionTagsGrid.prototype.options.inclusionTags.join(",");a.type=1;return a}}},pageSize:5,schema:{model:{id:"id",fields:{id:{type:"number"},name:{type:"string"}}},parse:function(a){$.each(a.Records,function(b,c){a.Records[b]={id:b,name:c}});return a},data:function(a){return a.Records},total:function(a){return a.TotalRecords}}})};UserInclusionTagsGrid.prototype.baseOptions={inclusionTagsCollapseGrid:"#inclusionTagsCollapseGrid",inclusionTagsGrid:"#inclusionTagsGrid"};UserInclusionTagsGrid.prototype.setupInclusionTagsCollapseGrid=function(){var a=this;$(a.options.inclusionTagsCollapseGrid).kendoCollapseGrid({scrollable:false,editable:false,dataSource:a.options.inclusionTagsDataSource,groupable:false,sortable:true,exportToExcel:false,toolbar:[{name:"showInclusionTags",text:" ~{Add}~","class":"fa fa-plus"}],labelProperty:"name",title:"~{InclusionTags}~",type:"list",remove:function(b){a.showRemovePrompt(b.data)},showInclusionTags:function(){$.fancybox({href:"#inclusionTagsGrid"})}})};UserInclusionTagsGrid.prototype.setupInclusionTagsGrid=function(){var c=this,a=$(c.options.inclusionTagsGrid).data("kendoGrid");if(a==null){var b={dataSource:c.options.typeAheadDataSource,groupable:false,editable:false,sortable:true,autoBind:true,scrollable:false,exportToExcel:false,selectable:"multiple, row",pageable:{refresh:true,pageSizes:false,buttonCount:1},columns:[{title:"Inclusion Tag",field:"name"}],title:"~{InclusionTags}~",toolbar:[{name:"addInclusionTags",text:"Add Selected Tags","class":"fa fa-plus"}],dataBound:function(f){var d=$(f.sender.element).find(".k-grid-addInclusionTags"),g=[];d.click(function(){if(f.sender.select().length>0){$.each(f.sender.select(),function(e,h){g.push(f.sender.dataItem(h).name)});UserInclusionTagsGrid.prototype.showAddPrompt(g)}})}};$(c.options.inclusionTagsGrid).kendoCustomGrid(b)}else{a.dataSource.read()}};UserInclusionTagsGrid.prototype.showAddPrompt=function(a){var c=this,b={buttonNoHidden:false,no:function(){$.fancybox.close()},type:"warning",yes:function(d){if(typeof(d.preventDefault)==="function"){c.addInclusionTags(a)}},question:"~{WantToAddTag}~ '"+a.join(", ")+"'?",description:"~{TagWillBeAdded}~",button:"~{Add}~"};prompt.alert(b)};UserInclusionTagsGrid.prototype.showRemovePrompt=function(a){var c=this,b={buttonNoHidden:false,no:function(){$.fancybox.close()},type:"warning",yes:function(d){if(typeof(d.preventDefault)==="function"){c.removeInclusionTag(a)}},question:"~{WantToRemove}~ '"+a.name+"'?",description:"~{CanNotRecoverDeletedTags}~",button:"~{Remove}~"};prompt.alert(b)};UserInclusionTagsGrid.prototype.removeInclusionTag=function(b){var a=this.options.userDataSource.data()[0].InclusionArray,c=a.indexOf(b.name);a.splice(c,1);this.options.userDataSource.sync();$.fancybox.close()};UserInclusionTagsGrid.prototype.addInclusionTags=function(b){var a=this.options.userDataSource.data()[0].InclusionArray;$.each(b,function(c,d){a.push(d)});this.options.userDataSource.sync();$.fancybox.close()};function UserModalGridView(a){var b=this;$.extend(true,b.options,b.baseOptions,a);$(document).bind(argosyEvents.SEARCH_PAGE_GRID,function(d,c){b.refineSearch(c)});b.refineSearch({})}UserModalGridView.prototype.options={};UserModalGridView.prototype.baseOptions={gridViewSelector:"div[data-argosy-view=UserModalGridView]",};UserModalGridView.prototype.searchCriteria={Username:null};UserModalGridView.prototype.refineSearch=function(a){var b=this;b.searchCriteria=a;b.setupGrid()};UserModalGridView.prototype.setupGrid=function(){var c=this;if($(c.options.gridViewSelector).getKendoGrid()==null){var b={scrollable:false,editable:false,autoBind:true,dataSource:c.getDataSource({}),groupable:false,sortable:true,selectable:"multiple, row",pageable:{refresh:false,pageSizes:false,buttonCount:1},columns:[{title:"Username",field:"Username",width:"100px"},{title:"<div class='text-center'>Active</div>",field:"Active",template:"<div class='bold text-center'>#if (Active == true) {#<span>YES</span>#} else {#<span>NO</span>#}#</div>"},{title:"Name",field:"LastName",template:"${FirstName} ${LastName}",width:"200px"},{title:"<div class='text-center'>Admin</div>",field:"AdminAccess",template:"<div class='text-center'>#if (AdminAccess == true) {#<span>YES</span>#} else {#<span>NO</span>#}#</div>"}],checkboxes:true,dataBinding:function(d){},dataBound:function(d){},search:[{name:"Keyword",type:"text",placeholder:"Search by First/Last Name or Username",toolbar:true},{name:"Active",type:"select",placeholder:"-- Status --",toolbar:true,data:[{value:"Y",text:"Active",selected:true},{value:"N",text:"Inactive"},{value:"",text:"All"}]}],};$(c.options.gridViewSelector).kendoArgosyGrid(b)}else{var a=$(c.options.gridViewSelector).getKendoGrid();a.dataSource.read();a.refresh()}};UserModalGridView.prototype.getDataSource=function(a){var b=this;$.extend(true,b.dataSourceOpts,_defaultDataSourceConfig,a);b.dataSourceOpts.pageSize=5;b.dataSourceOpts.transport={read:function(c){var d={};$.extend(true,d,kendoOptionsToObject(c),b.searchCriteria);$.ajax({url:"/DataView/GetUsers",dataType:"json",data:d,success:function(e){if(e.ReturnCode==ReturnCode.Failed){handleDataSourceException(e)}else{c.success(e)}}})}};return new kendo.data.DataSource(b.dataSourceOpts)};UserModalGridView.prototype.dataSourceOpts={};function UserPartCategoriesGrid(a){var b=this;$.extend(true,b.options,b.baseOptions,a);b.setupGrid({})}UserPartCategoriesGrid.prototype.options={};UserPartCategoriesGrid.prototype.baseOptions={gridViewSelector:"div[data-argosy-view=UserPartCategoriesGrid]",};UserPartCategoriesGrid.prototype.searchCriteria={};UserPartCategoriesGrid.prototype.setupGrid=function(){var b=this;if(b.kendoGrid==null){var a={dataSource:b.getDataSource({}),groupable:false,sortable:true,scrollable:false,exportToExcel:false,pageable:{refresh:true,pageSizes:false,buttonCount:1},columns:[{template:"<i class='fa la fa-times'></i>",width:"10%"},{title:"~{CategoryName}~",field:"GroupName"},{title:"~{Description}~",field:"GroupDescrip"}],title:"~{PartCategories}~",toolbar:[{name:"addPartCat",text:" ~{Add}~","class":"fa fa-plus"}],addPartCat:function(c){var d=showAddPartCategoryModal()},dataBinding:function(c){},dataBound:function(c){var d=$(c.sender.element);d.find("tbody tr[role=row]").each(function(){var e=b.kendoGrid.dataItem(this);var f=$(this).find(".fa.la.fa-times").parent();f.unbind("click");f.click(function(){b.showDeletePartCategoryFromUser(e)})})},};$(b.options.gridViewSelector).kendoCollapseGrid(a);b.kendoGrid=$(b.options.gridViewSelector).getKendoCollapseGrid().getKendoGrid()}else{b.kendoGrid.dataSource.read();b.kendoGrid.refresh()}};UserPartCategoriesGrid.prototype.showDeletePartCategoryFromUser=function(a){var c=this;var b={question:"",description:"",button:"",type:"warning",yes:function(d){if(typeof(d.preventDefault)==="function"){c.deletePartCategoriesFromUser(a)}}};b.question="~{WantToRemove}~";b.description="";b.button="~{Remove}~";prompt.alert(b)};UserPartCategoriesGrid.prototype.deletePartCategoriesFromUser=function(b){var c=this;var a={userPartCategory:b};$.ajax({url:"/Admin/Users/DeletePartCategoryFromUser",type:"POST",data:JSON.stringify(a),dataType:"json",traditional:true,contentType:"application/json; charset=utf-8",success:function(f){var d=$(c.options.gridViewSelector).find(".k-collapse-grid").getKendoGrid();if(f.ReturnCode===ReturnCode.Success){$(f.Records).each(function(){prompt.notify({question:"Category was "+(!this.Value?"":"not")+" successfully removed.",type:(!this.Value?"success":"error")})})}else{prompt.clientResponseError(f)}d.dataSource.read();d.refresh(true);var e=$("div[data-argosy-view=PartCategoryModalGridView]").getKendoGrid();e.dataSource.read();e.refresh(true)}});$.fancybox.close()};UserPartCategoriesGrid.prototype.getDataSource=function(a){var b=this;$.extend(true,b.dataSourceOpts,_defaultDataSourceConfig,a);b.dataSourceOpts.pageSize=5;b.dataSourceOpts.transport={read:function(c){var d=b.options;$.extend(true,d,kendoOptionsToObject(c),b.searchCriteria);$.ajax({url:"/DataView/GetUserPartGroups",dataType:"json",data:d,success:function(e){if(e.ReturnCode==ReturnCode.Failed){handleDataSourceException(e)}else{c.success(e)}}})}};return new kendo.data.DataSource(b.dataSourceOpts)};UserPartCategoriesGrid.prototype.dataSourceOpts={};function UserPartLimitsGrid(a){var b=this;$.extend(true,b.options,b.baseOptions,a);b.setupGrid({})}UserPartLimitsGrid.prototype.options={};UserPartLimitsGrid.prototype.baseOptions={gridViewSelector:"div[data-argosy-view=UserPartLimitsGrid]",};UserPartLimitsGrid.prototype.searchCriteria={};UserPartLimitsGrid.prototype.setupGrid=function(){var c=this;if($(c.options.gridViewSelector).getKendoGrid()==null){var b={dataSource:c.getDataSource({}),groupable:false,sortable:true,scrollable:false,exportToExcel:false,pageable:{refresh:true,pageSizes:false,buttonCount:1},columns:[{template:"<i class='fa la fa-times'></i>",width:"10%"},{title:"~{SKU}~",field:"Sku"},{title:"<span class='floatr textr'>~{LimitQty}~</span>",template:"<div class='floatr textr'>#:kendo.toString(LimitQuantity,'n0')#</div>"},{title:"<span class=''>~{TimeFrame}~</span>",template:"<div class=''>${TimeFrame}</div>"},{title:"<div class='text-center'>~{Active}~</div>",field:"Enabled",template:"<div class=' text-center '>#if (Active == 1) {#<span>YES</span>#} else {#<span>NO</span>#}#</div>"}],title:"~{ProductLimits}~",toolbar:[{name:"addedit",text:" ~{AddEdit}~","class":"fa fa-plus"}],addedit:function(d){showAddEditProductLimitsModal()},dataBinding:function(d){},dataBound:function(d){var g=$(d.sender.element);var f=g.getKendoGrid();g.find("tbody tr[role=row]").each(function(){var e=f.dataItem(this);var h=$(this).find(".fa.la.fa-times").parent();h.unbind("click");h.click(function(){c.showDeletePartLimitModal(e)})})}};$(c.options.gridViewSelector).kendoCollapseGrid(b)}else{var a=$(c.options.gridViewSelector).getKendoGrid();a.dataSource.read();a.refresh()}};UserPartLimitsGrid.prototype.showDeletePartLimitModal=function(a){var c=this;var b={question:"",description:"",button:"",type:"warning",yes:function(d){c.DeletePartLimitFromUser(a)}};b.question="~{WantToRemoveSelection}~";b.description="~{CanNotRecoverProductLimit}~";b.button="~{Remove}~";prompt.alert(b)};UserPartLimitsGrid.prototype.DeletePartLimitFromUser=function(b){var c=this;var a={partLimit:b};$.ajax({url:"/Admin/Users/DeleteUserPartLimit",type:"POST",data:JSON.stringify(a),dataType:"json",traditional:true,contentType:"application/json; charset=utf-8",success:function(f){if(f.ReturnCode==ReturnCode.Success){$(f.Records).each(function(){prompt.notify({question:"Part Limit for "+this.Key+" was "+(!this.Value?"":"not")+" successfully deleted.",type:(!this.Value?"success":"error")})})}else{prompt.clientResponseError(f)}var d=$(c.options.gridViewSelector).find(".k-collapse-grid").getKendoGrid();d.dataSource.read();d.refresh(true);var e=$("div[data-argosy-view=UserEditAddPartLimits]").getKendoGrid();e.dataSource.read();e.refresh(true)}});$.fancybox.close()};UserPartLimitsGrid.prototype.getDataSource=function(a){var b=this;$.extend(true,b.dataSourceOpts,_defaultDataSourceConfig,a);b.dataSourceOpts.pageSize=5;b.dataSourceOpts.transport={read:function(c){var d=b.options;$.extend(true,d,kendoOptionsToObject(c),b.searchCriteria);$.ajax({url:"/DataView/GetPartLimits",dataType:"json",data:d,success:function(e){if(e.ReturnCode==ReturnCode.Failed){handleDataSourceException(e)}else{c.success(e)}}})}};return new kendo.data.DataSource(b.dataSourceOpts)};UserPartLimitsGrid.prototype.dataSourceOpts={};function UserProfileUploads(b){var c=this;c.userId=b.userId;$.extend(true,c.options,c.baseOptions,b);var a=new ControlLoader();a.loadTemplate("UserProfileUploads",function(d){$(document.body).append(d);c.element=$("*[data-argosy-uuid="+c.options.uuid+"]");c.setupGrid({});c.setupEvents();$(document).trigger(c.EVENT_TEMPLATE_LOADED)})}UserProfileUploads.prototype.options={};UserProfileUploads.prototype.EVENT_TEMPLATE_LOADED="TEMPLATE_GLOBAL_FORMS_DATA_STRUCT_LOADED";UserProfileUploads.prototype.baseOptions={gridRowTemplate:"#_rowTemplate"};UserProfileUploads.prototype.addRemoveUserImages=function(b,a){var e=this;var d=$(e.element).find(".k-collapse-grid").getKendoListView();if(d!=null&&d!=undefined&&d.dataSource.data().length>0){var c=d.dataSource.data();$.each(c,function(f){var g=$("div[name=userUpload_"+c[f].uid+"]");var h=$(g).attr("id");if(a){if(g.getKendoImageEditor()!=null&&g.getKendoImageEditor()!=undefined&&g.getKendoImageEditor().response!=undefined&&g.getKendoImageEditor().response.FileName!=""&&g.getKendoImageEditor().response.FileSize>0&&$(g.getKendoImageEditor().hiddenInput).val()!=""){if(c[f].type=="profileImageUpload"&&h==b){var k=decodeURI($(g.getKendoImageEditor().hiddenInput).val());e.handleUserImageUploaded(k,"upload")}else{if(c[f].type=="logoUpload"&&h==b){var j=decodeURI($(g.getKendoImageEditor().hiddenInput).val());e.handleUserLogoUploaded(j,"upload")}}}}else{if(c[f].type=="profileImageUpload"&&h==b){e.handleUserImageUploaded("","remove")}else{if(c[f].type=="logoUpload"&&h==b){e.handleUserLogoUploaded("","remove")}}}})}};UserProfileUploads.prototype.setupEvents=function(){var a=this;$(document).bind(argosyEvents.KENDO_EDITOR_IMAGE_UPLOADED,function(d,c,b){if(b==undefined&&c.onSuccess==false){b=c.target}a.addRemoveUserImages(b,true)});$(document).bind(argosyEvents.KENDO_EDITOR_IMAGE_REMOVED,function(d,c,b){if(b==undefined&&c.onSuccess==false){b=c.target}a.addRemoveUserImages(b,false)})};UserProfileUploads.prototype.handleUserImageUploaded=function(d,a){var c=this;if((d!=""&&d!=null&&a=="upload")||a=="remove"){var b={userId:c.userId,fileUrl:d};$.ajax({url:"/Account/Details/UpdateUserProfileImage",type:"POST",data:JSON.stringify(b),dataType:"json",traditional:true,contentType:"application/json; charset=utf-8",success:function(e){if(!e.IsError){prompt.notify({question:"~{UserImageSuccessfullyUpdated}~",type:("success")});$.fancybox.close()}else{prompt.clientResponseError(e.Message);$.fancybox.close()}}})}else{prompt.notify({question:"~{SelectUploadProfileImage}~",type:"error"})}};UserProfileUploads.prototype.handleUserLogoUploaded=function(d,a){var c=this;if((d!=""&&d!=null&&a=="upload")||a=="remove"){var b={userId:c.userId,fileUrl:d};$.ajax({url:"/Account/Details/UpdateUserCompanyImage",type:"POST",data:JSON.stringify(b),dataType:"json",traditional:true,contentType:"application/json; charset=utf-8",success:function(e){if(!e.IsError){prompt.notify({question:"~{CompanyLogoSuccessfullyUpdated}~",type:("success")});$.fancybox.close()}else{prompt.clientResponseError(e.Message);$.fancybox.close()}}})}else{prompt.notify({question:"~{SelectUploadProfileImage}~",type:"error"})}};UserProfileUploads.prototype.setupGrid=function(){var b=this;if($(b.element).find(".k-collapse-grid").getKendoListView()==null){var a={dataSource:[{title:b.options.profileTitle,type:"profileImageUpload",userId:b.options.userId,thumbnail:b.options.profileThumbnail,event:b.options.profileThumbnailEvent,disabled:b.options.disabled},{title:b.options.logoTitle,type:"logoUpload",userId:b.options.userId,thumbnail:b.options.logoThumbnail,event:b.options.logoThumbnailEvent,disabled:b.options.disabled}],exportToExcel:false,groupable:false,sortable:false,scrollable:false,type:"list",title:"~{ProfileImageUploads}~",template:kendo.template($(b.options.gridRowTemplate).html()),dataBound:function(d){var c=d.sender.dataSource._data;$.each(c,function(e){var f=$("div[name=userUpload_"+c[e].uid+"]");kendo.bind(f,c[e])})}};$(b.element).kendoCollapseGrid(a);$(b.element).find(".k-listview").addClass("row")}};function UserSavedCreditCards(a){var b=this;$.extend(true,b.options,b.baseOptions,a);b.setupGrid({})}UserSavedCreditCards.prototype.options={};UserSavedCreditCards.prototype.baseOptions={userId:null};UserSavedCreditCards.prototype.searchCriteria={};UserSavedCreditCards.prototype.getElement=function(){var a=this;return $("*[data-argosy-uuid="+a.options.uuid+"]")};UserSavedCreditCards.prototype.setupGrid=function(){var d=this,a=d.getElement();a.append($("<div />"));if(a.find("div").getKendoGrid()==null){var c={dataSource:d.getDataSource({}),groupable:false,sortable:true,scrollable:false,exportToExcel:false,pageable:{refresh:false,pageSizes:false,buttonCount:1},columns:[{title:"Name",template:"<div><input type='text' value='${NameOnCard}' class='hide' style='max-width: 100px;' /> <span>${(NameOnCard != null ? NameOnCard : '')}</span></div>",},{title:"Last 4",template:"<div>${(Last4Digits != null ? Last4Digits : 'XXXX')}</div>",},{title:"Exp.",template:"<div>${kendo.toString((ExpirationDate != null ? Date.parse(ExpirationDate) : new Date(1900, 1, 1)), 'MM/yyyy')}</div>",},{title:"Default",template:"<div class='text-center'><input type='radio' name='cc-default' #if(IsDefault){#checked='checked'#}# id='cc-default-${Id}'/><label for='cc-default-${Id}'>&nbsp;</label></div>",},{title:" ",template:"<div><i class='fa fa-pencil' aria-hidden='true'></i> <i class='fa fa-times' aria-hidden='true'></i> <i class='fa fa-floppy-o hide' aria-hidden='true'></i>&nbsp;<i class='fa fa-ban hide' aria-hidden='true'></i></div>",width:60}],title:"Payment Methods",notes:"Expired cards are automatically removed",dataBinding:function(f){},dataBound:function(f){var h=$(f.sender.element);var g=h.getKendoGrid();h.find("tbody tr[role=row]").each(function(){var e=g.dataItem(this),i=$(this).find(".fa-times"),j=$(this).find(".fa-pencil"),k=$(this).find("input[type=radio]");j.unbind("click");j.click(function(){d.editPaymentMethod($(this).closest("tr"),e)});i.unbind("click");i.click(function(){d.deletePaymentMethod(e)});k.unbind("click");k.click(function(){d.setDefaultPaymentMethod(e)})});$("div[data-role=customgrid] th:eq(3),div[data-role=customgrid]  tr td:nth-child(2)").addClass("hidden-sm");$("div[data-role=customgrid] th:eq(4),div[data-role=customgrid]  tr td:nth-child(3)").addClass("hidden-sm hidden-md")}};a.find("div").kendoCollapseGrid(c)}else{var b=a.find("div").getKendoGrid();b.dataSource.read();b.refresh()}};UserSavedCreditCards.prototype.setDefaultPaymentMethod=function(a){var c=this,b=c.getElement();a.IsDefault=true;$.post({url:"/Users/UpdatePaymentMethod",dataType:"json",contentType:"application/json; charset=utf-8",data:JSON.stringify({token:a.toJSON()}),success:function(e){var d=b.find("[data-role='customgrid']").getKendoGrid();d.dataSource.read();d.refresh()}})};UserSavedCreditCards.prototype.editPaymentMethod=function(h,b){var k=this,d=k.getElement(),e=h.find("input"),j=h.find("span"),f=h.find(".fa-pencil"),c=h.find(".fa-times"),i=h.find(".fa-floppy-o"),a=h.find(".fa-ban"),g=function(){e.addClass("hide");i.addClass("hide");a.addClass("hide");j.removeClass("hide");c.removeClass("hide");f.removeClass("hide")};j.addClass("hide");c.addClass("hide");f.addClass("hide");e.removeClass("hide");i.removeClass("hide");a.removeClass("hide");a.unbind("click");a.bind("click",function(){g()});i.unbind("click");i.bind("click",function(){b.NameOnCard=e.val();$.post({url:"/Users/UpdatePaymentMethod",dataType:"json",contentType:"application/json; charset=utf-8",data:JSON.stringify({token:b.toJSON()}),success:function(m){var l=d.find("[data-role='customgrid']").getKendoGrid();l.dataSource.read();l.refresh();g()}})})};UserSavedCreditCards.prototype.deletePaymentMethod=function(a){var c=this,b=c.getElement();$.post({url:"/Users/DeletePaymentMethod",dataType:"json",contentType:"application/json; charset=utf-8",data:JSON.stringify({token:a.toJSON()}),success:function(e){var d=b.find("[data-role='customgrid']").getKendoGrid();d.dataSource.read();d.refresh()}})};UserSavedCreditCards.prototype.getDataSource=function(a){var b=this;$.extend(true,b.dataSourceOpts,_defaultDataSourceConfig,a);b.dataSourceOpts.pageSize=5;b.dataSourceOpts.transport={read:function(c){var d={};$.extend(true,d,kendoOptionsToObject(c),b.searchCriteria);$.ajax({url:"/DataView/GetSavedPaymentMethods",dataType:"json",data:d,success:function(e){if(e.ReturnCode==ReturnCode.Failed){handleDataSourceException(e)}else{c.success(e)}}})}};return new kendo.data.DataSource(b.dataSourceOpts)};UserSavedCreditCards.prototype.dataSourceOpts={};